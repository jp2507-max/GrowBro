
> growbro@0.0.1 test
> jest --runInBand --forceExit

node.exe : ÔùÅ Deprecation Warning:
In C:\Program Files\nodejs\npm.ps1:29 Zeichen:3
+   & $NODE_EXE $NPM_CLI_JS $args
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (ÔùÅ Deprec 
   ation Warning::String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError
 

  Option "timers" was replaced by "fakeTimers".

  Please update your configuration.

  Configuration Documentation:
  https://jestjs.io/docs/configuration

ÔùÅ Deprecation Warning:

  Option "timers" was replaced by "fakeTimers".

  Please update your configuration.

  Configuration Documentation:
  https://jestjs.io/docs/configuration

FAIL src/lib/moderation/monitoring-service.test.ts 
(72.671 s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ MonitoringService ÔÇ║ getDashboard ÔÇ║ should 
return comprehensive monitoring dashboard

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 34 |[39m
     [90m 35 |[39m   
describe([32m'getDashboard'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 36 |[39m     
it([32m'should return comprehensive monitoring 
dashboard'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 37 |[39m       [90m// Mock all database 
queries[39m
     [90m 38 |[39m       mockSupabase[33m.[39m[36mf
rom[39m[33m.[39mmockReturnValue({
     [90m 39 |[39m         select[33m:[39m jest[33m
.[39mfn()[33m.[39mmockReturnThis()[33m,[39m[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:36:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:35:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

  ÔùÅ MonitoringService ÔÇ║ getDashboard ÔÇ║ should 
calculate health status based on alerts

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 57 |[39m     }[33m,[39m 
[35m10000[39m)[33m;[39m
     [90m 58 |[39m
    [31m[1m>[22m[39m[90m 59 |[39m     
it([32m'should calculate health status based on 
alerts'[39m[33m,[39m [36masync[39m () [33m=>[39m 
{
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 60 |[39m       mockSupabase[33m.[39m[36mf
rom[39m[33m.[39mmockReturnValue({
     [90m 61 |[39m         select[33m:[39m jest[33m
.[39mfn()[33m.[39mmockReturnThis()[33m,[39m
     [90m 62 |[39m         eq[33m:[39m jest[33m.[3
9mfn()[33m.[39mmockReturnThis()[33m,[39m[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:59:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:35:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

  ÔùÅ MonitoringService ÔÇ║ getAuditIntegrityMetrics 
ÔÇ║ should detect signature mismatches

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 1
    Received:    0

    [0m [90m 216 |[39m       [36mconst[39m metrics 
[33m=[39m [36mawait[39m 
service[33m.[39mgetAuditIntegrityMetrics()[33m;[39m
     [90m 217 |[39m
    [31m[1m>[22m[39m[90m 218 |[39m       expect(me
trics[33m.[39msignature_mismatches)[33m.[39mtoBeGrea
terThanOrEqual([35m1[39m)[33m;[39m
     [90m     |[39m                                   
         [31m[1m^[22m[39m
     [90m 219 |[39m       expect(metrics[33m.[39mint
egrity_violations)[33m.[39mtoBeGreaterThanOrEqual([35
m1[39m)[33m;[39m
     [90m 220 |[39m     })[33m;[39m
     [90m 221 |[39m   })[33m;[39m[0m

      at Object.toBeGreaterThanOrEqual 
(src/lib/moderation/monitoring-service.test.ts:218:44)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ MonitoringService ÔÇ║ getCapacityMetrics ÔÇ║ 
should calculate queue depths

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 222 |[39m
     [90m 223 |[39m   
describe([32m'getCapacityMetrics'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 224 |[39m     
it([32m'should calculate queue depths'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 225 |[39m       mockSupabase[33m.[39m[36m
from[39m[33m.[39mmockImplementation((table[33m:[39m
 string) [33m=>[39m {
     [90m 226 |[39m         [36mconst[39m 
counts[33m:[39m 
[33mRecord[39m[33m<[39m[33mstring[39m[33m,[39m 
number[33m>[39m [33m=[39m {
     [90m 227 |[39m           reports[33m:[39m 
[35m50[39m[33m,[39m[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:224:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:223:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

  ÔùÅ MonitoringService ÔÇ║ getCapacityMetrics ÔÇ║ 
should calculate moderator utilization

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 250 |[39m     }[33m,[39m 
[35m10000[39m)[33m;[39m
     [90m 251 |[39m
    [31m[1m>[22m[39m[90m 252 |[39m     
it([32m'should calculate moderator 
utilization'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 253 |[39m       mockSupabase[33m.[39m[36m
from[39m[33m.[39mmockImplementation((table[33m:[39m
 string) [33m=>[39m {
     [90m 254 |[39m         [36mif[39m (table 
[33m===[39m [32m'moderation_sessions'[39m) {
     [90m 255 |[39m           [36mreturn[39m {[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:252:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:223:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

  ÔùÅ MonitoringService ÔÇ║ getCapacityMetrics ÔÇ║ 
should estimate capacity hours

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 279 |[39m     }[33m,[39m 
[35m10000[39m)[33m;[39m
     [90m 280 |[39m
    [31m[1m>[22m[39m[90m 281 |[39m     
it([32m'should estimate capacity 
hours'[39m[33m,[39m [36masync[39m () [33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 282 |[39m       mockSupabase[33m.[39m[36m
from[39m[33m.[39mmockReturnValue({
     [90m 283 |[39m         select[33m:[39m jest[33
m.[39mfn()[33m.[39mmockReturnThis()[33m,[39m
     [90m 284 |[39m         [36min[39m[33m:[39m je
st[33m.[39mfn()[33m.[39mmockReturnThis()[33m,[39m
[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:281:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:223:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

  ÔùÅ MonitoringService ÔÇ║ Alert Generation ÔÇ║ should 
generate performance alerts for high latency

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 296 |[39m
     [90m 297 |[39m   describe([32m'Alert 
Generation'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 298 |[39m     
it([32m'should generate performance alerts for high 
latency'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 299 |[39m       mockSupabase[33m.[39m[36m
from[39m[33m.[39mmockReturnValue({
     [90m 300 |[39m         select[33m:[39m jest[33
m.[39mfn()[33m.[39mmockReturnThis()[33m,[39m
     [90m 301 |[39m         eq[33m:[39m jest[33m.[
39mfn()[33m.[39mmockReturnThis()[33m,[39m[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:298:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:297:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

  ÔùÅ MonitoringService ÔÇ║ Alert Generation ÔÇ║ should 
generate compliance alerts for DSA failures

    TypeError: _supabase.supabase.from(...).select(...).
eq(...).gte(...).order is not a function

    [0m [90m 188 |[39m       
[33m.[39meq([32m'event_type'[39m[33m,[39m 
[32m'report_submitted'[39m)
     [90m 189 |[39m       
[33m.[39mgte([32m'timestamp'[39m[33m,[39m 
oneHourAgo[33m.[39mtoISOString())
    [31m[1m>[22m[39m[90m 190 |[39m       
[33m.[39morder([32m'timestamp'[39m[33m,[39m { 
ascending[33m:[39m [36mfalse[39m })
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 191 |[39m       
[33m.[39mlimit([35m1000[39m)[33m;[39m
     [90m 192 |[39m
     [90m 193 |[39m     [36mconst[39m { 
data[33m:[39m decisionTimes } [33m=[39m 
[36mawait[39m supabase[0m

      at MonitoringService.order 
(src/lib/moderation/monitoring-service.ts:190:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at MonitoringService.<anonymous> (node_modules/@ba
bel/runtime/helpers/asyncToGenerator.js:14:12)
      at MonitoringService.apply [as 
getPerformanceMetrics] 
(src/lib/moderation/monitoring-service.ts:180:30)
      at MonitoringService.getPerformanceMetrics 
(src/lib/moderation/monitoring-service.ts:152:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at MonitoringService.<anonymous> (node_modules/@ba
bel/runtime/helpers/asyncToGenerator.js:14:12)
      at MonitoringService.apply [as getDashboard] 
(src/lib/moderation/monitoring-service.ts:150:21)
      at Object.getDashboard 
(src/lib/moderation/monitoring-service.test.ts:337:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ MonitoringService ÔÇ║ Alert Generation ÔÇ║ should 
generate capacity alerts for low capacity

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 343 |[39m     }[33m,[39m 
[35m10000[39m)[33m;[39m
     [90m 344 |[39m
    [31m[1m>[22m[39m[90m 345 |[39m     
it([32m'should generate capacity alerts for low 
capacity'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 346 |[39m       mockSupabase[33m.[39m[36m
from[39m[33m.[39mmockReturnValue({
     [90m 347 |[39m         select[33m:[39m jest[33
m.[39mfn()[33m.[39mmockReturnThis()[33m,[39m
     [90m 348 |[39m         eq[33m:[39m jest[33m.[
39mfn()[33m.[39mmockReturnThis()[33m,[39m[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:345:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:297:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

FAIL src/lib/inventory/__tests__/telemetry-performance.t
est.ts (30.084 s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      [Inventory Telemetry] Failed to track low stock: 
Error: Analytics unavailable
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\inventory\__tests__\telemetry-performance.test.t
s:271:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 69 |[39m     [90m// Analytics failures 
should not break inventory operations[39m
     [90m 70 |[39m     [36mif[39m (__DEV__) {
    [31m[1m>[22m[39m[90m 71 |[39m       
console[33m.[39mwarn([32m'[Inventory Telemetry] 
Failed to track low stock:'[39m[33m,[39m 
error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 72 |[39m     }
     [90m 73 |[39m   }
     [90m 74 |[39m }[0m

      at warn (src/lib/inventory/telemetry.ts:71:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ Inventory Telemetry Performance ÔÇ║ Low Stock 
Tracking Overhead ÔÇ║ should have <1% overhead on stock 
checks

    expect(received).toBeLessThan(expected)

    Expected: < 1
    Received:   84.43456162642948

    [0m [90m 64 |[39m       [36mconst[39m 
overheadPercent [33m=[39m (overhead [33m/[39m 
baselineDuration) [33m*[39m [35m100[39m[33m;[39m
     [90m 65 |[39m
    [31m[1m>[22m[39m[90m 66 |[39m       expect(ove
rheadPercent)[33m.[39mtoBeLessThan([35m1[39m)[33m;
[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 67 |[39m       expect([33mNoopAnalytics[39
m[33m.[39mtrack)[33m.[39mtoHaveBeenCalledTimes(itera
tions)[33m;[39m
     [90m 68 |[39m     })[33m;[39m
     [90m 69 |[39m   })[33m;[39m[0m

      at Object.toBeLessThan (src/lib/inventory/__tests_
_/telemetry-performance.test.ts:66:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Telemetry Performance ÔÇ║ Deduction 
Failure Tracking Overhead ÔÇ║ should have <1% overhead 
on deduction failures

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 70 |[39m
     [90m 71 |[39m   describe([32m'Deduction Failure 
Tracking Overhead'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 72 |[39m     
it([32m'should have <1% overhead on deduction 
failures'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 73 |[39m       [36mconst[39m 
operationTime [33m=[39m [35m50[39m[33m;[39m 
[90m// 50ms for deduction operation[39m
     [90m 74 |[39m       [36mconst[39m iterations 
[33m=[39m [35m50[39m[33m;[39m
     [90m 75 |[39m[0m

      at it (src/lib/inventory/__tests__/telemetry-perfo
rmance.test.ts:72:5)
      at describe (src/lib/inventory/__tests__/telemetry
-performance.test.ts:71:3)
      at Object.describe (src/lib/inventory/__tests__/te
lemetry-performance.test.ts:31:1)

  ÔùÅ Inventory Telemetry Performance ÔÇ║ Import Error 
Tracking Overhead ÔÇ║ should have <1% overhead on 
import operations

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 106 |[39m
     [90m 107 |[39m   describe([32m'Import Error 
Tracking Overhead'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 108 |[39m     
it([32m'should have <1% overhead on import 
operations'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 109 |[39m       [36mconst[39m 
operationTime [33m=[39m [35m200[39m[33m;[39m 
[90m// 200ms for import operation[39m
     [90m 110 |[39m       [36mconst[39m iterations 
[33m=[39m [35m20[39m[33m;[39m
     [90m 111 |[39m[0m

      at it (src/lib/inventory/__tests__/telemetry-perfo
rmance.test.ts:108:5)
      at describe (src/lib/inventory/__tests__/telemetry
-performance.test.ts:107:3)
      at Object.describe (src/lib/inventory/__tests__/te
lemetry-performance.test.ts:31:1)

  ÔùÅ Inventory Telemetry Performance ÔÇ║ CSV Operation 
Tracking Overhead ÔÇ║ should have <1% overhead on CSV 
export

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 137 |[39m
     [90m 138 |[39m   describe([32m'CSV Operation 
Tracking Overhead'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 139 |[39m     
it([32m'should have <1% overhead on CSV 
export'[39m[33m,[39m [36masync[39m () [33m=>[39m 
{
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 140 |[39m       [36mconst[39m 
operationTime [33m=[39m [35m1000[39m[33m;[39m 
[90m// 1000ms for large CSV export[39m
     [90m 141 |[39m       [36mconst[39m iterations 
[33m=[39m [35m10[39m[33m;[39m
     [90m 142 |[39m[0m

      at it (src/lib/inventory/__tests__/telemetry-perfo
rmance.test.ts:139:5)
      at describe (src/lib/inventory/__tests__/telemetry
-performance.test.ts:138:3)
      at Object.describe (src/lib/inventory/__tests__/te
lemetry-performance.test.ts:31:1)

  ÔùÅ Inventory Telemetry Performance ÔÇ║ Batch 
Operation Tracking Overhead ÔÇ║ should have <1% 
overhead on batch operations

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 170 |[39m
     [90m 171 |[39m   describe([32m'Batch Operation 
Tracking Overhead'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 172 |[39m     
it([32m'should have <1% overhead on batch 
operations'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 173 |[39m       [36mconst[39m 
operationTime [33m=[39m [35m30[39m[33m;[39m 
[90m// 30ms for batch operation[39m
     [90m 174 |[39m       [36mconst[39m iterations 
[33m=[39m [35m100[39m[33m;[39m
     [90m 175 |[39m[0m

      at it (src/lib/inventory/__tests__/telemetry-perfo
rmance.test.ts:172:5)
      at describe (src/lib/inventory/__tests__/telemetry
-performance.test.ts:171:3)
      at Object.describe (src/lib/inventory/__tests__/te
lemetry-performance.test.ts:31:1)

  ÔùÅ Inventory Telemetry Performance ÔÇ║ Memory Impact 
ÔÇ║ should not accumulate memory with repeated tracking

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 233 |[39m
     [90m 234 |[39m   describe([32m'Memory 
Impact'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 235 |[39m     
it([32m'should not accumulate memory with repeated 
tracking'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 236 |[39m       [36mconst[39m iterations 
[33m=[39m [35m1000[39m[33m;[39m
     [90m 237 |[39m
     [90m 238 |[39m       [90m// Track memory 
before[39m[0m

      at it (src/lib/inventory/__tests__/telemetry-perfo
rmance.test.ts:235:5)
      at describe (src/lib/inventory/__tests__/telemetry
-performance.test.ts:234:3)
      at Object.describe (src/lib/inventory/__tests__/te
lemetry-performance.test.ts:31:1)

FAIL src/lib/strains/__tests__/integration.test.tsx 
(9.581 s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.log
      [auth] onAuthStateChange INITIAL_SESSION false

      at log (src/lib/auth/index.tsx:404:13)

    console.debug
      [StrainsApiClient] Cache tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at 
C:\Users\Peter\GrowBro\src\api\strains\client.ts:21:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply 
(C:\Users\Peter\GrowBro\src\api\strains\client.ts:27:2)
          at apply 
(C:\Users\Peter\GrowBro\src\api\strains\client.ts:19:34)
          at StrainsApiClient.getAnalyticsClient (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:699:31)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as 
trackCacheOperation] (C:\Users\Peter\GrowBro\src\api\str
ains\client.ts:692:36)
          at StrainsApiClient.trackCacheOperation [as 
getCachedETag] (C:\Users\Peter\GrowBro\src\api\strains\c
lient.ts:625:15)
          at StrainsApiClient.getCachedETag [as 
buildRequestConfig] (C:\Users\Peter\GrowBro\src\api\stra
ins\client.ts:407:29)
          at StrainsApiClient.buildRequestConfig (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:367:25)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as getStrains] (C:\
Users\Peter\GrowBro\src\api\strains\client.ts:362:19)
          at getStrains (C:\Users\Peter\GrowBro\src\api\
strains\use-strains-infinite.ts:55:37)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\strai
ns\use-strains-infinite.ts:52:12)
          at fetchPage (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\infiniteQueryBehavior.ts:74
:30)
          at Object.fetchFn [as fn] (C:\Users\Peter\Grow
Bro\node_modules\@tanstack\query-core\src\infiniteQueryB
ehavior.ts:108:28)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Query.fetch (C:\Users\Peter\GrowBro\node_mo
dules\@tanstack\query-core\src\query.ts:547:40)
          at InfiniteQueryObserver.#executeFetch (C:\Use
rs\Peter\GrowBro\node_modules\@tanstack\query-core\src\q
ueryObserver.ts:341:71)
          at InfiniteQueryObserver.onSubscribe (C:\Users
\Peter\GrowBro\node_modules\@tanstack\query-core\src\que
ryObserver.ts:101:14)
          at InfiniteQueryObserver.subscribe (C:\Users\P
eter\GrowBro\node_modules\@tanstack\query-core\src\subsc
ribable.ts:11:10)
          at C:\Users\Peter\GrowBro\node_modules\@tansta
ck\react-query\src\useBaseQuery.ts:100:22
          at subscribeToStore (C:\Users\Peter\GrowBro\no
de_modules\react-test-renderer\cjs\react-test-renderer.d
evelopment.js:3414:14)
          at Object.react-stack-bottom-frame (C:\Users\P
eter\GrowBro\node_modules\react-test-renderer\cjs\react-
test-renderer.development.js:14062:20)
          at runWithFiberInDEV (C:\Users\Peter\GrowBro\n
ode_modules\react-test-renderer\cjs\react-test-renderer.
development.js:1574:13)
          at commitHookEffectListMount (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:8376:29)
          at commitHookPassiveMountEffects (C:\Users\Pet
er\GrowBro\node_modules\react-test-renderer\cjs\react-te
st-renderer.development.js:8463:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9782:13)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9897:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9794:11)
          at flushPendingEffects (C:\Users\Peter\GrowBro
\node_modules\react-test-renderer\cjs\react-test-rendere
r.development.js:11528:11)
          at performWorkOnRootViaSchedulerTask (C:\Users
\Peter\GrowBro\node_modules\react-test-renderer\cjs\reac
t-test-renderer.development.js:2082:11)
          at flushActQueue (C:\Users\Peter\GrowBro\node_
modules\react\cjs\react.development.js:566:34)
          at 
Object.<anonymous>.process.env.NODE_ENV.exports.act (C:\
Users\Peter\GrowBro\node_modules\react\cjs\react.develop
ment.js:859:10)
          at actImplementation (C:\Users\Peter\GrowBro\n
ode_modules\@testing-library\react-native\src\act.ts:30:
25)
          at renderWithAct (C:\Users\Peter\GrowBro\node_
modules\@testing-library\react-native\src\render-act.ts:
12:11)
          at renderInternal (C:\Users\Peter\GrowBro\node
_modules\@testing-library\react-native\src\render.tsx:81
:33)
          at renderHook (C:\Users\Peter\GrowBro\node_mod
ules\@testing-library\react-native\src\render-hook.tsx:3
5:61)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\strains\__tests__\integration.test.tsx:87:36)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at StrainsApiClient.debug 
(src/api/strains/client.ts:713:15)
          at Generator.throw (<anonymous>)

    console.debug
      [StrainsApiClient] Cache tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at 
C:\Users\Peter\GrowBro\src\api\strains\client.ts:21:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply 
(C:\Users\Peter\GrowBro\src\api\strains\client.ts:19:34)
          at StrainsApiClient.getAnalyticsClient (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:699:31)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as 
trackCacheOperation] (C:\Users\Peter\GrowBro\src\api\str
ains\client.ts:692:36)
          at StrainsApiClient.trackCacheOperation [as 
getCachedETag] (C:\Users\Peter\GrowBro\src\api\strains\c
lient.ts:625:15)
          at StrainsApiClient.getCachedETag [as 
buildRequestConfig] (C:\Users\Peter\GrowBro\src\api\stra
ins\client.ts:407:29)
          at StrainsApiClient.buildRequestConfig (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:367:25)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as getStrains] (C:\
Users\Peter\GrowBro\src\api\strains\client.ts:362:19)
          at getStrains (C:\Users\Peter\GrowBro\src\api\
strains\use-strains-infinite.ts:55:37)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\strai
ns\use-strains-infinite.ts:52:12)
          at fetchPage (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\infiniteQueryBehavior.ts:74
:30)
          at Object.fetchFn [as fn] (C:\Users\Peter\Grow
Bro\node_modules\@tanstack\query-core\src\infiniteQueryB
ehavior.ts:108:28)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Query.fetch (C:\Users\Peter\GrowBro\node_mo
dules\@tanstack\query-core\src\query.ts:547:40)
          at InfiniteQueryObserver.#executeFetch (C:\Use
rs\Peter\GrowBro\node_modules\@tanstack\query-core\src\q
ueryObserver.ts:341:71)
          at InfiniteQueryObserver.onSubscribe (C:\Users
\Peter\GrowBro\node_modules\@tanstack\query-core\src\que
ryObserver.ts:101:14)
          at InfiniteQueryObserver.subscribe (C:\Users\P
eter\GrowBro\node_modules\@tanstack\query-core\src\subsc
ribable.ts:11:10)
          at C:\Users\Peter\GrowBro\node_modules\@tansta
ck\react-query\src\useBaseQuery.ts:100:22
          at subscribeToStore (C:\Users\Peter\GrowBro\no
de_modules\react-test-renderer\cjs\react-test-renderer.d
evelopment.js:3414:14)
          at Object.react-stack-bottom-frame (C:\Users\P
eter\GrowBro\node_modules\react-test-renderer\cjs\react-
test-renderer.development.js:14062:20)
          at runWithFiberInDEV (C:\Users\Peter\GrowBro\n
ode_modules\react-test-renderer\cjs\react-test-renderer.
development.js:1574:13)
          at commitHookEffectListMount (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:8376:29)
          at commitHookPassiveMountEffects (C:\Users\Pet
er\GrowBro\node_modules\react-test-renderer\cjs\react-te
st-renderer.development.js:8463:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9782:13)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9897:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9794:11)
          at flushPendingEffects (C:\Users\Peter\GrowBro
\node_modules\react-test-renderer\cjs\react-test-rendere
r.development.js:11528:11)
          at performWorkOnRootViaSchedulerTask (C:\Users
\Peter\GrowBro\node_modules\react-test-renderer\cjs\reac
t-test-renderer.development.js:2082:11)
          at flushActQueue (C:\Users\Peter\GrowBro\node_
modules\react\cjs\react.development.js:566:34)
          at 
Object.<anonymous>.process.env.NODE_ENV.exports.act (C:\
Users\Peter\GrowBro\node_modules\react\cjs\react.develop
ment.js:859:10)
          at actImplementation (C:\Users\Peter\GrowBro\n
ode_modules\@testing-library\react-native\src\act.ts:30:
25)
          at renderWithAct (C:\Users\Peter\GrowBro\node_
modules\@testing-library\react-native\src\render-act.ts:
12:11)
          at renderInternal (C:\Users\Peter\GrowBro\node
_modules\@testing-library\react-native\src\render.tsx:81
:33)
          at renderHook (C:\Users\Peter\GrowBro\node_mod
ules\@testing-library\react-native\src\render-hook.tsx:3
5:61)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\strains\__tests__\integration.test.tsx:133:36)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at StrainsApiClient.debug 
(src/api/strains/client.ts:713:15)
          at Generator.throw (<anonymous>)

    console.debug
      [StrainsApiClient] Cache tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at 
C:\Users\Peter\GrowBro\src\api\strains\client.ts:21:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply 
(C:\Users\Peter\GrowBro\src\api\strains\client.ts:19:34)
          at StrainsApiClient.getAnalyticsClient (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:699:31)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as 
trackCacheOperation] (C:\Users\Peter\GrowBro\src\api\str
ains\client.ts:692:36)
          at StrainsApiClient.trackCacheOperation [as 
getCachedETag] (C:\Users\Peter\GrowBro\src\api\strains\c
lient.ts:625:15)
          at StrainsApiClient.getCachedETag [as 
buildRequestConfig] (C:\Users\Peter\GrowBro\src\api\stra
ins\client.ts:407:29)
          at StrainsApiClient.buildRequestConfig (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:367:25)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as getStrains] (C:\
Users\Peter\GrowBro\src\api\strains\client.ts:362:19)
          at getStrains (C:\Users\Peter\GrowBro\src\api\
strains\use-strains-infinite.ts:55:37)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\strai
ns\use-strains-infinite.ts:52:12)
          at fetchPage (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\infiniteQueryBehavior.ts:74
:30)
          at Object.fetchFn [as fn] (C:\Users\Peter\Grow
Bro\node_modules\@tanstack\query-core\src\infiniteQueryB
ehavior.ts:108:28)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Query.fetch (C:\Users\Peter\GrowBro\node_mo
dules\@tanstack\query-core\src\query.ts:547:40)
          at InfiniteQueryObserver.#executeFetch (C:\Use
rs\Peter\GrowBro\node_modules\@tanstack\query-core\src\q
ueryObserver.ts:341:71)
          at InfiniteQueryObserver.onSubscribe (C:\Users
\Peter\GrowBro\node_modules\@tanstack\query-core\src\que
ryObserver.ts:101:14)
          at InfiniteQueryObserver.subscribe (C:\Users\P
eter\GrowBro\node_modules\@tanstack\query-core\src\subsc
ribable.ts:11:10)
          at C:\Users\Peter\GrowBro\node_modules\@tansta
ck\react-query\src\useBaseQuery.ts:100:22
          at subscribeToStore (C:\Users\Peter\GrowBro\no
de_modules\react-test-renderer\cjs\react-test-renderer.d
evelopment.js:3414:14)
          at Object.react-stack-bottom-frame (C:\Users\P
eter\GrowBro\node_modules\react-test-renderer\cjs\react-
test-renderer.development.js:14062:20)
          at runWithFiberInDEV (C:\Users\Peter\GrowBro\n
ode_modules\react-test-renderer\cjs\react-test-renderer.
development.js:1574:13)
          at commitHookEffectListMount (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:8376:29)
          at commitHookPassiveMountEffects (C:\Users\Pet
er\GrowBro\node_modules\react-test-renderer\cjs\react-te
st-renderer.development.js:8463:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9782:13)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9897:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9794:11)
          at flushPendingEffects (C:\Users\Peter\GrowBro
\node_modules\react-test-renderer\cjs\react-test-rendere
r.development.js:11528:11)
          at performWorkOnRootViaSchedulerTask (C:\Users
\Peter\GrowBro\node_modules\react-test-renderer\cjs\reac
t-test-renderer.development.js:2082:11)
          at flushActQueue (C:\Users\Peter\GrowBro\node_
modules\react\cjs\react.development.js:566:34)
          at 
Object.<anonymous>.process.env.NODE_ENV.exports.act (C:\
Users\Peter\GrowBro\node_modules\react\cjs\react.develop
ment.js:859:10)
          at actImplementation (C:\Users\Peter\GrowBro\n
ode_modules\@testing-library\react-native\src\act.ts:30:
25)
          at renderWithAct (C:\Users\Peter\GrowBro\node_
modules\@testing-library\react-native\src\render-act.ts:
12:11)
          at renderInternal (C:\Users\Peter\GrowBro\node
_modules\@testing-library\react-native\src\render.tsx:81
:33)
          at renderHook (C:\Users\Peter\GrowBro\node_mod
ules\@testing-library\react-native\src\render-hook.tsx:3
5:61)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\strains\__tests__\integration.test.tsx:155:36)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at StrainsApiClient.debug 
(src/api/strains/client.ts:713:15)
          at Generator.throw (<anonymous>)

    console.debug
      [StrainsApiClient] Cache tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at 
C:\Users\Peter\GrowBro\src\api\strains\client.ts:21:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply 
(C:\Users\Peter\GrowBro\src\api\strains\client.ts:19:34)
          at StrainsApiClient.getAnalyticsClient (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:699:31)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as 
trackCacheOperation] (C:\Users\Peter\GrowBro\src\api\str
ains\client.ts:692:36)
          at StrainsApiClient.trackCacheOperation [as 
getCachedETag] (C:\Users\Peter\GrowBro\src\api\strains\c
lient.ts:625:15)
          at StrainsApiClient.getCachedETag [as 
buildRequestConfig] (C:\Users\Peter\GrowBro\src\api\stra
ins\client.ts:407:29)
          at StrainsApiClient.buildRequestConfig (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:367:25)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as getStrains] (C:\
Users\Peter\GrowBro\src\api\strains\client.ts:362:19)
          at getStrains (C:\Users\Peter\GrowBro\src\api\
strains\use-strains-infinite.ts:55:37)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\strai
ns\use-strains-infinite.ts:52:12)
          at fetchPage (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\infiniteQueryBehavior.ts:74
:30)
          at Object.fetchFn [as fn] (C:\Users\Peter\Grow
Bro\node_modules\@tanstack\query-core\src\infiniteQueryB
ehavior.ts:108:28)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Query.fetch (C:\Users\Peter\GrowBro\node_mo
dules\@tanstack\query-core\src\query.ts:547:40)
          at InfiniteQueryObserver.#executeFetch (C:\Use
rs\Peter\GrowBro\node_modules\@tanstack\query-core\src\q
ueryObserver.ts:341:71)
          at InfiniteQueryObserver.onSubscribe (C:\Users
\Peter\GrowBro\node_modules\@tanstack\query-core\src\que
ryObserver.ts:101:14)
          at InfiniteQueryObserver.subscribe (C:\Users\P
eter\GrowBro\node_modules\@tanstack\query-core\src\subsc
ribable.ts:11:10)
          at C:\Users\Peter\GrowBro\node_modules\@tansta
ck\react-query\src\useBaseQuery.ts:100:22
          at subscribeToStore (C:\Users\Peter\GrowBro\no
de_modules\react-test-renderer\cjs\react-test-renderer.d
evelopment.js:3414:14)
          at Object.react-stack-bottom-frame (C:\Users\P
eter\GrowBro\node_modules\react-test-renderer\cjs\react-
test-renderer.development.js:14062:20)
          at runWithFiberInDEV (C:\Users\Peter\GrowBro\n
ode_modules\react-test-renderer\cjs\react-test-renderer.
development.js:1574:13)
          at commitHookEffectListMount (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:8376:29)
          at commitHookPassiveMountEffects (C:\Users\Pet
er\GrowBro\node_modules\react-test-renderer\cjs\react-te
st-renderer.development.js:8463:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9782:13)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9897:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9794:11)
          at flushPendingEffects (C:\Users\Peter\GrowBro
\node_modules\react-test-renderer\cjs\react-test-rendere
r.development.js:11528:11)
          at performWorkOnRootViaSchedulerTask (C:\Users
\Peter\GrowBro\node_modules\react-test-renderer\cjs\reac
t-test-renderer.development.js:2082:11)
          at flushActQueue (C:\Users\Peter\GrowBro\node_
modules\react\cjs\react.development.js:566:34)
          at 
Object.<anonymous>.process.env.NODE_ENV.exports.act (C:\
Users\Peter\GrowBro\node_modules\react\cjs\react.develop
ment.js:859:10)
          at actImplementation (C:\Users\Peter\GrowBro\n
ode_modules\@testing-library\react-native\src\act.ts:30:
25)
          at renderWithAct (C:\Users\Peter\GrowBro\node_
modules\@testing-library\react-native\src\render-act.ts:
12:11)
          at renderInternal (C:\Users\Peter\GrowBro\node
_modules\@testing-library\react-native\src\render.tsx:81
:33)
          at renderHook (C:\Users\Peter\GrowBro\node_mod
ules\@testing-library\react-native\src\render-hook.tsx:3
5:61)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\strains\__tests__\integration.test.tsx:179:36)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at StrainsApiClient.debug 
(src/api/strains/client.ts:713:15)
          at Generator.throw (<anonymous>)

    console.debug
      [StrainsApiClient] Cache tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at 
C:\Users\Peter\GrowBro\src\api\strains\client.ts:21:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply 
(C:\Users\Peter\GrowBro\src\api\strains\client.ts:19:34)
          at StrainsApiClient.getAnalyticsClient (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:699:31)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as 
trackCacheOperation] (C:\Users\Peter\GrowBro\src\api\str
ains\client.ts:692:36)
          at StrainsApiClient.trackCacheOperation [as 
getCachedETag] (C:\Users\Peter\GrowBro\src\api\strains\c
lient.ts:625:15)
          at StrainsApiClient.getCachedETag [as 
buildRequestConfig] (C:\Users\Peter\GrowBro\src\api\stra
ins\client.ts:407:29)
          at StrainsApiClient.buildRequestConfig (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:367:25)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as getStrains] (C:\
Users\Peter\GrowBro\src\api\strains\client.ts:362:19)
          at getStrains (C:\Users\Peter\GrowBro\src\api\
strains\use-strains-infinite.ts:55:37)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\strai
ns\use-strains-infinite.ts:52:12)
          at fetchPage (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\infiniteQueryBehavior.ts:74
:30)
          at Object.fetchFn [as fn] (C:\Users\Peter\Grow
Bro\node_modules\@tanstack\query-core\src\infiniteQueryB
ehavior.ts:108:28)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Query.fetch (C:\Users\Peter\GrowBro\node_mo
dules\@tanstack\query-core\src\query.ts:547:40)
          at InfiniteQueryObserver.#executeFetch (C:\Use
rs\Peter\GrowBro\node_modules\@tanstack\query-core\src\q
ueryObserver.ts:341:71)
          at InfiniteQueryObserver.onSubscribe (C:\Users
\Peter\GrowBro\node_modules\@tanstack\query-core\src\que
ryObserver.ts:101:14)
          at InfiniteQueryObserver.subscribe (C:\Users\P
eter\GrowBro\node_modules\@tanstack\query-core\src\subsc
ribable.ts:11:10)
          at C:\Users\Peter\GrowBro\node_modules\@tansta
ck\react-query\src\useBaseQuery.ts:100:22
          at subscribeToStore (C:\Users\Peter\GrowBro\no
de_modules\react-test-renderer\cjs\react-test-renderer.d
evelopment.js:3414:14)
          at Object.react-stack-bottom-frame (C:\Users\P
eter\GrowBro\node_modules\react-test-renderer\cjs\react-
test-renderer.development.js:14062:20)
          at runWithFiberInDEV (C:\Users\Peter\GrowBro\n
ode_modules\react-test-renderer\cjs\react-test-renderer.
development.js:1574:13)
          at commitHookEffectListMount (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:8376:29)
          at commitHookPassiveMountEffects (C:\Users\Pet
er\GrowBro\node_modules\react-test-renderer\cjs\react-te
st-renderer.development.js:8463:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9782:13)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9897:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9794:11)
          at flushPendingEffects (C:\Users\Peter\GrowBro
\node_modules\react-test-renderer\cjs\react-test-rendere
r.development.js:11528:11)
          at performWorkOnRootViaSchedulerTask (C:\Users
\Peter\GrowBro\node_modules\react-test-renderer\cjs\reac
t-test-renderer.development.js:2082:11)
          at flushActQueue (C:\Users\Peter\GrowBro\node_
modules\react\cjs\react.development.js:566:34)
          at 
Object.<anonymous>.process.env.NODE_ENV.exports.act (C:\
Users\Peter\GrowBro\node_modules\react\cjs\react.develop
ment.js:859:10)
          at actImplementation (C:\Users\Peter\GrowBro\n
ode_modules\@testing-library\react-native\src\act.ts:30:
25)
          at renderWithAct (C:\Users\Peter\GrowBro\node_
modules\@testing-library\react-native\src\render-act.ts:
12:11)
          at renderInternal (C:\Users\Peter\GrowBro\node
_modules\@testing-library\react-native\src\render.tsx:81
:33)
          at renderHook (C:\Users\Peter\GrowBro\node_mod
ules\@testing-library\react-native\src\render-hook.tsx:3
5:61)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\strains\__tests__\integration.test.tsx:228:36)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at StrainsApiClient.debug 
(src/api/strains/client.ts:713:15)
          at Generator.throw (<anonymous>)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 267 |[39m       strain[33m,[39m
     [90m 268 |[39m       (favorite) [33m=>[39m {
    [31m[1m>[22m[39m[90m 269 |[39m         
[36mset[39m((state) [33m=>[39m {
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 270 |[39m           [36mconst[39m 
favorites [33m=[39m { 
[33m...[39mstate[33m.[39mfavorites[33m,[39m 
[strain[33m.[39mid][33m:[39m favorite }[33m;[39m
     [90m 271 |[39m           [36mif[39m 
(strain[33m.[39mslug) {
     [90m 272 |[39m             
favorites[strain[33m.[39mslug] [33m=[39m 
favorite[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at forceStoreRerender (node_modules/react-test-ren
derer/cjs/react-test-renderer.development.js:3430:24)
      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:3415:41
      at node_modules/zustand/vanilla.js:11:39
          at Set.forEach (<anonymous>)
      at setState 
(node_modules/zustand/vanilla.js:11:17)
      at set (src/lib/strains/use-favorites.ts:269:9)
      at updateState 
(src/lib/strains/use-favorites.ts:143:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:46:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:287:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 313 |[39m       strainId[33m,[39m
     [90m 314 |[39m       () [33m=>[39m {
    [31m[1m>[22m[39m[90m 315 |[39m         
[36mset[39m((state) [33m=>[39m {
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 316 |[39m           [36mconst[39m 
newFavorites [33m=[39m { 
[33m...[39mstate[33m.[39mfavorites }[33m;[39m
     [90m 317 |[39m           [36mconst[39m 
favorite [33m=[39m newFavorites[strainId][33m;[39m
     [90m 318 |[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at forceStoreRerender (node_modules/react-test-ren
derer/cjs/react-test-renderer.development.js:3430:24)
      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:3415:41
      at node_modules/zustand/vanilla.js:11:39
          at Set.forEach (<anonymous>)
      at setState 
(node_modules/zustand/vanilla.js:11:17)
      at set (src/lib/strains/use-favorites.ts:315:9)
      at updateState 
(src/lib/strains/use-favorites.ts:162:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:339:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.debug
      [StrainsApiClient] Cache tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at 
C:\Users\Peter\GrowBro\src\api\strains\client.ts:21:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply 
(C:\Users\Peter\GrowBro\src\api\strains\client.ts:19:34)
          at StrainsApiClient.getAnalyticsClient (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:699:31)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as 
trackCacheOperation] (C:\Users\Peter\GrowBro\src\api\str
ains\client.ts:692:36)
          at StrainsApiClient.trackCacheOperation [as 
getCachedETag] (C:\Users\Peter\GrowBro\src\api\strains\c
lient.ts:625:15)
          at StrainsApiClient.getCachedETag [as 
buildRequestConfig] (C:\Users\Peter\GrowBro\src\api\stra
ins\client.ts:407:29)
          at StrainsApiClient.buildRequestConfig (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:367:25)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as getStrains] (C:\
Users\Peter\GrowBro\src\api\strains\client.ts:362:19)
          at getStrains (C:\Users\Peter\GrowBro\src\api\
strains\use-strains-infinite.ts:55:37)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\strai
ns\use-strains-infinite.ts:52:12)
          at fetchPage (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\infiniteQueryBehavior.ts:74
:30)
          at Object.fetchFn [as fn] (C:\Users\Peter\Grow
Bro\node_modules\@tanstack\query-core\src\infiniteQueryB
ehavior.ts:108:28)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Query.fetch (C:\Users\Peter\GrowBro\node_mo
dules\@tanstack\query-core\src\query.ts:547:40)
          at InfiniteQueryObserver.#executeFetch (C:\Use
rs\Peter\GrowBro\node_modules\@tanstack\query-core\src\q
ueryObserver.ts:341:71)
          at InfiniteQueryObserver.onSubscribe (C:\Users
\Peter\GrowBro\node_modules\@tanstack\query-core\src\que
ryObserver.ts:101:14)
          at InfiniteQueryObserver.subscribe (C:\Users\P
eter\GrowBro\node_modules\@tanstack\query-core\src\subsc
ribable.ts:11:10)
          at C:\Users\Peter\GrowBro\node_modules\@tansta
ck\react-query\src\useBaseQuery.ts:100:22
          at subscribeToStore (C:\Users\Peter\GrowBro\no
de_modules\react-test-renderer\cjs\react-test-renderer.d
evelopment.js:3414:14)
          at Object.react-stack-bottom-frame (C:\Users\P
eter\GrowBro\node_modules\react-test-renderer\cjs\react-
test-renderer.development.js:14062:20)
          at runWithFiberInDEV (C:\Users\Peter\GrowBro\n
ode_modules\react-test-renderer\cjs\react-test-renderer.
development.js:1574:13)
          at commitHookEffectListMount (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:8376:29)
          at commitHookPassiveMountEffects (C:\Users\Pet
er\GrowBro\node_modules\react-test-renderer\cjs\react-te
st-renderer.development.js:8463:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9782:13)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9897:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9794:11)
          at flushPendingEffects (C:\Users\Peter\GrowBro
\node_modules\react-test-renderer\cjs\react-test-rendere
r.development.js:11528:11)
          at performWorkOnRootViaSchedulerTask (C:\Users
\Peter\GrowBro\node_modules\react-test-renderer\cjs\reac
t-test-renderer.development.js:2082:11)
          at flushActQueue (C:\Users\Peter\GrowBro\node_
modules\react\cjs\react.development.js:566:34)
          at 
Object.<anonymous>.process.env.NODE_ENV.exports.act (C:\
Users\Peter\GrowBro\node_modules\react\cjs\react.develop
ment.js:859:10)
          at actImplementation (C:\Users\Peter\GrowBro\n
ode_modules\@testing-library\react-native\src\act.ts:30:
25)
          at renderWithAct (C:\Users\Peter\GrowBro\node_
modules\@testing-library\react-native\src\render-act.ts:
12:11)
          at renderInternal (C:\Users\Peter\GrowBro\node
_modules\@testing-library\react-native\src\render.tsx:81
:33)
          at renderHook (C:\Users\Peter\GrowBro\node_mod
ules\@testing-library\react-native\src\render-hook.tsx:3
5:61)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\strains\__tests__\integration.test.tsx:308:45)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at StrainsApiClient.debug 
(src/api/strains/client.ts:713:15)
          at Generator.throw (<anonymous>)

    console.debug
      [StrainsApiClient] Cache tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at 
C:\Users\Peter\GrowBro\src\api\strains\client.ts:21:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply 
(C:\Users\Peter\GrowBro\src\api\strains\client.ts:19:34)
          at StrainsApiClient.getAnalyticsClient (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:699:31)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as 
trackCacheOperation] (C:\Users\Peter\GrowBro\src\api\str
ains\client.ts:692:36)
          at StrainsApiClient.trackCacheOperation [as 
getCachedETag] (C:\Users\Peter\GrowBro\src\api\strains\c
lient.ts:625:15)
          at StrainsApiClient.getCachedETag [as 
buildRequestConfig] (C:\Users\Peter\GrowBro\src\api\stra
ins\client.ts:407:29)
          at StrainsApiClient.buildRequestConfig (C:\Use
rs\Peter\GrowBro\src\api\strains\client.ts:367:25)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at StrainsApiClient.<anonymous> (C:\Users\Pete
r\GrowBro\node_modules\@babel\runtime\helpers\asyncToGen
erator.js:14:12)
          at StrainsApiClient.apply [as getStrains] (C:\
Users\Peter\GrowBro\src\api\strains\client.ts:362:19)
          at getStrains (C:\Users\Peter\GrowBro\src\api\
strains\use-strains-infinite.ts:55:37)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\strai
ns\use-strains-infinite.ts:52:12)
          at fetchPage (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\infiniteQueryBehavior.ts:74
:30)
          at Object.fetchFn [as fn] (C:\Users\Peter\Grow
Bro\node_modules\@tanstack\query-core\src\infiniteQueryB
ehavior.ts:108:28)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Query.fetch (C:\Users\Peter\GrowBro\node_mo
dules\@tanstack\query-core\src\query.ts:547:40)
          at InfiniteQueryObserver.#executeFetch (C:\Use
rs\Peter\GrowBro\node_modules\@tanstack\query-core\src\q
ueryObserver.ts:341:71)
          at InfiniteQueryObserver.onSubscribe (C:\Users
\Peter\GrowBro\node_modules\@tanstack\query-core\src\que
ryObserver.ts:101:14)
          at InfiniteQueryObserver.subscribe (C:\Users\P
eter\GrowBro\node_modules\@tanstack\query-core\src\subsc
ribable.ts:11:10)
          at C:\Users\Peter\GrowBro\node_modules\@tansta
ck\react-query\src\useBaseQuery.ts:100:22
          at subscribeToStore (C:\Users\Peter\GrowBro\no
de_modules\react-test-renderer\cjs\react-test-renderer.d
evelopment.js:3414:14)
          at Object.react-stack-bottom-frame (C:\Users\P
eter\GrowBro\node_modules\react-test-renderer\cjs\react-
test-renderer.development.js:14062:20)
          at runWithFiberInDEV (C:\Users\Peter\GrowBro\n
ode_modules\react-test-renderer\cjs\react-test-renderer.
development.js:1574:13)
          at commitHookEffectListMount (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:8376:29)
          at commitHookPassiveMountEffects (C:\Users\Pet
er\GrowBro\node_modules\react-test-renderer\cjs\react-te
st-renderer.development.js:8463:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9782:13)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9897:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9775:11)
          at recursivelyTraversePassiveMountEffects (C:\
Users\Peter\GrowBro\node_modules\react-test-renderer\cjs
\react-test-renderer.development.js:9756:11)
          at commitPassiveMountOnFiber (C:\Users\Peter\G
rowBro\node_modules\react-test-renderer\cjs\react-test-r
enderer.development.js:9794:11)
          at flushPendingEffects (C:\Users\Peter\GrowBro
\node_modules\react-test-renderer\cjs\react-test-rendere
r.development.js:11528:11)
          at performWorkOnRootViaSchedulerTask (C:\Users
\Peter\GrowBro\node_modules\react-test-renderer\cjs\reac
t-test-renderer.development.js:2082:11)
          at flushActQueue (C:\Users\Peter\GrowBro\node_
modules\react\cjs\react.development.js:566:34)
          at 
Object.<anonymous>.process.env.NODE_ENV.exports.act (C:\
Users\Peter\GrowBro\node_modules\react\cjs\react.develop
ment.js:859:10)
          at actImplementation (C:\Users\Peter\GrowBro\n
ode_modules\@testing-library\react-native\src\act.ts:30:
25)
          at renderWithAct (C:\Users\Peter\GrowBro\node_
modules\@testing-library\react-native\src\render-act.ts:
12:11)
          at renderInternal (C:\Users\Peter\GrowBro\node
_modules\@testing-library\react-native\src\render.tsx:81
:33)
          at renderHook (C:\Users\Peter\GrowBro\node_mod
ules\@testing-library\react-native\src\render-hook.tsx:3
5:61)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\strains\__tests__\integration.test.tsx:340:36)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at StrainsApiClient.debug 
(src/api/strains/client.ts:713:15)
          at Generator.throw (<anonymous>)

  ÔùÅ Strains Feature Integration ÔÇ║ Data Fetching 
Integration ÔÇ║ should fetch strains list successfully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 89 |[39m       })[33m;[39m
     [90m 90 |[39m
    [31m[1m>[22m[39m[90m 91 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m    |[39m                    
[31m[1m^[22m[39m
     [90m 92 |[39m         expect(result[33m.[39mcur
rent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m 93 |[39m       })[33m;[39m
     [90m 94 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:91:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Data Fetching 
Integration ÔÇ║ should fetch single strain detail 
successfully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 118 |[39m       })[33m;[39m
     [90m 119 |[39m
    [31m[1m>[22m[39m[90m 120 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 121 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m
)[33m;[39m
     [90m 122 |[39m       })[33m;[39m
     [90m 123 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:120:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Data Fetching 
Integration ÔÇ║ should handle API errors gracefully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 135 |[39m       })[33m;[39m
     [90m 136 |[39m
    [31m[1m>[22m[39m[90m 137 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 138 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misError)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m 139 |[39m       })[33m;[39m
     [90m 140 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:137:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Search and Filter 
Integration ÔÇ║ should apply search query correctly

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 158 |[39m       )[33m;[39m
     [90m 159 |[39m
    [31m[1m>[22m[39m[90m 160 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 161 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m
)[33m;[39m
     [90m 162 |[39m       })[33m;[39m
     [90m 163 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:160:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Search and Filter 
Integration ÔÇ║ should apply filters correctly

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 190 |[39m       )[33m;[39m
     [90m 191 |[39m
    [31m[1m>[22m[39m[90m 192 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 193 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m
)[33m;[39m
     [90m 194 |[39m       })[33m;[39m
     [90m 195 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:192:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Infinite Scroll 
Integration ÔÇ║ should load next page on fetchNextPage

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 230 |[39m       })[33m;[39m
     [90m 231 |[39m
    [31m[1m>[22m[39m[90m 232 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 233 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m
)[33m;[39m
     [90m 234 |[39m       })[33m;[39m
     [90m 235 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:232:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Performance 
Integration ÔÇ║ should cache responses appropriately

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 310 |[39m       })[33m;[39m
     [90m 311 |[39m
    [31m[1m>[22m[39m[90m 312 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 313 |[39m         expect(result1[33m.[39mc
urrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39
m)[33m;[39m
     [90m 314 |[39m       })[33m;[39m
     [90m 315 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:312:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Error Recovery 
Integration ÔÇ║ should retry failed requests

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 342 |[39m       })[33m;[39m
     [90m 343 |[39m
    [31m[1m>[22m[39m[90m 344 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 345 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misError)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m 346 |[39m       })[33m;[39m
     [90m 347 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:344:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/nutrient-engine/services/alert-service-obse
rve.test.ts (11.388 s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ observeActiveAlerts ÔÇ║ observable behavior ÔÇ║ 
queries ph_ec_readings_v2 with reservoir_id filter

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    -   "_condition": "where",
    -   "left": "reservoir_id",
    -   "right": "test-reservoir-id",
    +   "key": "reservoir_id",
    +   "value": "test-reservoir-id",
      },

    Number of calls: 1

    [0m [90m 53 |[39m
     [90m 54 |[39m       expect(mockDb[33m.[39m[36m
get[39m)[33m.[39mtoHaveBeenCalledWith([32m'ph_ec_rea
dings_v2'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 55 |[39m       expect(moc
kTable[33m.[39mquery)[33m.[39mtoHaveBeenCalledWith({
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 56 |[39m         _condition[33m:[39m 
[32m'where'[39m[33m,[39m
     [90m 57 |[39m         left[33m:[39m 
[32m'reservoir_id'[39m[33m,[39m
     [90m 58 |[39m         right[33m:[39m 
[32m'test-reservoir-id'[39m[33m,[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/nutrient-e
ngine/services/alert-service-observe.test.ts:55:31)

  ÔùÅ observeActiveAlerts ÔÇ║ observable behavior ÔÇ║ 
returns empty observable when no readings exist

    expect(jest.fn()).toHaveBeenNthCalledWith(n, 
...expected)

    n: 2
    Expected: "deviation_alerts_v2"
    Received
           1: "ph_ec_readings_v2"

    Number of calls: 1

    [0m [90m 116 |[39m           
expect(alerts)[33m.[39mtoEqual([])[33m;[39m
     [90m 117 |[39m           expect(mockDb[33m.[39m
[36mget[39m)[33m.[39mtoHaveBeenNthCalledWith([35m1
[39m[33m,[39m 
[32m'ph_ec_readings_v2'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 118 |[39m           expec
t(mockDb[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenNt
hCalledWith([35m2[39m[33m,[39m 
[32m'deviation_alerts_v2'[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 119 |[39m
     [90m 120 |[39m           [90m// Verify empty 
query condition (id = '')[39m
     [90m 121 |[39m           expect(mockAlertsQueryBu
ilder[33m.[39mobserve)[33m.[39mtoHaveBeenCalled()[3
3m;[39m[0m

      at Object.toHaveBeenNthCalledWith [as next] (src/l
ib/nutrient-engine/services/alert-service-observe.test.t
s:118:30)
      at Timeout.next [as _onTimeout] (src/lib/nutrient-
engine/services/alert-service-observe.test.ts:73:42)

  ÔùÅ observeActiveAlerts ÔÇ║ observable behavior ÔÇ║ 
returns empty observable when no readings exist

    thrown: "Exceeded timeout of 5000 ms for a test 
while waiting for `done()` to be called.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 62 |[39m     })[33m;[39m
     [90m 63 |[39m
    [31m[1m>[22m[39m[90m 64 |[39m     
test([32m'returns empty observable when no readings 
exist'[39m[33m,[39m (done) [33m=>[39m {
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 65 |[39m       [36mconst[39m 
mockReadings[33m:[39m [33mPhEcReadingModel[39m[] 
[33m=[39m [][33m;[39m
     [90m 66 |[39m
     [90m 67 |[39m       [90m// Mock readings 
observable that emits empty array[39m[0m

      at test (src/lib/nutrient-engine/services/alert-se
rvice-observe.test.ts:64:5)
      at describe (src/lib/nutrient-engine/services/aler
t-service-observe.test.ts:34:3)
      at Object.describe (src/lib/nutrient-engine/servic
es/alert-service-observe.test.ts:12:1)

  ÔùÅ observeActiveAlerts ÔÇ║ observable behavior ÔÇ║ 
queries deviation_alerts_v2 with correct filters when 
readings exist

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 4

      Array [
        Object {
    -     "id": "alert-1",
    -     "readingId": "reading-1",
    +     "id": "reading-1",
    +   },
    +   Object {
    +     "id": "reading-2",
        },
      ]

    [0m [90m 205 |[39m       
observable[33m.[39msubscribe({
     [90m 206 |[39m         next[33m:[39m (alerts) 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 207 |[39m           
expect(alerts)[33m.[39mtoEqual(mockAlerts)[33m;[39m
     [90m     |[39m                          
[31m[1m^[22m[39m
     [90m 208 |[39m
     [90m 209 |[39m           [90m// Verify queries 
were called[39m
     [90m 210 |[39m           expect(mockDb[33m.[39m
[36mget[39m)[33m.[39mtoHaveBeenNthCalledWith([35m1
[39m[33m,[39m 
[32m'ph_ec_readings_v2'[39m)[33m;[39m[0m

      at Object.toEqual [as next] (src/lib/nutrient-engi
ne/services/alert-service-observe.test.ts:207:26)
      at Timeout.next [as _onTimeout] (src/lib/nutrient-
engine/services/alert-service-observe.test.ts:149:42)

  ÔùÅ observeActiveAlerts ÔÇ║ observable behavior ÔÇ║ 
queries deviation_alerts_v2 with correct filters when 
readings exist

    thrown: "Exceeded timeout of 5000 ms for a test 
while waiting for `done()` to be called.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 125 |[39m     })[33m;[39m
     [90m 126 |[39m
    [31m[1m>[22m[39m[90m 127 |[39m     
test([32m'queries deviation_alerts_v2 with correct 
filters when readings exist'[39m[33m,[39m (done) 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 128 |[39m       [36mconst[39m 
mockReadings[33m:[39m [33mPhEcReadingModel[39m[] 
[33m=[39m [
     [90m 129 |[39m         { id[33m:[39m 
[32m'reading-1'[39m } [36mas[39m 
[33mPhEcReadingModel[39m[33m,[39m
     [90m 130 |[39m         { id[33m:[39m 
[32m'reading-2'[39m } [36mas[39m 
[33mPhEcReadingModel[39m[33m,[39m[0m

      at test (src/lib/nutrient-engine/services/alert-se
rvice-observe.test.ts:127:5)
      at describe (src/lib/nutrient-engine/services/aler
t-service-observe.test.ts:34:3)
      at Object.describe (src/lib/nutrient-engine/servic
es/alert-service-observe.test.ts:12:1)

FAIL src/api/auth/use-auth-hooks.test.tsx (7.862 s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [SignIn] starting sign-in via Edge Function

      at Object.log (src/api/auth/use-sign-in.ts:179:28)

    console.warn
      [SignIn] onError Error: auth.error_generic
          at 
C:\Users\Peter\GrowBro\src\api\auth\use-sign-in.ts:64:31
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\auth\
use-sign-in.ts:101:2)
          at apply (C:\Users\Peter\GrowBro\src\api\auth\
use-sign-in.ts:58:32)
          at Object.callEdgeFunction (C:\Users\Peter\Gro
wBro\src\api\auth\use-sign-in.ts:182:29)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply [as mutationFn] (C:\Users\Pete
r\GrowBro\src\api\auth\use-sign-in.ts:176:15)
          at Object.fn (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\mutation.ts:190:29)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Mutation.execute (C:\Users\Peter\GrowBro\no
de_modules\@tanstack\query-core\src\mutation.ts:233:40)

    [0m [90m 228 |[39m     onError[33m:[39m 
[36masync[39m (error[33m:[39m 
[33mAuthMutationError[39m) [33m=>[39m {
     [90m 229 |[39m       [36mif[39m (__DEV__) {
    [31m[1m>[22m[39m[90m 230 |[39m         
console[33m.[39mwarn([32m'[SignIn] 
onError'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 231 |[39m       }
     [90m 232 |[39m       [90m// Log error for 
debugging with consent checking[39m
     [90m 233 |[39m       [36mawait[39m 
logAuthError(error[33m,[39m {[0m

      at Object.warn 
(src/api/auth/use-sign-in.ts:230:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as onError] 
(src/api/auth/use-sign-in.ts:228:12)
      at Mutation.execute (node_modules/@tanstack/query-
core/src/mutation.ts:282:28)

    console.log
      [SignIn] settled

      at Object.log [as onSettled] 
(src/api/auth/use-sign-in.ts:243:17)

    console.log
      [SignIn] starting sign-in via Edge Function

      at Object.log (src/api/auth/use-sign-in.ts:179:28)

    console.warn
      [SignIn] onError Error: auth.error_generic
          at 
C:\Users\Peter\GrowBro\src\api\auth\use-sign-in.ts:64:31
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\auth\
use-sign-in.ts:58:32)
          at Object.callEdgeFunction (C:\Users\Peter\Gro
wBro\src\api\auth\use-sign-in.ts:182:29)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply [as mutationFn] (C:\Users\Pete
r\GrowBro\src\api\auth\use-sign-in.ts:176:15)
          at Object.fn (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\mutation.ts:190:29)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Mutation.execute (C:\Users\Peter\GrowBro\no
de_modules\@tanstack\query-core\src\mutation.ts:233:40)

    [0m [90m 228 |[39m     onError[33m:[39m 
[36masync[39m (error[33m:[39m 
[33mAuthMutationError[39m) [33m=>[39m {
     [90m 229 |[39m       [36mif[39m (__DEV__) {
    [31m[1m>[22m[39m[90m 230 |[39m         
console[33m.[39mwarn([32m'[SignIn] 
onError'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 231 |[39m       }
     [90m 232 |[39m       [90m// Log error for 
debugging with consent checking[39m
     [90m 233 |[39m       [36mawait[39m 
logAuthError(error[33m,[39m {[0m

      at Object.warn 
(src/api/auth/use-sign-in.ts:230:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as onError] 
(src/api/auth/use-sign-in.ts:228:12)
      at Mutation.execute (node_modules/@tanstack/query-
core/src/mutation.ts:282:28)

    console.log
      [SignIn] settled

      at Object.log [as onSettled] 
(src/api/auth/use-sign-in.ts:243:17)

    console.log
      [SignIn] starting sign-in via Edge Function

      at Object.log (src/api/auth/use-sign-in.ts:179:28)

    console.warn
      [SignIn] onError Error: auth.error_generic
          at 
C:\Users\Peter\GrowBro\src\api\auth\use-sign-in.ts:64:31
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\auth\
use-sign-in.ts:58:32)
          at Object.callEdgeFunction (C:\Users\Peter\Gro
wBro\src\api\auth\use-sign-in.ts:182:29)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply [as mutationFn] (C:\Users\Pete
r\GrowBro\src\api\auth\use-sign-in.ts:176:15)
          at Object.fn (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\mutation.ts:190:29)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Mutation.execute (C:\Users\Peter\GrowBro\no
de_modules\@tanstack\query-core\src\mutation.ts:233:40)

    [0m [90m 228 |[39m     onError[33m:[39m 
[36masync[39m (error[33m:[39m 
[33mAuthMutationError[39m) [33m=>[39m {
     [90m 229 |[39m       [36mif[39m (__DEV__) {
    [31m[1m>[22m[39m[90m 230 |[39m         
console[33m.[39mwarn([32m'[SignIn] 
onError'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 231 |[39m       }
     [90m 232 |[39m       [90m// Log error for 
debugging with consent checking[39m
     [90m 233 |[39m       [36mawait[39m 
logAuthError(error[33m,[39m {[0m

      at Object.warn 
(src/api/auth/use-sign-in.ts:230:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as onError] 
(src/api/auth/use-sign-in.ts:228:12)
      at Mutation.execute (node_modules/@tanstack/query-
core/src/mutation.ts:282:28)

    console.log
      [SignIn] settled

      at Object.log [as onSettled] 
(src/api/auth/use-sign-in.ts:243:17)

    console.warn
      [SignIn] onError Error: auth.error_generic
          at 
C:\Users\Peter\GrowBro\src\api\auth\use-sign-in.ts:64:31
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\auth\
use-sign-in.ts:58:32)
          at Object.callEdgeFunction (C:\Users\Peter\Gro
wBro\src\api\auth\use-sign-in.ts:182:29)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply [as mutationFn] (C:\Users\Pete
r\GrowBro\src\api\auth\use-sign-in.ts:176:15)
          at Object.fn (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\mutation.ts:190:29)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Mutation.execute (C:\Users\Peter\GrowBro\no
de_modules\@tanstack\query-core\src\mutation.ts:233:40)

    [0m [90m 228 |[39m     onError[33m:[39m 
[36masync[39m (error[33m:[39m 
[33mAuthMutationError[39m) [33m=>[39m {
     [90m 229 |[39m       [36mif[39m (__DEV__) {
    [31m[1m>[22m[39m[90m 230 |[39m         
console[33m.[39mwarn([32m'[SignIn] 
onError'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 231 |[39m       }
     [90m 232 |[39m       [90m// Log error for 
debugging with consent checking[39m
     [90m 233 |[39m       [36mawait[39m 
logAuthError(error[33m,[39m {[0m

      at Object.warn 
(src/api/auth/use-sign-in.ts:230:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as onError] 
(src/api/auth/use-sign-in.ts:228:12)
      at Mutation.execute (node_modules/@tanstack/query-
core/src/mutation.ts:282:28)

    console.warn
      Failed to log auth error to Sentry: TypeError: 
Sentry.withScope is not a function
          at withScope (C:\Users\Peter\GrowBro\src\lib\a
uth\auth-telemetry.ts:250:12)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 264 |[39m     })[33m;[39m
     [90m 265 |[39m   } [36mcatch[39m (sentryError) 
{
    [31m[1m>[22m[39m[90m 266 |[39m     
console[33m.[39mwarn([32m'Failed to log auth error 
to Sentry:'[39m[33m,[39m sentryError)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 267 |[39m     [90m// Fail silently to 
avoid breaking auth flows[39m
     [90m 268 |[39m   }
     [90m 269 |[39m }[0m

      at warn (src/lib/auth/auth-telemetry.ts:266:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [SignIn] starting sign-in via Edge Function

      at Object.log (src/api/auth/use-sign-in.ts:179:28)

    console.warn
      [SignIn] onError Error: auth.error_generic
          at 
C:\Users\Peter\GrowBro\src\api\auth\use-sign-in.ts:64:31
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\auth\
use-sign-in.ts:58:32)
          at Object.callEdgeFunction (C:\Users\Peter\Gro
wBro\src\api\auth\use-sign-in.ts:182:29)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply [as mutationFn] (C:\Users\Pete
r\GrowBro\src\api\auth\use-sign-in.ts:176:15)
          at Object.fn (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\mutation.ts:190:29)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Mutation.execute (C:\Users\Peter\GrowBro\no
de_modules\@tanstack\query-core\src\mutation.ts:233:40)

    [0m [90m 228 |[39m     onError[33m:[39m 
[36masync[39m (error[33m:[39m 
[33mAuthMutationError[39m) [33m=>[39m {
     [90m 229 |[39m       [36mif[39m (__DEV__) {
    [31m[1m>[22m[39m[90m 230 |[39m         
console[33m.[39mwarn([32m'[SignIn] 
onError'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 231 |[39m       }
     [90m 232 |[39m       [90m// Log error for 
debugging with consent checking[39m
     [90m 233 |[39m       [36mawait[39m 
logAuthError(error[33m,[39m {[0m

      at Object.warn 
(src/api/auth/use-sign-in.ts:230:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as onError] 
(src/api/auth/use-sign-in.ts:228:12)
      at Mutation.execute (node_modules/@tanstack/query-
core/src/mutation.ts:282:28)

    console.log
      [SignIn] settled

      at Object.log [as onSettled] 
(src/api/auth/use-sign-in.ts:243:17)

    console.warn
      [SignUp] Env.SCHEME is undefined - using 
fallback. Check that SCHEME is set in your .env file 
and app.config.cjs extra field.

    [0m [90m 55 |[39m       [36mconst[39m scheme 
[33m=[39m 
[33mEnv[39m[33m.[39m[33mSCHEME[39m[33m;[39m
     [90m 56 |[39m       [36mif[39m (__DEV__ 
[33m&&[39m [33m![39mscheme) {
    [31m[1m>[22m[39m[90m 57 |[39m         
console[33m.[39mwarn(
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 58 |[39m           [32m'[SignUp] 
Env.SCHEME is undefined - using fallback. Check that 
SCHEME is set in your .env file and app.config.cjs 
extra field.'[39m
     [90m 59 |[39m         )[33m;[39m
     [90m 60 |[39m       }[0m

      at Object.warn (src/api/auth/use-sign-up.ts:57:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as mutationFn] 
(src/api/auth/use-sign-up.ts:42:15)
      at Object.fn (node_modules/@tanstack/query-core/sr
c/mutation.ts:190:29)
      at run (node_modules/@tanstack/query-core/src/retr
yer.ts:155:49)
      at Object.start 
(node_modules/@tanstack/query-core/src/retryer.ts:221:9)
      at Mutation.execute (node_modules/@tanstack/query-
core/src/mutation.ts:233:40)

    console.log
      [Auth] Sign up successful - verification email 
sent

      at Object.log (src/api/auth/use-sign-up.ts:99:15)

    console.warn
      [SignUp] Env.SCHEME is undefined - using 
fallback. Check that SCHEME is set in your .env file 
and app.config.cjs extra field.

    [0m [90m 55 |[39m       [36mconst[39m scheme 
[33m=[39m 
[33mEnv[39m[33m.[39m[33mSCHEME[39m[33m;[39m
     [90m 56 |[39m       [36mif[39m (__DEV__ 
[33m&&[39m [33m![39mscheme) {
    [31m[1m>[22m[39m[90m 57 |[39m         
console[33m.[39mwarn(
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 58 |[39m           [32m'[SignUp] 
Env.SCHEME is undefined - using fallback. Check that 
SCHEME is set in your .env file and app.config.cjs 
extra field.'[39m
     [90m 59 |[39m         )[33m;[39m
     [90m 60 |[39m       }[0m

      at Object.warn (src/api/auth/use-sign-up.ts:57:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as mutationFn] 
(src/api/auth/use-sign-up.ts:42:15)
      at Object.fn (node_modules/@tanstack/query-core/sr
c/mutation.ts:190:29)
      at run (node_modules/@tanstack/query-core/src/retr
yer.ts:155:49)
      at Object.start 
(node_modules/@tanstack/query-core/src/retryer.ts:221:9)
      at Mutation.execute (node_modules/@tanstack/query-
core/src/mutation.ts:233:40)

    console.warn
      [SignUp] supabase signUp error { message: 'User 
already registered', status: 422, name: undefined }

    [0m [90m 70 |[39m       [36mif[39m (error) {
     [90m 71 |[39m         [36mif[39m (__DEV__) {
    [31m[1m>[22m[39m[90m 72 |[39m           
console[33m.[39mwarn([32m'[SignUp] supabase signUp 
error'[39m[33m,[39m {
     [90m    |[39m                   
[31m[1m^[22m[39m
     [90m 73 |[39m             message[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 74 |[39m             status[33m:[39m 
error[33m.[39mstatus[33m,[39m
     [90m 75 |[39m             name[33m:[39m 
error[33m.[39mname[33m,[39m[0m

      at Object.warn (src/api/auth/use-sign-up.ts:72:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [OAuth] updating auth store

      at Object.log (src/api/auth/use-oauth.ts:181:15)

    console.log
      [OAuth] auth store updated

      at Object.log (src/api/auth/use-oauth.ts:189:15)

    console.log
      [OAuth] updating auth store

      at Object.log (src/api/auth/use-oauth.ts:181:15)

    console.log
      [OAuth] auth store updated

      at Object.log (src/api/auth/use-oauth.ts:189:15)

  ÔùÅ Auth Hooks ÔÇ║ useSignIn ÔÇ║ should successfully 
sign in with valid credentials

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 170 |[39m
     [90m 171 |[39m       [90m// Assert[39m
    [31m[1m>[22m[39m[90m 172 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 173 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m
)[33m;[39m
     [90m 174 |[39m       })[33m;[39m
     [90m 175 |[39m[0m

      at Object.<anonymous> 
(src/api/auth/use-auth-hooks.test.tsx:172:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth Hooks ÔÇ║ useSignIn ÔÇ║ should handle 
invalid credentials error

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "auth.error_invalid_credentials"
    Received: "auth.error_generic"

    [0m [90m 211 |[39m       })[33m;[39m
     [90m 212 |[39m
    [31m[1m>[22m[39m[90m 213 |[39m       expect(re
sult[33m.[39mcurrent[33m.[39merror[33m?[39m[33m.
[39mmessage)[33m.[39mtoBe(
     [90m     |[39m                                   
          [31m[1m^[22m[39m
     [90m 214 |[39m         
[32m'auth.error_invalid_credentials'[39m
     [90m 215 |[39m       )[33m;[39m
     [90m 216 |[39m       expect(mockSignIn)[33m.[39
mnot[33m.[39mtoHaveBeenCalled()[33m;[39m[0m

      at Object.toBe 
(src/api/auth/use-auth-hooks.test.tsx:213:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Auth Hooks ÔÇ║ useSignIn ÔÇ║ should handle 
account lockout error

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "auth.error_account_locked"
    Received: "auth.error_generic"

    [0m [90m 248 |[39m       })[33m;[39m
     [90m 249 |[39m
    [31m[1m>[22m[39m[90m 250 |[39m       expect(re
sult[33m.[39mcurrent[33m.[39merror[33m?[39m[33m.
[39mmessage)[33m.[39mtoBe([32m'auth.error_account_loc
ked'[39m)[33m;[39m
     [90m     |[39m                                   
          [31m[1m^[22m[39m
     [90m 251 |[39m       expect(
     [90m 252 |[39m         
(result[33m.[39mcurrent[33m.[39merror [36mas[39m 
[33mError[39m [33m&[39m { 
metadata[33m?[39m[33m:[39m { 
lockout[33m?[39m[33m:[39m boolean } })
     [90m 253 |[39m           [33m?[39m[33m.[39mme
tadata[33m?[39m[33m.[39mlockout[0m

      at Object.toBe 
(src/api/auth/use-auth-hooks.test.tsx:250:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Auth Hooks ÔÇ║ useSignIn ÔÇ║ should track 
analytics when consent is granted

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 287 |[39m
     [90m 288 |[39m       [90m// Assert[39m
    [31m[1m>[22m[39m[90m 289 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 290 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m
)[33m;[39m
     [90m 291 |[39m       })[33m;[39m
     [90m 292 |[39m[0m

      at Object.<anonymous> 
(src/api/auth/use-auth-hooks.test.tsx:289:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth Hooks ÔÇ║ useSignIn ÔÇ║ should handle 
offline login attempt

    expect(received).toContain(expected) // indexOf

    Expected substring: "Network"
    Received string:    "auth.error_generic"

    [0m [90m 319 |[39m       })[33m;[39m
     [90m 320 |[39m
    [31m[1m>[22m[39m[90m 321 |[39m       expect(re
sult[33m.[39mcurrent[33m.[39merror[33m?[39m[33m.
[39mmessage)[33m.[39mtoContain([32m'Network'[39m)[3
3m;[39m
     [90m     |[39m                                   
          [31m[1m^[22m[39m
     [90m 322 |[39m     })[33m;[39m
     [90m 323 |[39m   })[33m;[39m
     [90m 324 |[39m[0m

      at Object.toContain 
(src/api/auth/use-auth-hooks.test.tsx:321:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Auth Hooks ÔÇ║ OAuth Hooks ÔÇ║ useSignInWithOAuth 
ÔÇ║ should initiate Apple OAuth flow

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 508 |[39m
     [90m 509 |[39m         [90m// Assert[39m
    [31m[1m>[22m[39m[90m 510 |[39m         
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 511 |[39m           expect(result[33m.[39m
current[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[3
9m)[33m;[39m
     [90m 512 |[39m         })[33m;[39m
     [90m 513 |[39m[0m

      at Object.<anonymous> 
(src/api/auth/use-auth-hooks.test.tsx:510:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth Hooks ÔÇ║ OAuth Hooks ÔÇ║ useSignInWithOAuth 
ÔÇ║ should initiate Google OAuth flow

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 540 |[39m
     [90m 541 |[39m         [90m// Assert[39m
    [31m[1m>[22m[39m[90m 542 |[39m         
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 543 |[39m           expect(result[33m.[39m
current[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[3
9m)[33m;[39m
     [90m 544 |[39m         })[33m;[39m
     [90m 545 |[39m[0m

      at Object.<anonymous> 
(src/api/auth/use-auth-hooks.test.tsx:542:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth Hooks ÔÇ║ Password Reset Hooks ÔÇ║ 
useResetPassword ÔÇ║ should request password reset email

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 750 |[39m
     [90m 751 |[39m         [90m// Assert[39m
    [31m[1m>[22m[39m[90m 752 |[39m         
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 753 |[39m           expect(result[33m.[39m
current[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[3
9m)[33m;[39m
     [90m 754 |[39m         })[33m;[39m
     [90m 755 |[39m[0m

      at Object.<anonymous> 
(src/api/auth/use-auth-hooks.test.tsx:752:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth Hooks ÔÇ║ Password Reset Hooks ÔÇ║ 
useResetPassword ÔÇ║ should not reveal if email does 
not exist

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 777 |[39m
     [90m 778 |[39m         [90m// Assert[39m
    [31m[1m>[22m[39m[90m 779 |[39m         
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 780 |[39m           expect(result[33m.[39m
current[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[3
9m)[33m;[39m
     [90m 781 |[39m         })[33m;[39m
     [90m 782 |[39m       })[33m;[39m[0m

      at Object.<anonymous> 
(src/api/auth/use-auth-hooks.test.tsx:779:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth Hooks ÔÇ║ Error Mapper ÔÇ║ should fallback 
to generic error

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "auth.error_generic"
    Received: "auth.error_offline_login"

    [0m [90m 1055 |[39m
     [90m 1056 |[39m       [36mconst[39m result 
[33m=[39m mapAuthError(error)[33m;[39m
    [31m[1m>[22m[39m[90m 1057 |[39m       expect(r
esult)[33m.[39mtoBe([32m'auth.error_generic'[39m)[3
3m;[39m
     [90m      |[39m                      
[31m[1m^[22m[39m
     [90m 1058 |[39m     })[33m;[39m
     [90m 1059 |[39m   })[33m;[39m
     [90m 1060 |[39m[0m

      at Object.toBe 
(src/api/auth/use-auth-hooks.test.tsx:1057:22)

FAIL 
src/lib/moderation/__tests__/retry-strategy.test.ts 
(5.891 s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      Retry attempt 1/3 after 9ms delay. Error: Service 
unavailable

    [0m [90m 136 |[39m
     [90m 137 |[39m         [90m// Log retry 
attempt[39m
    [31m[1m>[22m[39m[90m 138 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 139 |[39m           [32m`Retry attempt 
${attempt}/${this.config.maxAttempts} after ${delay}ms 
delay. Error: ${lastError.message}`[39m
     [90m 140 |[39m         )[33m;[39m
     [90m 141 |[39m[0m

      at RetryStrategy.warn 
(src/lib/moderation/retry-strategy.ts:138:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Retry attempt 1/3 after 10ms delay. Error: 
Service unavailable

    [0m [90m 136 |[39m
     [90m 137 |[39m         [90m// Log retry 
attempt[39m
    [31m[1m>[22m[39m[90m 138 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 139 |[39m           [32m`Retry attempt 
${attempt}/${this.config.maxAttempts} after ${delay}ms 
delay. Error: ${lastError.message}`[39m
     [90m 140 |[39m         )[33m;[39m
     [90m 141 |[39m[0m

      at RetryStrategy.warn 
(src/lib/moderation/retry-strategy.ts:138:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Retry attempt 2/3 after 19ms delay. Error: 
Service unavailable

    [0m [90m 136 |[39m
     [90m 137 |[39m         [90m// Log retry 
attempt[39m
    [31m[1m>[22m[39m[90m 138 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 139 |[39m           [32m`Retry attempt 
${attempt}/${this.config.maxAttempts} after ${delay}ms 
delay. Error: ${lastError.message}`[39m
     [90m 140 |[39m         )[33m;[39m
     [90m 141 |[39m[0m

      at RetryStrategy.warn 
(src/lib/moderation/retry-strategy.ts:138:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Retry attempt 1/3 after 100ms delay. Error: 
Service unavailable

    [0m [90m 136 |[39m
     [90m 137 |[39m         [90m// Log retry 
attempt[39m
    [31m[1m>[22m[39m[90m 138 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 139 |[39m           [32m`Retry attempt 
${attempt}/${this.config.maxAttempts} after ${delay}ms 
delay. Error: ${lastError.message}`[39m
     [90m 140 |[39m         )[33m;[39m
     [90m 141 |[39m[0m

      at RetryStrategy.warn 
(src/lib/moderation/retry-strategy.ts:138:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Retry attempt 2/3 after 200ms delay. Error: 
Service unavailable

    [0m [90m 136 |[39m
     [90m 137 |[39m         [90m// Log retry 
attempt[39m
    [31m[1m>[22m[39m[90m 138 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 139 |[39m           [32m`Retry attempt 
${attempt}/${this.config.maxAttempts} after ${delay}ms 
delay. Error: ${lastError.message}`[39m
     [90m 140 |[39m         )[33m;[39m
     [90m 141 |[39m[0m

      at RetryStrategy.warn 
(src/lib/moderation/retry-strategy.ts:138:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Retry attempt 1/5 after 1000ms delay. Error: 
Service unavailable

    [0m [90m 136 |[39m
     [90m 137 |[39m         [90m// Log retry 
attempt[39m
    [31m[1m>[22m[39m[90m 138 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 139 |[39m           [32m`Retry attempt 
${attempt}/${this.config.maxAttempts} after ${delay}ms 
delay. Error: ${lastError.message}`[39m
     [90m 140 |[39m         )[33m;[39m
     [90m 141 |[39m[0m

      at RetryStrategy.warn 
(src/lib/moderation/retry-strategy.ts:138:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Retry attempt 2/5 after 2000ms delay. Error: 
Service unavailable

    [0m [90m 136 |[39m
     [90m 137 |[39m         [90m// Log retry 
attempt[39m
    [31m[1m>[22m[39m[90m 138 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 139 |[39m           [32m`Retry attempt 
${attempt}/${this.config.maxAttempts} after ${delay}ms 
delay. Error: ${lastError.message}`[39m
     [90m 140 |[39m         )[33m;[39m
     [90m 141 |[39m[0m

      at RetryStrategy.warn 
(src/lib/moderation/retry-strategy.ts:138:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Retry attempt 3/5 after 2000ms delay. Error: 
Service unavailable

    [0m [90m 136 |[39m
     [90m 137 |[39m         [90m// Log retry 
attempt[39m
    [31m[1m>[22m[39m[90m 138 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 139 |[39m           [32m`Retry attempt 
${attempt}/${this.config.maxAttempts} after ${delay}ms 
delay. Error: ${lastError.message}`[39m
     [90m 140 |[39m         )[33m;[39m
     [90m 141 |[39m[0m

      at RetryStrategy.warn 
(src/lib/moderation/retry-strategy.ts:138:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Retry attempt 4/5 after 2000ms delay. Error: 
Service unavailable

    [0m [90m 136 |[39m
     [90m 137 |[39m         [90m// Log retry 
attempt[39m
    [31m[1m>[22m[39m[90m 138 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 139 |[39m           [32m`Retry attempt 
${attempt}/${this.config.maxAttempts} after ${delay}ms 
delay. Error: ${lastError.message}`[39m
     [90m 140 |[39m         )[33m;[39m
     [90m 141 |[39m[0m

      at RetryStrategy.warn 
(src/lib/moderation/retry-strategy.ts:138:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Retry attempt 1/2 after 9ms delay. Error: Service 
unavailable

    [0m [90m 136 |[39m
     [90m 137 |[39m         [90m// Log retry 
attempt[39m
    [31m[1m>[22m[39m[90m 138 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 139 |[39m           [32m`Retry attempt 
${attempt}/${this.config.maxAttempts} after ${delay}ms 
delay. Error: ${lastError.message}`[39m
     [90m 140 |[39m         )[33m;[39m
     [90m 141 |[39m[0m

      at RetryStrategy.warn 
(src/lib/moderation/retry-strategy.ts:138:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ RetryStrategy ÔÇ║ exponential backoff ÔÇ║ caps 
delay at maxDelayMs

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 110 |[39m     })[33m;[39m
     [90m 111 |[39m
    [31m[1m>[22m[39m[90m 112 |[39m     
test([32m'caps delay at maxDelayMs'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 113 |[39m       [36mconst[39m strategy 
[33m=[39m [36mnew[39m [33mRetryStrategy[39m({
     [90m 114 |[39m         maxAttempts[33m:[39m 
[35m5[39m[33m,[39m
     [90m 115 |[39m         baseDelayMs[33m:[39m 
[35m1000[39m[33m,[39m[0m

      at test (src/lib/moderation/__tests__/retry-strate
gy.test.ts:112:5)
      at describe (src/lib/moderation/__tests__/retry-st
rategy.test.ts:85:3)
      at Object.describe (src/lib/moderation/__tests__/r
etry-strategy.test.ts:12:1)

FAIL src/lib/__tests__/network-manager.test.ts (6.995 s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      [NetworkManager] Failed to fetch network state 
after retries, assuming offline: Error: NetInfo module 
unavailable
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\__tests__\network-manager.test.ts:35:15)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply (C:\Users\Peter\GrowBro\src\li
b\__tests__\network-manager.test.ts:33:10)
          at fetch (C:\Users\Peter\GrowBro\src\lib\sync\
network-manager.ts:48:33)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 57 |[39m       [36mif[39m (attempt 
[33m===[39m maxRetries [33m-[39m [35m1[39m) {
     [90m 58 |[39m         [90m// Final attempt 
failed - use fallback[39m
    [31m[1m>[22m[39m[90m 59 |[39m         
console[33m.[39mwarn(
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 60 |[39m           [32m'[NetworkManager] 
Failed to fetch network state after retries, assuming 
offline:'[39m[33m,[39m
     [90m 61 |[39m           error
     [90m 62 |[39m         )[33m;[39m[0m

      at warn (src/lib/sync/network-manager.ts:59:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [NetworkManager] Failed to fetch network state 
after retries, assuming offline: Error: NetInfo module 
unavailable
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\__tests__\network-manager.test.ts:35:15)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply (C:\Users\Peter\GrowBro\src\li
b\__tests__\network-manager.test.ts:33:10)
          at fetch (C:\Users\Peter\GrowBro\src\lib\sync\
network-manager.ts:48:33)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 57 |[39m       [36mif[39m (attempt 
[33m===[39m maxRetries [33m-[39m [35m1[39m) {
     [90m 58 |[39m         [90m// Final attempt 
failed - use fallback[39m
    [31m[1m>[22m[39m[90m 59 |[39m         
console[33m.[39mwarn(
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 60 |[39m           [32m'[NetworkManager] 
Failed to fetch network state after retries, assuming 
offline:'[39m[33m,[39m
     [90m 61 |[39m           error
     [90m 62 |[39m         )[33m;[39m[0m

      at warn (src/lib/sync/network-manager.ts:59:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [NetworkManager] Failed to fetch network state 
after retries, assuming offline: Error: NetInfo module 
unavailable
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\__tests__\network-manager.test.ts:35:15)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply (C:\Users\Peter\GrowBro\src\li
b\__tests__\network-manager.test.ts:33:10)
          at fetch (C:\Users\Peter\GrowBro\src\lib\sync\
network-manager.ts:48:33)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 57 |[39m       [36mif[39m (attempt 
[33m===[39m maxRetries [33m-[39m [35m1[39m) {
     [90m 58 |[39m         [90m// Final attempt 
failed - use fallback[39m
    [31m[1m>[22m[39m[90m 59 |[39m         
console[33m.[39mwarn(
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 60 |[39m           [32m'[NetworkManager] 
Failed to fetch network state after retries, assuming 
offline:'[39m[33m,[39m
     [90m 61 |[39m           error
     [90m 62 |[39m         )[33m;[39m[0m

      at warn (src/lib/sync/network-manager.ts:59:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [NetworkManager] Failed to fetch network state 
after retries, assuming offline: Error: NetInfo module 
unavailable
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\__tests__\network-manager.test.ts:35:15)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply (C:\Users\Peter\GrowBro\src\li
b\__tests__\network-manager.test.ts:33:10)
          at fetch (C:\Users\Peter\GrowBro\src\lib\sync\
network-manager.ts:48:33)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 57 |[39m       [36mif[39m (attempt 
[33m===[39m maxRetries [33m-[39m [35m1[39m) {
     [90m 58 |[39m         [90m// Final attempt 
failed - use fallback[39m
    [31m[1m>[22m[39m[90m 59 |[39m         
console[33m.[39mwarn(
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 60 |[39m           [32m'[NetworkManager] 
Failed to fetch network state after retries, assuming 
offline:'[39m[33m,[39m
     [90m 61 |[39m           error
     [90m 62 |[39m         )[33m;[39m[0m

      at warn (src/lib/sync/network-manager.ts:59:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ NetworkManager - Error Handling ÔÇ║ handles 
NetInfo.fetch errors gracefully with fallback state

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 177 |[39m   })[33m;[39m
     [90m 178 |[39m
    [31m[1m>[22m[39m[90m 179 |[39m   
it([32m'handles NetInfo.fetch errors gracefully with 
fallback state'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m   [31m[1m^[22m[39m
     [90m 180 |[39m     [90m// Enable error throwing 
in NetInfo mock[39m
     [90m 181 |[39m     
setNetInfoThrow([36mtrue[39m)[33m;[39m
     [90m 182 |[39m[0m

      at it 
(src/lib/__tests__/network-manager.test.ts:179:3)
      at Object.describe 
(src/lib/__tests__/network-manager.test.ts:174:1)


  ÔùÅ  Cannot log after tests are done. Did you forget 
to wait for something async in your test?
    Attempted to log "[NetworkManager] Failed to fetch 
network state after retries, assuming offline: Error: 
NetInfo module unavailable
        at Object.<anonymous> (C:\Users\Peter\GrowBro\sr
c\lib\__tests__\network-manager.test.ts:35:15)
        at Generator.next (<anonymous>)
        at asyncGeneratorStep (C:\Users\Peter\GrowBro\no
de_modules\@babel\runtime\helpers\asyncToGenerator.js:3:
17)
        at _next (C:\Users\Peter\GrowBro\node_modules\@b
abel\runtime\helpers\asyncToGenerator.js:17:9)
        at C:\Users\Peter\GrowBro\node_modules\@babel\ru
ntime\helpers\asyncToGenerator.js:22:7
        at new Promise (<anonymous>)
        at Object.<anonymous> (C:\Users\Peter\GrowBro\no
de_modules\@babel\runtime\helpers\asyncToGenerator.js:14
:12)
        at Object.apply (C:\Users\Peter\GrowBro\src\lib\
__tests__\network-manager.test.ts:33:10)
        at fetch (C:\Users\Peter\GrowBro\src\lib\sync\ne
twork-manager.ts:48:33)
        at Generator.next (<anonymous>)
        at asyncGeneratorStep (C:\Users\Peter\GrowBro\no
de_modules\@babel\runtime\helpers\asyncToGenerator.js:3:
17)
        at _next (C:\Users\Peter\GrowBro\node_modules\@b
abel\runtime\helpers\asyncToGenerator.js:17:9)".

    [0m [90m 33 |[39m     fetch[33m:[39m 
[36masync[39m () [33m=>[39m {
     [90m 34 |[39m       [36mif[39m (shouldThrow) {
    [31m[1m>[22m[39m[90m 35 |[39m         
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'NetInfo module 
unavailable'[39m)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 36 |[39m       }
     [90m 37 |[39m       [36mreturn[39m 
state[33m;[39m
     [90m 38 |[39m     }[33m,[39m[0m

      at Object.<anonymous> 
(src/lib/__tests__/network-manager.test.ts:35:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/__tests__/network-manager.test.ts:33:10)
      at fetch (src/lib/sync/network-manager.ts:48:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)".
      at console.warn (node_modules/@jest/console/build/
BufferedConsole.js:191:10)
      at warn (src/lib/sync/network-manager.ts:59:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

FAIL src/lib/hooks/use-profile-statistics.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 111 |[39m     ])[33m;[39m
     [90m 112 |[39m
    [31m[1m>[22m[39m[90m 113 |[39m     
setStatistics({
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 114 |[39m       
[33m...[39muserCounts[33m,[39m
     [90m 115 |[39m       
[33m...[39mpostsAndLikes[33m,[39m
     [90m 116 |[39m     })[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at setStatistics 
(src/lib/hooks/use-profile-statistics.ts:113:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 140 |[39m     } [36mfinally[39m {
     [90m 141 |[39m       
inFlightRef[33m.[39mcurrent [33m=[39m 
[36mnull[39m[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m       
setIsLoading([36mfalse[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 143 |[39m       
setIsSyncing([36mfalse[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m       [36mif[39m 
(pendingRef[33m.[39mcurrent) {[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at setIsLoading 
(src/lib/hooks/use-profile-statistics.ts:142:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 141 |[39m       
inFlightRef[33m.[39mcurrent [33m=[39m 
[36mnull[39m[33m;[39m
     [90m 142 |[39m       
setIsLoading([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m       
setIsSyncing([36mfalse[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m       [36mif[39m 
(pendingRef[33m.[39mcurrent) {
     [90m 146 |[39m         
pendingRef[33m.[39mcurrent [33m=[39m 
[36mfalse[39m[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at setIsSyncing 
(src/lib/hooks/use-profile-statistics.ts:143:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ useProfileStatistics ÔÇ║ Data Fetching ÔÇ║ 
fetches statistics with user filtering

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 120 |[39m   describe([32m'Data 
Fetching'[39m[33m,[39m () [33m=>[39m {
     [90m 121 |[39m     test([32m'fetches statistics 
with user filtering'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
[36mconst[39m { useDatabase } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db/react'[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 123 |[39m       (useDatabase [36mas[39m je
st[33m.[39m[33mMock[39m)[33m.[39mmockReturnValue(m
ockDatabase)[33m;[39m
     [90m 124 |[39m
     [90m 125 |[39m       renderHook(() [33m=>[39m u
seProfileStatistics([32m'user-123'[39m))[33m;[39m[0
m

      at Object.<anonymous> 
(src/lib/hooks/use-profile-statistics.test.ts:122:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ useProfileStatistics ÔÇ║ Data Fetching ÔÇ║ 
updates statistics when data is fetched

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 139 |[39m
     [90m 140 |[39m     test([32m'updates statistics 
when data is fetched'[39m[33m,[39m [36masync[39m 
() [33m=>[39m {
    [31m[1m>[22m[39m[90m 141 |[39m       
[36mconst[39m { useDatabase } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db/react'[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 142 |[39m       (useDatabase [36mas[39m je
st[33m.[39m[33mMock[39m)[33m.[39mmockReturnValue(m
ockDatabase)[33m;[39m
     [90m 143 |[39m
     [90m 144 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m useProfileStatist
ics([32m'user-123'[39m))[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/hooks/use-profile-statistics.test.ts:141:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ useProfileStatistics ÔÇ║ Data Fetching ÔÇ║ 
handles missing collections gracefully

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 156 |[39m
     [90m 157 |[39m     test([32m'handles missing 
collections gracefully'[39m[33m,[39m [36masync[39m 
() [33m=>[39m {
    [31m[1m>[22m[39m[90m 158 |[39m       
[36mconst[39m { useDatabase } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db/react'[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 159 |[39m       (useDatabase [36mas[39m je
st[33m.[39m[33mMock[39m)[33m.[39mmockReturnValue(m
ockDatabase)[33m;[39m
     [90m 160 |[39m
     [90m 161 |[39m       mockDatabase[33m.[39mcolle
ctions[33m.[39m[36mget[39m[33m.[39mmockImplementat
ion(() [33m=>[39m {[0m

      at Object.<anonymous> 
(src/lib/hooks/use-profile-statistics.test.ts:158:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ useProfileStatistics ÔÇ║ Throttling ÔÇ║ throttles 
rapid updates

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 179 |[39m   
describe([32m'Throttling'[39m[33m,[39m () 
[33m=>[39m {
     [90m 180 |[39m     test([32m'throttles rapid 
updates'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 181 |[39m       
[36mconst[39m { useDatabase } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db/react'[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 182 |[39m       (useDatabase [36mas[39m je
st[33m.[39m[33mMock[39m)[33m.[39mmockReturnValue(m
ockDatabase)[33m;[39m
     [90m 183 |[39m
     [90m 184 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m useProfileStatist
ics([32m'user-123'[39m))[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/hooks/use-profile-statistics.test.ts:181:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ useProfileStatistics ÔÇ║ Refresh Functionality 
ÔÇ║ refresh updates statistics

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 199 |[39m   describe([32m'Refresh 
Functionality'[39m[33m,[39m () [33m=>[39m {
     [90m 200 |[39m     test([32m'refresh updates 
statistics'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 201 |[39m       
[36mconst[39m { useDatabase } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db/react'[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 202 |[39m       (useDatabase [36mas[39m je
st[33m.[39m[33mMock[39m)[33m.[39mmockReturnValue(m
ockDatabase)[33m;[39m
     [90m 203 |[39m
     [90m 204 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m useProfileStatist
ics([32m'user-123'[39m))[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/hooks/use-profile-statistics.test.ts:201:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ useProfileStatistics ÔÇ║ Real-time Updates ÔÇ║ 
sets up collection observers

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 223 |[39m   describe([32m'Real-time 
Updates'[39m[33m,[39m () [33m=>[39m {
     [90m 224 |[39m     test([32m'sets up collection 
observers'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 225 |[39m       
[36mconst[39m { useDatabase } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db/react'[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 226 |[39m       (useDatabase [36mas[39m je
st[33m.[39m[33mMock[39m)[33m.[39mmockReturnValue(m
ockDatabase)[33m;[39m
     [90m 227 |[39m
     [90m 228 |[39m       renderHook(() [33m=>[39m u
seProfileStatistics([32m'user-123'[39m))[33m;[39m[0
m

      at Object.<anonymous> 
(src/lib/hooks/use-profile-statistics.test.ts:225:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/moderation/age-verification-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ AgeVerificationService ÔÇ║ verifyAgeAttribute ÔÇ║ 
should successfully verify age attribute and issue token

    TypeError: 
this.supabase.from(...).insert(...).select is not a 
function

    [0m [90m 81 |[39m         
age_attribute_verified[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 82 |[39m       })
    [31m[1m>[22m[39m[90m 83 |[39m       
[33m.[39mselect()
     [90m    |[39m        [31m[1m^[22m[39m
     [90m 84 |[39m       
[33m.[39msingle()[33m;[39m
     [90m 85 |[39m
     [90m 86 |[39m     [36mif[39m (error 
[33m||[39m [33m![39mtoken) {[0m

      at AgeTokenService.select 
(src/lib/moderation/age-token-service.ts:83:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AgeVerificationService ÔÇ║ verifyAgeAttribute ÔÇ║ 
should not store raw ID data during verification

    TypeError: 
this.supabase.from(...).insert(...).select is not a 
function

    [0m [90m 81 |[39m         
age_attribute_verified[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 82 |[39m       })
    [31m[1m>[22m[39m[90m 83 |[39m       
[33m.[39mselect()
     [90m    |[39m        [31m[1m^[22m[39m
     [90m 84 |[39m       
[33m.[39msingle()[33m;[39m
     [90m 85 |[39m
     [90m 86 |[39m     [36mif[39m (error 
[33m||[39m [33m![39mtoken) {[0m

      at AgeTokenService.select 
(src/lib/moderation/age-token-service.ts:83:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AgeVerificationService ÔÇ║ checkAgeGating ÔÇ║ 
should grant access to verified users

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "age_verified"
    Received: "content_not_restricted"

    [0m [90m 417 |[39m       mockSupabase[33m.[39mi
nsert[33m.[39mmockResolvedValue({ error[33m:[39m 
[36mnull[39m })[33m;[39m
     [90m 418 |[39m
    [31m[1m>[22m[39m[90m 419 |[39m       
[36mawait[39m service[33m.[39mdetectSuspiciousActivi
ty(input)[33m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 420 |[39m
     [90m 421 |[39m       [90m// Verify device 
signals included[39m
     [90m 422 |[39m       expect(mockSupabase[33m.[3
9minsert)[33m.[39mtoHaveBeenCalledWith([0m

      at Object.<anonymous> (src/lib/moderation/age-veri
fication-service.test.ts:419:29)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AgeVerificationService ÔÇ║ checkAgeGating ÔÇ║ 
should deny access to unverified users

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 448 |[39m
     [90m 449 |[39m       [90m// Mock user status 
upsert[39m
    [31m[1m>[22m[39m[90m 450 |[39m       mockSupab
ase[33m.[39mupsert[33m.[39mmockResolvedValue({ 
error[33m:[39m [36mnull[39m })[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 451 |[39m
     [90m 452 |[39m       [36mawait[39m service[33m
.[39mdetectSuspiciousActivity(input)[33m;[39m
     [90m 453 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/age-veri
fication-service.test.ts:450:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)


  ÔùÅ  Cannot log after tests are done. Did you forget 
to wait for something async in your test?
    Attempted to log "[NetworkManager] Failed to fetch 
network state after retries, assuming offline: Error: 
NetInfo module unavailable
        at Object.<anonymous> (C:\Users\Peter\GrowBro\sr
c\lib\__tests__\network-manager.test.ts:35:15)
        at Generator.next (<anonymous>)
        at asyncGeneratorStep (C:\Users\Peter\GrowBro\no
de_modules\@babel\runtime\helpers\asyncToGenerator.js:3:
17)
        at _next (C:\Users\Peter\GrowBro\node_modules\@b
abel\runtime\helpers\asyncToGenerator.js:17:9)
        at C:\Users\Peter\GrowBro\node_modules\@babel\ru
ntime\helpers\asyncToGenerator.js:22:7
        at new Promise (<anonymous>)
        at Object.<anonymous> (C:\Users\Peter\GrowBro\no
de_modules\@babel\runtime\helpers\asyncToGenerator.js:14
:12)
        at Object.apply (C:\Users\Peter\GrowBro\src\lib\
__tests__\network-manager.test.ts:33:10)
        at fetch (C:\Users\Peter\GrowBro\src\lib\sync\ne
twork-manager.ts:48:33)
        at Generator.next (<anonymous>)
        at asyncGeneratorStep (C:\Users\Peter\GrowBro\no
de_modules\@babel\runtime\helpers\asyncToGenerator.js:3:
17)
        at _next (C:\Users\Peter\GrowBro\node_modules\@b
abel\runtime\helpers\asyncToGenerator.js:17:9)".

    [0m [90m 33 |[39m     fetch[33m:[39m 
[36masync[39m () [33m=>[39m {
     [90m 34 |[39m       [36mif[39m (shouldThrow) {
    [31m[1m>[22m[39m[90m 35 |[39m         
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'NetInfo module 
unavailable'[39m)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 36 |[39m       }
     [90m 37 |[39m       [36mreturn[39m 
state[33m;[39m
     [90m 38 |[39m     }[33m,[39m[0m

      at Object.<anonymous> 
(src/lib/__tests__/network-manager.test.ts:35:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/__tests__/network-manager.test.ts:33:10)
      at fetch (src/lib/sync/network-manager.ts:48:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)".
      at console.warn (node_modules/@jest/console/build/
BufferedConsole.js:191:10)
      at warn (src/lib/sync/network-manager.ts:59:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

FAIL src/lib/strains/use-favorites.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      [useFavorites] Sync to cloud failed: TypeError: 
repo.getAllFavoritesNeedingSync is not a function
          at getAllFavoritesNeedingSync (C:\Users\Peter\
GrowBro\src\lib\strains\use-favorites.ts:81:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:103:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:79:32)
          at performCloudSync (C:\Users\Peter\GrowBro\sr
c\lib\strains\use-favorites.ts:191:11)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 199 |[39m     [36mconst[39m 
errorMessage [33m=[39m
     [90m 200 |[39m       error [36minstanceof[39m 
[33mError[39m [33m?[39m error[33m.[39mmessage 
[33m:[39m [32m'Unknown sync error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
console[33m.[39merror([32m'[useFavorites] Sync to 
cloud failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 202 |[39m     
setSyncError(errorMessage)[33m;[39m
     [90m 203 |[39m
     [90m 204 |[39m     [90m// Store sync 
error[39m[0m

      at error (src/lib/strains/use-favorites.ts:201:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:46:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:287:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      [useFavorites] Background sync failed: TypeError: 
A dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:205:5
          at Generator.throw (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _throw (C:\Users\Peter\GrowBro\node_modules
\@babel\runtime\helpers\asyncToGenerator.js:20:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 279 |[39m           
[33m.[39msyncToCloud()
     [90m 280 |[39m           
[33m.[39m[36mcatch[39m((e) [33m=>[39m {
    [31m[1m>[22m[39m[90m 281 |[39m             
console[33m.[39merror([32m'[useFavorites] Background 
sync failed:'[39m[33m,[39m e)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 282 |[39m           })[33m;[39m
     [90m 283 |[39m       }
     [90m 284 |[39m     )[33m;[39m[0m

      at error (src/lib/strains/use-favorites.ts:281:21)

    console.error
      [useFavorites] Sync to cloud failed: TypeError: 
repo.getAllFavoritesNeedingSync is not a function
          at getAllFavoritesNeedingSync (C:\Users\Peter\
GrowBro\src\lib\strains\use-favorites.ts:81:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:79:32)
          at performCloudSync (C:\Users\Peter\GrowBro\sr
c\lib\strains\use-favorites.ts:191:11)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 199 |[39m     [36mconst[39m 
errorMessage [33m=[39m
     [90m 200 |[39m       error [36minstanceof[39m 
[33mError[39m [33m?[39m error[33m.[39mmessage 
[33m:[39m [32m'Unknown sync error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
console[33m.[39merror([32m'[useFavorites] Sync to 
cloud failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 202 |[39m     
setSyncError(errorMessage)[33m;[39m
     [90m 203 |[39m
     [90m 204 |[39m     [90m// Store sync 
error[39m[0m

      at error (src/lib/strains/use-favorites.ts:201:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:287:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      [useFavorites] Background sync failed: TypeError: 
A dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:205:5
          at Generator.throw (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _throw (C:\Users\Peter\GrowBro\node_modules
\@babel\runtime\helpers\asyncToGenerator.js:20:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 279 |[39m           
[33m.[39msyncToCloud()
     [90m 280 |[39m           
[33m.[39m[36mcatch[39m((e) [33m=>[39m {
    [31m[1m>[22m[39m[90m 281 |[39m             
console[33m.[39merror([32m'[useFavorites] Background 
sync failed:'[39m[33m,[39m e)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 282 |[39m           })[33m;[39m
     [90m 283 |[39m       }
     [90m 284 |[39m     )[33m;[39m[0m

      at error (src/lib/strains/use-favorites.ts:281:21)

    console.error
      [useFavorites] Sync to cloud failed: TypeError: 
repo.getAllFavoritesNeedingSync is not a function
          at getAllFavoritesNeedingSync (C:\Users\Peter\
GrowBro\src\lib\strains\use-favorites.ts:81:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:79:32)
          at performCloudSync (C:\Users\Peter\GrowBro\sr
c\lib\strains\use-favorites.ts:191:11)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 199 |[39m     [36mconst[39m 
errorMessage [33m=[39m
     [90m 200 |[39m       error [36minstanceof[39m 
[33mError[39m [33m?[39m error[33m.[39mmessage 
[33m:[39m [32m'Unknown sync error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
console[33m.[39merror([32m'[useFavorites] Sync to 
cloud failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 202 |[39m     
setSyncError(errorMessage)[33m;[39m
     [90m 203 |[39m
     [90m 204 |[39m     [90m// Store sync 
error[39m[0m

      at error (src/lib/strains/use-favorites.ts:201:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:287:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      [useFavorites] Background sync failed: TypeError: 
A dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:205:5
          at Generator.throw (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _throw (C:\Users\Peter\GrowBro\node_modules
\@babel\runtime\helpers\asyncToGenerator.js:20:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 279 |[39m           
[33m.[39msyncToCloud()
     [90m 280 |[39m           
[33m.[39m[36mcatch[39m((e) [33m=>[39m {
    [31m[1m>[22m[39m[90m 281 |[39m             
console[33m.[39merror([32m'[useFavorites] Background 
sync failed:'[39m[33m,[39m e)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 282 |[39m           })[33m;[39m
     [90m 283 |[39m       }
     [90m 284 |[39m     )[33m;[39m[0m

      at error (src/lib/strains/use-favorites.ts:281:21)

    console.error
      [useFavorites] Sync to cloud failed: TypeError: 
repo.getAllFavoritesNeedingSync is not a function
          at getAllFavoritesNeedingSync (C:\Users\Peter\
GrowBro\src\lib\strains\use-favorites.ts:81:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:79:32)
          at performCloudSync (C:\Users\Peter\GrowBro\sr
c\lib\strains\use-favorites.ts:191:11)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 199 |[39m     [36mconst[39m 
errorMessage [33m=[39m
     [90m 200 |[39m       error [36minstanceof[39m 
[33mError[39m [33m?[39m error[33m.[39mmessage 
[33m:[39m [32m'Unknown sync error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
console[33m.[39merror([32m'[useFavorites] Sync to 
cloud failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 202 |[39m     
setSyncError(errorMessage)[33m;[39m
     [90m 203 |[39m
     [90m 204 |[39m     [90m// Store sync 
error[39m[0m

      at error (src/lib/strains/use-favorites.ts:201:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:287:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      [useFavorites] Background sync failed: TypeError: 
A dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:205:5
          at Generator.throw (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _throw (C:\Users\Peter\GrowBro\node_modules
\@babel\runtime\helpers\asyncToGenerator.js:20:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 279 |[39m           
[33m.[39msyncToCloud()
     [90m 280 |[39m           
[33m.[39m[36mcatch[39m((e) [33m=>[39m {
    [31m[1m>[22m[39m[90m 281 |[39m             
console[33m.[39merror([32m'[useFavorites] Background 
sync failed:'[39m[33m,[39m e)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 282 |[39m           })[33m;[39m
     [90m 283 |[39m       }
     [90m 284 |[39m     )[33m;[39m[0m

      at error (src/lib/strains/use-favorites.ts:281:21)

    console.error
      [useFavorites] Sync to cloud failed: TypeError: 
repo.getAllFavoritesNeedingSync is not a function
          at getAllFavoritesNeedingSync (C:\Users\Peter\
GrowBro\src\lib\strains\use-favorites.ts:81:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:79:32)
          at performCloudSync (C:\Users\Peter\GrowBro\sr
c\lib\strains\use-favorites.ts:191:11)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 199 |[39m     [36mconst[39m 
errorMessage [33m=[39m
     [90m 200 |[39m       error [36minstanceof[39m 
[33mError[39m [33m?[39m error[33m.[39mmessage 
[33m:[39m [32m'Unknown sync error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
console[33m.[39merror([32m'[useFavorites] Sync to 
cloud failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 202 |[39m     
setSyncError(errorMessage)[33m;[39m
     [90m 203 |[39m
     [90m 204 |[39m     [90m// Store sync 
error[39m[0m

      at error (src/lib/strains/use-favorites.ts:201:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:339:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      [useFavorites] Background sync failed: TypeError: 
A dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:205:5
          at Generator.throw (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _throw (C:\Users\Peter\GrowBro\node_modules
\@babel\runtime\helpers\asyncToGenerator.js:20:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 331 |[39m           
[33m.[39msyncToCloud()
     [90m 332 |[39m           
[33m.[39m[36mcatch[39m((e) [33m=>[39m {
    [31m[1m>[22m[39m[90m 333 |[39m             
console[33m.[39merror([32m'[useFavorites] Background 
sync failed:'[39m[33m,[39m e)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 334 |[39m           })[33m;[39m
     [90m 335 |[39m       }
     [90m 336 |[39m     )[33m;[39m[0m

      at error (src/lib/strains/use-favorites.ts:333:21)

    console.error
      [useFavorites] Sync to cloud failed: TypeError: 
repo.getAllFavoritesNeedingSync is not a function
          at getAllFavoritesNeedingSync (C:\Users\Peter\
GrowBro\src\lib\strains\use-favorites.ts:81:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:79:32)
          at performCloudSync (C:\Users\Peter\GrowBro\sr
c\lib\strains\use-favorites.ts:191:11)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 199 |[39m     [36mconst[39m 
errorMessage [33m=[39m
     [90m 200 |[39m       error [36minstanceof[39m 
[33mError[39m [33m?[39m error[33m.[39mmessage 
[33m:[39m [32m'Unknown sync error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
console[33m.[39merror([32m'[useFavorites] Sync to 
cloud failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 202 |[39m     
setSyncError(errorMessage)[33m;[39m
     [90m 203 |[39m
     [90m 204 |[39m     [90m// Store sync 
error[39m[0m

      at error (src/lib/strains/use-favorites.ts:201:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:287:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      [useFavorites] Background sync failed: TypeError: 
A dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:205:5
          at Generator.throw (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _throw (C:\Users\Peter\GrowBro\node_modules
\@babel\runtime\helpers\asyncToGenerator.js:20:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 279 |[39m           
[33m.[39msyncToCloud()
     [90m 280 |[39m           
[33m.[39m[36mcatch[39m((e) [33m=>[39m {
    [31m[1m>[22m[39m[90m 281 |[39m             
console[33m.[39merror([32m'[useFavorites] Background 
sync failed:'[39m[33m,[39m e)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 282 |[39m           })[33m;[39m
     [90m 283 |[39m       }
     [90m 284 |[39m     )[33m;[39m[0m

      at error (src/lib/strains/use-favorites.ts:281:21)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:339:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      [useFavorites] Sync to cloud failed: TypeError: 
repo.getAllFavoritesNeedingSync is not a function
          at getAllFavoritesNeedingSync (C:\Users\Peter\
GrowBro\src\lib\strains\use-favorites.ts:81:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:79:32)
          at performCloudSync (C:\Users\Peter\GrowBro\sr
c\lib\strains\use-favorites.ts:191:11)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 199 |[39m     [36mconst[39m 
errorMessage [33m=[39m
     [90m 200 |[39m       error [36minstanceof[39m 
[33mError[39m [33m?[39m error[33m.[39mmessage 
[33m:[39m [32m'Unknown sync error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
console[33m.[39merror([32m'[useFavorites] Sync to 
cloud failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 202 |[39m     
setSyncError(errorMessage)[33m;[39m
     [90m 203 |[39m
     [90m 204 |[39m     [90m// Store sync 
error[39m[0m

      at error (src/lib/strains/use-favorites.ts:201:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:287:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      [useFavorites] Background sync failed: TypeError: 
A dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:205:5
          at Generator.throw (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _throw (C:\Users\Peter\GrowBro\node_modules
\@babel\runtime\helpers\asyncToGenerator.js:20:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 279 |[39m           
[33m.[39msyncToCloud()
     [90m 280 |[39m           
[33m.[39m[36mcatch[39m((e) [33m=>[39m {
    [31m[1m>[22m[39m[90m 281 |[39m             
console[33m.[39merror([32m'[useFavorites] Background 
sync failed:'[39m[33m,[39m e)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 282 |[39m           })[33m;[39m
     [90m 283 |[39m       }
     [90m 284 |[39m     )[33m;[39m[0m

      at error (src/lib/strains/use-favorites.ts:281:21)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:287:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      [useFavorites] Sync to cloud failed: TypeError: 
repo.getAllFavoritesNeedingSync is not a function
          at getAllFavoritesNeedingSync (C:\Users\Peter\
GrowBro\src\lib\strains\use-favorites.ts:81:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:79:32)
          at performCloudSync (C:\Users\Peter\GrowBro\sr
c\lib\strains\use-favorites.ts:191:11)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 199 |[39m     [36mconst[39m 
errorMessage [33m=[39m
     [90m 200 |[39m       error [36minstanceof[39m 
[33mError[39m [33m?[39m error[33m.[39mmessage 
[33m:[39m [32m'Unknown sync error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
console[33m.[39merror([32m'[useFavorites] Sync to 
cloud failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 202 |[39m     
setSyncError(errorMessage)[33m;[39m
     [90m 203 |[39m
     [90m 204 |[39m     [90m// Store sync 
error[39m[0m

      at error (src/lib/strains/use-favorites.ts:201:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:287:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      [useFavorites] Background sync failed: TypeError: 
A dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:205:5
          at Generator.throw (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _throw (C:\Users\Peter\GrowBro\node_modules
\@babel\runtime\helpers\asyncToGenerator.js:20:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 279 |[39m           
[33m.[39msyncToCloud()
     [90m 280 |[39m           
[33m.[39m[36mcatch[39m((e) [33m=>[39m {
    [31m[1m>[22m[39m[90m 281 |[39m             
console[33m.[39merror([32m'[useFavorites] Background 
sync failed:'[39m[33m,[39m e)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 282 |[39m           })[33m;[39m
     [90m 283 |[39m       }
     [90m 284 |[39m     )[33m;[39m[0m

      at error (src/lib/strains/use-favorites.ts:281:21)

    console.error
      [useFavorites] Sync to cloud failed: TypeError: 
repo.getAllFavoritesNeedingSync is not a function
          at getAllFavoritesNeedingSync (C:\Users\Peter\
GrowBro\src\lib\strains\use-favorites.ts:81:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:79:32)
          at performCloudSync (C:\Users\Peter\GrowBro\sr
c\lib\strains\use-favorites.ts:191:11)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 199 |[39m     [36mconst[39m 
errorMessage [33m=[39m
     [90m 200 |[39m       error [36minstanceof[39m 
[33mError[39m [33m?[39m error[33m.[39mmessage 
[33m:[39m [32m'Unknown sync error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
console[33m.[39merror([32m'[useFavorites] Sync to 
cloud failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 202 |[39m     
setSyncError(errorMessage)[33m;[39m
     [90m 203 |[39m
     [90m 204 |[39m     [90m// Store sync 
error[39m[0m

      at error (src/lib/strains/use-favorites.ts:201:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:287:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      [useFavorites] Background sync failed: TypeError: 
A dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:205:5
          at Generator.throw (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _throw (C:\Users\Peter\GrowBro\node_modules
\@babel\runtime\helpers\asyncToGenerator.js:20:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 279 |[39m           
[33m.[39msyncToCloud()
     [90m 280 |[39m           
[33m.[39m[36mcatch[39m((e) [33m=>[39m {
    [31m[1m>[22m[39m[90m 281 |[39m             
console[33m.[39merror([32m'[useFavorites] Background 
sync failed:'[39m[33m,[39m e)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 282 |[39m           })[33m;[39m
     [90m 283 |[39m       }
     [90m 284 |[39m     )[33m;[39m[0m

      at error (src/lib/strains/use-favorites.ts:281:21)

    console.error
      [useFavorites] Sync to cloud failed: TypeError: 
repo.getAllFavoritesNeedingSync is not a function
          at getAllFavoritesNeedingSync (C:\Users\Peter\
GrowBro\src\lib\strains\use-favorites.ts:81:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:79:32)
          at performCloudSync (C:\Users\Peter\GrowBro\sr
c\lib\strains\use-favorites.ts:191:11)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 199 |[39m     [36mconst[39m 
errorMessage [33m=[39m
     [90m 200 |[39m       error [36minstanceof[39m 
[33mError[39m [33m?[39m error[33m.[39mmessage 
[33m:[39m [32m'Unknown sync error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
console[33m.[39merror([32m'[useFavorites] Sync to 
cloud failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 202 |[39m     
setSyncError(errorMessage)[33m;[39m
     [90m 203 |[39m
     [90m 204 |[39m     [90m// Store sync 
error[39m[0m

      at error (src/lib/strains/use-favorites.ts:201:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.debug
      [useFavorites] Analytics tracking failed: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:23:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\strai
ns\use-favorites.ts:17:38)
          at Object.trackFavoriteAnalytics (C:\Users\Pet
er\GrowBro\src\lib\strains\use-favorites.ts:287:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

      at debug (src/lib/strains/use-favorites.ts:44:13)
          at Generator.throw (<anonymous>)

    console.error
      [useFavorites] Background sync failed: TypeError: 
A dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\strains\use-
favorites.ts:205:5
          at Generator.throw (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _throw (C:\Users\Peter\GrowBro\node_modules
\@babel\runtime\helpers\asyncToGenerator.js:20:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 279 |[39m           
[33m.[39msyncToCloud()
     [90m 280 |[39m           
[33m.[39m[36mcatch[39m((e) [33m=>[39m {
    [31m[1m>[22m[39m[90m 281 |[39m             
console[33m.[39merror([32m'[useFavorites] Background 
sync failed:'[39m[33m,[39m e)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 282 |[39m           })[33m;[39m
     [90m 283 |[39m       }
     [90m 284 |[39m     )[33m;[39m[0m

      at error (src/lib/strains/use-favorites.ts:281:21)

  ÔùÅ useFavorites ÔÇ║ addFavorite ÔÇ║ stores snapshot 
with essential fields

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 1

      Object {
        "id": "test-strain-1",
        "imageUrl": "https://example.com/image.jpg",
        "name": "Test Strain",
        "race": "hybrid",
    +   "slug": "test-strain",
        "thc_display": "18-24%",
      }

    [0m [90m 142 |[39m       })[33m;[39m
     [90m 143 |[39m
    [31m[1m>[22m[39m[90m 144 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 145 |[39m         [36mconst[39m favorites 
[33m=[39m result[33m.[39mcurrent[33m.[39mgetFavori
tes()[33m;[39m
     [90m 146 |[39m         [36mconst[39m snapshot 
[33m=[39m 
favorites[[35m0[39m][33m.[39msnapshot[33m;[39m
     [90m 147 |[39m         
expect(snapshot)[33m.[39mtoEqual({[0m

      at Object.<anonymous> 
(src/lib/strains/use-favorites.test.ts:144:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ useFavorites ÔÇ║ multiple favorites ÔÇ║ sorts 
favorites by addedAt descending

    expect(received).toHaveLength(expected)

    Expected length: 2
    Received length: 3
    Received array:  [{"addedAt": 1768559000702, "id": 
"test-strain-2", "snapshot": {"id": "test-strain-2", 
"imageUrl": "https://example.com/image.jpg", "name": 
"Strain 2", "race": "hybrid", "slug": "test-strain", 
"thc_display": "18-24%"}}, {"addedAt": 1768559000680, 
"id": "test-strain-1", "snapshot": {"id": 
"test-strain-1", "imageUrl": 
"https://example.com/image.jpg", "name": "Test Strain", 
"race": "hybrid", "slug": "test-strain", "thc_display": 
"18-24%"}}, {"addedAt": 1768559000677, "id": 
"test-strain-3", "snapshot": {"id": "test-strain-3", 
"imageUrl": "https://example.com/image.jpg", "name": 
"Strain 3", "race": "hybrid", "slug": "test-strain", 
"thc_display": "18-24%"}}]

    [0m [90m 248 |[39m       })[33m;[39m
     [90m 249 |[39m
    [31m[1m>[22m[39m[90m 250 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 251 |[39m         expect(result[33m.[39mcu
rrent[33m.[39mgetFavorites())[33m.[39mtoHaveLength(
[35m2[39m)[33m;[39m
     [90m 252 |[39m       })[33m;[39m
     [90m 253 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/use-favorites.test.ts:250:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ useFavorites ÔÇ║ sync state ÔÇ║ tracks sync errors

    expect(received).toBeNull()

    Received: "repo.getAllFavoritesNeedingSync is not a 
function"

    [0m [90m 266 |[39m     test([32m'tracks sync 
errors'[39m[33m,[39m () [33m=>[39m {
     [90m 267 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m 
useFavorites())[33m;[39m
    [31m[1m>[22m[39m[90m 268 |[39m       expect(re
sult[33m.[39mcurrent[33m.[39msyncError)[33m.[39mto
BeNull()[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 269 |[39m     })[33m;[39m
     [90m 270 |[39m
     [90m 271 |[39m     test([32m'tracks last sync 
timestamp'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBeNull 
(src/lib/strains/use-favorites.test.ts:268:40)

FAIL src/lib/moderation/content-age-gating.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ checkAgeGating ÔÇ║ 
should grant access to non-restricted content

    TypeError: this.supabase.from(...).select(...).eq(..
.).eq(...).limit is not a function

    [0m [90m 445 |[39m       
[33m.[39meq([32m'content_id'[39m[33m,[39m 
contentId)
     [90m 446 |[39m       
[33m.[39meq([32m'content_type'[39m[33m,[39m 
contentType)
    [31m[1m>[22m[39m[90m 447 |[39m       
[33m.[39mlimit([35m1[39m)[33m;[39m [90m// Safe 
due to unique constraint on (content_id, 
content_type)[39m
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 448 |[39m
     [90m 449 |[39m     [36mconst[39m restriction 
[33m=[39m (data [36mas[39m 
[33mDbContentRestriction[39m[] [33m|[39m [36mnull[
39m)[33m?[39m[33m.[39m[[35m0[39m][33m;[39m
     [90m 450 |[39m[0m

      at ContentAgeGatingEngine.limit 
(src/lib/moderation/content-age-gating.ts:447:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getContentRestriction] 
(src/lib/moderation/content-age-gating.ts:438:38)
      at ContentAgeGatingEngine.getContentRestriction 
(src/lib/moderation/content-age-gating.ts:114:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
checkAgeGating] 
(src/lib/moderation/content-age-gating.ts:108:23)
      at Object.checkAgeGating 
(src/lib/moderation/content-age-gating.test.ts:54:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ checkAgeGating ÔÇ║ 
should grant access to verified users for restricted 
content

    TypeError: this.supabase.from(...).select(...).eq(..
.).eq(...).limit is not a function

    [0m [90m 445 |[39m       
[33m.[39meq([32m'content_id'[39m[33m,[39m 
contentId)
     [90m 446 |[39m       
[33m.[39meq([32m'content_type'[39m[33m,[39m 
contentType)
    [31m[1m>[22m[39m[90m 447 |[39m       
[33m.[39mlimit([35m1[39m)[33m;[39m [90m// Safe 
due to unique constraint on (content_id, 
content_type)[39m
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 448 |[39m
     [90m 449 |[39m     [36mconst[39m restriction 
[33m=[39m (data [36mas[39m 
[33mDbContentRestriction[39m[] [33m|[39m [36mnull[
39m)[33m?[39m[33m.[39m[[35m0[39m][33m;[39m
     [90m 450 |[39m[0m

      at ContentAgeGatingEngine.limit 
(src/lib/moderation/content-age-gating.ts:447:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getContentRestriction] 
(src/lib/moderation/content-age-gating.ts:438:38)
      at ContentAgeGatingEngine.getContentRestriction 
(src/lib/moderation/content-age-gating.ts:114:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
checkAgeGating] 
(src/lib/moderation/content-age-gating.ts:108:23)
      at Object.checkAgeGating 
(src/lib/moderation/content-age-gating.test.ts:90:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ checkAgeGating ÔÇ║ 
should deny access to unverified users for restricted 
content

    TypeError: this.supabase.from(...).select(...).eq(..
.).eq(...).limit is not a function

    [0m [90m 445 |[39m       
[33m.[39meq([32m'content_id'[39m[33m,[39m 
contentId)
     [90m 446 |[39m       
[33m.[39meq([32m'content_type'[39m[33m,[39m 
contentType)
    [31m[1m>[22m[39m[90m 447 |[39m       
[33m.[39mlimit([35m1[39m)[33m;[39m [90m// Safe 
due to unique constraint on (content_id, 
content_type)[39m
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 448 |[39m
     [90m 449 |[39m     [36mconst[39m restriction 
[33m=[39m (data [36mas[39m 
[33mDbContentRestriction[39m[] [33m|[39m [36mnull[
39m)[33m?[39m[33m.[39m[[35m0[39m][33m;[39m
     [90m 450 |[39m[0m

      at ContentAgeGatingEngine.limit 
(src/lib/moderation/content-age-gating.ts:447:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getContentRestriction] 
(src/lib/moderation/content-age-gating.ts:438:38)
      at ContentAgeGatingEngine.getContentRestriction 
(src/lib/moderation/content-age-gating.ts:114:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
checkAgeGating] 
(src/lib/moderation/content-age-gating.ts:108:23)
      at Object.checkAgeGating 
(src/lib/moderation/content-age-gating.test.ts:124:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ autoFlagContent ÔÇ║ 
should not flag content without restricted keywords

    TypeError: Cannot read properties of undefined 
(reading 'data')

    [0m [90m 177 |[39m
     [90m 178 |[39m     [90m// Upsert age 
restriction[39m
    [31m[1m>[22m[39m[90m 179 |[39m     
[36mconst[39m { data[33m:[39m 
restriction[33m,[39m error } [33m=[39m 
[36mawait[39m [36mthis[39m[33m.[39msupabase
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 180 |[39m       [33m.[39m[36mfrom[39m([
32m'content_age_restrictions'[39m)
     [90m 181 |[39m       [33m.[39mupsert(
     [90m 182 |[39m         {[0m

      at ContentAgeGatingEngine.data 
(src/lib/moderation/content-age-gating.ts:179:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ filterContentByAge ÔÇ║ 
should not filter content for verified users

    TypeError: 
this.supabase.from(...).select(...).eq(...).limit is 
not a function

    [0m [90m 478 |[39m       
[33m.[39mselect([32m'*'[39m)
     [90m 479 |[39m       
[33m.[39meq([32m'user_id'[39m[33m,[39m userId)
    [31m[1m>[22m[39m[90m 480 |[39m       
[33m.[39mlimit([35m1[39m)[33m;[39m
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 481 |[39m
     [90m 482 |[39m     [36mif[39m (error) {
     [90m 483 |[39m       [90m// Cache transient DB 
errors briefly to avoid hot-looping[39m[0m

      at ContentAgeGatingEngine.limit 
(src/lib/moderation/content-age-gating.ts:480:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getUserAgeStatus] 
(src/lib/moderation/content-age-gating.ts:462:33)
      at ContentAgeGatingEngine.getUserAgeStatus 
(src/lib/moderation/content-age-gating.ts:302:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
filterContentByAge] 
(src/lib/moderation/content-age-gating.ts:296:27)
      at Object.filterContentByAge 
(src/lib/moderation/content-age-gating.test.ts:327:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ filterContentByAge ÔÇ║ 
should filter restricted content for unverified users

    TypeError: this.supabase.from(...).select(...).eq 
is not a function

    [0m [90m 477 |[39m       
[33m.[39m[36mfrom[39m([32m'user_age_status'[39m)
     [90m 478 |[39m       
[33m.[39mselect([32m'*'[39m)
    [31m[1m>[22m[39m[90m 479 |[39m       
[33m.[39meq([32m'user_id'[39m[33m,[39m userId)
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 480 |[39m       
[33m.[39mlimit([35m1[39m)[33m;[39m
     [90m 481 |[39m
     [90m 482 |[39m     [36mif[39m (error) {[0m

      at ContentAgeGatingEngine.eq 
(src/lib/moderation/content-age-gating.ts:479:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getUserAgeStatus] 
(src/lib/moderation/content-age-gating.ts:462:33)
      at ContentAgeGatingEngine.getUserAgeStatus 
(src/lib/moderation/content-age-gating.ts:302:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
filterContentByAge] 
(src/lib/moderation/content-age-gating.ts:296:27)
      at Object.filterContentByAge 
(src/lib/moderation/content-age-gating.test.ts:357:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ filterContentByAge ÔÇ║ 
should apply safer defaults for minors

    TypeError: this.supabase.from(...).select(...).eq 
is not a function

    [0m [90m 477 |[39m       
[33m.[39m[36mfrom[39m([32m'user_age_status'[39m)
     [90m 478 |[39m       
[33m.[39mselect([32m'*'[39m)
    [31m[1m>[22m[39m[90m 479 |[39m       
[33m.[39meq([32m'user_id'[39m[33m,[39m userId)
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 480 |[39m       
[33m.[39mlimit([35m1[39m)[33m;[39m
     [90m 481 |[39m
     [90m 482 |[39m     [36mif[39m (error) {[0m

      at ContentAgeGatingEngine.eq 
(src/lib/moderation/content-age-gating.ts:479:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getUserAgeStatus] 
(src/lib/moderation/content-age-gating.ts:462:33)
      at ContentAgeGatingEngine.getUserAgeStatus 
(src/lib/moderation/content-age-gating.ts:302:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
filterContentByAge] 
(src/lib/moderation/content-age-gating.ts:296:27)
      at Object.filterContentByAge 
(src/lib/moderation/content-age-gating.test.ts:390:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ removeAgeRestriction 
ÔÇ║ should remove age restriction from content

    TypeError: this.supabase.from(...).update(...).eq 
is not a function

    [0m [90m 263 |[39m         
is_age_restricted[33m:[39m [36mfalse[39m[33m,[39m
     [90m 264 |[39m       })
    [31m[1m>[22m[39m[90m 265 |[39m       
[33m.[39meq([32m'content_id'[39m[33m,[39m 
contentId)
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 266 |[39m       
[33m.[39meq([32m'content_type'[39m[33m,[39m 
contentType)[33m;[39m
     [90m 267 |[39m
     [90m 268 |[39m     [36mif[39m (error) {[0m

      at ContentAgeGatingEngine.eq 
(src/lib/moderation/content-age-gating.ts:265:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
removeAgeRestriction] 
(src/lib/moderation/content-age-gating.ts:256:29)
      at Object.removeAgeRestriction 
(src/lib/moderation/content-age-gating.test.ts:409:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ getAgeRestrictionStats 
ÔÇ║ should return statistics for age-restricted content

    TypeError: this.supabase.from(...).select(...).eq 
is not a function

    [0m [90m 339 |[39m       [33m.[39m[36mfrom[39
m([32m'content_age_restrictions'[39m)
     [90m 340 |[39m       
[33m.[39mselect([32m'flagged_by_system, 
flagged_by_author, flagged_by_moderator'[39m)
    [31m[1m>[22m[39m[90m 341 |[39m       
[33m.[39meq([32m'is_age_restricted'[39m[33m,[39m 
[36mtrue[39m)[33m;[39m
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 342 |[39m
     [90m 343 |[39m     [36mconst[39m statsList 
[33m=[39m (stats [33m||[39m []) [36mas[39m 
[33mPick[39m[33m<[39m
     [90m 344 |[39m       
[33mDbContentRestriction[39m[33m,[39m[0m

      at ContentAgeGatingEngine.eq 
(src/lib/moderation/content-age-gating.ts:341:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getAgeRestrictionStats] 
(src/lib/moderation/content-age-gating.ts:332:31)
      at Object.getAgeRestrictionStats 
(src/lib/moderation/content-age-gating.test.ts:445:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/api/community/client.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

  ÔùÅ CommunityApiClient ÔÇ║ getPost ÔÇ║ should fetch a 
single post successfully

    TypeError: this.client.from(...).select(...).eq is 
not a function

    [0m [90m 331 |[39m       
[33m.[39m[36mfrom[39m([32m'posts'[39m)
     [90m 332 |[39m       
[33m.[39mselect([32m'*'[39m)
    [31m[1m>[22m[39m[90m 333 |[39m       
[33m.[39meq([32m'id'[39m[33m,[39m postId)
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 334 |[39m       
[33m.[39mis([32m'deleted_at'[39m[33m,[39m 
[36mnull[39m)
     [90m 335 |[39m       
[33m.[39mis([32m'hidden_at'[39m[33m,[39m 
[36mnull[39m)[33m;[39m
     [90m 336 |[39m[0m

      at CommunityApiClient.eq 
(src/api/community/client.ts:333:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CommunityApiClient.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at CommunityApiClient.apply [as getPost] 
(src/api/community/client.ts:329:16)
      at Object.getPost 
(src/api/community/client.test.ts:138:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ CommunityApiClient ÔÇ║ getPost ÔÇ║ should throw 
error when post fetch fails

    expect(received).rejects.toThrow(expected)

    Expected substring: "Failed to fetch posts with 
counts"
    Received message:   
"this.client.from(...).select(...).eq is not a function"

        [0m [90m 331 |[39m       
[33m.[39m[36mfrom[39m([32m'posts'[39m)
         [90m 332 |[39m       
[33m.[39mselect([32m'*'[39m)
        [31m[1m>[22m[39m[90m 333 |[39m       
[33m.[39meq([32m'id'[39m[33m,[39m postId)
         [90m     |[39m        [31m[1m^[22m[39m
         [90m 334 |[39m       
[33m.[39mis([32m'deleted_at'[39m[33m,[39m 
[36mnull[39m)
         [90m 335 |[39m       
[33m.[39mis([32m'hidden_at'[39m[33m,[39m 
[36mnull[39m)[33m;[39m
         [90m 336 |[39m[0m

      at CommunityApiClient.eq 
(src/api/community/client.ts:333:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CommunityApiClient.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at CommunityApiClient.apply [as getPost] 
(src/api/community/client.ts:329:16)
      at Object.getPost 
(src/api/community/client.test.ts:171:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow 
(src/api/community/client.test.ts:171:58)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ CommunityApiClient ÔÇ║ deletePost and 
undoDeletePost ÔÇ║ should restore a post within undo 
window

    TypeError: Cannot read properties of undefined 
(reading 'select')

    [0m [90m 585 |[39m   }[33m>[39m {
     [90m 586 |[39m     [36mconst[39m { 
data[33m:[39m diagnosticPost[33m,[39m 
error[33m:[39m diagnosticError } [33m=[39m 
[36mawait[39m [36mthis[39m[33m.[39mclient
    [31m[1m>[22m[39m[90m 587 |[39m       
[33m.[39m[36mfrom[39m([32m'posts'[39m)
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 588 |[39m       [33m.[39mselect([32m'id, 
deleted_at, created_at, updated_at'[39m)
     [90m 589 |[39m       
[33m.[39meq([32m'id'[39m[33m,[39m postId)
     [90m 590 |[39m       
[33m.[39msingle()[33m;[39m[0m

      at CommunityApiClient.<anonymous> 
(src/api/community/client.ts:587:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CommunityApiClient.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at CommunityApiClient.apply [as 
runPostDiagnostic] (src/api/community/client.ts:582:34)
      at Object.runPostDiagnostic 
(src/api/community/client.ts:673:24)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ CommunityApiClient ÔÇ║ Pagination ÔÇ║ should 
handle pagination with cursor correctly

    TypeError: this.client.from(...).select(...).is is 
not a function

    [0m [90m 358 |[39m       
[33m.[39m[36mfrom[39m([32m'posts'[39m)
     [90m 359 |[39m       
[33m.[39mselect([32m'*'[39m)
    [31m[1m>[22m[39m[90m 360 |[39m       
[33m.[39mis([32m'deleted_at'[39m[33m,[39m 
[36mnull[39m)
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 361 |[39m       
[33m.[39mis([32m'hidden_at'[39m[33m,[39m 
[36mnull[39m)
     [90m 362 |[39m       
[33m.[39morder([32m'created_at'[39m[33m,[39m { 
ascending[33m:[39m [36mfalse[39m })
     [90m 363 |[39m       
[33m.[39mlimit(limit)[33m;[39m[0m

      at CommunityApiClient.is 
(src/api/community/client.ts:360:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CommunityApiClient ÔÇ║ getPostsDiscover ÔÇ║ 
applies top_7d sorting and filters

    TypeError: b.not is not a function

    [0m [90m 226 |[39m   [36mif[39m 
(ctx[33m.[39mphotosOnly) {
     [90m 227 |[39m     b [33m=[39m b
    [31m[1m>[22m[39m[90m 228 |[39m       
[33m.[39mnot([32m'media_uri'[39m[33m,[39m 
[32m'is'[39m[33m,[39m [36mnull[39m)
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 229 |[39m       
[33m.[39mnot([32m'media_resized_uri'[39m[33m,[39m 
[32m'is'[39m[33m,[39m [36mnull[39m)
     [90m 230 |[39m       [33m.[39mnot([32m'media_t
humbnail_uri'[39m[33m,[39m [32m'is'[39m[33m,[39m 
[36mnull[39m)[33m;[39m
     [90m 231 |[39m   }[0m

      at not (src/api/community/client.ts:228:8)
      at CommunityApiClient.applyDiscoverFilters 
(src/api/community/client.ts:413:29)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/hooks/use-notification-preferences.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 29 |[39m     [36mconst[39m loadUserId 
[33m=[39m [36masync[39m () [33m=>[39m {
     [90m 30 |[39m       [36mconst[39m id 
[33m=[39m [36mawait[39m 
getOptionalAuthenticatedUserId()[33m;[39m
    [31m[1m>[22m[39m[90m 31 |[39m       
[36mif[39m (isMounted) setUserId(id)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 32 |[39m     }[33m;[39m
     [90m 33 |[39m     loadUserId()[33m;[39m
     [90m 34 |[39m     [36mreturn[39m () 
[33m=>[39m {[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at setUserId 
(src/lib/hooks/use-notification-preferences.ts:31:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 47 |[39m     [36mconst[39m 
loadPreferences [33m=[39m [36masync[39m () 
[33m=>[39m {
     [90m 48 |[39m       [36mtry[39m {
    [31m[1m>[22m[39m[90m 49 |[39m         
setLoading([36mtrue[39m)[33m;[39m
     [90m    |[39m         [31m[1m^[22m[39m
     [90m 50 |[39m         
setError([36mnull[39m)[33m;[39m
     [90m 51 |[39m         [36mconst[39m prefs 
[33m=[39m [36mawait[39m preferencesService[33m.[39
mgetPreferences(userId)[33m;[39m
     [90m 52 |[39m         [36mif[39m (isMounted) 
{[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at setLoading 
(src/lib/hooks/use-notification-preferences.ts:49:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/hooks/use-notification-preferences.ts:47:26)
      at loadPreferences 
(src/lib/hooks/use-notification-preferences.ts:69:5)
      at Object.react-stack-bottom-frame (node_modules/r
eact-test-renderer/cjs/react-test-renderer.development.j
s:14062:20)
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at commitHookEffectListMount (node_modules/react-t
est-renderer/cjs/react-test-renderer.development.js:8376
:29)
      at commitHookPassiveMountEffects (node_modules/rea
ct-test-renderer/cjs/react-test-renderer.development.js:
8463:11)
      at commitPassiveMountOnFiber (node_modules/react-t
est-renderer/cjs/react-test-renderer.development.js:9782
:13)
      at recursivelyTraversePassiveMountEffects (node_mo
dules/react-test-renderer/cjs/react-test-renderer.develo
pment.js:9756:11)
      at commitPassiveMountOnFiber (node_modules/react-t
est-renderer/cjs/react-test-renderer.development.js:9794
:11)
      at flushPendingEffects (node_modules/react-test-re
nderer/cjs/react-test-renderer.development.js:11528:11)
      at performWorkOnRootViaSchedulerTask (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:2082:11)
      at Immediate.performWorkUntilDeadline [as 
_onImmediate] (node_modules/scheduler/cjs/scheduler.nati
ve.development.js:45:48)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 48 |[39m       [36mtry[39m {
     [90m 49 |[39m         
setLoading([36mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 50 |[39m         
setError([36mnull[39m)[33m;[39m
     [90m    |[39m         [31m[1m^[22m[39m
     [90m 51 |[39m         [36mconst[39m prefs 
[33m=[39m [36mawait[39m preferencesService[33m.[39
mgetPreferences(userId)[33m;[39m
     [90m 52 |[39m         [36mif[39m (isMounted) {
     [90m 53 |[39m           
setPreferences(prefs)[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at setError 
(src/lib/hooks/use-notification-preferences.ts:50:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/hooks/use-notification-preferences.ts:47:26)
      at loadPreferences 
(src/lib/hooks/use-notification-preferences.ts:69:5)
      at Object.react-stack-bottom-frame (node_modules/r
eact-test-renderer/cjs/react-test-renderer.development.j
s:14062:20)
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at commitHookEffectListMount (node_modules/react-t
est-renderer/cjs/react-test-renderer.development.js:8376
:29)
      at commitHookPassiveMountEffects (node_modules/rea
ct-test-renderer/cjs/react-test-renderer.development.js:
8463:11)
      at commitPassiveMountOnFiber (node_modules/react-t
est-renderer/cjs/react-test-renderer.development.js:9782
:13)
      at recursivelyTraversePassiveMountEffects (node_mo
dules/react-test-renderer/cjs/react-test-renderer.develo
pment.js:9756:11)
      at commitPassiveMountOnFiber (node_modules/react-t
est-renderer/cjs/react-test-renderer.development.js:9794
:11)
      at flushPendingEffects (node_modules/react-test-re
nderer/cjs/react-test-renderer.development.js:11528:11)
      at performWorkOnRootViaSchedulerTask (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:2082:11)
      at Immediate.performWorkUntilDeadline [as 
_onImmediate] (node_modules/scheduler/cjs/scheduler.nati
ve.development.js:45:48)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 55 |[39m       } [36mcatch[39m (err) {
     [90m 56 |[39m         [36mif[39m (isMounted) {
    [31m[1m>[22m[39m[90m 57 |[39m           
setError(
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 58 |[39m             err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to load 
preferences'[39m
     [90m 59 |[39m           )[33m;[39m
     [90m 60 |[39m           
console[33m.[39merror([32m'Failed to load 
notification preferences'[39m[33m,[39m 
err)[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at setError 
(src/lib/hooks/use-notification-preferences.ts:57:11)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to load notification preferences 
TypeError: Cannot read properties of undefined (reading 
'toISOString')
          at NotificationPreferencesService.toISOString 
[as modelToPreferences] (C:\Users\Peter\GrowBro\src\lib\
notifications\notification-preferences-service.ts:261:38
)
          at 
NotificationPreferencesService.modelToPreferences (C:\Us
ers\Peter\GrowBro\src\lib\notifications\notification-pre
ferences-service.ts:34:17)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at runNextTicks 
(node:internal/process/task_queues:65:5)
          at processImmediate 
(node:internal/timers:459:9)

    [0m [90m 58 |[39m             err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to load 
preferences'[39m
     [90m 59 |[39m           )[33m;[39m
    [31m[1m>[22m[39m[90m 60 |[39m           
console[33m.[39merror([32m'Failed to load 
notification preferences'[39m[33m,[39m 
err)[33m;[39m
     [90m    |[39m                   
[31m[1m^[22m[39m
     [90m 61 |[39m         }
     [90m 62 |[39m       } [36mfinally[39m {
     [90m 63 |[39m         [36mif[39m (isMounted) 
{[0m

      at error 
(src/lib/hooks/use-notification-preferences.ts:60:19)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 62 |[39m       } [36mfinally[39m {
     [90m 63 |[39m         [36mif[39m (isMounted) {
    [31m[1m>[22m[39m[90m 64 |[39m           
setLoading([36mfalse[39m)[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 65 |[39m         }
     [90m 66 |[39m       }
     [90m 67 |[39m     }[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at setLoading 
(src/lib/hooks/use-notification-preferences.ts:64:11)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 88 |[39m       [36mconst[39m 
prevValue [33m=[39m preferences[category][33m;[39m
     [90m 89 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 90 |[39m       
setPreferences({ [33m...[39mpreferences[33m,[39m 
[category][33m:[39m enabled })[33m;[39m
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 91 |[39m
     [90m 92 |[39m       [36mtry[39m {
     [90m 93 |[39m         [36mconst[39m updated 
[33m=[39m [36mawait[39m 
preferencesService[33m.[39mtoggleCategory([0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:90:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as toggleCategory] 
(src/lib/hooks/use-notification-preferences.ts:107:6)
      at Object.toggleCategory (src/lib/hooks/use-notifi
cation-preferences.test.ts:151:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m  96 |[39m           enabled
     [90m  97 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m  98 |[39m         
setPreferences(updated)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m  99 |[39m       } [36mcatch[39m (err) {
     [90m 100 |[39m         [90m// Revert on 
error[39m
     [90m 101 |[39m         setPreferences({ 
[33m...[39mpreferences[33m,[39m 
[category][33m:[39m prevValue })[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:98:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 88 |[39m       [36mconst[39m 
prevValue [33m=[39m preferences[category][33m;[39m
     [90m 89 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 90 |[39m       
setPreferences({ [33m...[39mpreferences[33m,[39m 
[category][33m:[39m enabled })[33m;[39m
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 91 |[39m
     [90m 92 |[39m       [36mtry[39m {
     [90m 93 |[39m         [36mconst[39m updated 
[33m=[39m [36mawait[39m 
preferencesService[33m.[39mtoggleCategory([0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:90:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as toggleCategory] 
(src/lib/hooks/use-notification-preferences.ts:107:6)
      at Object.toggleCategory (src/lib/hooks/use-notifi
cation-preferences.test.ts:185:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m  96 |[39m           enabled
     [90m  97 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m  98 |[39m         
setPreferences(updated)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m  99 |[39m       } [36mcatch[39m (err) {
     [90m 100 |[39m         [90m// Revert on 
error[39m
     [90m 101 |[39m         setPreferences({ 
[33m...[39mpreferences[33m,[39m 
[category][33m:[39m prevValue })[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:98:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 88 |[39m       [36mconst[39m 
prevValue [33m=[39m preferences[category][33m;[39m
     [90m 89 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 90 |[39m       
setPreferences({ [33m...[39mpreferences[33m,[39m 
[category][33m:[39m enabled })[33m;[39m
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 91 |[39m
     [90m 92 |[39m       [36mtry[39m {
     [90m 93 |[39m         [36mconst[39m updated 
[33m=[39m [36mawait[39m 
preferencesService[33m.[39mtoggleCategory([0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:90:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as toggleCategory] 
(src/lib/hooks/use-notification-preferences.ts:107:6)
      at Object.toggleCategory (src/lib/hooks/use-notifi
cation-preferences.test.ts:215:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m  96 |[39m           enabled
     [90m  97 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m  98 |[39m         
setPreferences(updated)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m  99 |[39m       } [36mcatch[39m (err) {
     [90m 100 |[39m         [90m// Revert on 
error[39m
     [90m 101 |[39m         setPreferences({ 
[33m...[39mpreferences[33m,[39m 
[category][33m:[39m prevValue })[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:98:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 88 |[39m       [36mconst[39m 
prevValue [33m=[39m preferences[category][33m;[39m
     [90m 89 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 90 |[39m       
setPreferences({ [33m...[39mpreferences[33m,[39m 
[category][33m:[39m enabled })[33m;[39m
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 91 |[39m
     [90m 92 |[39m       [36mtry[39m {
     [90m 93 |[39m         [36mconst[39m updated 
[33m=[39m [36mawait[39m 
preferencesService[33m.[39mtoggleCategory([0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:90:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as toggleCategory] 
(src/lib/hooks/use-notification-preferences.ts:107:6)
      at Object.toggleCategory (src/lib/hooks/use-notifi
cation-preferences.test.ts:243:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m  99 |[39m       } [36mcatch[39m (err) 
{
     [90m 100 |[39m         [90m// Revert on 
error[39m
    [31m[1m>[22m[39m[90m 101 |[39m         
setPreferences({ [33m...[39mpreferences[33m,[39m 
[category][33m:[39m prevValue })[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 102 |[39m         setError(
     [90m 103 |[39m           err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to 
update preference'[39m
     [90m 104 |[39m         )[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:101:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 100 |[39m         [90m// Revert on 
error[39m
     [90m 101 |[39m         setPreferences({ 
[33m...[39mpreferences[33m,[39m 
[category][33m:[39m prevValue })[33m;[39m
    [31m[1m>[22m[39m[90m 102 |[39m         
setError(
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 103 |[39m           err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to 
update preference'[39m
     [90m 104 |[39m         )[33m;[39m
     [90m 105 |[39m         
console[33m.[39merror([32m'Failed to toggle 
notification category'[39m[33m,[39m 
err)[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setError 
(src/lib/hooks/use-notification-preferences.ts:102:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to toggle notification category Error: 
Network error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\hooks\use-notification-preferences.test.ts:231:2
1)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 103 |[39m           err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to 
update preference'[39m
     [90m 104 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m 105 |[39m         
console[33m.[39merror([32m'Failed to toggle 
notification category'[39m[33m,[39m err)[33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 106 |[39m       }
     [90m 107 |[39m     }[33m,[39m
     [90m 108 |[39m     [userId[33m,[39m 
preferences][0m

      at Object.error 
(src/lib/hooks/use-notification-preferences.ts:105:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 118 |[39m
     [90m 119 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 120 |[39m       
setPreferences({
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 121 |[39m         
[33m...[39mpreferences[33m,[39m
     [90m 122 |[39m         
taskReminderTiming[33m:[39m timing[33m,[39m
     [90m 123 |[39m         
customReminderMinutes[33m:[39m 
customMinutes[33m,[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:120:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as updateTaskReminderTiming] 
(src/lib/hooks/use-notification-preferences.ts:145:6)
      at Object.updateTaskReminderTiming (src/lib/hooks/
use-notification-preferences.test.ts:276:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 130 |[39m           customMinutes
     [90m 131 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m 132 |[39m         
setPreferences(updated)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 133 |[39m       } [36mcatch[39m (err) {
     [90m 134 |[39m         [90m// Revert on 
error[39m
     [90m 135 |[39m         setPreferences({[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:132:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 118 |[39m
     [90m 119 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 120 |[39m       
setPreferences({
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 121 |[39m         
[33m...[39mpreferences[33m,[39m
     [90m 122 |[39m         
taskReminderTiming[33m:[39m timing[33m,[39m
     [90m 123 |[39m         
customReminderMinutes[33m:[39m 
customMinutes[33m,[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:120:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as updateTaskReminderTiming] 
(src/lib/hooks/use-notification-preferences.ts:145:6)
      at Object.updateTaskReminderTiming (src/lib/hooks/
use-notification-preferences.test.ts:303:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 130 |[39m           customMinutes
     [90m 131 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m 132 |[39m         
setPreferences(updated)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 133 |[39m       } [36mcatch[39m (err) {
     [90m 134 |[39m         [90m// Revert on 
error[39m
     [90m 135 |[39m         setPreferences({[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:132:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 118 |[39m
     [90m 119 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 120 |[39m       
setPreferences({
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 121 |[39m         
[33m...[39mpreferences[33m,[39m
     [90m 122 |[39m         
taskReminderTiming[33m:[39m timing[33m,[39m
     [90m 123 |[39m         
customReminderMinutes[33m:[39m 
customMinutes[33m,[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:120:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as updateTaskReminderTiming] 
(src/lib/hooks/use-notification-preferences.ts:145:6)
      at Object.updateTaskReminderTiming (src/lib/hooks/
use-notification-preferences.test.ts:330:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 133 |[39m       } [36mcatch[39m (err) 
{
     [90m 134 |[39m         [90m// Revert on 
error[39m
    [31m[1m>[22m[39m[90m 135 |[39m         
setPreferences({
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 136 |[39m           
[33m...[39mpreferences[33m,[39m
     [90m 137 |[39m           
taskReminderTiming[33m:[39m prevTiming[33m,[39m
     [90m 138 |[39m           
customReminderMinutes[33m:[39m 
prevMinutes[33m,[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:135:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 138 |[39m           
customReminderMinutes[33m:[39m prevMinutes[33m,[39m
     [90m 139 |[39m         })[33m;[39m
    [31m[1m>[22m[39m[90m 140 |[39m         
setError(
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 141 |[39m           err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to 
update timing'[39m
     [90m 142 |[39m         )[33m;[39m
     [90m 143 |[39m         
console[33m.[39merror([32m'Failed to update task 
reminder timing'[39m[33m,[39m err)[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setError 
(src/lib/hooks/use-notification-preferences.ts:140:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to update task reminder timing Error: 
Update failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\hooks\use-notification-preferences.test.ts:319:9
)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 141 |[39m           err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to 
update timing'[39m
     [90m 142 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         
console[33m.[39merror([32m'Failed to update task 
reminder timing'[39m[33m,[39m err)[33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 144 |[39m       }
     [90m 145 |[39m     }[33m,[39m
     [90m 146 |[39m     [userId[33m,[39m 
preferences][0m

      at Object.error 
(src/lib/hooks/use-notification-preferences.ts:143:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 157 |[39m
     [90m 158 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 159 |[39m       
setPreferences({
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 160 |[39m         
[33m...[39mpreferences[33m,[39m
     [90m 161 |[39m         
quietHoursEnabled[33m:[39m enabled[33m,[39m
     [90m 162 |[39m         
quietHoursStart[33m:[39m start[33m,[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:159:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as updateQuietHours] 
(src/lib/hooks/use-notification-preferences.ts:186:6)
      at Object.updateQuietHours (src/lib/hooks/use-noti
fication-preferences.test.ts:358:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 170 |[39m           end[33m,[39m
     [90m 171 |[39m         })[33m;[39m
    [31m[1m>[22m[39m[90m 172 |[39m         
setPreferences(updated)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 173 |[39m       } [36mcatch[39m (err) {
     [90m 174 |[39m         [90m// Revert on 
error[39m
     [90m 175 |[39m         setPreferences({[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:172:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 157 |[39m
     [90m 158 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 159 |[39m       
setPreferences({
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 160 |[39m         
[33m...[39mpreferences[33m,[39m
     [90m 161 |[39m         
quietHoursEnabled[33m:[39m enabled[33m,[39m
     [90m 162 |[39m         
quietHoursStart[33m:[39m start[33m,[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:159:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as updateQuietHours] 
(src/lib/hooks/use-notification-preferences.ts:186:6)
      at Object.updateQuietHours (src/lib/hooks/use-noti
fication-preferences.test.ts:391:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 170 |[39m           end[33m,[39m
     [90m 171 |[39m         })[33m;[39m
    [31m[1m>[22m[39m[90m 172 |[39m         
setPreferences(updated)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 173 |[39m       } [36mcatch[39m (err) {
     [90m 174 |[39m         [90m// Revert on 
error[39m
     [90m 175 |[39m         setPreferences({[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:172:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 157 |[39m
     [90m 158 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 159 |[39m       
setPreferences({
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 160 |[39m         
[33m...[39mpreferences[33m,[39m
     [90m 161 |[39m         
quietHoursEnabled[33m:[39m enabled[33m,[39m
     [90m 162 |[39m         
quietHoursStart[33m:[39m start[33m,[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:159:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as updateQuietHours] 
(src/lib/hooks/use-notification-preferences.ts:186:6)
      at Object.updateQuietHours (src/lib/hooks/use-noti
fication-preferences.test.ts:415:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 170 |[39m           end[33m,[39m
     [90m 171 |[39m         })[33m;[39m
    [31m[1m>[22m[39m[90m 172 |[39m         
setPreferences(updated)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 173 |[39m       } [36mcatch[39m (err) {
     [90m 174 |[39m         [90m// Revert on 
error[39m
     [90m 175 |[39m         setPreferences({[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:172:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 88 |[39m       [36mconst[39m 
prevValue [33m=[39m preferences[category][33m;[39m
     [90m 89 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 90 |[39m       
setPreferences({ [33m...[39mpreferences[33m,[39m 
[category][33m:[39m enabled })[33m;[39m
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 91 |[39m
     [90m 92 |[39m       [36mtry[39m {
     [90m 93 |[39m         [36mconst[39m updated 
[33m=[39m [36mawait[39m 
preferencesService[33m.[39mtoggleCategory([0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:90:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as toggleCategory] 
(src/lib/hooks/use-notification-preferences.ts:107:6)
      at Object.toggleCategory (src/lib/hooks/use-notifi
cation-preferences.test.ts:501:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m  99 |[39m       } [36mcatch[39m (err) 
{
     [90m 100 |[39m         [90m// Revert on 
error[39m
    [31m[1m>[22m[39m[90m 101 |[39m         
setPreferences({ [33m...[39mpreferences[33m,[39m 
[category][33m:[39m prevValue })[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 102 |[39m         setError(
     [90m 103 |[39m           err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to 
update preference'[39m
     [90m 104 |[39m         )[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:101:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 100 |[39m         [90m// Revert on 
error[39m
     [90m 101 |[39m         setPreferences({ 
[33m...[39mpreferences[33m,[39m 
[category][33m:[39m prevValue })[33m;[39m
    [31m[1m>[22m[39m[90m 102 |[39m         
setError(
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 103 |[39m           err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to 
update preference'[39m
     [90m 104 |[39m         )[33m;[39m
     [90m 105 |[39m         
console[33m.[39merror([32m'Failed to toggle 
notification category'[39m[33m,[39m 
err)[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setError 
(src/lib/hooks/use-notification-preferences.ts:102:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to toggle notification category Error: 
Network error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\hooks\use-notification-preferences.test.ts:490:3
2)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 103 |[39m           err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to 
update preference'[39m
     [90m 104 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m 105 |[39m         
console[33m.[39merror([32m'Failed to toggle 
notification category'[39m[33m,[39m err)[33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 106 |[39m       }
     [90m 107 |[39m     }[33m,[39m
     [90m 108 |[39m     [userId[33m,[39m 
preferences][0m

      at Object.error 
(src/lib/hooks/use-notification-preferences.ts:105:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 88 |[39m       [36mconst[39m 
prevValue [33m=[39m preferences[category][33m;[39m
     [90m 89 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 90 |[39m       
setPreferences({ [33m...[39mpreferences[33m,[39m 
[category][33m:[39m enabled })[33m;[39m
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 91 |[39m
     [90m 92 |[39m       [36mtry[39m {
     [90m 93 |[39m         [36mconst[39m updated 
[33m=[39m [36mawait[39m 
preferencesService[33m.[39mtoggleCategory([0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:90:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as toggleCategory] 
(src/lib/hooks/use-notification-preferences.ts:107:6)
      at Object.toggleCategory (src/lib/hooks/use-notifi
cation-preferences.test.ts:506:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m  96 |[39m           enabled
     [90m  97 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m  98 |[39m         
setPreferences(updated)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m  99 |[39m       } [36mcatch[39m (err) {
     [90m 100 |[39m         [90m// Revert on 
error[39m
     [90m 101 |[39m         setPreferences({ 
[33m...[39mpreferences[33m,[39m 
[category][33m:[39m prevValue })[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:98:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 88 |[39m       [36mconst[39m 
prevValue [33m=[39m preferences[category][33m;[39m
     [90m 89 |[39m       [90m// Optimistic 
update[39m
    [31m[1m>[22m[39m[90m 90 |[39m       
setPreferences({ [33m...[39mpreferences[33m,[39m 
[category][33m:[39m enabled })[33m;[39m
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 91 |[39m
     [90m 92 |[39m       [36mtry[39m {
     [90m 93 |[39m         [36mconst[39m updated 
[33m=[39m [36mawait[39m 
preferencesService[33m.[39mtoggleCategory([0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:90:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as toggleCategory] 
(src/lib/hooks/use-notification-preferences.ts:107:6)
      at Object.toggleCategory (src/lib/hooks/use-notifi
cation-preferences.test.ts:531:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m  99 |[39m       } [36mcatch[39m (err) 
{
     [90m 100 |[39m         [90m// Revert on 
error[39m
    [31m[1m>[22m[39m[90m 101 |[39m         
setPreferences({ [33m...[39mpreferences[33m,[39m 
[category][33m:[39m prevValue })[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 102 |[39m         setError(
     [90m 103 |[39m           err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to 
update preference'[39m
     [90m 104 |[39m         )[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setPreferences 
(src/lib/hooks/use-notification-preferences.ts:101:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 100 |[39m         [90m// Revert on 
error[39m
     [90m 101 |[39m         setPreferences({ 
[33m...[39mpreferences[33m,[39m 
[category][33m:[39m prevValue })[33m;[39m
    [31m[1m>[22m[39m[90m 102 |[39m         
setError(
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 103 |[39m           err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to 
update preference'[39m
     [90m 104 |[39m         )[33m;[39m
     [90m 105 |[39m         
console[33m.[39merror([32m'Failed to toggle 
notification category'[39m[33m,[39m 
err)[33m;[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at Object.setError 
(src/lib/hooks/use-notification-preferences.ts:102:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to toggle notification category Error: 
Network unavailable
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\hooks\use-notification-preferences.test.ts:526:9
)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 103 |[39m           err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m [32m'Failed to 
update preference'[39m
     [90m 104 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m 105 |[39m         
console[33m.[39merror([32m'Failed to toggle 
notification category'[39m[33m,[39m err)[33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 106 |[39m       }
     [90m 107 |[39m     }[33m,[39m
     [90m 108 |[39m     [userId[33m,[39m 
preferences][0m

      at Object.error 
(src/lib/hooks/use-notification-preferences.ts:105:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ Notification Preferences Integration ÔÇ║ Loading 
Preferences ÔÇ║ loads preferences for authenticated user

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 94 |[39m       [36mconst[39m { result 
} [33m=[39m renderHook(() [33m=>[39m 
useNotificationPreferences())[33m;[39m
     [90m 95 |[39m
    [31m[1m>[22m[39m[90m 96 |[39m       expect(res
ult[33m.[39mcurrent[33m.[39mloading)[33m.[39mtoBe(
[36mtrue[39m)[33m;[39m
     [90m    |[39m                                    
  [31m[1m^[22m[39m
     [90m 97 |[39m
     [90m 98 |[39m       [36mawait[39m waitFor(() 
[33m=>[39m expect(result[33m.[39mcurrent[33m.[39ml
oading)[33m.[39mtoBe([36mfalse[39m))[33m;[39m
     [90m 99 |[39m[0m

      at Object.toBe (src/lib/hooks/use-notification-pre
ferences.test.ts:96:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Notification Preferences Integration ÔÇ║ Loading 
Preferences ÔÇ║ handles loading errors gracefully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Database connection failed"
    Received: null

    [0m [90m 112 |[39m       [36mawait[39m 
waitFor(() [33m=>[39m expect(result[33m.[39mcurrent
[33m.[39mloading)[33m.[39mtoBe([36mfalse[39m))[33m
;[39m
     [90m 113 |[39m
    [31m[1m>[22m[39m[90m 114 |[39m       expect(re
sult[33m.[39mcurrent[33m.[39merror)[33m.[39mtoBe(
[32m'Database connection failed'[39m)[33m;[39m
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 115 |[39m       expect(result[33m.[39mcurr
ent[33m.[39mpreferences)[33m.[39mtoBeNull()[33m;[3
9m
     [90m 116 |[39m     })[33m;[39m
     [90m 117 |[39m[0m

      at Object.toBe (src/lib/hooks/use-notification-pre
ferences.test.ts:114:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Notification Preferences Integration ÔÇ║ Toggle 
Categories ÔÇ║ reverts on toggle failure

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Network error"
    Received: null

    [0m [90m 250 |[39m       )[33m;[39m
     [90m 251 |[39m
    [31m[1m>[22m[39m[90m 252 |[39m       expect(re
sult[33m.[39mcurrent[33m.[39merror)[33m.[39mtoBe(
[32m'Network error'[39m)[33m;[39m
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 253 |[39m     })[33m;[39m
     [90m 254 |[39m   })[33m;[39m
     [90m 255 |[39m[0m

      at Object.toBe (src/lib/hooks/use-notification-pre
ferences.test.ts:252:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/nutrient-engine/services/reservoir-service.
test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ reservoir-service ÔÇ║ updateReservoir ÔÇ║ should 
reject invalid pH range when updating one bound

    expect(received).rejects.toThrow(expected)

    Expected substring: "Target pH min must be less 
than pH max"
    Received message:   "reservoir.update is not a 
function"

        [0m [90m 140 |[39m
         [90m 141 |[39m   [36mreturn[39m 
[36mawait[39m 
database[33m.[39mwrite([36masync[39m () 
[33m=>[39m {
        [31m[1m>[22m[39m[90m 142 |[39m     
[36mreturn[39m [36mawait[39m 
reservoir[33m.[39mupdate((record[33m:[39m 
[33mReservoirModel[39m) [33m=>[39m {
         [90m     |[39m                            
[31m[1m^[22m[39m
         [90m 143 |[39m       [36mif[39m 
(updates[33m.[39mname [33m!==[39m undefined) {
         [90m 144 |[39m         record[33m.[39mname 
[33m=[39m 
updates[33m.[39mname[33m.[39mtrim()[33m;[39m
         [90m 145 |[39m       }[0m

      at update (src/lib/nutrient-engine/services/reserv
oir-service.ts:142:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.callback (src/lib/nutrient-engine/servic
es/reservoir-service.test.ts:159:43)
      at write (src/lib/nutrient-engine/services/reservo
ir-service.ts:141:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/nutrient-engine/service
s/reservoir-service.test.ts:191:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ reservoir-service ÔÇ║ updateReservoir ÔÇ║ should 
reject invalid EC range when updating one bound

    expect(received).rejects.toThrow(expected)

    Expected substring: "Target EC min must be less 
than EC max"
    Received message:   "reservoir.update is not a 
function"

        [0m [90m 140 |[39m
         [90m 141 |[39m   [36mreturn[39m 
[36mawait[39m 
database[33m.[39mwrite([36masync[39m () 
[33m=>[39m {
        [31m[1m>[22m[39m[90m 142 |[39m     
[36mreturn[39m [36mawait[39m 
reservoir[33m.[39mupdate((record[33m:[39m 
[33mReservoirModel[39m) [33m=>[39m {
         [90m     |[39m                            
[31m[1m^[22m[39m
         [90m 143 |[39m       [36mif[39m 
(updates[33m.[39mname [33m!==[39m undefined) {
         [90m 144 |[39m         record[33m.[39mname 
[33m=[39m 
updates[33m.[39mname[33m.[39mtrim()[33m;[39m
         [90m 145 |[39m       }[0m

      at update (src/lib/nutrient-engine/services/reserv
oir-service.ts:142:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.callback (src/lib/nutrient-engine/servic
es/reservoir-service.test.ts:159:43)
      at write (src/lib/nutrient-engine/services/reservo
ir-service.ts:141:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/nutrient-engine/service
s/reservoir-service.test.ts:217:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/community/__tests__/realtime-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      Unsubscribed from community feed realtime

      at RealtimeConnectionManager.log [as unsubscribe] 
(src/lib/community/realtime-manager.ts:498:13)

    console.log
      Connected to community feed realtime

      at RealtimeConnectionManager.log [as 
handleSubscriptionStatus] 
(src/lib/community/realtime-manager.ts:233:15)

    console.log
      Unsubscribed from community feed realtime

      at RealtimeConnectionManager.log [as unsubscribe] 
(src/lib/community/realtime-manager.ts:498:13)

    console.log
      Connected to community feed realtime

      at RealtimeConnectionManager.log [as 
handleSubscriptionStatus] 
(src/lib/community/realtime-manager.ts:233:15)

    console.log
      Unsubscribed from community feed realtime

      at RealtimeConnectionManager.log [as unsubscribe] 
(src/lib/community/realtime-manager.ts:498:13)

    console.log
      Unsubscribed from community feed realtime

      at RealtimeConnectionManager.log [as unsubscribe] 
(src/lib/community/realtime-manager.ts:498:13)

    console.log
      Unsubscribed from community feed realtime

      at RealtimeConnectionManager.log [as unsubscribe] 
(src/lib/community/realtime-manager.ts:498:13)

    console.error
      Realtime subscription error: {
        status: 'CHANNEL_ERROR',
        errorMessage: undefined,
        errorStack: undefined,
        channelName: undefined,
        reconnectAttempts: 0
      }

    [0m [90m 234 |[39m     } [36melse[39m 
[36mif[39m (status [33m===[39m 
[32m'CHANNEL_ERROR'[39m) {
     [90m 235 |[39m       [36mthis[39m[33m.[39mset
ConnectionState([32m'error'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 236 |[39m       
console[33m.[39merror([32m'Realtime subscription 
error:'[39m[33m,[39m {
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 237 |[39m         status[33m,[39m
     [90m 238 |[39m         errorMessage[33m:[39m 
error [36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m 
error[33m?[39m[33m.[39mmessage[33m,[39m
     [90m 239 |[39m         errorStack[33m:[39m 
error [36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mstack [33m:[39m 
undefined[33m,[39m[0m

      at RealtimeConnectionManager.error [as 
handleSubscriptionStatus] 
(src/lib/community/realtime-manager.ts:236:15)
      at handleSubscriptionStatus 
(src/lib/community/realtime-manager.ts:290:12)
      at Timeout.callback [as _onTimeout] (src/lib/commu
nity/__tests__/realtime-manager.test.ts:82:13)

    console.log
      Reconnecting in 1000ms (attempt 1/3)

      at RealtimeConnectionManager.log [as 
handleConnectionError] 
(src/lib/community/realtime-manager.ts:318:13)

    console.log
      Unsubscribed from community feed realtime

      at RealtimeConnectionManager.log [as unsubscribe] 
(src/lib/community/realtime-manager.ts:498:13)

    console.log
      Reconnecting in 1000ms (attempt 1/3)

      at RealtimeConnectionManager.log [as 
handleConnectionError] 
(src/lib/community/realtime-manager.ts:318:13)

    console.log
      Unsubscribed from community feed realtime

      at RealtimeConnectionManager.log [as unsubscribe] 
(src/lib/community/realtime-manager.ts:498:13)

    console.error
      Realtime subscription error: {
        status: 'CHANNEL_ERROR',
        errorMessage: undefined,
        errorStack: undefined,
        channelName: undefined,
        reconnectAttempts: 0
      }

    [0m [90m 234 |[39m     } [36melse[39m 
[36mif[39m (status [33m===[39m 
[32m'CHANNEL_ERROR'[39m) {
     [90m 235 |[39m       [36mthis[39m[33m.[39mset
ConnectionState([32m'error'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 236 |[39m       
console[33m.[39merror([32m'Realtime subscription 
error:'[39m[33m,[39m {
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 237 |[39m         status[33m,[39m
     [90m 238 |[39m         errorMessage[33m:[39m 
error [36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m 
error[33m?[39m[33m.[39mmessage[33m,[39m
     [90m 239 |[39m         errorStack[33m:[39m 
error [36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mstack [33m:[39m 
undefined[33m,[39m[0m

      at RealtimeConnectionManager.error [as 
handleSubscriptionStatus] 
(src/lib/community/realtime-manager.ts:236:15)
      at handleSubscriptionStatus 
(src/lib/community/realtime-manager.ts:290:12)
      at Timeout.callback [as _onTimeout] (src/lib/commu
nity/__tests__/realtime-manager.test.ts:151:13)

    console.log
      Reconnecting in 1000ms (attempt 1/3)

      at RealtimeConnectionManager.log [as 
handleConnectionError] 
(src/lib/community/realtime-manager.ts:318:13)

    console.log
      Unsubscribed from community feed realtime

      at RealtimeConnectionManager.log [as unsubscribe] 
(src/lib/community/realtime-manager.ts:498:13)

    console.log
      Unsubscribed from community feed realtime

      at RealtimeConnectionManager.log [as unsubscribe] 
(src/lib/community/realtime-manager.ts:498:13)

  ÔùÅ RealtimeConnectionManager ÔÇ║ Polling Fallback 
ÔÇ║ should call onPollRefresh during polling

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

    [0m [90m  98 |[39m       [36mawait[39m 
[36mnew[39m [33mPromise[39m((resolve) [33m=>[39m 
setTimeout(resolve[33m,[39m [35m200[39m))[33m;[39m
     [90m  99 |[39m
    [31m[1m>[22m[39m[90m 100 |[39m       expect(mo
ckCallbacks[33m.[39monPollRefresh)[33m.[39mtoHaveBee
nCalled()[33m;[39m
     [90m     |[39m                                   
        [31m[1m^[22m[39m
     [90m 101 |[39m     })[33m;[39m
     [90m 102 |[39m
     [90m 103 |[39m     it([32m'should stop polling 
when onPollRefresh is not implemented'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toHaveBeenCalled (src/lib/community/__te
sts__/realtime-manager.test.ts:100:43)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ RealtimeConnectionManager ÔÇ║ Polling Fallback 
ÔÇ║ should stop polling when onPollRefresh is not 
implemented

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "[Realtime] CRITICAL: Polling active but 
onPollRefresh not implemented. Data will NOT update. 
This is a bug in consumer implementation. Stopping 
polling."
    Received: "Realtime subscription error:", 
{"channelName": undefined, "errorMessage": undefined, 
"errorStack": undefined, "reconnectAttempts": 0, 
"status": "CHANNEL_ERROR"}

    Number of calls: 1

    [0m [90m 120 |[39m             [90m// After max 
retries, should start polling and trigger error[39m
     [90m 121 |[39m             setTimeout(() 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 122 |[39m               
expect(consoleErrorSpy)[33m.[39mtoHaveBeenCalledWith(
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 123 |[39m                 [32m'[Realtime] 
CRITICAL: Polling active but onPollRefresh not 
implemented. '[39m [33m+[39m
     [90m 124 |[39m                   [32m'Data will 
NOT update. This is a bug in consumer implementation. 
Stopping polling.'[39m
     [90m 125 |[39m               )[33m;[39m[0m

      at Timeout.toHaveBeenCalledWith [as _onTimeout] (s
rc/lib/community/__tests__/realtime-manager.test.ts:122:
39)

FAIL src/components/ui/checkbox.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ Checkbox, Radio & Switch components  ÔÇ║ <Radio 
/> should render the correct label

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: undefined

    [0m [90m 122 |[39m     )[33m;[39m
     [90m 123 |[39m
    [31m[1m>[22m[39m[90m 124 |[39m     expect(scre
en[33m.[39mgetByTestId([32m'radio'[39m)[33m.[39mpr
ops[33m.[39maccessibilityState[33m.[39mchecked)[33m
.[39mtoBe(
     [90m     |[39m                                   
                                       
[31m[1m^[22m[39m
     [90m 125 |[39m       [36mfalse[39m
     [90m 126 |[39m     )[33m;[39m
     [90m 127 |[39m     expect(screen[33m.[39mgetByT
estId([32m'radio'[39m)[33m.[39mprops[33m.[39macces
sibilityRole)[33m.[39mtoBe([32m'radio'[39m)[33m;[3
9m[0m

      at Object.toBe 
(src/components/ui/checkbox.test.tsx:124:74)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/components/inventory/csv/csv.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      Duplicate headers found and renamed.

    [0m [90m 241 |[39m   [36mlet[39m 
parseResult[33m:[39m [33mParseResult[39m[33m<[39m
[33mRecord[39m[33m<[39m[33mstring[39m[33m,[39m 
unknown[33m>>[39m[33m;[39m
     [90m 242 |[39m   [36mtry[39m {
    [31m[1m>[22m[39m[90m 243 |[39m     
parseResult [33m=[39m parse[33m<[39m[33mRecord[39m
[33m<[39m[33mstring[39m[33m,[39m 
unknown[33m>>[39m(content[33m,[39m {
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 244 |[39m       header[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 245 |[39m       delimiter[33m:[39m [33mCS
V_FORMAT[39m[33m.[39m[33mDELIMITER[39m[33m,[39m
     [90m 246 |[39m       newline[33m:[39m [33mCSV_
FORMAT[39m[33m.[39m[33mLINE_ENDING[39m[33m,[39m[
0m

      at returnable 
(node_modules/papaparse/papaparse.js:1783:15)
      at Parser.parse 
(node_modules/papaparse/papaparse.js:1514:12)
      at ParserHandle.parse 
(node_modules/papaparse/papaparse.js:1117:23)
      at StringStreamer.ChunkStreamer.parseChunk 
(node_modules/papaparse/papaparse.js:536:31)
      at StringStreamer._nextChunk 
(node_modules/papaparse/papaparse.js:828:16)
      at StringStreamer.stream 
(node_modules/papaparse/papaparse.js:813:16)
      at CsvToJson 
(node_modules/papaparse/papaparse.js:251:19)
      at parseCSV 
(src/lib/inventory/csv-parser.ts:243:24)
      at parseCSV 
(src/lib/inventory/csv-parser.ts:343:18)
      at parseItemsCSV 
(src/lib/inventory/csv-parser.ts:461:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/inventory/csv-parser.ts:445:36)
      at src/lib/inventory/csv-import-service.ts:49:42
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/inventory/csv-import-service.ts:41:39)
      at Object.<anonymous> 
(src/components/inventory/csv/csv.test.tsx:120:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ CSV Export ÔÇ║ exports RFC 4180 compliant CSV 
files

    expect(received).toContain(expected) // indexOf

    Expected substring: "external_key,name,category"
    Received string:    ""

    [0m [90m 22 |[39m     expect(result[33m.[39mite
ms)[33m.[39mtoBeDefined()[33m;[39m
     [90m 23 |[39m     expect(result[33m.[39mitems[
33m.[39mfilename)[33m.[39mtoBe([32m'items.csv'[39m)
[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     expect(resul
t[33m.[39mitems[33m.[39mcontent)[33m.[39mtoContain
([32m'external_key,name,category'[39m)[33m;[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 25 |[39m
     [90m 26 |[39m     expect(result[33m.[39mbatches
)[33m.[39mtoBeDefined()[33m;[39m
     [90m 27 |[39m     expect(result[33m.[39mbatches
[33m.[39mfilename)[33m.[39mtoBe([32m'batches.csv'[
39m)[33m;[39m[0m

      at Object.toContain 
(src/components/inventory/csv/csv.test.tsx:24:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CSV Export ÔÇ║ uses UTF-8 encoding with CRLF line 
endings

    expect(received).toContain(expected) // indexOf

    Expected substring: "┬À
    "
    Received string:    ""

    [0m [90m 35 |[39m
     [90m 36 |[39m     [90m// Check for CRLF line 
endings[39m
    [31m[1m>[22m[39m[90m 37 |[39m     expect(resul
t[33m.[39mitems[33m.[39mcontent)[33m.[39mtoContain
([32m'\r\n'[39m)[33m;[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 38 |[39m   })[33m;[39m
     [90m 39 |[39m
     [90m 40 |[39m   test([32m'uses ISO-8601 dates 
and dot decimals'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {[0m

      at Object.toContain 
(src/components/inventory/csv/csv.test.tsx:37:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CSV Export ÔÇ║ uses ISO-8601 dates and dot 
decimals

    expect(received).toMatch(expected)

    Expected pattern: /\d{4}-\d{2}-\d{2}/
    Received string:  ""

    [0m [90m 43 |[39m     [90m// Check date format 
(YYYY-MM-DD)[39m
     [90m 44 |[39m     [36mconst[39m dateRegex 
[33m=[39m [35m/\d{4}-\d{2}-\d{2}/[39m[33m;[39m
    [31m[1m>[22m[39m[90m 45 |[39m     expect(resul
t[33m.[39mbatches[33m.[39mcontent)[33m.[39mtoMatch
(dateRegex)[33m;[39m
     [90m    |[39m                                    
[31m[1m^[22m[39m
     [90m 46 |[39m
     [90m 47 |[39m     [90m// Check decimal format 
(dot separator)[39m
     [90m 48 |[39m     [36mconst[39m decimalRegex 
[33m=[39m [35m/\d+\.\d+/[39m[33m;[39m[0m

      at Object.toMatch 
(src/components/inventory/csv/csv.test.tsx:45:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CSV Import Preview ÔÇ║ generates dry-run preview 
with row-level diffs

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 1
    Received:    0

    [0m [90m 60 |[39m     [36mconst[39m preview 
[33m=[39m [36mawait[39m previewCSVImport({ 
items[33m:[39m csvContent })[33m;[39m
     [90m 61 |[39m
    [31m[1m>[22m[39m[90m 62 |[39m     expect(previ
ew[33m.[39mtotalRows)[33m.[39mtoBeGreaterThanOrEqual
([35m1[39m)[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 63 |[39m     expect(preview[33m.[39mdiffs)
[33m.[39mtoBeDefined()[33m;[39m
     [90m 64 |[39m     expect(preview[33m.[39msummar
y)[33m.[39mtoBeDefined()[33m;[39m
     [90m 65 |[39m     expect(preview[33m.[39msummar
y[33m.[39mitemsToAdd)[33m.[39mtoBeGreaterThanOrEqual
([35m0[39m)[33m;[39m[0m

      at Object.toBeGreaterThanOrEqual 
(src/components/inventory/csv/csv.test.tsx:62:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CSV Import Preview ÔÇ║ validates CSV format and 
reports errors

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

    [0m [90m 72 |[39m     [36mconst[39m preview 
[33m=[39m [36mawait[39m previewCSVImport({ 
items[33m:[39m invalidCSV })[33m;[39m
     [90m 73 |[39m
    [31m[1m>[22m[39m[90m 74 |[39m     expect(previ
ew[33m.[39minvalidRows)[33m.[39mtoBeGreaterThan([35
m0[39m)[33m;[39m
     [90m    |[39m                                 
[31m[1m^[22m[39m
     [90m 75 |[39m     expect(preview[33m.[39mcanPro
ceed)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 76 |[39m   })[33m;[39m
     [90m 77 |[39m })[33m;[39m[0m

      at Object.toBeGreaterThan 
(src/components/inventory/csv/csv.test.tsx:74:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CSV Size Limits ÔÇ║ enforces 50k row limit

    expect(received).rejects.toThrow()

    Received promise resolved instead of rejected
    Resolved to value: {"canProceed": true, "diffs": 
[], "errors": [], "invalidRows": 0, "parseErrors": [], 
"summary": {"batchesToAdd": 0, "batchesToSkip": 0, 
"batchesToUpdate": 0, "itemsToAdd": 0, "itemsToSkip": 
0, "itemsToUpdate": 0, "movementsToAdd": 0}, 
"totalRows": 0, "validRows": 0}

    [0m [90m 118 |[39m     [36mconst[39m largeCSV 
[33m=[39m header [33m+[39m rows[33m;[39m
     [90m 119 |[39m
    [31m[1m>[22m[39m[90m 120 |[39m     
[36mawait[39m expect(previewCSVImport({ 
items[33m:[39m largeCSV 
}))[33m.[39mrejects[33m.[39mtoThrow()[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 121 |[39m   })[33m;[39m
     [90m 122 |[39m
     [90m 123 |[39m   test([32m'enforces 10MB file 
size limit'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect 
(src/components/inventory/csv/csv.test.tsx:120:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ CSV Size Limits ÔÇ║ enforces 10MB file size limit

    expect(received).rejects.toThrow()

    Received promise resolved instead of rejected
    Resolved to value: {"canProceed": false, "diffs": 
[], "errors": [], "invalidRows": 1, "parseErrors": 
[{"message": "File size (10.90 MB) exceeds maximum 
allowed size (10 MB)", "type": "size_limit"}], 
"summary": {"batchesToAdd": 0, "batchesToSkip": 0, 
"batchesToUpdate": 0, "itemsToAdd": 0, "itemsToSkip": 
0, "itemsToUpdate": 0, "movementsToAdd": 0}, 
"totalRows": 0, "validRows": 0}

    [0m [90m 132 |[39m     [36mconst[39m largeCSV 
[33m=[39m header [33m+[39m rows[33m;[39m
     [90m 133 |[39m
    [31m[1m>[22m[39m[90m 134 |[39m     
[36mawait[39m expect(previewCSVImport({ 
items[33m:[39m largeCSV 
}))[33m.[39mrejects[33m.[39mtoThrow()[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 135 |[39m   })[33m;[39m
     [90m 136 |[39m })[33m;[39m
     [90m 137 |[39m[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect 
(src/components/inventory/csv/csv.test.tsx:134:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/api/ph-ec-readings/index.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.info
      SYNC: API_BASE is empty; sync is disabled 
(expected in dev)

      at Object.logMethod (src/lib/sync-engine.ts:170:3)

    console.warn
      [watermelon-indexes] Failed to ensure indexes 
TypeError: Cannot read properties of undefined (reading 
'unsafeExecute')
          at C:\Users\Peter\GrowBro\src\lib\watermelon-i
ndexes.ts:41:38
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at C:\Users\Peter\GrowBro\src\lib\watermelon-i
ndexes.ts:58:7
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at _ensureNutrientEngineIndexes (C:\Users\Pete
r\GrowBro\src\lib\watermelon-indexes.ts:61:39)
          at ensureNutrientEngineIndexes (C:\Users\Peter
\GrowBro\src\lib\watermelon-indexes.ts:24:39)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\nutrient-engine\state\nutrient-engine-store.ts:6
62:33)
          at Runtime._execModule (C:\Users\Peter\GrowBro
\node_modules\jest-runtime\build\index.js:1439:24)
          at Runtime._loadModule (C:\Users\Peter\GrowBro
\node_modules\jest-runtime\build\index.js:1022:12)
          at Runtime.requireModule (C:\Users\Peter\GrowB
ro\node_modules\jest-runtime\build\index.js:882:12)
          at Runtime.requireModuleOrMock (C:\Users\Peter
\GrowBro\node_modules\jest-runtime\build\index.js:1048:2
1)
          at Object.require (C:\Users\Peter\GrowBro\src\
api\ph-ec-readings\index.ts:8:1)
          at Runtime._execModule (C:\Users\Peter\GrowBro
\node_modules\jest-runtime\build\index.js:1439:24)
          at Runtime._loadModule (C:\Users\Peter\GrowBro
\node_modules\jest-runtime\build\index.js:1022:12)
          at Runtime.requireModule (C:\Users\Peter\GrowB
ro\node_modules\jest-runtime\build\index.js:882:12)
          at Runtime.requireModuleOrMock (C:\Users\Peter
\GrowBro\node_modules\jest-runtime\build\index.js:1048:2
1)
          at Object.require (C:\Users\Peter\GrowBro\src\
api\ph-ec-readings\index.test.ts:4:1)
          at Runtime._execModule (C:\Users\Peter\GrowBro
\node_modules\jest-runtime\build\index.js:1439:24)
          at Runtime._loadModule (C:\Users\Peter\GrowBro
\node_modules\jest-runtime\build\index.js:1022:12)
          at Runtime.requireModule (C:\Users\Peter\GrowB
ro\node_modules\jest-runtime\build\index.js:882:12)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:77:13)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 52 |[39m }
     [90m 53 |[39m
    [31m[1m>[22m[39m[90m 54 |[39m 
[36mexport[39m [36masync[39m [36mfunction[39m 
ensureNutrientEngineIndexes(
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 55 |[39m   target[33m:[39m 
[36mtypeof[39m adapter [33m=[39m adapter
     [90m 56 |[39m )[33m:[39m 
[33mPromise[39m[33m<[39m[36mvoid[39m[33m>[39m {
     [90m 57 |[39m   [36mif[39m (initialized) 
[36mreturn[39m[33m;[39m[0m

      at src/lib/watermelon-indexes.ts:54:17
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at src/lib/watermelon-indexes.ts:58:7
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at _ensureNutrientEngineIndexes 
(src/lib/watermelon-indexes.ts:61:39)
      at ensureNutrientEngineIndexes 
(src/lib/watermelon-indexes.ts:24:39)
      at Object.<anonymous> (src/lib/nutrient-engine/sta
te/nutrient-engine-store.ts:662:33)
      at Object.require 
(src/api/ph-ec-readings/index.ts:8:1)
      at Object.require 
(src/api/ph-ec-readings/index.test.ts:4:1)

    console.log
      [auth] onAuthStateChange INITIAL_SESSION false

      at log (src/lib/auth/index.tsx:404:13)

  ÔùÅ pH/EC Readings API ÔÇ║ createReadingLocal ÔÇ║ 
should create a reading in local database

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "ph_ec_readings"
    Received: "ph_ec_readings_v2"

    Number of calls: 1

    [0m [90m 60 |[39m       expect(result[33m.[39mp
h)[33m.[39mtoBe([35m6.5[39m)[33m;[39m
     [90m 61 |[39m       expect(result[33m.[39mec25c
)[33m.[39mtoBe([35m2.1[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 62 |[39m       expect(dat
abase[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalle
dWith([32m'ph_ec_readings'[39m)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 63 |[39m       expect(database[33m.[39mwri
te)[33m.[39mtoHaveBeenCalled()[33m;[39m
     [90m 64 |[39m     })[33m;[39m
     [90m 65 |[39m[0m

      at Object.toHaveBeenCalledWith 
(src/api/ph-ec-readings/index.test.ts:62:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ pH/EC Readings API ÔÇ║ fetchReadingsLocal ÔÇ║ 
should fetch readings from local database

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "ph_ec_readings"
    Received: "ph_ec_readings_v2"

    Number of calls: 1

    [0m [90m 176 |[39m       expect(result[33m.[39m
data)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 177 |[39m       expect(result[33m.[39mtota
l)[33m.[39mtoBe([35m1[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m       expect(da
tabase[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCall
edWith([32m'ph_ec_readings'[39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 179 |[39m     })[33m;[39m
     [90m 180 |[39m
     [90m 181 |[39m     it([32m'should filter 
readings by reservoir'[39m[33m,[39m [36masync[39m 
() [33m=>[39m {[0m

      at Object.toHaveBeenCalledWith 
(src/api/ph-ec-readings/index.test.ts:178:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/inventory/__tests__/use-consumption-analyti
cs.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ useConsumptionAnalytics ÔÇ║ should handle errors 
gracefully

    expect(received).toBeTruthy()

    Received: null

    [0m [90m 143 |[39m     })[33m;[39m
     [90m 144 |[39m
    [31m[1m>[22m[39m[90m 145 |[39m     expect(resu
lt[33m.[39mcurrent[33m.[39merror)[33m.[39mtoBeTrut
hy()[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 146 |[39m     expect(result[33m.[39mcurren
t[33m.[39merror[33m?[39m[33m.[39mmessage)[33m.[3
9mtoContain([32m'error'[39m)[33m;[39m
     [90m 147 |[39m   })[33m;[39m
     [90m 148 |[39m })[33m;[39m[0m

      at Object.toBeTruthy (src/lib/inventory/__tests__/
use-consumption-analytics.test.ts:145:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/components/consent-manager.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      An update to ConsentManager inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 377 |[39m       
setPrivacyConsent(updates)[33m;[39m
     [90m 378 |[39m       [90m// Merge the partial 
updates into local React state safely[39m
    [31m[1m>[22m[39m[90m 379 |[39m       
setPrivacyConsentState((p) [33m=>[39m ({ 
[33m...[39mp[33m,[39m [33m...[39mupdates 
}))[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 380 |[39m       [36mfor[39m 
([36mconst[39m k [36mof[39m 
[33mRUNTIME_CONSENT_KEYS[39m) {
     [90m 381 |[39m         [36mawait[39m [33mConse
ntService[39m[33m.[39msetConsent(k[33m,[39m 
[36mfalse[39m)[33m;[39m
     [90m 382 |[39m       }[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at setPrivacyConsentState 
(src/components/consent-manager.tsx:379:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to ConsentManager inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 381 |[39m         [36mawait[39m [33mC
onsentService[39m[33m.[39msetConsent(k[33m,[39m 
[36mfalse[39m)[33m;[39m
     [90m 382 |[39m       }
    [31m[1m>[22m[39m[90m 383 |[39m       
setConsentState((prevState) [33m=>[39m {
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 384 |[39m         [36mif[39m 
([33m![39mprevState) [36mreturn[39m 
prevState[33m;[39m [90m// Guard against null 
prevState[39m
     [90m 385 |[39m         [36mreturn[39m {
     [90m 386 |[39m           
[33m...[39mprevState[33m,[39m [90m// Preserve 
required fields like version and locale[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at setConsentState 
(src/components/consent-manager.tsx:383:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ConsentManager ÔÇ║ toggling runtime consent 
updates ConsentService

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "telemetry", false

    Number of calls: 0

    [0m [90m 151 |[39m       [36mfalse[39m
     [90m 152 |[39m     )[33m;[39m
    [31m[1m>[22m[39m[90m 153 |[39m     expect([33
mConsentService[39m[33m.[39msetConsent)[33m.[39mtoH
aveBeenCalledWith([32m'telemetry'[39m[33m,[39m 
[36mfalse[39m)[33m;[39m
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 154 |[39m   })[33m;[39m
     [90m 155 |[39m
     [90m 156 |[39m   test([32m'quick opt-out clears 
telemetry queue and revokes consents'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toHaveBeenCalledWith 
(src/components/consent-manager.test.tsx:153:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ConsentManager ÔÇ║ quick opt-out clears telemetry 
queue and revokes consents

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "telemetry", false

    Number of calls: 0

    [0m [90m 160 |[39m     fireEvent[33m.[39mpress(
screen[33m.[39mgetByTestId([32m'opt-out-all-btn'[39m
))[33m;[39m
     [90m 161 |[39m     expect(telemetryClient[33m.[
39mclearQueue)[33m.[39mtoHaveBeenCalled()[33m;[39m
    [31m[1m>[22m[39m[90m 162 |[39m     expect([33
mConsentService[39m[33m.[39msetConsent)[33m.[39mtoH
aveBeenCalledWith([32m'telemetry'[39m[33m,[39m 
[36mfalse[39m)[33m;[39m
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 163 |[39m     expect(setPrivacyConsent)[33m
.[39mtoHaveBeenCalledWith({
     [90m 164 |[39m       analytics[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 165 |[39m       crashReporting[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.toHaveBeenCalledWith 
(src/components/consent-manager.test.tsx:162:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/quality/analyzers/__tests__/white-balance.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ analyzeWhiteBalance ÔÇ║ color cast detection ÔÇ║ 
should detect warm color cast

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m  99 |[39m
     [90m 100 |[39m       expect(result[33m.[39mscor
e)[33m.[39mtoBeLessThan([35m100[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 101 |[39m       expect(re
sult[33m.[39missue)[33m.[39mtoBeDefined()[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 102 |[39m       expect(result[33m.[39missu
e[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'white_
balance'[39m)[33m;[39m
     [90m 103 |[39m     })[33m;[39m
     [90m 104 |[39m[0m

      at Object.toBeDefined (src/lib/quality/analyzers/_
_tests__/white-balance.test.ts:101:28)

  ÔùÅ analyzeWhiteBalance ÔÇ║ color cast detection ÔÇ║ 
should detect cool color cast

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 108 |[39m
     [90m 109 |[39m       expect(result[33m.[39mscor
e)[33m.[39mtoBeLessThan([35m100[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 110 |[39m       expect(re
sult[33m.[39missue)[33m.[39mtoBeDefined()[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 111 |[39m       expect(result[33m.[39missu
e[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'white_
balance'[39m)[33m;[39m
     [90m 112 |[39m     })[33m;[39m
     [90m 113 |[39m[0m

      at Object.toBeDefined (src/lib/quality/analyzers/_
_tests__/white-balance.test.ts:110:28)

FAIL src/components/ui/button.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ Button component  ÔÇ║ should apply correct styles 
based on size prop

    expect(received).toContain(expected) // indexOf

    Expected substring: "font-inter font-semibold 
text-white dark:text-black text-xl"
    Received string:    "font-inter font-semibold 
text-white text-xl"

    [0m [90m 86 |[39m     [36mconst[39m 
receivedStyle [33m=[39m
     [90m 87 |[39m       button[33m.[39mprops[33m.
[39mchildren[[35m0[39m][33m.[39mprops[33m.[39mchil
dren[33m.[39mprops[33m.[39mclassName[33m;[39m
    [31m[1m>[22m[39m[90m 88 |[39m     expect(recei
vedStyle)[33m.[39mtoContain(expectedStyle)[33m;[39m
     [90m    |[39m                           
[31m[1m^[22m[39m
     [90m 89 |[39m   })[33m;[39m
     [90m 90 |[39m   it([32m'should apply correct 
styles for label when variant is 
secondary'[39m[33m,[39m () [33m=>[39m {
     [90m 91 |[39m     
render([33m<[39m[33mButton[39m 
testID[33m=[39m[32m"button"[39m 
variant[33m=[39m[32m"secondary"[39m 
label[33m=[39m[32m"Submit"[39m 
[33m/[39m[33m>[39m)[33m;[39m[0m

      at Object.toContain 
(src/components/ui/button.test.tsx:88:27)

  ÔùÅ Button component  ÔÇ║ should apply correct styles 
for label when variant is secondary

    expect(received).toContain(expected) // indexOf

    Expected substring: "font-inter font-semibold 
text-secondary-600 text-base"
    Received string:    "font-inter font-semibold 
text-white text-base"

    [0m [90m  96 |[39m     [36mconst[39m 
receivedStyle [33m=[39m
     [90m  97 |[39m       button[33m.[39mprops[33m.
[39mchildren[[35m0[39m][33m.[39mprops[33m.[39mchi
ldren[33m.[39mprops[33m.[39mclassName[33m;[39m
    [31m[1m>[22m[39m[90m  98 |[39m     expect(rece
ivedStyle)[33m.[39mtoContain(expectedStyle)[33m;[39m
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m  99 |[39m   })[33m;[39m
     [90m 100 |[39m   it([32m'should apply correct 
styles for label when is disabled'[39m[33m,[39m () 
[33m=>[39m {
     [90m 101 |[39m     
render([33m<[39m[33mButton[39m 
testID[33m=[39m[32m"button"[39m 
label[33m=[39m[32m"Submit"[39m disabled 
[33m/[39m[33m>[39m)[33m;[39m[0m

      at Object.toContain 
(src/components/ui/button.test.tsx:98:27)

FAIL src/lib/moderation/__tests__/community-integration.
test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Error getting moderation status: TypeError: 
_supabase.supabase.from(...).select(...).eq(...).eq is 
not a function
          at CommunityIntegrationService.eq (C:\Users\Pe
ter\GrowBro\src\lib\moderation\community-integration.ts:
305:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at CommunityIntegrationService.<anonymous> (C:
\Users\Peter\GrowBro\node_modules\@babel\runtime\helpers
\asyncToGenerator.js:14:12)
          at CommunityIntegrationService.apply [as 
getModerationStatus] (C:\Users\Peter\GrowBro\src\lib\mod
eration\community-integration.ts:295:36)
          at 
CommunityIntegrationService.getModerationStatus (C:\User
s\Peter\GrowBro\src\lib\moderation\community-integration
.ts:84:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 337 |[39m       }
     [90m 338 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 339 |[39m       
console[33m.[39merror([32m'Error getting moderation 
status:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 340 |[39m       [36mreturn[39m 
[32m'active'[39m[33m;[39m
     [90m 341 |[39m     }
     [90m 342 |[39m   }[0m

      at CommunityIntegrationService.error 
(src/lib/moderation/community-integration.ts:339:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CommunityIntegrationService.<anonymous> (node_m
odules/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at CommunityIntegrationService.apply [as 
getModerationStatus] 
(src/lib/moderation/community-integration.ts:295:36)
      at 
CommunityIntegrationService.getModerationStatus 
(src/lib/moderation/community-integration.ts:84:43)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      Error getting current location: GeoLocationError: 
Cannot read properties of undefined (reading 'invoke')
          at GeoLocationService.handleError (C:\Users\Pe
ter\GrowBro\src\lib\moderation\geo-location-service.ts:5
28:12)
          at GeoLocationService.handleError (C:\Users\Pe
ter\GrowBro\src\lib\moderation\geo-location-service.ts:8
4:18)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at GeoLocationService.<anonymous> (C:\Users\Pe
ter\GrowBro\node_modules\@babel\runtime\helpers\asyncToG
enerator.js:14:12)
          at GeoLocationService.apply [as 
detectUserLocationIP] (C:\Users\Peter\GrowBro\src\lib\mo
deration\geo-location-service.ts:45:29)
          at 
CommunityIntegrationService.detectUserLocationIP (C:\Use
rs\Peter\GrowBro\src\lib\moderation\community-integratio
n.ts:261:49)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at processTicksAndRejections 
(node:internal/process/task_queues:105:5) {
        code: 'IP_LOOKUP_FAILED',
        metadata: { ipAddress: '91.61.247.89' }
      }

    [0m [90m 268 |[39m       }[33m;[39m
     [90m 269 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 270 |[39m       
console[33m.[39merror([32m'Error getting current 
location:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 271 |[39m       [90m// Default to no 
restrictions on error[39m
     [90m 272 |[39m       [36mreturn[39m { 
country[33m:[39m [32m'UNKNOWN'[39m }[33m;[39m
     [90m 273 |[39m     }[0m

      at CommunityIntegrationService.error 
(src/lib/moderation/community-integration.ts:270:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Error checking content visibility: 
GeoLocationError: _supabase.supabase.rpc is not a 
function
          at GeoLocationService.handleError (C:\Users\Pe
ter\GrowBro\src\lib\moderation\geo-location-service.ts:5
28:12)
          at GeoLocationService.handleError (C:\Users\Pe
ter\GrowBro\src\lib\moderation\geo-location-service.ts:1
87:18)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at GeoLocationService.<anonymous> (C:\Users\Pe
ter\GrowBro\node_modules\@babel\runtime\helpers\asyncToG
enerator.js:14:12)
          at GeoLocationService.apply [as 
checkContentAvailability] (C:\Users\Peter\GrowBro\src\li
b\moderation\geo-location-service.ts:145:33)
          at 
CommunityIntegrationService.checkContentAvailability (C:
\Users\Peter\GrowBro\src\lib\moderation\community-integr
ation.ts:126:56)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at processTicksAndRejections 
(node:internal/process/task_queues:105:5) {
        code: 'RESTRICTION_NOT_FOUND',
        metadata: { contentId: 'post-123', location: { 
country: 'UNKNOWN' } }
      }

    [0m [90m 140 |[39m       [36mreturn[39m { 
visible[33m:[39m [36mtrue[39m }[33m;[39m
     [90m 141 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 142 |[39m       
console[33m.[39merror([32m'Error checking content 
visibility:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 143 |[39m       [90m// Default to visible 
on error to avoid blocking legitimate content[39m
     [90m 144 |[39m       [36mreturn[39m { 
visible[33m:[39m [36mtrue[39m }[33m;[39m
     [90m 145 |[39m     }[0m

      at CommunityIntegrationService.error 
(src/lib/moderation/community-integration.ts:142:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Error getting moderation status: TypeError: 
_supabase.supabase.from(...).select(...).eq(...).eq is 
not a function
          at CommunityIntegrationService.eq (C:\Users\Pe
ter\GrowBro\src\lib\moderation\community-integration.ts:
305:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at CommunityIntegrationService.<anonymous> (C:
\Users\Peter\GrowBro\node_modules\@babel\runtime\helpers
\asyncToGenerator.js:14:12)
          at CommunityIntegrationService.apply [as 
getModerationStatus] (C:\Users\Peter\GrowBro\src\lib\mod
eration\community-integration.ts:295:36)
          at 
CommunityIntegrationService.getModerationStatus (C:\User
s\Peter\GrowBro\src\lib\moderation\community-integration
.ts:84:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 337 |[39m       }
     [90m 338 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 339 |[39m       
console[33m.[39merror([32m'Error getting moderation 
status:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 340 |[39m       [36mreturn[39m 
[32m'active'[39m[33m;[39m
     [90m 341 |[39m     }
     [90m 342 |[39m   }[0m

      at CommunityIntegrationService.error 
(src/lib/moderation/community-integration.ts:339:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CommunityIntegrationService.<anonymous> (node_m
odules/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at CommunityIntegrationService.apply [as 
getModerationStatus] 
(src/lib/moderation/community-integration.ts:295:36)
      at 
CommunityIntegrationService.getModerationStatus 
(src/lib/moderation/community-integration.ts:84:43)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      Error getting current location: GeoLocationError: 
Cannot read properties of undefined (reading 'invoke')
          at GeoLocationService.handleError (C:\Users\Pe
ter\GrowBro\src\lib\moderation\geo-location-service.ts:5
28:12)
          at GeoLocationService.handleError (C:\Users\Pe
ter\GrowBro\src\lib\moderation\geo-location-service.ts:8
4:18)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at GeoLocationService.<anonymous> (C:\Users\Pe
ter\GrowBro\node_modules\@babel\runtime\helpers\asyncToG
enerator.js:14:12)
          at GeoLocationService.apply [as 
detectUserLocationIP] (C:\Users\Peter\GrowBro\src\lib\mo
deration\geo-location-service.ts:45:29)
          at 
CommunityIntegrationService.detectUserLocationIP (C:\Use
rs\Peter\GrowBro\src\lib\moderation\community-integratio
n.ts:261:49)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at processTicksAndRejections 
(node:internal/process/task_queues:105:5) {
        code: 'IP_LOOKUP_FAILED',
        metadata: { ipAddress: '91.61.247.89' }
      }

    [0m [90m 268 |[39m       }[33m;[39m
     [90m 269 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 270 |[39m       
console[33m.[39merror([32m'Error getting current 
location:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 271 |[39m       [90m// Default to no 
restrictions on error[39m
     [90m 272 |[39m       [36mreturn[39m { 
country[33m:[39m [32m'UNKNOWN'[39m }[33m;[39m
     [90m 273 |[39m     }[0m

      at CommunityIntegrationService.error 
(src/lib/moderation/community-integration.ts:270:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Error checking content visibility: 
GeoLocationError: _supabase.supabase.rpc is not a 
function
          at GeoLocationService.handleError (C:\Users\Pe
ter\GrowBro\src\lib\moderation\geo-location-service.ts:5
28:12)
          at GeoLocationService.handleError (C:\Users\Pe
ter\GrowBro\src\lib\moderation\geo-location-service.ts:1
87:18)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at GeoLocationService.<anonymous> (C:\Users\Pe
ter\GrowBro\node_modules\@babel\runtime\helpers\asyncToG
enerator.js:14:12)
          at GeoLocationService.apply [as 
checkContentAvailability] (C:\Users\Peter\GrowBro\src\li
b\moderation\geo-location-service.ts:145:33)
          at 
CommunityIntegrationService.checkContentAvailability (C:
\Users\Peter\GrowBro\src\lib\moderation\community-integr
ation.ts:126:56)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at processTicksAndRejections 
(node:internal/process/task_queues:105:5) {
        code: 'RESTRICTION_NOT_FOUND',
        metadata: { contentId: 'post-123', location: { 
country: 'UNKNOWN' } }
      }

    [0m [90m 140 |[39m       [36mreturn[39m { 
visible[33m:[39m [36mtrue[39m }[33m;[39m
     [90m 141 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 142 |[39m       
console[33m.[39merror([32m'Error checking content 
visibility:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 143 |[39m       [90m// Default to visible 
on error to avoid blocking legitimate content[39m
     [90m 144 |[39m       [36mreturn[39m { 
visible[33m:[39m [36mtrue[39m }[33m;[39m
     [90m 145 |[39m     }[0m

      at CommunityIntegrationService.error 
(src/lib/moderation/community-integration.ts:142:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ Community Integration ÔÇ║ Content Visibility ÔÇ║ 
should return not visible for removed content

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 73 |[39m       )[33m;[39m
     [90m 74 |[39m
    [31m[1m>[22m[39m[90m 75 |[39m       expect(res
ult[33m.[39mvisible)[33m.[39mtoBe([36mfalse[39m)[
33m;[39m
     [90m    |[39m                              
[31m[1m^[22m[39m
     [90m 76 |[39m       expect(result[33m.[39mreaso
n)[33m.[39mtoBe([32m'removed'[39m)[33m;[39m
     [90m 77 |[39m     })[33m;[39m
     [90m 78 |[39m   })[33m;[39m[0m

      at Object.toBe (src/lib/moderation/__tests__/commu
nity-integration.test.ts:75:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/nutrient-engine/schemas/ph-ec-reading-schem
a.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.log
      [auth] onAuthStateChange INITIAL_SESSION false

      at log (src/lib/auth/index.tsx:404:13)

  ÔùÅ PhEcReadingSchema ÔÇ║ Validation Messages ÔÇ║ 
returns localized error message for pH too high

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "pH must be at most 14"
    Received: "pH must be 14 or less"

    [0m [90m 66 |[39m           
err[33m.[39mpath[33m.[39mincludes([32m'ph'[39m)
     [90m 67 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m 68 |[39m         expect(p
hError[33m?[39m[33m.[39mmessage)[33m.[39mtoBe([32
m'pH must be at most 14'[39m)[33m;[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 69 |[39m       }
     [90m 70 |[39m     })[33m;[39m
     [90m 71 |[39m[0m

      at Object.toBe (src/lib/nutrient-engine/schemas/ph
-ec-reading-schema.test.ts:68:34)

  ÔùÅ PhEcReadingSchema ÔÇ║ Validation Messages ÔÇ║ 
returns localized error message for EC out of range

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "EC must be at most 10 mS/cm"
    Received: "EC must be 10 or less"

    [0m [90m  99 |[39m           
err[33m.[39mpath[33m.[39mincludes([32m'ecRaw'[39m)
     [90m 100 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m 101 |[39m         expect(
ecError[33m?[39m[33m.[39mmessage)[33m.[39mtoBe([3
2m'EC must be at most 10 mS/cm'[39m)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 102 |[39m       }
     [90m 103 |[39m     })[33m;[39m
     [90m 104 |[39m[0m

      at Object.toBe (src/lib/nutrient-engine/schemas/ph
-ec-reading-schema.test.ts:101:34)

FAIL 
src/lib/moderation/__tests__/misuse-detection.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Violation Tracking ÔÇ║ should track multiple violations 
by user

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 43 |[39m
     [90m 44 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 45 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m    |[39m                                    
 [31m[1m^[22m[39m
     [90m 46 |[39m
     [90m 47 |[39m       expect(record[33m.[39mviola
tionCount)[33m.[39mtoBe([35m3[39m)[33m;[39m
     [90m 48 |[39m       expect(record[33m.[39mviola
tionsByType)[33m.[39mtoMatchObject({[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:45:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Violation Tracking ÔÇ║ should distinguish between 
different violation types

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 60 |[39m
     [90m 61 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 62 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m    |[39m                                    
 [31m[1m^[22m[39m
     [90m 63 |[39m
     [90m 64 |[39m       expect(record[33m.[39mviola
tionsByType[33m.[39mspam)[33m.[39mtoBe([35m2[39m)
[33m;[39m
     [90m 65 |[39m       expect(record[33m.[39mviola
tionsByType[33m.[39mmisinformation)[33m.[39mtoBe([3
5m1[39m)[33m;[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:62:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Violation Tracking ÔÇ║ should track violation 
timestamps for pattern analysis

    TypeError: Cannot read properties of undefined 
(reading 'getTime')

    [0m [90m 79 |[39m       )[33m;[39m
     [90m 80 |[39m
    [31m[1m>[22m[39m[90m 81 |[39m       expect(vio
lation2[33m.[39mtimestamp[33m.[39mgetTime())[33m.[
39mtoBeGreaterThan(
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 82 |[39m         
violation1[33m.[39mtimestamp[33m.[39mgetTime()
     [90m 83 |[39m       )[33m;[39m
     [90m 84 |[39m     })[33m;[39m[0m

      at Object.getTime (src/lib/moderation/__tests__/mi
suse-detection.test.ts:81:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Graduated Enforcement (Requirement 12.2) ÔÇ║ should 
escalate from warning to temporary suspension

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 91 |[39m       [90m// First violation: 
warning[39m
     [90m 92 |[39m       [36mawait[39m repeatOffende
rService[33m.[39mrecordViolation(userId[33m,[39m 
[32m'spam'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 93 |[39m       
[36mlet[39m record [33m=[39m [36mawait[39m repeatO
ffenderService[33m.[39mgetRepeatOffenderRecord(userId)
[33m;[39m
     [90m    |[39m                                    
            [31m[1m^[22m[39m
     [90m 94 |[39m       expect(record[33m.[39mescal
ationLevel)[33m.[39mtoBe([32m'warning'[39m)[33m;[3
9m
     [90m 95 |[39m
     [90m 96 |[39m       [90m// Second violation: 
still warning[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:93:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Graduated Enforcement (Requirement 12.2) ÔÇ║ should 
escalate to permanent ban after multiple suspensions

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 115 |[39m
     [90m 116 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 117 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 118 |[39m
     [90m 119 |[39m       expect(record[33m.[39mesca
lationLevel)[33m.[39mtoBe([32m'permanent_ban'[39m)[
33m;[39m
     [90m 120 |[39m       expect(record[33m.[39mstat
us)[33m.[39mtoBe([32m'banned'[39m)[33m;[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:117:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Graduated Enforcement (Requirement 12.2) ÔÇ║ should 
apply different thresholds for severe violations

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 128 |[39m
     [90m 129 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 130 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 131 |[39m
     [90m 132 |[39m       [90m// Should immediately 
suspend for severe violations[39m
     [90m 133 |[39m       expect(record[33m.[39mesca
lationLevel)[33m.[39mtoBe([32m'temporary_suspension'
[39m)[33m;[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:130:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Graduated Enforcement (Requirement 12.2) ÔÇ║ should 
include suspension duration in enforcement action

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 143 |[39m
     [90m 144 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 145 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 146 |[39m       [36mconst[39m 
latestSuspension [33m=[39m
     [90m 147 |[39m         record[33m.[39msuspensio
nHistory[record[33m.[39msuspensionHistory[33m.[39mle
ngth [33m-[39m [35m1[39m][33m;[39m
     [90m 148 |[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:145:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Manifestly Unfounded Reporter Tracking ÔÇ║ should track 
false reports by reporter

    TypeError: moderationService.submitReport is not a 
function

    [0m [90m 159 |[39m       [90m// Submit 5 false 
reports[39m
     [90m 160 |[39m       [36mfor[39m 
([36mlet[39m i [33m=[39m [35m0[39m[33m;[39m i 
[33m<[39m [35m5[39m[33m;[39m i[33m++[39m) {
    [31m[1m>[22m[39m[90m 161 |[39m         
[36mconst[39m report [33m=[39m [36mawait[39m 
moderationService[33m.[39msubmitReport({
     [90m     |[39m                                   
             [31m[1m^[22m[39m
     [90m 162 |[39m           contentId[33m:[39m 
[32m`content-${i}`[39m[33m,[39m
     [90m 163 |[39m           reporterId[33m,[39m
     [90m 164 |[39m           reportType[33m:[39m 
[32m'policy_violation'[39m[33m,[39m[0m

      at Object.submitReport (src/lib/moderation/__tests
__/misuse-detection.test.ts:161:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Manifestly Unfounded Reporter Tracking ÔÇ║ should 
suspend reporter after threshold of false reports

    TypeError: moderationService.submitReport is not a 
function

    [0m [90m 192 |[39m       [90m// Submit 10 false 
reports (threshold)[39m
     [90m 193 |[39m       [36mfor[39m 
([36mlet[39m i [33m=[39m [35m0[39m[33m;[39m i 
[33m<[39m [35m10[39m[33m;[39m i[33m++[39m) {
    [31m[1m>[22m[39m[90m 194 |[39m         
[36mconst[39m report [33m=[39m [36mawait[39m 
moderationService[33m.[39msubmitReport({
     [90m     |[39m                                   
             [31m[1m^[22m[39m
     [90m 195 |[39m           contentId[33m:[39m 
[32m`content-${i}`[39m[33m,[39m
     [90m 196 |[39m           reporterId[33m,[39m
     [90m 197 |[39m           reportType[33m:[39m 
[32m'policy_violation'[39m[33m,[39m[0m

      at Object.submitReport (src/lib/moderation/__tests
__/misuse-detection.test.ts:194:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Manifestly Unfounded Reporter Tracking ÔÇ║ should 
calculate false report rate

    TypeError: moderationService.submitReport is not a 
function

    [0m [90m 225 |[39m       [90m// Submit 10 
reports: 3 valid, 7 false[39m
     [90m 226 |[39m       [36mfor[39m 
([36mlet[39m i [33m=[39m [35m0[39m[33m;[39m i 
[33m<[39m [35m10[39m[33m;[39m i[33m++[39m) {
    [31m[1m>[22m[39m[90m 227 |[39m         
[36mconst[39m report [33m=[39m [36mawait[39m 
moderationService[33m.[39msubmitReport({
     [90m     |[39m                                   
             [31m[1m^[22m[39m
     [90m 228 |[39m           contentId[33m:[39m 
[32m`content-${i}`[39m[33m,[39m
     [90m 229 |[39m           reporterId[33m,[39m
     [90m 230 |[39m           reportType[33m:[39m 
[32m'policy_violation'[39m[33m,[39m[0m

      at Object.submitReport (src/lib/moderation/__tests
__/misuse-detection.test.ts:227:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Audit 
Trail (Requirement 12.3) ÔÇ║ should log all enforcement 
actions with immutable audit trail

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: ObjectContaining {"actorId": Any<String>, 
"eventType": "repeat_offender_violation_recorded", 
"metadata": ObjectContaining {"violationCount": 
Any<Number>, "violationType": "hate_speech"}, 
"targetId": "user-audit-123"}

    Number of calls: 0

    [0m [90m 262 |[39m       [36mawait[39m repeatOf
fenderService[33m.[39mrecordViolation(userId[33m,[39
m [32m'hate_speech'[39m)[33m;[39m
     [90m 263 |[39m
    [31m[1m>[22m[39m[90m 264 |[39m       
expect(auditLogSpy)[33m.[39mtoHaveBeenCalledWith(
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 265 |[39m         
expect[33m.[39mobjectContaining({
     [90m 266 |[39m           eventType[33m:[39m [3
2m'repeat_offender_violation_recorded'[39m[33m,[39m
     [90m 267 |[39m           actorId[33m:[39m 
expect[33m.[39many([33mString[39m)[33m,[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/__tests__/misuse-detection.test.ts:264:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Audit 
Trail (Requirement 12.3) ÔÇ║ should log escalation 
actions with reason codes

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: ObjectContaining {"eventType": 
"repeat_offender_escalation", "metadata": 
ObjectContaining {"escalationLevel": 
"temporary_suspension", "reasonCode": Any<String>}}

    Number of calls: 0

    [0m [90m 284 |[39m       }
     [90m 285 |[39m
    [31m[1m>[22m[39m[90m 286 |[39m       
expect(auditLogSpy)[33m.[39mtoHaveBeenCalledWith(
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 287 |[39m         
expect[33m.[39mobjectContaining({
     [90m 288 |[39m           eventType[33m:[39m 
[32m'repeat_offender_escalation'[39m[33m,[39m
     [90m 289 |[39m           metadata[33m:[39m 
expect[33m.[39mobjectContaining({[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/__tests__/misuse-detection.test.ts:286:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Audit 
Trail (Requirement 12.3) ÔÇ║ should include evidence 
links in audit trail

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: ObjectContaining {"metadata": 
ObjectContaining {"decisionId": "decision-123", 
"evidenceUrls": ArrayContaining 
["https://example.com/evidence/1"]}}

    Number of calls: 0

    [0m [90m 304 |[39m       })[33m;[39m
     [90m 305 |[39m
    [31m[1m>[22m[39m[90m 306 |[39m       
expect(auditLogSpy)[33m.[39mtoHaveBeenCalledWith(
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 307 |[39m         
expect[33m.[39mobjectContaining({
     [90m 308 |[39m           metadata[33m:[39m 
expect[33m.[39mobjectContaining({
     [90m 309 |[39m             
evidenceUrls[33m:[39m 
expect[33m.[39marrayContaining([[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/__tests__/misuse-detection.test.ts:306:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Appeal 
Paths (Requirement 12.4) ÔÇ║ should allow users to 
appeal repeat offender status

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 327 |[39m
     [90m 328 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 329 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 330 |[39m       expect(record[33m.[39mstat
us)[33m.[39mtoBe([32m'suspended'[39m)[33m;[39m
     [90m 331 |[39m
     [90m 332 |[39m       [90m// Submit 
appeal[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:329:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Appeal 
Paths (Requirement 12.4) ÔÇ║ should restore account 
status when appeal is upheld

    TypeError: repeatOffenderService.submitStatusAppeal 
is not a function

    [0m [90m 350 |[39m
     [90m 351 |[39m       [90m// Submit and uphold 
appeal[39m
    [31m[1m>[22m[39m[90m 352 |[39m       
[36mconst[39m appeal [33m=[39m [36mawait[39m repea
tOffenderService[33m.[39msubmitStatusAppeal(userId[33
m,[39m {
     [90m     |[39m                                   
               [31m[1m^[22m[39m
     [90m 353 |[39m         reason[33m:[39m 
[32m'False positives'[39m[33m,[39m
     [90m 354 |[39m         evidence[33m:[39m 
[][33m,[39m
     [90m 355 |[39m       })[33m;[39m[0m

      at Object.submitStatusAppeal (src/lib/moderation/_
_tests__/misuse-detection.test.ts:352:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Appeal 
Paths (Requirement 12.4) ÔÇ║ should maintain suspension 
when appeal is rejected

    TypeError: repeatOffenderService.submitStatusAppeal 
is not a function

    [0m [90m 376 |[39m
     [90m 377 |[39m       [90m// Submit and reject 
appeal[39m
    [31m[1m>[22m[39m[90m 378 |[39m       
[36mconst[39m appeal [33m=[39m [36mawait[39m repea
tOffenderService[33m.[39msubmitStatusAppeal(userId[33
m,[39m {
     [90m     |[39m                                   
               [31m[1m^[22m[39m
     [90m 379 |[39m         reason[33m:[39m [32m'I 
disagree with the violations'[39m[33m,[39m
     [90m 380 |[39m         evidence[33m:[39m 
[][33m,[39m
     [90m 381 |[39m       })[33m;[39m[0m

      at Object.submitStatusAppeal (src/lib/moderation/_
_tests__/misuse-detection.test.ts:378:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Pattern 
Detection ÔÇ║ should detect rapid violation patterns

    TypeError: 
repeatOffenderService.detectViolationPattern is not a 
function

    [0m [90m 406 |[39m
     [90m 407 |[39m       [36mconst[39m pattern 
[33m=[39m
    [31m[1m>[22m[39m[90m 408 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mdetectVi
olationPattern(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 409 |[39m
     [90m 410 |[39m       expect(pattern[33m.[39misR
apid)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 411 |[39m       expect(pattern[33m.[39mvio
lationsPerHour)[33m.[39mtoBeGreaterThan([35m4[39m)[
33m;[39m[0m

      at Object.detectViolationPattern (src/lib/moderati
on/__tests__/misuse-detection.test.ts:408:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Pattern 
Detection ÔÇ║ should detect cross-category violation 
patterns

    TypeError: 
repeatOffenderService.detectViolationPattern is not a 
function

    [0m [90m 421 |[39m
     [90m 422 |[39m       [36mconst[39m pattern 
[33m=[39m
    [31m[1m>[22m[39m[90m 423 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mdetectVi
olationPattern(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 424 |[39m
     [90m 425 |[39m       expect(pattern[33m.[39misC
rossCategory)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 426 |[39m       expect(pattern[33m.[39muni
queViolationTypes)[33m.[39mtoBe([35m3[39m)[33m;[39
m[0m

      at Object.detectViolationPattern (src/lib/moderati
on/__tests__/misuse-detection.test.ts:423:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Severity-Based Thresholds ÔÇ║ should apply stricter 
thresholds for severe violations

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 437 |[39m
     [90m 438 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 439 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 440 |[39m
     [90m 441 |[39m       expect(record[33m.[39mesca
lationLevel)[33m.[39mtoBe([32m'permanent_ban'[39m)[
33m;[39m
     [90m 442 |[39m       expect(record[33m.[39mstat
us)[33m.[39mtoBe([32m'banned'[39m)[33m;[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:439:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Severity-Based Thresholds ÔÇ║ should apply lenient 
thresholds for minor violations

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 452 |[39m
     [90m 453 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 454 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 455 |[39m
     [90m 456 |[39m       expect(record[33m.[39mesca
lationLevel)[33m.[39mtoBe([32m'warning'[39m)[33m;[
39m
     [90m 457 |[39m       expect(record[33m.[39mstat
us)[33m.[39mtoBe([32m'active'[39m)[33m;[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:454:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/task-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

  ÔùÅ TaskManager basic flows ÔÇ║ create/update/delete 
one-off task

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 256 |[39m     completedAt[33m:[39m mod
el[33m.[39mcompletedAt[33m?[39m[33m.[39mtoISOStrin
g()[33m,[39m
     [90m 257 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
{}[33m,[39m
    [31m[1m>[22m[39m[90m 258 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 259 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 260 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 261 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:258:32)
      at toTaskFromModel 
(src/lib/task-manager.ts:423:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager basic flows ÔÇ║ series create and 
visible window materialization (lazy)

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 276 |[39m     origin[33m:[39m 
model[33m.[39morigin [33m?[39m[33m?[39m 
undefined[33m,[39m
     [90m 277 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
undefined[33m,[39m
    [31m[1m>[22m[39m[90m 278 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 279 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 280 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 281 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:278:32)
      at toSeriesFromModel 
(src/lib/task-manager.ts:1628:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager basic flows ÔÇ║ complete task and 
materialize next for recurring

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 276 |[39m     origin[33m:[39m 
model[33m.[39morigin [33m?[39m[33m?[39m 
undefined[33m,[39m
     [90m 277 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
undefined[33m,[39m
    [31m[1m>[22m[39m[90m 278 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 279 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 280 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 281 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:278:32)
      at toSeriesFromModel 
(src/lib/task-manager.ts:1628:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager basic flows ÔÇ║ skip recurring 
instance via override

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 276 |[39m     origin[33m:[39m 
model[33m.[39morigin [33m?[39m[33m?[39m 
undefined[33m,[39m
     [90m 277 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
undefined[33m,[39m
    [31m[1m>[22m[39m[90m 278 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 279 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 280 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 281 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:278:32)
      at toSeriesFromModel 
(src/lib/task-manager.ts:1628:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager basic flows ÔÇ║ complete recurring 
instance via override and materialize next

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 276 |[39m     origin[33m:[39m 
model[33m.[39morigin [33m?[39m[33m?[39m 
undefined[33m,[39m
     [90m 277 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
undefined[33m,[39m
    [31m[1m>[22m[39m[90m 278 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 279 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 280 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 281 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:278:32)
      at toSeriesFromModel 
(src/lib/task-manager.ts:1628:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager basic flows ÔÇ║ reschedule recurring 
instance override persists and affects visibility

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 276 |[39m     origin[33m:[39m 
model[33m.[39morigin [33m?[39m[33m?[39m 
undefined[33m,[39m
     [90m 277 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
undefined[33m,[39m
    [31m[1m>[22m[39m[90m 278 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 279 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 280 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 281 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:278:32)
      at toSeriesFromModel 
(src/lib/task-manager.ts:1628:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager notification scheduling ÔÇ║ 
createTask respects scheduleNotifications=false

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 256 |[39m     completedAt[33m:[39m mod
el[33m.[39mcompletedAt[33m?[39m[33m.[39mtoISOStrin
g()[33m,[39m
     [90m 257 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
{}[33m,[39m
    [31m[1m>[22m[39m[90m 258 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 259 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 260 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 261 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:258:32)
      at toTaskFromModel 
(src/lib/task-manager.ts:423:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager notification scheduling ÔÇ║ 
createTask schedules reminders by default

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 256 |[39m     completedAt[33m:[39m mod
el[33m.[39mcompletedAt[33m?[39m[33m.[39mtoISOStrin
g()[33m,[39m
     [90m 257 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
{}[33m,[39m
    [31m[1m>[22m[39m[90m 258 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 259 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 260 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 261 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:258:32)
      at toTaskFromModel 
(src/lib/task-manager.ts:423:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/auth/__tests__/key-rotation.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.error
      [key-rotation] Error checking rotation status: 
Error: Database error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\auth\__tests__\key-rotation.test.ts:71:16)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 75 |[39m
     [90m 76 |[39m     [36mif[39m (error) {
    [31m[1m>[22m[39m[90m 77 |[39m       
console[33m.[39merror([32m'[key-rotation] Error 
checking rotation status:'[39m[33m,[39m 
error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 78 |[39m       [36mthrow[39m 
error[33m;[39m
     [90m 79 |[39m     }
     [90m 80 |[39m[0m

      at error (src/lib/auth/key-rotation.ts:77:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [key-rotation] Failed to check rotation status: 
Error: Database error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\auth\__tests__\key-rotation.test.ts:71:16)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m  97 |[39m     [36mreturn[39m 
status[33m;[39m
     [90m  98 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m  99 |[39m     
console[33m.[39merror([32m'[key-rotation] Failed to 
check rotation status:'[39m[33m,[39m 
error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 100 |[39m     [90m// Return safe defaults 
on error[39m
     [90m 101 |[39m     [36mreturn[39m {
     [90m 102 |[39m       needsRotation[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at error (src/lib/auth/key-rotation.ts:99:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [key-rotation] Starting rotation from v1 to v2

      at log (src/lib/auth/key-rotation.ts:165:13)

    console.error
      [key-rotation] Database rotation failed: Error: 
Database error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\auth\__tests__\key-rotation.test.ts:166:16)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 138 |[39m
     [90m 139 |[39m   [36mif[39m (rotationError) {
    [31m[1m>[22m[39m[90m 140 |[39m     
console[33m.[39merror([32m'[key-rotation] Database 
rotation failed:'[39m[33m,[39m 
rotationError)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 141 |[39m     [90m// Rollback local state: 
remove the newly stored key so local doesn't drift[39m
     [90m 142 |[39m     [36mtry[39m {
     [90m 143 |[39m       [36mawait[39m [33mSecureS
tore[39m[33m.[39mdeleteItemAsync(newKeyStorageKey)[3
3m;[39m[0m

      at error (src/lib/auth/key-rotation.ts:140:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [key-rotation] Rotation failed: Error: Database 
error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\auth\__tests__\key-rotation.test.ts:166:16)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 227 |[39m     }[33m;[39m
     [90m 228 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 229 |[39m     
console[33m.[39merror([32m'[key-rotation] Rotation 
failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 230 |[39m     [36mreturn[39m {
     [90m 231 |[39m       success[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 232 |[39m       newVersion[33m:[39m 
[35m0[39m[33m,[39m[0m

      at error (src/lib/auth/key-rotation.ts:229:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [key-rotation] Failed to get encryption key: 
Error: Read error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\auth\__tests__\key-rotation.test.ts:313:54)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 486 |[39m     [36mreturn[39m 
[36mawait[39m [33mSecureStore[39m[33m.[39mgetItemA
sync(keyStorageKey)[33m;[39m
     [90m 487 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 488 |[39m     
console[33m.[39merror([32m'[key-rotation] Failed to 
get encryption key:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 489 |[39m     [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 490 |[39m   }
     [90m 491 |[39m }[0m

      at error (src/lib/auth/key-rotation.ts:488:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ Key Rotation ÔÇ║ rotateEncryptionKey ÔÇ║ should 
successfully rotate encryption key

    TypeError: _reactNativeMmkv.MMKV.mockImplementation 
is not a function

    [0m [90m 129 |[39m       }[33m;[39m
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m       
([33mMMKV[39m [36mas[39m jest[33m.[39m[33mMockedC
lass[39m[33m<[39m[36mtypeof[39m 
[33mMMKV[39m[33m>[39m)[33m.[39mmockImplementation(
     [90m     |[39m                                   
            [31m[1m^[22m[39m
     [90m 132 |[39m         (config[33m:[39m any) 
[33m=>[39m {
     [90m 133 |[39m           [36mif[39m 
(config[33m.[39mid [33m===[39m 
[32m'auth-storage'[39m) {
     [90m 134 |[39m             [36mreturn[39m 
mockOldStorage [36mas[39m any[33m;[39m[0m

      at Object.mockImplementation 
(src/lib/auth/__tests__/key-rotation.test.ts:131:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Key Rotation ÔÇ║ initializeEncryptionKey ÔÇ║ 
should return existing key if available

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "existing-key-hex"
    Received: "1"

    [0m [90m 188 |[39m       [36mconst[39m key 
[33m=[39m [36mawait[39m 
initializeEncryptionKey()[33m;[39m
     [90m 189 |[39m
    [31m[1m>[22m[39m[90m 190 |[39m       
expect(key)[33m.[39mtoBe(existingKey)[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 191 |[39m       expect(mockCrypto[33m.[39m
getRandomBytesAsync)[33m.[39mnot[33m.[39mtoHaveBeenC
alled()[33m;[39m
     [90m 192 |[39m     })[33m;[39m
     [90m 193 |[39m[0m

      at Object.toBe 
(src/lib/auth/__tests__/key-rotation.test.ts:190:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Key Rotation ÔÇ║ initializeEncryptionKey ÔÇ║ 
should generate new key if none exists

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 32

    Number of calls: 0

    [0m [90m 213 |[39m
     [90m 214 |[39m       
expect(key)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 215 |[39m       expect(mo
ckCrypto[33m.[39mgetRandomBytesAsync)[33m.[39mtoHave
BeenCalledWith([35m32[39m)[33m;[39m
     [90m     |[39m                                   
           [31m[1m^[22m[39m
     [90m 216 |[39m       expect(mockSecureStore[33m.
[39msetItemAsync)[33m.[39mtoHaveBeenCalled()[33m;[3
9m
     [90m 217 |[39m       expect(mockSupabase[33m.[3
9mrpc)[33m.[39mtoHaveBeenCalledWith([32m'rotate_encry
ption_key'[39m[33m,[39m {
     [90m 218 |[39m         p_old_version[33m:[39m 
[35m0[39m[33m,[39m[0m

      at Object.toHaveBeenCalledWith 
(src/lib/auth/__tests__/key-rotation.test.ts:215:46)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Key Rotation ÔÇ║ cleanupOldKeys ÔÇ║ should remove 
keys older than 2 versions

    expect(jest.fn()).toHaveBeenCalledTimes(expected)

    Expected number of calls: 3
    Received number of calls: 0

    [0m [90m 272 |[39m
     [90m 273 |[39m       [90m// Should delete 
versions 1, 2, 3 (keep 4 and 5)[39m
    [31m[1m>[22m[39m[90m 274 |[39m       expect(mo
ckSecureStore[33m.[39mdeleteItemAsync)[33m.[39mtoHav
eBeenCalledTimes([35m3[39m)[33m;[39m
     [90m     |[39m                                   
            [31m[1m^[22m[39m
     [90m 275 |[39m       expect(mockSecureStore[33m.
[39mdeleteItemAsync)[33m.[39mtoHaveBeenCalledWith(
     [90m 276 |[39m         
[32m'auth_encryption_key_v1'[39m
     [90m 277 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledTimes 
(src/lib/auth/__tests__/key-rotation.test.ts:274:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/auth/index.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.warn
      Auth storage not initialized. Call 
getAuthStorage() first.

    [0m [90m 123 |[39m   setItem[33m:[39m 
(key[33m:[39m string[33m,[39m value[33m:[39m 
string)[33m:[39m [36mvoid[39m [33m=>[39m {
     [90m 124 |[39m     [36mif[39m 
([33m![39mauthStorage) {
    [31m[1m>[22m[39m[90m 125 |[39m       
console[33m.[39mwarn(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 126 |[39m         [32m'Auth storage not 
initialized. Call getAuthStorage() first.'[39m
     [90m 127 |[39m       )[33m;[39m
     [90m 128 |[39m       
[36mreturn[39m[33m;[39m[0m

      at Object.warn [as setItem] 
(src/lib/auth/auth-storage.ts:125:15)
      at setItem (src/lib/auth/utils.tsx:96:25)
      at src/lib/auth/index.tsx:106:13
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [auth] performSignIn complete

      at log (src/lib/auth/index.tsx:274:17)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.warn
      Auth storage not initialized. Call 
getAuthStorage() first.

    [0m [90m 123 |[39m   setItem[33m:[39m 
(key[33m:[39m string[33m,[39m value[33m:[39m 
string)[33m:[39m [36mvoid[39m [33m=>[39m {
     [90m 124 |[39m     [36mif[39m 
([33m![39mauthStorage) {
    [31m[1m>[22m[39m[90m 125 |[39m       
console[33m.[39mwarn(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 126 |[39m         [32m'Auth storage not 
initialized. Call getAuthStorage() first.'[39m
     [90m 127 |[39m       )[33m;[39m
     [90m 128 |[39m       
[36mreturn[39m[33m;[39m[0m

      at Object.warn [as setItem] 
(src/lib/auth/auth-storage.ts:125:15)
      at setItem (src/lib/auth/utils.tsx:96:25)
      at src/lib/auth/index.tsx:106:13
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [auth] performSignIn complete

      at log (src/lib/auth/index.tsx:274:17)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn complete

      at log (src/lib/auth/index.tsx:274:17)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] onAuthStateChange SIGNED_IN true

      at log (src/lib/auth/index.tsx:404:13)

    console.warn
      Auth storage not initialized. Call 
getAuthStorage() first.

    [0m [90m 123 |[39m   setItem[33m:[39m 
(key[33m:[39m string[33m,[39m value[33m:[39m 
string)[33m:[39m [36mvoid[39m [33m=>[39m {
     [90m 124 |[39m     [36mif[39m 
([33m![39mauthStorage) {
    [31m[1m>[22m[39m[90m 125 |[39m       
console[33m.[39mwarn(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 126 |[39m         [32m'Auth storage not 
initialized. Call getAuthStorage() first.'[39m
     [90m 127 |[39m       )[33m;[39m
     [90m 128 |[39m       
[36mreturn[39m[33m;[39m[0m

      at Object.warn [as setItem] 
(src/lib/auth/auth-storage.ts:125:15)
      at setItem (src/lib/auth/utils.tsx:96:25)
      at src/lib/auth/index.tsx:299:13
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:310:2)
      at apply (src/lib/auth/index.tsx:282:30)
      at handleSignedIn (src/lib/auth/index.tsx:409:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:417:2)
      at apply (src/lib/auth/index.tsx:397:37)
      at handleAuthStateChange 
(src/lib/auth/index.tsx:499:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:255:2)
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:497:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:507:2)
      at Object.authStateChangeCallback 
(src/lib/auth/index.test.tsx:314:7)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] onAuthStateChange SIGNED_IN true

      at log (src/lib/auth/index.tsx:404:13)

    console.warn
      Auth storage not initialized. Call 
getAuthStorage() first.

    [0m [90m 123 |[39m   setItem[33m:[39m 
(key[33m:[39m string[33m,[39m value[33m:[39m 
string)[33m:[39m [36mvoid[39m [33m=>[39m {
     [90m 124 |[39m     [36mif[39m 
([33m![39mauthStorage) {
    [31m[1m>[22m[39m[90m 125 |[39m       
console[33m.[39mwarn(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 126 |[39m         [32m'Auth storage not 
initialized. Call getAuthStorage() first.'[39m
     [90m 127 |[39m       )[33m;[39m
     [90m 128 |[39m       
[36mreturn[39m[33m;[39m[0m

      at Object.warn [as setItem] 
(src/lib/auth/auth-storage.ts:125:15)
      at setItem (src/lib/auth/utils.tsx:96:25)
      at src/lib/auth/index.tsx:299:13
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:310:2)
      at apply (src/lib/auth/index.tsx:282:30)
      at handleSignedIn (src/lib/auth/index.tsx:409:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:417:2)
      at apply (src/lib/auth/index.tsx:397:37)
      at handleAuthStateChange 
(src/lib/auth/index.tsx:499:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:255:2)
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:497:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:507:2)
      at Object.authStateChangeCallback 
(src/lib/auth/index.test.tsx:354:7)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn complete

      at log (src/lib/auth/index.tsx:274:17)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn complete

      at log (src/lib/auth/index.tsx:274:17)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn complete

      at log (src/lib/auth/index.tsx:274:17)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn complete

      at log (src/lib/auth/index.tsx:274:17)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn complete

      at log (src/lib/auth/index.tsx:274:17)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn complete

      at log (src/lib/auth/index.tsx:274:17)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn complete

      at log (src/lib/auth/index.tsx:274:17)

    console.log
      [auth] performSignIn start

      at log (src/lib/auth/index.tsx:263:13)

    console.log
      [auth] performSignIn complete

      at log (src/lib/auth/index.tsx:274:17)

  ÔùÅ Auth ÔÇ║ state transitions ÔÇ║ should transition 
from idle to signIn with session and user

    TypeError: _supabase.supabase.auth.getSession is 
not a function

    [0m [90m 54 |[39m   [90m// Check if Supabase 
client already has this session active[39m
     [90m 55 |[39m   [90m// (e.g., from 
signInWithPassword, signInWithIdToken, or OAuth)[39m
    [31m[1m>[22m[39m[90m 56 |[39m   
[36mconst[39m { data[33m:[39m currentData } 
[33m=[39m [36mawait[39m supabase[33m.[39mauth[33m
.[39mgetSession()[33m;[39m
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 57 |[39m   [36mconst[39m 
supabaseHasSession [33m=[39m
     [90m 58 |[39m     currentData[33m?[39m[33m.[3
9msession[33m?[39m[33m.[39maccess_token 
[33m===[39m session[33m.[39maccess_token[33m;[39m
     [90m 59 |[39m[0m

      at getSession (src/lib/auth/index.tsx:56:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:92:2)
      at apply (src/lib/auth/index.tsx:49:39)
      at handleSignInWithSession 
(src/lib/auth/index.tsx:268:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:265:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:257:29)
      at Object.performSignIn 
(src/lib/auth/index.tsx:428:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as signIn] 
(src/lib/auth/index.tsx:428:9)
      at Object.signIn 
(src/lib/auth/index.test.tsx:139:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth ÔÇ║ session management ÔÇ║ should update 
session with updateSession action

    TypeError: _supabase.supabase.auth.getSession is 
not a function

    [0m [90m 54 |[39m   [90m// Check if Supabase 
client already has this session active[39m
     [90m 55 |[39m   [90m// (e.g., from 
signInWithPassword, signInWithIdToken, or OAuth)[39m
    [31m[1m>[22m[39m[90m 56 |[39m   
[36mconst[39m { data[33m:[39m currentData } 
[33m=[39m [36mawait[39m supabase[33m.[39mauth[33m
.[39mgetSession()[33m;[39m
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 57 |[39m   [36mconst[39m 
supabaseHasSession [33m=[39m
     [90m 58 |[39m     currentData[33m?[39m[33m.[3
9msession[33m?[39m[33m.[39maccess_token 
[33m===[39m session[33m.[39maccess_token[33m;[39m
     [90m 59 |[39m[0m

      at getSession (src/lib/auth/index.tsx:56:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:49:39)
      at handleSignInWithSession 
(src/lib/auth/index.tsx:268:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:265:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:257:29)
      at Object.performSignIn 
(src/lib/auth/index.tsx:428:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as signIn] 
(src/lib/auth/index.tsx:428:9)
      at Object.signIn 
(src/lib/auth/index.test.tsx:174:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth ÔÇ║ session management ÔÇ║ should update 
user with updateUser action

    TypeError: _supabase.supabase.auth.getSession is 
not a function

    [0m [90m 54 |[39m   [90m// Check if Supabase 
client already has this session active[39m
     [90m 55 |[39m   [90m// (e.g., from 
signInWithPassword, signInWithIdToken, or OAuth)[39m
    [31m[1m>[22m[39m[90m 56 |[39m   
[36mconst[39m { data[33m:[39m currentData } 
[33m=[39m [36mawait[39m supabase[33m.[39mauth[33m
.[39mgetSession()[33m;[39m
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 57 |[39m   [36mconst[39m 
supabaseHasSession [33m=[39m
     [90m 58 |[39m     currentData[33m?[39m[33m.[3
9msession[33m?[39m[33m.[39maccess_token 
[33m===[39m session[33m.[39maccess_token[33m;[39m
     [90m 59 |[39m[0m

      at getSession (src/lib/auth/index.tsx:56:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:49:39)
      at handleSignInWithSession 
(src/lib/auth/index.tsx:268:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:265:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:257:29)
      at Object.performSignIn 
(src/lib/auth/index.tsx:428:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as signIn] 
(src/lib/auth/index.tsx:428:9)
      at Object.signIn 
(src/lib/auth/index.test.tsx:196:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth ÔÇ║ session persistence ÔÇ║ should persist 
session to storage on signIn

    TypeError: _supabase.supabase.auth.getSession is 
not a function

    [0m [90m 54 |[39m   [90m// Check if Supabase 
client already has this session active[39m
     [90m 55 |[39m   [90m// (e.g., from 
signInWithPassword, signInWithIdToken, or OAuth)[39m
    [31m[1m>[22m[39m[90m 56 |[39m   
[36mconst[39m { data[33m:[39m currentData } 
[33m=[39m [36mawait[39m supabase[33m.[39mauth[33m
.[39mgetSession()[33m;[39m
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 57 |[39m   [36mconst[39m 
supabaseHasSession [33m=[39m
     [90m 58 |[39m     currentData[33m?[39m[33m.[3
9msession[33m?[39m[33m.[39maccess_token 
[33m===[39m session[33m.[39maccess_token[33m;[39m
     [90m 59 |[39m[0m

      at getSession (src/lib/auth/index.tsx:56:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:49:39)
      at handleSignInWithSession 
(src/lib/auth/index.tsx:268:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:265:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:257:29)
      at Object.performSignIn 
(src/lib/auth/index.tsx:428:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as signIn] 
(src/lib/auth/index.tsx:428:9)
      at Object.signIn 
(src/lib/auth/index.test.tsx:226:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth ÔÇ║ session persistence ÔÇ║ should hydrate 
session from storage

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "signIn"
    Received: "signOut"

    [0m [90m 250 |[39m
     [90m 251 |[39m       [36mconst[39m state 
[33m=[39m useAuth[33m.[39mgetState()[33m;[39m
    [31m[1m>[22m[39m[90m 252 |[39m       expect(st
ate[33m.[39mstatus)[33m.[39mtoBe([32m'signIn'[39m)
[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 253 |[39m       expect(state[33m.[39mtoken
)[33m.[39mtoEqual(token)[33m;[39m
     [90m 254 |[39m     })[33m;[39m
     [90m 255 |[39m[0m

      at Object.toBe 
(src/lib/auth/index.test.tsx:252:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Auth ÔÇ║ session persistence ÔÇ║ should clear 
storage on signOut

    expect(received).toBeTruthy()

    Received: undefined

    [0m [90m 270 |[39m         [33m.[39mgetState()
     [90m 271 |[39m         [33m.[39msignIn({ 
access[33m:[39m [32m'test-token'[39m[33m,[39m 
refresh[33m:[39m [32m'test-refresh'[39m 
})[33m;[39m
    [31m[1m>[22m[39m[90m 272 |[39m       expect(mo
ckStorage[33m.[39m[36mget[39m([32m'token'[39m))[3
3m.[39mtoBeTruthy()[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 273 |[39m
     [90m 274 |[39m       [36mawait[39m 
signOut()[33m;[39m
     [90m 275 |[39m[0m

      at Object.toBeTruthy 
(src/lib/auth/index.test.tsx:272:40)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Auth ÔÇ║ onAuthStateChange event handling ÔÇ║ 
should update state on SIGNED_IN event with different 
session token

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "different-access-token"
    Received: "test-access-token"

    [0m [90m 317 |[39m       [36mconst[39m 
updatedState [33m=[39m 
useAuth[33m.[39mgetState()[33m;[39m
     [90m 318 |[39m       expect(updatedState[33m.[3
9mstatus)[33m.[39mtoBe([32m'signIn'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 319 |[39m       expect(up
datedState[33m.[39msession[33m?[39m[33m.[39maccess
_token)[33m.[39mtoBe([32m'different-access-token'[39
m)[33m;[39m
     [90m     |[39m                                   
               [31m[1m^[22m[39m
     [90m 320 |[39m       expect(updatedState[33m.[3
9msession[33m?[39m[33m.[39mrefresh_token)[33m.[39m
toBe(
     [90m 321 |[39m         
[32m'different-refresh-token'[39m
     [90m 322 |[39m       )[33m;[39m[0m

      at Object.toBe 
(src/lib/auth/index.test.tsx:319:50)

  ÔùÅ Auth ÔÇ║ onAuthStateChange event handling ÔÇ║ 
should update state on SIGNED_IN event with different 
session token

    TypeError: _supabase.supabase.auth.getSession is 
not a function

    [0m [90m 54 |[39m   [90m// Check if Supabase 
client already has this session active[39m
     [90m 55 |[39m   [90m// (e.g., from 
signInWithPassword, signInWithIdToken, or OAuth)[39m
    [31m[1m>[22m[39m[90m 56 |[39m   
[36mconst[39m { data[33m:[39m currentData } 
[33m=[39m [36mawait[39m supabase[33m.[39mauth[33m
.[39mgetSession()[33m;[39m
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 57 |[39m   [36mconst[39m 
supabaseHasSession [33m=[39m
     [90m 58 |[39m     currentData[33m?[39m[33m.[3
9msession[33m?[39m[33m.[39maccess_token 
[33m===[39m session[33m.[39maccess_token[33m;[39m
     [90m 59 |[39m[0m

      at getSession (src/lib/auth/index.tsx:56:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:49:39)
      at handleSignInWithSession 
(src/lib/auth/index.tsx:268:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:265:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:257:29)
      at Object.performSignIn 
(src/lib/auth/index.tsx:428:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as signIn] 
(src/lib/auth/index.tsx:428:9)
      at Object.signIn 
(src/lib/auth/index.test.tsx:283:26)

  ÔùÅ Auth ÔÇ║ onAuthStateChange event handling ÔÇ║ 
should not update state on SIGNED_IN event with same 
session token

    TypeError: _supabase.supabase.auth.getSession is 
not a function

    [0m [90m 54 |[39m   [90m// Check if Supabase 
client already has this session active[39m
     [90m 55 |[39m   [90m// (e.g., from 
signInWithPassword, signInWithIdToken, or OAuth)[39m
    [31m[1m>[22m[39m[90m 56 |[39m   
[36mconst[39m { data[33m:[39m currentData } 
[33m=[39m [36mawait[39m supabase[33m.[39mauth[33m
.[39mgetSession()[33m;[39m
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 57 |[39m   [36mconst[39m 
supabaseHasSession [33m=[39m
     [90m 58 |[39m     currentData[33m?[39m[33m.[3
9msession[33m?[39m[33m.[39maccess_token 
[33m===[39m session[33m.[39maccess_token[33m;[39m
     [90m 59 |[39m[0m

      at getSession (src/lib/auth/index.tsx:56:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:49:39)
      at handleSignInWithSession 
(src/lib/auth/index.tsx:268:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:265:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:257:29)
      at Object.performSignIn 
(src/lib/auth/index.tsx:428:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as signIn] 
(src/lib/auth/index.tsx:428:9)
      at Object.signIn 
(src/lib/auth/index.test.tsx:331:26)

  ÔùÅ Auth ÔÇ║ signOut ÔÇ║ should clear auth token from 
storage on signOut

    expect(received).toBeTruthy()

    Received: undefined

    [0m [90m 382 |[39m
     [90m 383 |[39m       [90m// Verify token is 
stored[39m
    [31m[1m>[22m[39m[90m 384 |[39m       expect(mo
ckStorage[33m.[39m[36mget[39m([32m'token'[39m))[3
3m.[39mtoBeTruthy()[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 385 |[39m
     [90m 386 |[39m       [90m// Sign out[39m
     [90m 387 |[39m       [36mawait[39m 
signOut()[33m;[39m[0m

      at Object.toBeTruthy 
(src/lib/auth/index.test.tsx:384:40)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/moderation/__tests__/security-tests.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should prevent unauthorized access to moderation 
queues

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should allow moderators to access moderation queues

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should allow admins to access all moderation 
functions

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should enforce role-based access control via JWT 
claims

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should prevent privilege escalation

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should validate moderator credentials on every 
request

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should log all authentication attempts

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should create immutable audit events with cryptographic 
signatures

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should detect tampering with audit events

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should maintain chain of custody for audit trail access

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should prevent deletion of audit events

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should prevent modification of audit events

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should verify partition checksums for integrity

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should detect partition tampering

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Data Access Controls ÔÇ║ 
should enforce row-level security on sensitive data

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Data Access Controls ÔÇ║ 
should allow moderators to access only their assigned 
reports

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Data Access Controls ÔÇ║ 
should prevent cross-moderator data access

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Data Access Controls ÔÇ║ 
should log all data access attempts

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Input Validation & Injection 
Prevention ÔÇ║ should prevent SQL injection in report 
queries

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Input Validation & Injection 
Prevention ÔÇ║ should sanitize user input in reports

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Input Validation & Injection 
Prevention ÔÇ║ should validate content locator URLs

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Input Validation & Injection 
Prevention ÔÇ║ should enforce maximum input lengths

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Rate Limiting & Abuse 
Prevention ÔÇ║ should rate limit report submissions

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Rate Limiting & Abuse 
Prevention ÔÇ║ should detect and prevent duplicate 
report spam

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Rate Limiting & Abuse 
Prevention ÔÇ║ should implement CAPTCHA for suspicious 
activity

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Encryption & Data Protection 
ÔÇ║ should encrypt sensitive data at rest

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Encryption & Data Protection 
ÔÇ║ should use secure hashing for content snapshots

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Encryption & Data Protection 
ÔÇ║ should protect API keys and secrets

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Session Management ÔÇ║ should 
invalidate sessions after timeout

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Session Management ÔÇ║ should 
release claimed reports on session expiry

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

FAIL src/lib/assessment/offline-queue-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

  ÔùÅ OfflineQueueManager ÔÇ║ enqueue ÔÇ║ should create 
a new assessment request

    TypeError: _watermelondb.Q.lt is not a function

    [0m [90m 473 |[39m     [36mconst[39m 
conditions [33m=[39m [
     [90m 474 |[39m       [33mQ[39m[33m.[39mwhere(
[32m'status'[39m[33m,[39m status)[33m,[39m
    [31m[1m>[22m[39m[90m 475 |[39m       [33mQ[3
9m[33m.[39mwhere([32m'updated_at'[39m[33m,[39m 
[33mQ[39m[33m.[39mlt(cutoff))[33m,[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 476 |[39m     ][33m;[39m
     [90m 477 |[39m
     [90m 478 |[39m     [36mreturn[39m collection[3
3m.[39mquery([33m...[39mconditions)[33m.[39mfetch()
[33m;[39m[0m

      at OfflineQueueManager.lt 
(src/lib/assessment/offline-queue-manager.ts:475:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
fetchRecordsBefore] 
(src/lib/assessment/offline-queue-manager.ts:468:35)
      at OfflineQueueManager.fetchRecordsBefore 
(src/lib/assessment/offline-queue-manager.ts:407:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
getRetentionRemovals] 
(src/lib/assessment/offline-queue-manager.ts:399:37)
      at OfflineQueueManager.getRetentionRemovals 
(src/lib/assessment/offline-queue-manager.ts:366:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
cleanupStoragePolicy] 
(src/lib/assessment/offline-queue-manager.ts:358:37)
      at OfflineQueueManager.cleanupStoragePolicy 
(src/lib/assessment/offline-queue-manager.ts:64:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as enqueue] 
(src/lib/assessment/offline-queue-manager.ts:56:16)
      at Object.enqueue 
(src/lib/assessment/offline-queue-manager.test.ts:34:44)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ OfflineQueueManager ÔÇ║ getQueueStatus ÔÇ║ should 
return correct queue counts

    TypeError: _watermelondb.Q.lt is not a function

    [0m [90m 473 |[39m     [36mconst[39m 
conditions [33m=[39m [
     [90m 474 |[39m       [33mQ[39m[33m.[39mwhere(
[32m'status'[39m[33m,[39m status)[33m,[39m
    [31m[1m>[22m[39m[90m 475 |[39m       [33mQ[3
9m[33m.[39mwhere([32m'updated_at'[39m[33m,[39m 
[33mQ[39m[33m.[39mlt(cutoff))[33m,[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 476 |[39m     ][33m;[39m
     [90m 477 |[39m
     [90m 478 |[39m     [36mreturn[39m collection[3
3m.[39mquery([33m...[39mconditions)[33m.[39mfetch()
[33m;[39m[0m

      at OfflineQueueManager.lt 
(src/lib/assessment/offline-queue-manager.ts:475:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
fetchRecordsBefore] 
(src/lib/assessment/offline-queue-manager.ts:468:35)
      at OfflineQueueManager.fetchRecordsBefore 
(src/lib/assessment/offline-queue-manager.ts:407:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
getRetentionRemovals] 
(src/lib/assessment/offline-queue-manager.ts:399:37)
      at OfflineQueueManager.getRetentionRemovals 
(src/lib/assessment/offline-queue-manager.ts:366:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
cleanupStoragePolicy] 
(src/lib/assessment/offline-queue-manager.ts:358:37)
      at OfflineQueueManager.cleanupStoragePolicy 
(src/lib/assessment/offline-queue-manager.ts:64:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as enqueue] 
(src/lib/assessment/offline-queue-manager.ts:56:16)
      at Object.enqueue 
(src/lib/assessment/offline-queue-manager.test.ts:63:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ OfflineQueueManager ÔÇ║ getQueueStatus ÔÇ║ should 
count processing requests

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 1
    Received: 0

    [0m [90m 104 |[39m       [36mconst[39m status 
[33m=[39m [36mawait[39m 
queueManager[33m.[39mgetQueueStatus()[33m;[39m
     [90m 105 |[39m
    [31m[1m>[22m[39m[90m 106 |[39m       expect(st
atus[33m.[39mprocessing)[33m.[39mtoBe([35m1[39m)[
33m;[39m
     [90m     |[39m                                 
[31m[1m^[22m[39m
     [90m 107 |[39m     })[33m;[39m
     [90m 108 |[39m   })[33m;[39m
     [90m 109 |[39m[0m

      at Object.toBe (src/lib/assessment/offline-queue-m
anager.test.ts:106:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OfflineQueueManager ÔÇ║ processQueue ÔÇ║ should 
not process when offline

    TypeError: _watermelondb.Q.lt is not a function

    [0m [90m 473 |[39m     [36mconst[39m 
conditions [33m=[39m [
     [90m 474 |[39m       [33mQ[39m[33m.[39mwhere(
[32m'status'[39m[33m,[39m status)[33m,[39m
    [31m[1m>[22m[39m[90m 475 |[39m       [33mQ[3
9m[33m.[39mwhere([32m'updated_at'[39m[33m,[39m 
[33mQ[39m[33m.[39mlt(cutoff))[33m,[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 476 |[39m     ][33m;[39m
     [90m 477 |[39m
     [90m 478 |[39m     [36mreturn[39m collection[3
3m.[39mquery([33m...[39mconditions)[33m.[39mfetch()
[33m;[39m[0m

      at OfflineQueueManager.lt 
(src/lib/assessment/offline-queue-manager.ts:475:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
fetchRecordsBefore] 
(src/lib/assessment/offline-queue-manager.ts:468:35)
      at OfflineQueueManager.fetchRecordsBefore 
(src/lib/assessment/offline-queue-manager.ts:407:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
getRetentionRemovals] 
(src/lib/assessment/offline-queue-manager.ts:399:37)
      at OfflineQueueManager.getRetentionRemovals 
(src/lib/assessment/offline-queue-manager.ts:366:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
cleanupStoragePolicy] 
(src/lib/assessment/offline-queue-manager.ts:358:37)
      at OfflineQueueManager.cleanupStoragePolicy 
(src/lib/assessment/offline-queue-manager.ts:64:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as enqueue] 
(src/lib/assessment/offline-queue-manager.ts:56:16)
      at Object.enqueue (src/lib/assessment/offline-queu
e-manager.test.ts:114:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ OfflineQueueManager ÔÇ║ processQueue ÔÇ║ should 
process pending requests when online

    TypeError: _watermelondb.Q.lt is not a function

    [0m [90m 473 |[39m     [36mconst[39m 
conditions [33m=[39m [
     [90m 474 |[39m       [33mQ[39m[33m.[39mwhere(
[32m'status'[39m[33m,[39m status)[33m,[39m
    [31m[1m>[22m[39m[90m 475 |[39m       [33mQ[3
9m[33m.[39mwhere([32m'updated_at'[39m[33m,[39m 
[33mQ[39m[33m.[39mlt(cutoff))[33m,[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 476 |[39m     ][33m;[39m
     [90m 477 |[39m
     [90m 478 |[39m     [36mreturn[39m collection[3
3m.[39mquery([33m...[39mconditions)[33m.[39mfetch()
[33m;[39m[0m

      at OfflineQueueManager.lt 
(src/lib/assessment/offline-queue-manager.ts:475:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
fetchRecordsBefore] 
(src/lib/assessment/offline-queue-manager.ts:468:35)
      at OfflineQueueManager.fetchRecordsBefore 
(src/lib/assessment/offline-queue-manager.ts:407:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
getRetentionRemovals] 
(src/lib/assessment/offline-queue-manager.ts:399:37)
      at OfflineQueueManager.getRetentionRemovals 
(src/lib/assessment/offline-queue-manager.ts:366:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
cleanupStoragePolicy] 
(src/lib/assessment/offline-queue-manager.ts:358:37)
      at OfflineQueueManager.cleanupStoragePolicy 
(src/lib/assessment/offline-queue-manager.ts:64:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as enqueue] 
(src/lib/assessment/offline-queue-manager.ts:56:16)
      at Object.enqueue (src/lib/assessment/offline-queu
e-manager.test.ts:129:44)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ OfflineQueueManager ÔÇ║ processQueue ÔÇ║ should 
skip requests that exceeded max retries

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 163 |[39m       [36mconst[39m results 
[33m=[39m [36mawait[39m 
queueManager[33m.[39mprocessQueue()[33m;[39m
     [90m 164 |[39m
    [31m[1m>[22m[39m[90m 165 |[39m       expect(re
sults)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 166 |[39m       expect(results[[35m0[39m]
[33m?[39m[33m.[39msuccess)[33m.[39mtoBe([36mfalse
[39m)[33m;[39m
     [90m 167 |[39m       expect(results[[35m0[39m]
[33m?[39m[33m.[39merror)[33m.[39mtoBe([32m'Max 
retries exceeded'[39m)[33m;[39m
     [90m 168 |[39m     })[33m;[39m[0m

      at Object.toHaveLength (src/lib/assessment/offline
-queue-manager.test.ts:165:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OfflineQueueManager ÔÇ║ retryFailed ÔÇ║ should 
reset failed requests to pending

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 196 |[39m         
[33m.[39mfetch()[33m;[39m
     [90m 197 |[39m
    [31m[1m>[22m[39m[90m 198 |[39m       expect(re
quests)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 199 |[39m       expect(requests[[35m0[39m]
[33m?[39m[33m.[39mnextAttemptAt)[33m.[39mtoBeUndef
ined()[33m;[39m
     [90m 200 |[39m     })[33m;[39m
     [90m 201 |[39m[0m

      at Object.toHaveLength (src/lib/assessment/offline
-queue-manager.test.ts:198:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OfflineQueueManager ÔÇ║ retryFailed ÔÇ║ should 
not retry requests that exceeded max retries

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 224 |[39m         
[33m.[39mfetch()[33m;[39m
     [90m 225 |[39m
    [31m[1m>[22m[39m[90m 226 |[39m       expect(fa
iledRequests)[33m.[39mtoHaveLength([35m1[39m)[33m;
[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 227 |[39m     })[33m;[39m
     [90m 228 |[39m   })[33m;[39m
     [90m 229 |[39m[0m

      at Object.toHaveLength (src/lib/assessment/offline
-queue-manager.test.ts:226:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OfflineQueueManager ÔÇ║ clearCompleted ÔÇ║ should 
have clearCompleted method

    TypeError: _watermelondb.Q.lt is not a function

    [0m [90m 290 |[39m       [33m.[39mquery(
     [90m 291 |[39m         [33mQ[39m[33m.[39mwher
e([32m'status'[39m[33m,[39m 
[32m'completed'[39m)[33m,[39m
    [31m[1m>[22m[39m[90m 292 |[39m         [33mQ
[39m[33m.[39mwhere([32m'updated_at'[39m[33m,[39m 
[33mQ[39m[33m.[39mlt(cutoffTime))
     [90m     |[39m                                 
[31m[1m^[22m[39m
     [90m 293 |[39m       )
     [90m 294 |[39m       
[33m.[39mfetch()[33m;[39m
     [90m 295 |[39m[0m

      at OfflineQueueManager.lt 
(src/lib/assessment/offline-queue-manager.ts:292:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as clearCompleted] 
(src/lib/assessment/offline-queue-manager.ts:282:23)
      at Object.clearCompleted (src/lib/assessment/offli
ne-queue-manager.test.ts:234:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ OfflineQueueManager ÔÇ║ cancelRequest ÔÇ║ should 
cancel a pending request

    TypeError: _watermelondb.Q.lt is not a function

    [0m [90m 473 |[39m     [36mconst[39m 
conditions [33m=[39m [
     [90m 474 |[39m       [33mQ[39m[33m.[39mwhere(
[32m'status'[39m[33m,[39m status)[33m,[39m
    [31m[1m>[22m[39m[90m 475 |[39m       [33mQ[3
9m[33m.[39mwhere([32m'updated_at'[39m[33m,[39m 
[33mQ[39m[33m.[39mlt(cutoff))[33m,[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 476 |[39m     ][33m;[39m
     [90m 477 |[39m
     [90m 478 |[39m     [36mreturn[39m collection[3
3m.[39mquery([33m...[39mconditions)[33m.[39mfetch()
[33m;[39m[0m

      at OfflineQueueManager.lt 
(src/lib/assessment/offline-queue-manager.ts:475:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
fetchRecordsBefore] 
(src/lib/assessment/offline-queue-manager.ts:468:35)
      at OfflineQueueManager.fetchRecordsBefore 
(src/lib/assessment/offline-queue-manager.ts:407:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
getRetentionRemovals] 
(src/lib/assessment/offline-queue-manager.ts:399:37)
      at OfflineQueueManager.getRetentionRemovals 
(src/lib/assessment/offline-queue-manager.ts:366:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
cleanupStoragePolicy] 
(src/lib/assessment/offline-queue-manager.ts:358:37)
      at OfflineQueueManager.cleanupStoragePolicy 
(src/lib/assessment/offline-queue-manager.ts:64:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as enqueue] 
(src/lib/assessment/offline-queue-manager.ts:56:16)
      at Object.enqueue (src/lib/assessment/offline-queu
e-manager.test.ts:243:44)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/moderation/__tests__/age-verification-secur
ity.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

  ÔùÅ Age Verification Security Tests ÔÇ║ No Raw ID 
Persistence (Blueprint Compliance) ÔÇ║ should not store 
raw ID data after verification

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:35:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ No Raw ID 
Persistence (Blueprint Compliance) ÔÇ║ should only 
store age verification status and token hash

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:64:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ No Raw ID 
Persistence (Blueprint Compliance) ÔÇ║ should reject 
verification attempts with raw ID data

    expect(received).rejects.toThrow(expected)

    Expected pattern: /raw ID data not allowed/i
    Received message: "Cannot read properties of 
undefined (reading 'over18')"

        [0m [90m 67 |[39m
         [90m 68 |[39m     [90m// Validate age 
attribute[39m
        [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
         [90m    |[39m                       
[31m[1m^[22m[39m
         [90m 70 |[39m       [36mawait[39m [36mthis
[39m[33m.[39mauditService[33m.[39mlogTokenEvent({
         [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
         [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:95:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/moderation/__tests__/ag
e-verification-security.test.ts:96:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Token 
Security (HMAC-SHA256) ÔÇ║ should hash tokens with 
HMAC-SHA256

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:109:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Token 
Security (HMAC-SHA256) ÔÇ║ should use 
environment-specific salt for token hashing

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:135:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Token 
Security (HMAC-SHA256) ÔÇ║ should generate 
cryptographically secure random tokens

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:160:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Replay Attack 
Prevention ÔÇ║ should prevent token reuse after first 
validation

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:187:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Replay Attack 
Prevention ÔÇ║ should track token use count

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:214:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Replay Attack 
Prevention ÔÇ║ should log suspicious replay attempts

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:238:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Replay Attack 
Prevention ÔÇ║ should expire tokens after configured 
duration

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:271:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Suspicious 
Activity Detection (ePrivacy 5(3) Compliance) ÔÇ║ 
should detect suspicious activity only with consent

    TypeError: Cannot read properties of undefined 
(reading 'rapidAccountCreation')

    [0m [90m 120 |[39m     [90m// Filter signals 
based on consent (ePrivacy 5(3) compliance)[39m
     [90m 121 |[39m     [36mconst[39m 
allowedSignals [33m=[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
rapidAccountCreation[33m:[39m 
signals[33m.[39mrapidAccountCreation[33m,[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 123 |[39m       
multipleFailedVerifications[33m:[39m 
signals[33m.[39mmultipleFailedVerifications[33m,[39m
     [90m 124 |[39m       
unusualAccessPattern[33m:[39m 
signals[33m.[39munusualAccessPattern[33m,[39m
     [90m 125 |[39m       vpnDetected[33m:[39m 
signals[33m.[39mvpnDetected[33m,[39m[0m

      at AgeVerificationService.rapidAccountCreation 
(src/lib/moderation/age-verification-service.ts:122:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
detectSuspiciousActivity] 
(src/lib/moderation/age-verification-service.ts:115:33)
      at Object.detectSuspiciousActivity (src/lib/modera
tion/__tests__/age-verification-security.test.ts:298:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Suspicious 
Activity Detection (ePrivacy 5(3) Compliance) ÔÇ║ 
should not store device fingerprints without consent

    TypeError: Cannot read properties of undefined 
(reading 'rapidAccountCreation')

    [0m [90m 120 |[39m     [90m// Filter signals 
based on consent (ePrivacy 5(3) compliance)[39m
     [90m 121 |[39m     [36mconst[39m 
allowedSignals [33m=[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
rapidAccountCreation[33m:[39m 
signals[33m.[39mrapidAccountCreation[33m,[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 123 |[39m       
multipleFailedVerifications[33m:[39m 
signals[33m.[39mmultipleFailedVerifications[33m,[39m
     [90m 124 |[39m       
unusualAccessPattern[33m:[39m 
signals[33m.[39munusualAccessPattern[33m,[39m
     [90m 125 |[39m       vpnDetected[33m:[39m 
signals[33m.[39mvpnDetected[33m,[39m[0m

      at AgeVerificationService.rapidAccountCreation 
(src/lib/moderation/age-verification-service.ts:122:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
detectSuspiciousActivity] 
(src/lib/moderation/age-verification-service.ts:115:33)
      at Object.detectSuspiciousActivity (src/lib/modera
tion/__tests__/age-verification-security.test.ts:329:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Suspicious 
Activity Detection (ePrivacy 5(3) Compliance) ÔÇ║ 
should detect rapid verification attempts without 
fingerprinting

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:354:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Suspicious 
Activity Detection (ePrivacy 5(3) Compliance) ÔÇ║ 
should require explicit consent for GPS-based location 
checks

    TypeError: 
ageVerificationService.verifyLocationBasedAge is not a 
function

    [0m [90m 375 |[39m       [90m// Without 
consent: should not use GPS[39m
     [90m 376 |[39m       [36mawait[39m expect(
    [31m[1m>[22m[39m[90m 377 |[39m         ageVeri
ficationService[33m.[39mverifyLocationBasedAge(userId
[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 378 |[39m           useGPS[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 379 |[39m           hasConsent[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 380 |[39m         })[0m

      at Object.verifyLocationBasedAge (src/lib/moderati
on/__tests__/age-verification-security.test.ts:377:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ EUDI Wallet 
Integration (Blueprint Compliance) ÔÇ║ should accept 
EUDI wallet age attributes

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:408:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ EUDI Wallet 
Integration (Blueprint Compliance) ÔÇ║ should validate 
EUDI wallet signatures

    expect(received).rejects.toThrow(expected)

    Expected pattern: /invalid EUDI wallet signature/i
    Received message: "Cannot read properties of 
undefined (reading 'over18')"

        [0m [90m 67 |[39m
         [90m 68 |[39m     [90m// Validate age 
attribute[39m
        [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
         [90m    |[39m                       
[31m[1m^[22m[39m
         [90m 70 |[39m       [36mawait[39m [36mthis
[39m[33m.[39mauditService[33m.[39mlogTokenEvent({
         [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
         [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:427:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/moderation/__tests__/ag
e-verification-security.test.ts:428:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ EUDI Wallet 
Integration (Blueprint Compliance) ÔÇ║ should support 
multiple verification methods

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:442:52)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Appeal Window 
Configuration ÔÇ║ should allow users to appeal age 
verification decisions

    TypeError: 
ageVerificationService.recordVerificationFailure is not 
a function

    [0m [90m 463 |[39m
     [90m 464 |[39m       [90m// Simulate failed 
verification[39m
    [31m[1m>[22m[39m[90m 465 |[39m       
[36mawait[39m ageVerificationService[33m.[39mrecordV
erificationFailure(userId[33m,[39m {
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 466 |[39m         reason[33m:[39m 
[32m'Attribute verification failed'[39m[33m,[39m
     [90m 467 |[39m         canAppeal[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 468 |[39m       })[33m;[39m[0m

      at Object.recordVerificationFailure (src/lib/moder
ation/__tests__/age-verification-security.test.ts:465:36
)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ 
Privacy-by-Design Principles ÔÇ║ should implement data 
minimization for age verification

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:499:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ 
Privacy-by-Design Principles ÔÇ║ should auto-delete 
expired verification tokens

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:534:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ 
Privacy-by-Design Principles ÔÇ║ should retain audit 
logs per retention policy

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:565:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Safer 
Defaults for Minors ÔÇ║ should assume minor status 
until verified

    TypeError: Cannot read properties of null (reading 
'isVerified')

    [0m [90m 590 |[39m       [36mconst[39m 
ageStatus [33m=[39m [36mawait[39m ageVerificationSer
vice[33m.[39mgetUserAgeStatus(userId)[33m;[39m
     [90m 591 |[39m
    [31m[1m>[22m[39m[90m 592 |[39m       expect(ag
eStatus[33m.[39misVerified)[33m.[39mtoBe([36mfalse
[39m)[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 593 |[39m       expect(ageStatus[33m.[39ma
ssumedMinor)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 594 |[39m       expect(ageStatus[33m.[39mc
anAccessAgeRestrictedContent)[33m.[39mtoBe([36mfalse
[39m)[33m;[39m
     [90m 595 |[39m     })[33m;[39m[0m

      at Object.isVerified (src/lib/moderation/__tests__
/age-verification-security.test.ts:592:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Age Verification Security Tests ÔÇ║ Safer 
Defaults for Minors ÔÇ║ should apply stricter content 
filtering for unverified users

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: undefined

    [0m [90m 604 |[39m       )[33m;[39m
     [90m 605 |[39m
    [31m[1m>[22m[39m[90m 606 |[39m       expect(ac
cessResult[33m.[39mallowed)[33m.[39mtoBe([36mfalse
[39m)[33m;[39m
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 607 |[39m       expect(accessResult[33m.[3
9mreason)[33m.[39mtoContain([32m'age_verification_req
uired'[39m)[33m;[39m
     [90m 608 |[39m       expect(accessResult[33m.[3
9msaferDefaultsApplied)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m 609 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/moderation/__tests__/age-v
erification-security.test.ts:606:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/api/posts/use-add-post.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ handles 
prefill attachments without metadata

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:76:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ handles 
attachments with complete metadata

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:106:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ handles 
Supabase attachments with incomplete metadata by 
falling back to download

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:130:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ handles 
non-Supabase URLs with incomplete metadata

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:160:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ extracts 
storage path from signed URL

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:190:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ extracts 
storage path from public URL

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:220:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ uses original 
path as fallback when variant paths are missing

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:275:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/nutrient-engine/services/alert-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ evaluateAndTriggerAlert ÔÇ║ triggers alert for pH 
out of range with persistence

    TypeError: Cannot read properties of undefined 
(reading 'getTime')

    [0m [90m 353 |[39m     note[33m:[39m 
model[33m.[39mnote[33m,[39m
     [90m 354 |[39m     qualityFlags[33m:[39m 
model[33m.[39mqualityFlags[33m,[39m
    [31m[1m>[22m[39m[90m 355 |[39m     
createdAt[33m:[39m 
model[33m.[39mcreatedAt[33m.[39mgetTime()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 356 |[39m     updatedAt[33m:[39m 
model[33m.[39mupdatedAt[33m.[39mgetTime()[33m,[39m
     [90m 357 |[39m   }[33m;[39m
     [90m 358 |[39m }[0m

      at getTime (src/lib/nutrient-engine/services/alert
-service.ts:355:32)
      at modelToReading (src/lib/nutrient-engine/service
s/alert-service.ts:60:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ evaluateAndTriggerAlert ÔÇ║ triggers alert for pH 
out of range with persistence

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ evaluateAndTriggerAlert ÔÇ║ does not trigger 
alert for reading within range

    TypeError: Cannot read properties of undefined 
(reading 'getTime')

    [0m [90m 353 |[39m     note[33m:[39m 
model[33m.[39mnote[33m,[39m
     [90m 354 |[39m     qualityFlags[33m:[39m 
model[33m.[39mqualityFlags[33m,[39m
    [31m[1m>[22m[39m[90m 355 |[39m     
createdAt[33m:[39m 
model[33m.[39mcreatedAt[33m.[39mgetTime()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 356 |[39m     updatedAt[33m:[39m 
model[33m.[39mupdatedAt[33m.[39mgetTime()[33m,[39m
     [90m 357 |[39m   }[33m;[39m
     [90m 358 |[39m }[0m

      at getTime (src/lib/nutrient-engine/services/alert
-service.ts:355:32)
      at modelToReading (src/lib/nutrient-engine/service
s/alert-service.ts:60:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ evaluateAndTriggerAlert ÔÇ║ does not trigger 
alert for reading within range

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ evaluateAndTriggerAlert ÔÇ║ does not trigger 
alert without persistence

    TypeError: Cannot read properties of undefined 
(reading 'getTime')

    [0m [90m 353 |[39m     note[33m:[39m 
model[33m.[39mnote[33m,[39m
     [90m 354 |[39m     qualityFlags[33m:[39m 
model[33m.[39mqualityFlags[33m,[39m
    [31m[1m>[22m[39m[90m 355 |[39m     
createdAt[33m:[39m 
model[33m.[39mcreatedAt[33m.[39mgetTime()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 356 |[39m     updatedAt[33m:[39m 
model[33m.[39mupdatedAt[33m.[39mgetTime()[33m,[39m
     [90m 357 |[39m   }[33m;[39m
     [90m 358 |[39m }[0m

      at getTime (src/lib/nutrient-engine/services/alert
-service.ts:355:32)
      at modelToReading (src/lib/nutrient-engine/service
s/alert-service.ts:60:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ evaluateAndTriggerAlert ÔÇ║ does not trigger 
alert without persistence

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ createAlert ÔÇ║ creates alert with all required 
fields

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "mock-id"
    Received: undefined

    [0m [90m 203 |[39m     [36mconst[39m alert 
[33m=[39m [36mawait[39m 
createAlert(alertData[33m,[39m 
[32m'user123'[39m)[33m;[39m
     [90m 204 |[39m
    [31m[1m>[22m[39m[90m 205 |[39m     expect(aler
t[33m.[39mreadingId)[33m.[39mtoBe(reading[33m.[39m
id)[33m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 206 |[39m     expect(alert[33m.[39mtype)[
33m.[39mtoBe([32m'ph_high'[39m)[33m;[39m
     [90m 207 |[39m     expect(alert[33m.[39muserId)
[33m.[39mtoBe([32m'user123'[39m)[33m;[39m
     [90m 208 |[39m[0m

      at Object.toBe (src/lib/nutrient-engine/services/a
lert-service.test.ts:205:29)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ createAlert ÔÇ║ creates alert with all required 
fields

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ acknowledgeAlert ÔÇ║ sets acknowledgedAt timestamp

    TypeError: alert.acknowledge is not a function

    [0m [90m 148 |[39m     
[33m.[39mfind(alertId)[33m;[39m
     [90m 149 |[39m
    [31m[1m>[22m[39m[90m 150 |[39m   
[36mawait[39m alert[33m.[39macknowledge()[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 151 |[39m   [36mreturn[39m 
alert[33m;[39m
     [90m 152 |[39m }
     [90m 153 |[39m[0m

      at acknowledge (src/lib/nutrient-engine/services/a
lert-service.ts:150:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ acknowledgeAlert ÔÇ║ sets acknowledgedAt timestamp

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ resolveAlert ÔÇ║ sets resolvedAt timestamp

    TypeError: alert.resolve is not a function

    [0m [90m 164 |[39m     
[33m.[39mfind(alertId)[33m;[39m
     [90m 165 |[39m
    [31m[1m>[22m[39m[90m 166 |[39m   
[36mawait[39m alert[33m.[39mresolve()[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 167 |[39m   [36mreturn[39m 
alert[33m;[39m
     [90m 168 |[39m }
     [90m 169 |[39m[0m

      at resolve (src/lib/nutrient-engine/services/alert
-service.ts:166:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ resolveAlert ÔÇ║ sets resolvedAt timestamp

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ markAlertDeliveredLocally ÔÇ║ sets 
deliveredAtLocal timestamp

    TypeError: alert.markDeliveredLocally is not a 
function

    [0m [90m 179 |[39m     
[33m.[39mfind(alertId)[33m;[39m
     [90m 180 |[39m
    [31m[1m>[22m[39m[90m 181 |[39m   
[36mawait[39m 
alert[33m.[39mmarkDeliveredLocally()[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 182 |[39m   [36mreturn[39m 
alert[33m;[39m
     [90m 183 |[39m }
     [90m 184 |[39m[0m

      at markDeliveredLocally (src/lib/nutrient-engine/s
ervices/alert-service.ts:181:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ markAlertDeliveredLocally ÔÇ║ sets 
deliveredAtLocal timestamp

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ getActiveAlerts ÔÇ║ returns unresolved alerts for 
reservoir

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 1
    Received: 0

    [0m [90m 331 |[39m     [36mconst[39m active 
[33m=[39m [36mawait[39m 
getActiveAlerts(reservoir[33m.[39mid)[33m;[39m
     [90m 332 |[39m
    [31m[1m>[22m[39m[90m 333 |[39m     expect(acti
ve[33m.[39mlength)[33m.[39mtoBe([35m1[39m)[33m;[
39m
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 334 |[39m     expect(active[[35m0[39m][33
m.[39mid)[33m.[39mtoBe(activeAlert[33m.[39mid)[33m
;[39m
     [90m 335 |[39m     expect(active[[35m0[39m][33
m.[39mtype)[33m.[39mtoBe([32m'ph_high'[39m)[33m;[
39m
     [90m 336 |[39m[0m

      at Object.toBe (src/lib/nutrient-engine/services/a
lert-service.test.ts:333:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ getActiveAlerts ÔÇ║ returns unresolved alerts for 
reservoir

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ getActiveAlerts ÔÇ║ returns empty array for 
reservoir with no alerts

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ getAlertHistory ÔÇ║ returns alerts within time 
period

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

    [0m [90m 366 |[39m     [36mconst[39m history 
[33m=[39m [36mawait[39m 
getAlertHistory(reservoir[33m.[39mid[33m,[39m 
[35m7[39m)[33m;[39m
     [90m 367 |[39m
    [31m[1m>[22m[39m[90m 368 |[39m     expect(hist
ory[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[
39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 369 |[39m     
expect(history[33m.[39mfind((a) [33m=>[39m 
a[33m.[39mid [33m===[39m recentAlert[33m.[39mid))
[33m.[39mtoBeTruthy()[33m;[39m
     [90m 370 |[39m
     [90m 371 |[39m     [90m// Cleanup[39m[0m

      at Object.toBeGreaterThan (src/lib/nutrient-engine
/services/alert-service.test.ts:368:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ getAlertHistory ÔÇ║ returns alerts within time 
period

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ getUnacknowledgedAlerts ÔÇ║ returns all 
unacknowledged alerts

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

    [0m [90m 402 |[39m     [36mconst[39m results 
[33m=[39m [36mawait[39m 
getUnacknowledgedAlerts()[33m;[39m
     [90m 403 |[39m
    [31m[1m>[22m[39m[90m 404 |[39m     expect(resu
lts[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[
39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 405 |[39m     
expect(results[33m.[39mfind((a) [33m=>[39m 
a[33m.[39mid [33m===[39m unacknowledged[33m.[39mid
))[33m.[39mtoBeTruthy()[33m;[39m
     [90m 406 |[39m     
expect(results[33m.[39mfind((a) [33m=>[39m 
a[33m.[39mid [33m===[39m acknowledged[33m.[39mid))
[33m.[39mtoBeUndefined()[33m;[39m
     [90m 407 |[39m[0m

      at Object.toBeGreaterThan (src/lib/nutrient-engine
/services/alert-service.test.ts:404:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ getUnacknowledgedAlerts ÔÇ║ returns all 
unacknowledged alerts

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ getOfflineAlerts ÔÇ║ returns alerts delivered 
offline

    expect(received).toBeTruthy()

    Received: undefined

    [0m [90m 440 |[39m     [36mconst[39m offline 
[33m=[39m [36mawait[39m 
getOfflineAlerts()[33m;[39m
     [90m 441 |[39m
    [31m[1m>[22m[39m[90m 442 |[39m     
expect(offline[33m.[39mfind((a) [33m=>[39m 
a[33m.[39mid [33m===[39m offlineAlert[33m.[39mid))
[33m.[39mtoBeTruthy()[33m;[39m
     [90m     |[39m                                   
                        [31m[1m^[22m[39m
     [90m 443 |[39m     
expect(offline[33m.[39mfind((a) [33m=>[39m 
a[33m.[39mid [33m===[39m onlineAlert[33m.[39mid))
[33m.[39mtoBeUndefined()[33m;[39m
     [90m 444 |[39m
     [90m 445 |[39m     [90m// Cleanup[39m[0m

      at Object.toBeTruthy (src/lib/nutrient-engine/serv
ices/alert-service.test.ts:442:59)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ getOfflineAlerts ÔÇ║ returns alerts delivered 
offline

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ observeActiveAlerts ÔÇ║ returns observable that 
filters by reservoir ID

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/uploads/__tests__/harvest-photo-cleanup.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Failed to cleanup deleted harvest photos: Error: 
Database connection failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\uploads\__tests__\harvest-photo-cleanup.test.ts:
202:15)
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:397:39
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\jest-mock\build\index.js:404:13)
          at Object.mockConstructor [as query] (C:\Users
\Peter\GrowBro\node_modules\jest-mock\build\index.js:148
:19)
          at query (C:\Users\Peter\GrowBro\src\lib\uploa
ds\harvest-photo-cleanup.ts:103:8)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\uploa
ds\harvest-photo-cleanup.ts:91:50)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\uploads\__tests__\harvest-photo-cleanup.test.ts:
207:53)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 122 |[39m     [36mreturn[39m 
result[33m;[39m
     [90m 123 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 124 |[39m     
console[33m.[39merror([32m'Failed to cleanup deleted 
harvest photos:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 125 |[39m     [36mreturn[39m 
result[33m;[39m
     [90m 126 |[39m   }
     [90m 127 |[39m }[0m

      at error 
(src/lib/uploads/harvest-photo-cleanup.ts:124:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/uploads/harvest-photo-cleanup.ts:91:50)
      at Object.<anonymous> (src/lib/uploads/__tests__/h
arvest-photo-cleanup.test.ts:207:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to cleanup photos for harvest 
nonexistent-harvest: Error: Harvest not found
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\uploads\__tests__\harvest-photo-cleanup.test.ts:
280:41)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 144 |[39m     [36mreturn[39m 
[36mawait[39m deleteRemotePhotos(harvestId[33m,[39m 
remotePaths)[33m;[39m
     [90m 145 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 146 |[39m     
console[33m.[39merror([32m`Failed to cleanup photos 
for harvest ${harvestId}:`[39m[33m,[39m 
error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 147 |[39m     [36mreturn[39m 
[35m0[39m[33m;[39m
     [90m 148 |[39m   }
     [90m 149 |[39m }[0m

      at error 
(src/lib/uploads/harvest-photo-cleanup.ts:146:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ cleanupDeletedHarvestPhotos ÔÇ║ should cleanup 
photos from soft-deleted harvests

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 3
    Received: 0

    [0m [90m 94 |[39m     [90m// Verify results[39m
     [90m 95 |[39m     expect(result[33m.[39mharvest
sProcessed)[33m.[39mtoBe([35m2[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 96 |[39m     expect(resul
t[33m.[39mphotosDeleted)[33m.[39mtoBe([35m3[39m)[
33m;[39m [90m// 2 + 1 photos[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 97 |[39m     expect(result[33m.[39merrors)
[33m.[39mtoBe([35m0[39m)[33m;[39m
     [90m 98 |[39m
     [90m 99 |[39m     [90m// Verify storage 
calls[39m[0m

      at Object.toBe (src/lib/uploads/__tests__/harvest-
photo-cleanup.test.ts:96:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ cleanupHarvestPhotos ÔÇ║ should cleanup photos 
for specific harvest

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 2
    Received: 0

    [0m [90m 249 |[39m     [36mconst[39m 
deletedCount [33m=[39m [36mawait[39m 
cleanupHarvestPhotos([32m'harvest-1'[39m)[33m;[39m
     [90m 250 |[39m
    [31m[1m>[22m[39m[90m 251 |[39m     expect(dele
tedCount)[33m.[39mtoBe([35m2[39m)[33m;[39m
     [90m     |[39m                          
[31m[1m^[22m[39m
     [90m 252 |[39m     expect(supabase[33m.[39mstor
age[33m.[39m[36mfrom[39m)[33m.[39mtoHaveBeenCalled
With([32m'harvest-photos'[39m)[33m;[39m
     [90m 253 |[39m     
expect(mockRemove)[33m.[39mtoHaveBeenCalledWith([
     [90m 254 |[39m       [32m'user123/harvest-1/phot
o1_original.jpg'[39m[33m,[39m[0m

      at Object.toBe (src/lib/uploads/__tests__/harvest-
photo-cleanup.test.ts:251:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ cleanupHarvestPhotos ÔÇ║ should strip bucket 
prefix from remote paths

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: ["user123/harvest-1/photo1.jpg"]

    Number of calls: 0

    [0m [90m 308 |[39m
     [90m 309 |[39m     [90m// Should strip 
'harvest-photos/' prefix[39m
    [31m[1m>[22m[39m[90m 310 |[39m     expect(mock
Remove)[33m.[39mtoHaveBeenCalledWith([[32m'user123/ha
rvest-1/photo1.jpg'[39m])[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 311 |[39m   })[33m;[39m
     [90m 312 |[39m })[33m;[39m
     [90m 313 |[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/uploads/__
tests__/harvest-photo-cleanup.test.ts:310:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/moderation/__tests__/eprivacy-compliance.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should use IP 
geolocation by default without consent

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 32 |[39m       [36mconst[39m userId 
[33m=[39m [32m'user-ip-default'[39m[33m;[39m
     [90m 33 |[39m
    [31m[1m>[22m[39m[90m 34 |[39m       
[36mconst[39m location [33m=[39m [36mawait[39m geo
LocationService[33m.[39mdetectUserLocation(userId[33m
,[39m {
     [90m    |[39m                                    
             [31m[1m^[22m[39m
     [90m 35 |[39m         method[33m:[39m 
[32m'ip'[39m[33m,[39m
     [90m 36 |[39m         requireConsent[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 37 |[39m       })[33m;[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:34:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should require 
explicit consent for GPS location

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 46 |[39m
     [90m 47 |[39m       [36mawait[39m expect(
    [31m[1m>[22m[39m[90m 48 |[39m         geoLocat
ionService[33m.[39mdetectUserLocation(userId[33m,[39
m {
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 49 |[39m           method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 50 |[39m           
requireConsent[33m:[39m [36mtrue[39m[33m,[39m
     [90m 51 |[39m           hasConsent[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:48:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should allow GPS 
location with explicit consent

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 69 |[39m         
[33m.[39mmockResolvedValue(mockGPSLocation 
[36mas[39m any)[33m;[39m
     [90m 70 |[39m
    [31m[1m>[22m[39m[90m 71 |[39m       
[36mconst[39m location [33m=[39m [36mawait[39m geo
LocationService[33m.[39mdetectUserLocation(userId[33m
,[39m {
     [90m    |[39m                                    
             [31m[1m^[22m[39m
     [90m 72 |[39m         method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 73 |[39m         requireConsent[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 74 |[39m         hasConsent[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:71:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should record consent 
for GPS location access

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 92 |[39m       } [36mas[39m 
any)[33m;[39m
     [90m 93 |[39m
    [31m[1m>[22m[39m[90m 94 |[39m       
[36mawait[39m geoLocationService[33m.[39mdetectUserL
ocation(userId[33m,[39m {
     [90m    |[39m                                
[31m[1m^[22m[39m
     [90m 95 |[39m         method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 96 |[39m         requireConsent[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 97 |[39m         hasConsent[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:94:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should provide clear 
user benefit explanation for GPS request

    TypeError: geoLocationService.requestGPSConsent is 
not a function

    [0m [90m 118 |[39m       [36mconst[39m userId 
[33m=[39m [32m'user-gps-benefit'[39m[33m;[39m
     [90m 119 |[39m
    [31m[1m>[22m[39m[90m 120 |[39m       
[36mconst[39m consentRequest [33m=[39m 
[36mawait[39m 
geoLocationService[33m.[39mrequestGPSConsent(
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 121 |[39m         userId[33m,[39m
     [90m 122 |[39m         {
     [90m 123 |[39m           purpose[33m:[39m 
[32m'Accurate geo-restriction for legal 
compliance'[39m[33m,[39m[0m

      at Object.requestGPSConsent (src/lib/moderation/__
tests__/eprivacy-compliance.test.ts:120:55)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should fall back to IP 
geolocation when GPS consent denied

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 135 |[39m       [36mconst[39m userId 
[33m=[39m 
[32m'user-gps-denied-fallback'[39m[33m;[39m
     [90m 136 |[39m
    [31m[1m>[22m[39m[90m 137 |[39m       
[36mconst[39m location [33m=[39m [36mawait[39m geo
LocationService[33m.[39mdetectUserLocation(userId[33m
,[39m {
     [90m     |[39m                                   
              [31m[1m^[22m[39m
     [90m 138 |[39m         method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 139 |[39m         requireConsent[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 140 |[39m         hasConsent[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:137:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should allow users to 
revoke GPS consent

    TypeError: geoLocationService.grantGPSConsent is 
not a function

    [0m [90m 151 |[39m
     [90m 152 |[39m       [90m// Grant consent[39m
    [31m[1m>[22m[39m[90m 153 |[39m       
[36mawait[39m geoLocationService[33m.[39mgrantGPSCon
sent(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 154 |[39m         purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m
     [90m 155 |[39m       })[33m;[39m
     [90m 156 |[39m[0m

      at Object.grantGPSConsent (src/lib/moderation/__te
sts__/eprivacy-compliance.test.ts:153:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should not cache GPS 
location without consent

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 176 |[39m       [90m// Attempt GPS 
without consent[39m
     [90m 177 |[39m       [36mawait[39m expect(
    [31m[1m>[22m[39m[90m 178 |[39m         geoLoca
tionService[33m.[39mdetectUserLocation(userId[33m,[3
9m {
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 179 |[39m           method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 180 |[39m           
requireConsent[33m:[39m [36mtrue[39m[33m,[39m
     [90m 181 |[39m           hasConsent[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:178:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should not perform device fingerprinting without consent

    TypeError: Cannot read properties of undefined 
(reading 'rapidAccountCreation')

    [0m [90m 120 |[39m     [90m// Filter signals 
based on consent (ePrivacy 5(3) compliance)[39m
     [90m 121 |[39m     [36mconst[39m 
allowedSignals [33m=[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
rapidAccountCreation[33m:[39m 
signals[33m.[39mrapidAccountCreation[33m,[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 123 |[39m       
multipleFailedVerifications[33m:[39m 
signals[33m.[39mmultipleFailedVerifications[33m,[39m
     [90m 124 |[39m       
unusualAccessPattern[33m:[39m 
signals[33m.[39munusualAccessPattern[33m,[39m
     [90m 125 |[39m       vpnDetected[33m:[39m 
signals[33m.[39mvpnDetected[33m,[39m[0m

      at AgeVerificationService.rapidAccountCreation 
(src/lib/moderation/age-verification-service.ts:122:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
detectSuspiciousActivity] 
(src/lib/moderation/age-verification-service.ts:115:33)
      at Object.detectSuspiciousActivity (src/lib/modera
tion/__tests__/eprivacy-compliance.test.ts:201:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should allow device fingerprinting with explicit consent

    TypeError: Cannot read properties of undefined 
(reading 'rapidAccountCreation')

    [0m [90m 120 |[39m     [90m// Filter signals 
based on consent (ePrivacy 5(3) compliance)[39m
     [90m 121 |[39m     [36mconst[39m 
allowedSignals [33m=[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
rapidAccountCreation[33m:[39m 
signals[33m.[39mrapidAccountCreation[33m,[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 123 |[39m       
multipleFailedVerifications[33m:[39m 
signals[33m.[39mmultipleFailedVerifications[33m,[39m
     [90m 124 |[39m       
unusualAccessPattern[33m:[39m 
signals[33m.[39munusualAccessPattern[33m,[39m
     [90m 125 |[39m       vpnDetected[33m:[39m 
signals[33m.[39mvpnDetected[33m,[39m[0m

      at AgeVerificationService.rapidAccountCreation 
(src/lib/moderation/age-verification-service.ts:122:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
detectSuspiciousActivity] 
(src/lib/moderation/age-verification-service.ts:115:33)
      at Object.detectSuspiciousActivity (src/lib/modera
tion/__tests__/eprivacy-compliance.test.ts:217:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should not store device fingerprints without consent

    TypeError: Cannot read properties of undefined 
(reading 'rapidAccountCreation')

    [0m [90m 120 |[39m     [90m// Filter signals 
based on consent (ePrivacy 5(3) compliance)[39m
     [90m 121 |[39m     [36mconst[39m 
allowedSignals [33m=[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
rapidAccountCreation[33m:[39m 
signals[33m.[39mrapidAccountCreation[33m,[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 123 |[39m       
multipleFailedVerifications[33m:[39m 
signals[33m.[39mmultipleFailedVerifications[33m,[39m
     [90m 124 |[39m       
unusualAccessPattern[33m:[39m 
signals[33m.[39munusualAccessPattern[33m,[39m
     [90m 125 |[39m       vpnDetected[33m:[39m 
signals[33m.[39mvpnDetected[33m,[39m[0m

      at AgeVerificationService.rapidAccountCreation 
(src/lib/moderation/age-verification-service.ts:122:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
detectSuspiciousActivity] 
(src/lib/moderation/age-verification-service.ts:115:33)
      at Object.detectSuspiciousActivity (src/lib/modera
tion/__tests__/eprivacy-compliance.test.ts:234:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should request consent before collecting device 
identifiers

    TypeError: 
ageVerificationService.requestDeviceFingerprintConsent 
is not a function

    [0m [90m 257 |[39m
     [90m 258 |[39m       [36mconst[39m 
consentRequest [33m=[39m
    [31m[1m>[22m[39m[90m 259 |[39m         
[36mawait[39m ageVerificationService[33m.[39mrequest
DeviceFingerprintConsent(userId[33m,[39m {
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 260 |[39m           purpose[33m:[39m 
[32m'Fraud prevention and age verification 
enforcement'[39m[33m,[39m
     [90m 261 |[39m           
dataCollected[33m:[39m [
     [90m 262 |[39m             [32m'Device 
model'[39m[33m,[39m[0m

      at Object.requestDeviceFingerprintConsent (src/lib
/moderation/__tests__/eprivacy-compliance.test.ts:259:38
)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should use alternative fraud detection without 
fingerprinting

    TypeError: Cannot read properties of undefined 
(reading 'rapidAccountCreation')

    [0m [90m 120 |[39m     [90m// Filter signals 
based on consent (ePrivacy 5(3) compliance)[39m
     [90m 121 |[39m     [36mconst[39m 
allowedSignals [33m=[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
rapidAccountCreation[33m:[39m 
signals[33m.[39mrapidAccountCreation[33m,[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 123 |[39m       
multipleFailedVerifications[33m:[39m 
signals[33m.[39mmultipleFailedVerifications[33m,[39m
     [90m 124 |[39m       
unusualAccessPattern[33m:[39m 
signals[33m.[39munusualAccessPattern[33m,[39m
     [90m 125 |[39m       vpnDetected[33m:[39m 
signals[33m.[39mvpnDetected[33m,[39m[0m

      at AgeVerificationService.rapidAccountCreation 
(src/lib/moderation/age-verification-service.ts:122:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
detectSuspiciousActivity] 
(src/lib/moderation/age-verification-service.ts:115:33)
      at Object.detectSuspiciousActivity (src/lib/modera
tion/__tests__/eprivacy-compliance.test.ts:278:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should not use VPN/proxy detection without consent

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 293 |[39m       [36mconst[39m userId 
[33m=[39m [32m'user-no-vpn-detection'[39m[33m;[39m
     [90m 294 |[39m
    [31m[1m>[22m[39m[90m 295 |[39m       
[36mconst[39m location [33m=[39m [36mawait[39m geo
LocationService[33m.[39mdetectUserLocation(userId[33m
,[39m {
     [90m     |[39m                                   
              [31m[1m^[22m[39m
     [90m 296 |[39m         method[33m:[39m 
[32m'ip'[39m[33m,[39m
     [90m 297 |[39m         detectVPN[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 298 |[39m         
hasVPNDetectionConsent[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:295:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should allow VPN/proxy detection with consent

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 306 |[39m       [36mconst[39m userId 
[33m=[39m 
[32m'user-vpn-detection-consent'[39m[33m;[39m
     [90m 307 |[39m
    [31m[1m>[22m[39m[90m 308 |[39m       
[36mconst[39m location [33m=[39m [36mawait[39m geo
LocationService[33m.[39mdetectUserLocation(userId[33m
,[39m {
     [90m     |[39m                                   
              [31m[1m^[22m[39m
     [90m 309 |[39m         method[33m:[39m 
[32m'ip'[39m[33m,[39m
     [90m 310 |[39m         detectVPN[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 311 |[39m         
hasVPNDetectionConsent[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:308:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent Management 
ÔÇ║ should provide granular consent options

    TypeError: geoLocationService.getConsentOptions is 
not a function

    [0m [90m 321 |[39m       [36mconst[39m userId 
[33m=[39m [32m'user-granular-consent'[39m[33m;[39m
     [90m 322 |[39m
    [31m[1m>[22m[39m[90m 323 |[39m       
[36mconst[39m consentOptions [33m=[39m 
[36mawait[39m geoLocationService[33m.[39mgetConsentO
ptions(userId)[33m;[39m
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 324 |[39m
     [90m 325 |[39m       
expect(consentOptions)[33m.[39mtoContainEqual(
     [90m 326 |[39m         
expect[33m.[39mobjectContaining({[0m

      at Object.getConsentOptions (src/lib/moderation/__
tests__/eprivacy-compliance.test.ts:323:55)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent Management 
ÔÇ║ should allow users to grant consent selectively

    TypeError: geoLocationService.updateConsent is not 
a function

    [0m [90m 352 |[39m
     [90m 353 |[39m       [90m// Grant GPS consent 
but deny fingerprinting[39m
    [31m[1m>[22m[39m[90m 354 |[39m       
[36mawait[39m geoLocationService[33m.[39mupdateConse
nt(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 355 |[39m         gps_location[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 356 |[39m         
device_fingerprinting[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 357 |[39m         vpn_detection[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.updateConsent (src/lib/moderation/__test
s__/eprivacy-compliance.test.ts:354:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent Management 
ÔÇ║ should record consent timestamp and version

    TypeError: geoLocationService.grantGPSConsent is 
not a function

    [0m [90m 368 |[39m       [36mconst[39m userId 
[33m=[39m 
[32m'user-consent-timestamp'[39m[33m;[39m
     [90m 369 |[39m
    [31m[1m>[22m[39m[90m 370 |[39m       
[36mawait[39m geoLocationService[33m.[39mgrantGPSCon
sent(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 371 |[39m         purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m
     [90m 372 |[39m       })[33m;[39m
     [90m 373 |[39m[0m

      at Object.grantGPSConsent (src/lib/moderation/__te
sts__/eprivacy-compliance.test.ts:370:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent Management 
ÔÇ║ should allow users to withdraw consent at any time

    TypeError: geoLocationService.grantGPSConsent is 
not a function

    [0m [90m 390 |[39m
     [90m 391 |[39m       [90m// Grant consent[39m
    [31m[1m>[22m[39m[90m 392 |[39m       
[36mawait[39m geoLocationService[33m.[39mgrantGPSCon
sent(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 393 |[39m         purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m
     [90m 394 |[39m       })[33m;[39m
     [90m 395 |[39m[0m

      at Object.grantGPSConsent (src/lib/moderation/__te
sts__/eprivacy-compliance.test.ts:392:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent Management 
ÔÇ║ should stop data collection immediately after 
consent withdrawal

    TypeError: geoLocationService.grantGPSConsent is 
not a function

    [0m [90m 414 |[39m
     [90m 415 |[39m       [90m// Grant consent[39m
    [31m[1m>[22m[39m[90m 416 |[39m       
[36mawait[39m geoLocationService[33m.[39mgrantGPSCon
sent(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 417 |[39m         purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m
     [90m 418 |[39m       })[33m;[39m
     [90m 419 |[39m[0m

      at Object.grantGPSConsent (src/lib/moderation/__te
sts__/eprivacy-compliance.test.ts:416:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent UI 
Requirements ÔÇ║ should provide clear consent request 
text

    TypeError: geoLocationService.requestGPSConsent is 
not a function

    [0m [90m 447 |[39m       [36mconst[39m userId 
[33m=[39m 
[32m'user-clear-consent-text'[39m[33m;[39m
     [90m 448 |[39m
    [31m[1m>[22m[39m[90m 449 |[39m       
[36mconst[39m consentRequest [33m=[39m 
[36mawait[39m 
geoLocationService[33m.[39mrequestGPSConsent(
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 450 |[39m         userId[33m,[39m
     [90m 451 |[39m         {
     [90m 452 |[39m           purpose[33m:[39m 
[32m'Geo-restriction enforcement'[39m[33m,[39m[0m

      at Object.requestGPSConsent (src/lib/moderation/__
tests__/eprivacy-compliance.test.ts:449:55)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent UI 
Requirements ÔÇ║ should provide accept and decline 
options

    TypeError: geoLocationService.requestGPSConsent is 
not a function

    [0m [90m 463 |[39m       [36mconst[39m userId 
[33m=[39m [32m'user-accept-decline'[39m[33m;[39m
     [90m 464 |[39m
    [31m[1m>[22m[39m[90m 465 |[39m       
[36mconst[39m consentRequest [33m=[39m 
[36mawait[39m 
geoLocationService[33m.[39mrequestGPSConsent(
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 466 |[39m         userId[33m,[39m
     [90m 467 |[39m         {
     [90m 468 |[39m           purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m[0m

      at Object.requestGPSConsent (src/lib/moderation/__
tests__/eprivacy-compliance.test.ts:465:55)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent UI 
Requirements ÔÇ║ should link to privacy policy in 
consent request

    TypeError: geoLocationService.requestGPSConsent is 
not a function

    [0m [90m 478 |[39m       [36mconst[39m userId 
[33m=[39m 
[32m'user-privacy-policy-link'[39m[33m;[39m
     [90m 479 |[39m
    [31m[1m>[22m[39m[90m 480 |[39m       
[36mconst[39m consentRequest [33m=[39m 
[36mawait[39m 
geoLocationService[33m.[39mrequestGPSConsent(
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 481 |[39m         userId[33m,[39m
     [90m 482 |[39m         {
     [90m 483 |[39m           purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m[0m

      at Object.requestGPSConsent (src/lib/moderation/__
tests__/eprivacy-compliance.test.ts:480:55)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent UI 
Requirements ÔÇ║ should not use pre-ticked consent boxes

    TypeError: geoLocationService.requestGPSConsent is 
not a function

    [0m [90m 492 |[39m       [36mconst[39m userId 
[33m=[39m [32m'user-no-preticked'[39m[33m;[39m
     [90m 493 |[39m
    [31m[1m>[22m[39m[90m 494 |[39m       
[36mconst[39m consentRequest [33m=[39m 
[36mawait[39m 
geoLocationService[33m.[39mrequestGPSConsent(
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 495 |[39m         userId[33m,[39m
     [90m 496 |[39m         {
     [90m 497 |[39m           purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m[0m

      at Object.requestGPSConsent (src/lib/moderation/__
tests__/eprivacy-compliance.test.ts:494:55)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Data Minimization 
with Consent ÔÇ║ should collect minimal data even with 
consent

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 520 |[39m       } [36mas[39m 
any)[33m;[39m
     [90m 521 |[39m
    [31m[1m>[22m[39m[90m 522 |[39m       
[36mconst[39m location [33m=[39m [36mawait[39m geo
LocationService[33m.[39mdetectUserLocation(userId[33m
,[39m {
     [90m     |[39m                                   
              [31m[1m^[22m[39m
     [90m 523 |[39m         method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 524 |[39m         requireConsent[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 525 |[39m         hasConsent[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:522:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Data Minimization 
with Consent ÔÇ║ should not retain location data longer 
than necessary

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 546 |[39m       } [36mas[39m 
any)[33m;[39m
     [90m 547 |[39m
    [31m[1m>[22m[39m[90m 548 |[39m       
[36mawait[39m geoLocationService[33m.[39mdetectUserL
ocation(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 549 |[39m         method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 550 |[39m         requireConsent[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 551 |[39m         hasConsent[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:548:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Audit Logging for 
Consent ÔÇ║ should log all consent grants and 
withdrawals

    TypeError: geoLocationService.grantGPSConsent is 
not a function

    [0m [90m 577 |[39m
     [90m 578 |[39m       [90m// Grant consent[39m
    [31m[1m>[22m[39m[90m 579 |[39m       
[36mawait[39m geoLocationService[33m.[39mgrantGPSCon
sent(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 580 |[39m         purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m
     [90m 581 |[39m       })[33m;[39m
     [90m 582 |[39m[0m

      at Object.grantGPSConsent (src/lib/moderation/__te
sts__/eprivacy-compliance.test.ts:579:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Audit Logging for 
Consent ÔÇ║ should log consent version and policy 
version

    TypeError: geoLocationService.grantGPSConsent is 
not a function

    [0m [90m 598 |[39m       [36mconst[39m userId 
[33m=[39m 
[32m'user-consent-version-audit'[39m[33m;[39m
     [90m 599 |[39m
    [31m[1m>[22m[39m[90m 600 |[39m       
[36mawait[39m geoLocationService[33m.[39mgrantGPSCon
sent(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 601 |[39m         purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m
     [90m 602 |[39m       })[33m;[39m
     [90m 603 |[39m[0m

      at Object.grantGPSConsent (src/lib/moderation/__te
sts__/eprivacy-compliance.test.ts:600:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/quality/remote-config.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      [QualityRemoteConfig] Failed to read cache: 
SyntaxError: Expected property name or '}' in JSON at 
position 2 (line 1 column 3)
          at JSON.parse (<anonymous>)
          at parse (C:\Users\Peter\GrowBro\src\lib\quali
ty\remote-config.ts:244:25)
          at readCache (C:\Users\Peter\GrowBro\src\lib\q
uality\remote-config.ts:139:18)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\quali
ty\remote-config.ts:136:30)
          at performRefresh (C:\Users\Peter\GrowBro\src\
lib\quality\remote-config.ts:128:16)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\quali
ty\remote-config.ts:121:47)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\quality\remote-config.test.ts:210:35)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 246 |[39m     [36mreturn[39m 
parsed[33m;[39m
     [90m 247 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 248 |[39m     
console[33m.[39mwarn([32m'[QualityRemoteConfig] 
Failed to read cache:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 249 |[39m     storage[33m.[39m[36mdelete
[39m([33mREMOTE_CACHE_STORAGE_KEY[39m)[33m;[39m
     [90m 250 |[39m     [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 251 |[39m   }[0m

      at warn (src/lib/quality/remote-config.ts:248:13)
      at readCache 
(src/lib/quality/remote-config.ts:139:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/quality/remote-config.ts:136:30)
      at performRefresh 
(src/lib/quality/remote-config.ts:128:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/quality/remote-config.ts:121:47)
      at Object.<anonymous> 
(src/lib/quality/remote-config.test.ts:210:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ refreshQualityThresholds - cache behavior ÔÇ║ 
should handle 304 Not Modified with cached ETag

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "cache"
    Received: "stale-cache"

    [0m [90m 232 |[39m
     [90m 233 |[39m     [36mconst[39m state 
[33m=[39m getQualityConfigState()[33m;[39m
    [31m[1m>[22m[39m[90m 234 |[39m     expect(stat
e[33m.[39mmetadata[33m.[39msource)[33m.[39mtoBe([
32m'cache'[39m)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 235 |[39m     expect(state[33m.[39mthresho
lds[33m.[39macceptableScore)[33m.[39mtoBe([35m80[3
9m)[33m;[39m
     [90m 236 |[39m   })[33m;[39m
     [90m 237 |[39m })[33m;[39m[0m

      at Object.toBe 
(src/lib/quality/remote-config.test.ts:234:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/playbooks/__tests__/schema-validation.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ Playbook Schema Validation ÔÇ║ Valid Playbook 
Schemas ÔÇ║ should validate minimal valid playbook

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 68 |[39m   describe([32m'Valid 
Playbook Schemas'[39m[33m,[39m () [33m=>[39m {
     [90m 69 |[39m     it([32m'should validate 
minimal valid playbook'[39m[33m,[39m () [33m=>[39m 
{
    [31m[1m>[22m[39m[90m 70 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 71 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 72 |[39m         id[33m:[39m [32m'550e840
0-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 73 |[39m         name[33m:[39m [32m'Auto 
Indoor Basic'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:70:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Valid Playbook 
Schemas ÔÇ║ should validate complete playbook with all 
fields

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 91 |[39m
     [90m 92 |[39m     it([32m'should validate 
complete playbook with all fields'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 93 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 94 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 95 |[39m         id[33m:[39m [32m'550e840
0-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 96 |[39m         name[33m:[39m 
[32m'Photo Indoor Advanced'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:93:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Valid Playbook 
Schemas ÔÇ║ should validate playbook with all task types

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 132 |[39m
     [90m 133 |[39m     it([32m'should validate 
playbook with all task types'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 134 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 135 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 136 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 137 |[39m         name[33m:[39m 
[32m'Complete Task Types'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:134:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject playbook missing required 
fields

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 199 |[39m   describe([32m'Invalid 
Playbook Schemas'[39m[33m,[39m () [33m=>[39m {
     [90m 200 |[39m     it([32m'should reject 
playbook missing required fields'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 201 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 202 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 203 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 204 |[39m         name[33m:[39m 
[32m'Incomplete'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:201:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject invalid UUID format

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 213 |[39m
     [90m 214 |[39m     it([32m'should reject 
invalid UUID format'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 215 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 216 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 217 |[39m         id[33m:[39m 
[32m'not-a-uuid'[39m[33m,[39m
     [90m 218 |[39m         name[33m:[39m 
[32m'Invalid ID'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:215:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject invalid setup value

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 228 |[39m
     [90m 229 |[39m     it([32m'should reject 
invalid setup value'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 230 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 231 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 232 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 233 |[39m         name[33m:[39m 
[32m'Invalid Setup'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:230:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject invalid locale format

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 243 |[39m
     [90m 244 |[39m     it([32m'should reject 
invalid locale format'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 245 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 246 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 247 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 248 |[39m         name[33m:[39m 
[32m'Invalid Locale'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:245:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject invalid reminder time format

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 258 |[39m
     [90m 259 |[39m     it([32m'should reject 
invalid reminder time format'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 260 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 261 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 262 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 263 |[39m         name[33m:[39m 
[32m'Invalid Reminder'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:260:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject step missing required fields

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 282 |[39m
     [90m 283 |[39m     it([32m'should reject step 
missing required fields'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 284 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 285 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 286 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 287 |[39m         name[33m:[39m 
[32m'Incomplete Step'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:284:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject invalid phase value

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 303 |[39m
     [90m 304 |[39m     it([32m'should reject 
invalid phase value'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 305 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 306 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 307 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 308 |[39m         name[33m:[39m 
[32m'Invalid Phase'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:305:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject invalid task type

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 326 |[39m
     [90m 327 |[39m     it([32m'should reject 
invalid task type'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 328 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 329 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 330 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 331 |[39m         name[33m:[39m 
[32m'Invalid Task Type'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:328:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject negative relativeDay

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 349 |[39m
     [90m 350 |[39m     it([32m'should reject 
negative relativeDay'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 351 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 352 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 353 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 354 |[39m         name[33m:[39m 
[32m'Negative Day'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:351:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Edge Cases ÔÇ║ 
should validate empty steps array

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 374 |[39m   describe([32m'Edge 
Cases'[39m[33m,[39m () [33m=>[39m {
     [90m 375 |[39m     it([32m'should validate 
empty steps array'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 376 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 377 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 378 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 379 |[39m         name[33m:[39m 
[32m'Empty Steps'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:376:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Edge Cases ÔÇ║ 
should validate playbook with many steps

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 388 |[39m
     [90m 389 |[39m     it([32m'should validate 
playbook with many steps'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 390 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 391 |[39m       [36mconst[39m steps 
[33m=[39m [33mArray[39m[33m.[39m[36mfrom[39m({ 
length[33m:[39m [35m100[39m }[33m,[39m 
(_[33m,[39m i) [33m=>[39m ({
     [90m 392 |[39m         id[33m:[39m 
[32m`step-${i}`[39m[33m,[39m
     [90m 393 |[39m         phase[33m:[39m 
[32m'veg'[39m [36mas[39m 
[36mconst[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:390:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Edge Cases ÔÇ║ 
should validate locale with region code

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 410 |[39m
     [90m 411 |[39m     it([32m'should validate 
locale with region code'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 412 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 413 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 414 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 415 |[39m         name[33m:[39m 
[32m'Regional Locale'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:412:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Edge Cases ÔÇ║ 
should validate complex RRULE patterns

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 424 |[39m
     [90m 425 |[39m     it([32m'should validate 
complex RRULE patterns'[39m[33m,[39m () [33m=>[39m 
{
    [31m[1m>[22m[39m[90m 426 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 427 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 428 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 429 |[39m         name[33m:[39m 
[32m'Complex RRULE'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:426:28)

FAIL 
src/lib/community/__tests__/offline-workflow.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: LIKE, 
attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 1 failed: Conflict

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 1 will retry in 1000ms

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:325:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: 
COMMENT, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 1 failed: [
        {
          "code": "invalid_type",
          "expected": "string",
          "received": "undefined",
          "path": [
            "postId"
          ],
          "message": "Required"
        }
      ]

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 1 will retry in 1000ms

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:325:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: 
COMMENT, attempt: 2

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 1 failed: [
        {
          "code": "invalid_type",
          "expected": "string",
          "received": "undefined",
          "path": [
            "postId"
          ],
          "message": "Required"
        }
      ]

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 1 will retry in 2000ms

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:325:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Entry 1 exceeded max retries, 
marking as failed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:109:19)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: LIKE, 
attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 1 failed: Not found

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 1 dropped (404)

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:306:17)

    console.log
      [OutboxProcessor] Processed 1 entries with 
client_tx_id: client-tx-123

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:195:13)

  ÔùÅ Offline Workflow Integration ÔÇ║ Comment Offline 
Workflow ÔÇ║ should queue comment ÔåÆ fail ÔåÆ retry 
with backoff ÔåÆ succeed

    expect(jest.fn()).toHaveBeenCalledTimes(expected)

    Expected number of calls: 2
    Received number of calls: 0

    [0m [90m 203 |[39m       [36mawait[39m 
outboxProcessor[33m.[39mprocessQueue()[33m;[39m
     [90m 204 |[39m
    [31m[1m>[22m[39m[90m 205 |[39m       expect(mo
ckApiClient[33m.[39mcreateComment)[33m.[39mtoHaveBee
nCalledTimes([35m2[39m)[33m;[39m
     [90m     |[39m                                   
        [31m[1m^[22m[39m
     [90m 206 |[39m     })[33m;[39m
     [90m 207 |[39m
     [90m 208 |[39m     it([32m'should mark as 
failed after max retries'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toHaveBeenCalledTimes (src/lib/community
/__tests__/offline-workflow.test.ts:205:43)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/moderation/trusted-flagger-analytics.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
getTrustedFlaggerAnalytics ÔÇ║ fetches analytics and 
converts date strings to Date objects

    Failed to fetch trusted flaggers: TypeError: fetch 
failed

    [0m [90m 202 |[39m
     [90m 203 |[39m   [36mif[39m (error) {
    [31m[1m>[22m[39m[90m 204 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Failed to fetch trusted flaggers: 
${error.message}`[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 205 |[39m   }
     [90m 206 |[39m
     [90m 207 |[39m   [36mif[39m 
([33m![39mflaggers [33m||[39m 
flaggers[33m.[39mlength [33m===[39m [35m0[39m) 
{[0m

      at 
src/lib/moderation/trusted-flagger-analytics.ts:204:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
getTrustedFlaggerAnalytics ÔÇ║ handles empty flaggers 
array

    Failed to fetch trusted flaggers: TypeError: fetch 
failed

    [0m [90m 202 |[39m
     [90m 203 |[39m   [36mif[39m (error) {
    [31m[1m>[22m[39m[90m 204 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Failed to fetch trusted flaggers: 
${error.message}`[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 205 |[39m   }
     [90m 206 |[39m
     [90m 207 |[39m   [36mif[39m 
([33m![39mflaggers [33m||[39m 
flaggers[33m.[39mlength [33m===[39m [35m0[39m) 
{[0m

      at 
src/lib/moderation/trusted-flagger-analytics.ts:204:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
getTrustedFlaggerAnalytics ÔÇ║ throws error on failed 
response

    expect(received).rejects.toThrow(expected)

    Expected substring: "Failed to fetch trusted 
flagger analytics: Internal Server Error"
    Received message:   "Failed to fetch trusted 
flaggers: TypeError: fetch failed"

        [0m [90m 202 |[39m
         [90m 203 |[39m   [36mif[39m (error) {
        [31m[1m>[22m[39m[90m 204 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Failed to fetch trusted flaggers: 
${error.message}`[39m)[33m;[39m
         [90m     |[39m           [31m[1m^[22m[39m
         [90m 205 |[39m   }
         [90m 206 |[39m
         [90m 207 |[39m   [36mif[39m 
([33m![39mflaggers [33m||[39m 
flaggers[33m.[39mlength [33m===[39m [35m0[39m) 
{[0m

      at 
src/lib/moderation/trusted-flagger-analytics.ts:204:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/moderation/trusted-flag
ger-analytics.test.ts:115:58)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
getTrustedFlaggerMetrics ÔÇ║ fetches metrics and 
converts date string to Date object

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Date

    Received value has no prototype
    Received value: undefined

    [0m [90m 143 |[39m         
[32m'/api/moderation/trusted-flaggers/1/metrics'[39m
     [90m 144 |[39m       )[33m;[39m
    [31m[1m>[22m[39m[90m 145 |[39m       expect(re
sult[33m.[39mlast_reviewed_at)[33m.[39mtoBeInstanceO
f([33mDate[39m)[33m;[39m
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 146 |[39m       expect(result[33m.[39mlast
_reviewed_at[33m?[39m[33m.[39mtoISOString())[33m.[
39mtoBe(
     [90m 147 |[39m         
[32m'2024-01-15T10:00:00.000Z'[39m
     [90m 148 |[39m       )[33m;[39m[0m

      at Object.toBeInstanceOf (src/lib/moderation/trust
ed-flagger-analytics.test.ts:145:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ getTrustedFlaggers 
ÔÇ║ fetches flaggers and converts date strings to Date 
objects

    Failed to fetch trusted flaggers: Internal Server 
Error

    [0m [90m 291 |[39m
     [90m 292 |[39m   [36mif[39m 
([33m![39mresponse[33m.[39mok) {
    [31m[1m>[22m[39m[90m 293 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Failed to fetch trusted flaggers: 
${response.statusText}`[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 294 |[39m   }
     [90m 295 |[39m
     [90m 296 |[39m   [36mconst[39m rawData 
[33m=[39m [36mawait[39m 
response[33m.[39mjson()[33m;[39m[0m

      at 
src/lib/moderation/trusted-flagger-analytics.ts:293:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ getTrustedFlaggers 
ÔÇ║ handles status filter

    TypeError: rawData.map is not a function

    [0m [90m 297 |[39m
     [90m 298 |[39m   [90m// Convert date strings to 
Date objects for each flagger[39m
    [31m[1m>[22m[39m[90m 299 |[39m   
[36mreturn[39m rawData[33m.[39mmap(
     [90m     |[39m                  
[31m[1m^[22m[39m
     [90m 300 |[39m     (
     [90m 301 |[39m       flagger[33m:[39m 
[33mRawFlaggerData[39m [33m&[39m
     [90m 302 |[39m         
[33mOmit[39m[33m<[39m[0m

      at map 
(src/lib/moderation/trusted-flagger-analytics.ts:299:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ getTrustedFlaggers 
ÔÇ║ handles empty response array

    TypeError: rawData.map is not a function

    [0m [90m 297 |[39m
     [90m 298 |[39m   [90m// Convert date strings to 
Date objects for each flagger[39m
    [31m[1m>[22m[39m[90m 299 |[39m   
[36mreturn[39m rawData[33m.[39mmap(
     [90m     |[39m                  
[31m[1m^[22m[39m
     [90m 300 |[39m     (
     [90m 301 |[39m       flagger[33m:[39m 
[33mRawFlaggerData[39m [33m&[39m
     [90m 302 |[39m         
[33mOmit[39m[33m<[39m[0m

      at map 
(src/lib/moderation/trusted-flagger-analytics.ts:299:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ shouldWarnFlagger 
ÔÇ║ warns when accuracy drops below 70%

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 315 |[39m           }
     [90m 316 |[39m         )
    [31m[1m>[22m[39m[90m 317 |[39m       
)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 318 |[39m     })[33m;[39m
     [90m 319 |[39m
     [90m 320 |[39m     test([32m'warns when false 
positive rate exceeds 30%'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:317:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ shouldWarnFlagger 
ÔÇ║ warns when false positive rate exceeds 30%

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 327 |[39m           }
     [90m 328 |[39m         )
    [31m[1m>[22m[39m[90m 329 |[39m       
)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 330 |[39m     })[33m;[39m
     [90m 331 |[39m
     [90m 332 |[39m     test([32m'warns when quality 
is degrading'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:329:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ shouldWarnFlagger 
ÔÇ║ warns when quality is degrading

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 339 |[39m           }
     [90m 340 |[39m         )
    [31m[1m>[22m[39m[90m 341 |[39m       
)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 342 |[39m     })[33m;[39m
     [90m 343 |[39m
     [90m 344 |[39m     test([32m'does not warn when 
all metrics are good'[39m[33m,[39m () [33m=>[39m 
{[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:341:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
shouldSuspendFlagger ÔÇ║ suspends when accuracy drops 
below 50%

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 366 |[39m           }
     [90m 367 |[39m         )
    [31m[1m>[22m[39m[90m 368 |[39m       
)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 369 |[39m     })[33m;[39m
     [90m 370 |[39m
     [90m 371 |[39m     test([32m'suspends when 
false positive rate exceeds 50%'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:368:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
shouldSuspendFlagger ÔÇ║ suspends when false positive 
rate exceeds 50%

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 379 |[39m           }
     [90m 380 |[39m         )
    [31m[1m>[22m[39m[90m 381 |[39m       
)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 382 |[39m     })[33m;[39m
     [90m 383 |[39m
     [90m 384 |[39m     test([32m'suspends when 
already on warning and still degrading'[39m[33m,[39m 
() [33m=>[39m {[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:381:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
shouldSuspendFlagger ÔÇ║ suspends when already on 
warning and still degrading

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 392 |[39m           }
     [90m 393 |[39m         )
    [31m[1m>[22m[39m[90m 394 |[39m       
)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 395 |[39m     })[33m;[39m
     [90m 396 |[39m
     [90m 397 |[39m     test([32m'does not suspend 
when metrics are acceptable'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:394:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ formatResponseTime 
ÔÇ║ formats milliseconds to hours and minutes

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "2h 0m"
    Received: "2h"

    [0m [90m 495 |[39m     test([32m'formats 
milliseconds to hours and minutes'[39m[33m,[39m () 
[33m=>[39m {
     [90m 496 |[39m       expect(formatResponseTime([
35m3661000[39m))[33m.[39mtoBe([32m'1h 
1m'[39m)[33m;[39m [90m// 1h 1m 1s[39m
    [31m[1m>[22m[39m[90m 497 |[39m       expect(fo
rmatResponseTime([35m7200000[39m))[33m.[39mtoBe([32
m'2h 0m'[39m)[33m;[39m [90m// 2h[39m
     [90m     |[39m                                   
        [31m[1m^[22m[39m
     [90m 498 |[39m     })[33m;[39m
     [90m 499 |[39m
     [90m 500 |[39m     test([32m'formats days for 
very long response times'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:497:43)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
exportFlaggerMetrics ÔÇ║ exports metrics with date range

    TypeError: response.blob is not a function

    [0m [90m 469 |[39m   }
     [90m 470 |[39m
    [31m[1m>[22m[39m[90m 471 |[39m   
[36mreturn[39m response[33m.[39mblob()[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 472 |[39m }
     [90m 473 |[39m[0m

      at blob 
(src/lib/moderation/trusted-flagger-analytics.ts:471:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
exportFlaggerMetrics ÔÇ║ throws error on failed response

    expect(received).rejects.toThrow(expected)

    Expected substring: "Failed to export flagger 
metrics: Internal Server Error"
    Received message:   "response.blob is not a 
function"

        [0m [90m 469 |[39m   }
         [90m 470 |[39m
        [31m[1m>[22m[39m[90m 471 |[39m   
[36mreturn[39m response[33m.[39mblob()[33m;[39m
         [90m     |[39m                   
[31m[1m^[22m[39m
         [90m 472 |[39m }
         [90m 473 |[39m[0m

      at blob 
(src/lib/moderation/trusted-flagger-analytics.ts:471:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/moderation/trusted-flag
ger-analytics.test.ts:556:70)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/playbooks/outbox-worker.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      [OutboxWorker] Error processing actions: 
TypeError: Cannot read properties of undefined (reading 
'query')
          at OutboxWorker.<anonymous> (C:\Users\Peter\Gr
owBro\src\lib\playbooks\outbox-worker.ts:244:73)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at OutboxWorker.<anonymous> (C:\Users\Peter\Gr
owBro\node_modules\@babel\runtime\helpers\asyncToGenerat
or.js:14:12)
          at OutboxWorker.apply [as 
cleanupExpiredActions] (C:\Users\Peter\GrowBro\src\lib\p
laybooks\outbox-worker.ts:242:38)
          at OutboxWorker.cleanupExpiredActions (C:\User
s\Peter\GrowBro\src\lib\playbooks\outbox-worker.ts:88:16
)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at OutboxWorker.<anonymous> (C:\Users\Peter\Gr
owBro\node_modules\@babel\runtime\helpers\asyncToGenerat
or.js:14:12)
          at OutboxWorker.apply [as 
processPendingActions] (C:\Users\Peter\GrowBro\src\lib\p
laybooks\outbox-worker.ts:84:30)
          at OutboxWorker.processPendingActions [as 
start] (C:\Users\Peter\GrowBro\src\lib\playbooks\outbox-
worker.ts:65:10)
          at Object.start (C:\Users\Peter\GrowBro\src\li
b\playbooks\outbox-worker.test.ts:67:14)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 64 |[39m     [90m// Process 
immediately on start[39m
     [90m 65 |[39m     [36mthis[39m[33m.[39mproces
sPendingActions()[33m.[39m[36mcatch[39m((error) 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 66 |[39m       
console[33m.[39merror([32m'[OutboxWorker] Error 
processing actions:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     })[33m;[39m
     [90m 68 |[39m   }
     [90m 69 |[39m[0m

      at error 
(src/lib/playbooks/outbox-worker.ts:66:15)

  ÔùÅ OutboxWorker ÔÇ║ processPendingActions ÔÇ║ should 
process pending schedule actions

    TypeError: action.destroyPermanently is not a 
function

    [0m [90m 271 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mdatabase[33m.[39mwrite([36masync[39
m () [33m=>[39m {
     [90m 272 |[39m         [36mfor[39m 
([36mconst[39m action [36mof[39m oldActions) {
    [31m[1m>[22m[39m[90m 273 |[39m           
[36mawait[39m 
action[33m.[39mdestroyPermanently()[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 274 |[39m         }
     [90m 275 |[39m       })[33m;[39m
     [90m 276 |[39m     }[0m

      at destroyPermanently 
(src/lib/playbooks/outbox-worker.ts:273:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn 
(src/lib/playbooks/outbox-worker.test.ts:97:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/playbooks/outbox-worker.test.ts:98:8)
      at OutboxWorker.write 
(src/lib/playbooks/outbox-worker.ts:271:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OutboxWorker ÔÇ║ processPendingActions ÔÇ║ should 
process pending cancel actions

    TypeError: action.destroyPermanently is not a 
function

    [0m [90m 271 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mdatabase[33m.[39mwrite([36masync[39
m () [33m=>[39m {
     [90m 272 |[39m         [36mfor[39m 
([36mconst[39m action [36mof[39m oldActions) {
    [31m[1m>[22m[39m[90m 273 |[39m           
[36mawait[39m 
action[33m.[39mdestroyPermanently()[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 274 |[39m         }
     [90m 275 |[39m       })[33m;[39m
     [90m 276 |[39m     }[0m

      at destroyPermanently 
(src/lib/playbooks/outbox-worker.ts:273:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn 
(src/lib/playbooks/outbox-worker.test.ts:132:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/playbooks/outbox-worker.test.ts:133:8)
      at OutboxWorker.write 
(src/lib/playbooks/outbox-worker.ts:271:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OutboxWorker ÔÇ║ processPendingActions ÔÇ║ should 
handle processing errors with retry

    TypeError: action.destroyPermanently is not a 
function

    [0m [90m 271 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mdatabase[33m.[39mwrite([36masync[39
m () [33m=>[39m {
     [90m 272 |[39m         [36mfor[39m 
([36mconst[39m action [36mof[39m oldActions) {
    [31m[1m>[22m[39m[90m 273 |[39m           
[36mawait[39m 
action[33m.[39mdestroyPermanently()[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 274 |[39m         }
     [90m 275 |[39m       })[33m;[39m
     [90m 276 |[39m     }[0m

      at destroyPermanently 
(src/lib/playbooks/outbox-worker.ts:273:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn 
(src/lib/playbooks/outbox-worker.test.ts:164:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/playbooks/outbox-worker.test.ts:165:8)
      at OutboxWorker.write 
(src/lib/playbooks/outbox-worker.ts:271:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OutboxWorker ÔÇ║ processPendingActions ÔÇ║ should 
mark as failed after max retries

    TypeError: action.destroyPermanently is not a 
function

    [0m [90m 271 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mdatabase[33m.[39mwrite([36masync[39
m () [33m=>[39m {
     [90m 272 |[39m         [36mfor[39m 
([36mconst[39m action [36mof[39m oldActions) {
    [31m[1m>[22m[39m[90m 273 |[39m           
[36mawait[39m 
action[33m.[39mdestroyPermanently()[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 274 |[39m         }
     [90m 275 |[39m       })[33m;[39m
     [90m 276 |[39m     }[0m

      at destroyPermanently 
(src/lib/playbooks/outbox-worker.ts:273:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn 
(src/lib/playbooks/outbox-worker.test.ts:200:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/playbooks/outbox-worker.test.ts:201:8)
      at OutboxWorker.write 
(src/lib/playbooks/outbox-worker.ts:271:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OutboxWorker ÔÇ║ cleanup ÔÇ║ should mark expired 
actions as expired

    TypeError: action.destroyPermanently is not a 
function

    [0m [90m 271 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mdatabase[33m.[39mwrite([36masync[39
m () [33m=>[39m {
     [90m 272 |[39m         [36mfor[39m 
([36mconst[39m action [36mof[39m oldActions) {
    [31m[1m>[22m[39m[90m 273 |[39m           
[36mawait[39m 
action[33m.[39mdestroyPermanently()[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 274 |[39m         }
     [90m 275 |[39m       })[33m;[39m
     [90m 276 |[39m     }[0m

      at destroyPermanently 
(src/lib/playbooks/outbox-worker.ts:273:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn 
(src/lib/playbooks/outbox-worker.test.ts:229:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/playbooks/outbox-worker.test.ts:230:8)
      at OutboxWorker.write 
(src/lib/playbooks/outbox-worker.ts:271:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OutboxWorker ÔÇ║ cleanup ÔÇ║ should delete old 
completed actions

    TypeError: action.update is not a function

    [0m [90m 249 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mdatabase[33m.[39mwrite([36masync[39
m () [33m=>[39m {
     [90m 250 |[39m         [36mfor[39m 
([36mconst[39m action [36mof[39m expiredActions) {
    [31m[1m>[22m[39m[90m 251 |[39m           
[36mawait[39m action[33m.[39mupdate((record) 
[33m=>[39m {
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 252 |[39m             [36mif[39m 
(record[33m.[39mstatus [33m===[39m 
[32m'pending'[39m) {
     [90m 253 |[39m               
record[33m.[39mstatus [33m=[39m 
[32m'expired'[39m[33m;[39m
     [90m 254 |[39m             }[0m

      at update 
(src/lib/playbooks/outbox-worker.ts:251:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn 
(src/lib/playbooks/outbox-worker.test.ts:252:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/playbooks/outbox-worker.test.ts:253:8)
      at OutboxWorker.write 
(src/lib/playbooks/outbox-worker.ts:249:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/__tests__/template-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

  ÔùÅ TemplateManager ÔÇ║ applyTemplate creates tasks 
and is idempotent with same key

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 256 |[39m     completedAt[33m:[39m mod
el[33m.[39mcompletedAt[33m?[39m[33m.[39mtoISOStrin
g()[33m,[39m
     [90m 257 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
{}[33m,[39m
    [31m[1m>[22m[39m[90m 258 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 259 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 260 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 261 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:258:32)
      at toTaskFromModel 
(src/lib/task-manager.ts:423:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TemplateManager ÔÇ║ bulkShiftTasks shifts due and 
reminder timestamps

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 256 |[39m     completedAt[33m:[39m mod
el[33m.[39mcompletedAt[33m?[39m[33m.[39mtoISOStrin
g()[33m,[39m
     [90m 257 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
{}[33m,[39m
    [31m[1m>[22m[39m[90m 258 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 259 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 260 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 261 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:258:32)
      at toTaskFromModel 
(src/lib/task-manager.ts:423:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/playbooks/playbook-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      [PlaybookService] Failed to fetch plant plant-1, 
using defaults: TypeError: A dynamic import callback 
was invoked without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\src\lib\playbooks\playbook-service.ts:400:7)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\node_modules\@babel\runtime\helpers\asyncToGene
rator.js:14:12)
          at PlaybookService.apply [as getPlantInfo] (C:
\Users\Peter\GrowBro\src\lib\playbooks\playbook-service.
ts:394:29)
          at PlaybookService.getPlantInfo (C:\Users\Pete
r\GrowBro\src\lib\playbooks\playbook-service.ts:360:30)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\node_modules\@babel\runtime\helpers\asyncToGene
rator.js:14:12)
          at PlaybookService.apply [as 
generateAndScheduleTasks] (C:\Users\Peter\GrowBro\src\li
b\playbooks\playbook-service.ts:355:41)
          at PlaybookService.generateAndScheduleTasks (C
:\Users\Peter\GrowBro\src\lib\playbooks\playbook-service
.ts:290:36)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 423 |[39m       }[33m;[39m
     [90m 424 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 425 |[39m       
console[33m.[39mwarn(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 426 |[39m         [32m`[PlaybookService] 
Failed to fetch plant ${plantId}, using 
defaults:`[39m[33m,[39m
     [90m 427 |[39m         error
     [90m 428 |[39m       )[33m;[39m[0m

      at PlaybookService.warn 
(src/lib/playbooks/playbook-service.ts:425:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [PlaybookService] Failed to fetch plant plant-1, 
using defaults: TypeError: A dynamic import callback 
was invoked without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\src\lib\playbooks\playbook-service.ts:400:7)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\node_modules\@babel\runtime\helpers\asyncToGene
rator.js:14:12)
          at PlaybookService.apply [as getPlantInfo] (C:
\Users\Peter\GrowBro\src\lib\playbooks\playbook-service.
ts:394:29)
          at PlaybookService.getPlantInfo (C:\Users\Pete
r\GrowBro\src\lib\playbooks\playbook-service.ts:360:30)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\node_modules\@babel\runtime\helpers\asyncToGene
rator.js:14:12)
          at PlaybookService.apply [as 
generateAndScheduleTasks] (C:\Users\Peter\GrowBro\src\li
b\playbooks\playbook-service.ts:355:41)
          at PlaybookService.generateAndScheduleTasks (C
:\Users\Peter\GrowBro\src\lib\playbooks\playbook-service
.ts:290:36)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 423 |[39m       }[33m;[39m
     [90m 424 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 425 |[39m       
console[33m.[39mwarn(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 426 |[39m         [32m`[PlaybookService] 
Failed to fetch plant ${plantId}, using 
defaults:`[39m[33m,[39m
     [90m 427 |[39m         error
     [90m 428 |[39m       )[33m;[39m[0m

      at PlaybookService.warn 
(src/lib/playbooks/playbook-service.ts:425:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [PlaybookService] Failed to fetch plant plant-1, 
using defaults: TypeError: A dynamic import callback 
was invoked without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\src\lib\playbooks\playbook-service.ts:400:7)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\node_modules\@babel\runtime\helpers\asyncToGene
rator.js:14:12)
          at PlaybookService.apply [as getPlantInfo] (C:
\Users\Peter\GrowBro\src\lib\playbooks\playbook-service.
ts:394:29)
          at PlaybookService.getPlantInfo (C:\Users\Pete
r\GrowBro\src\lib\playbooks\playbook-service.ts:360:30)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\node_modules\@babel\runtime\helpers\asyncToGene
rator.js:14:12)
          at PlaybookService.apply [as 
generateAndScheduleTasks] (C:\Users\Peter\GrowBro\src\li
b\playbooks\playbook-service.ts:355:41)
          at PlaybookService.generateAndScheduleTasks (C
:\Users\Peter\GrowBro\src\lib\playbooks\playbook-service
.ts:290:36)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 423 |[39m       }[33m;[39m
     [90m 424 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 425 |[39m       
console[33m.[39mwarn(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 426 |[39m         [32m`[PlaybookService] 
Failed to fetch plant ${plantId}, using 
defaults:`[39m[33m,[39m
     [90m 427 |[39m         error
     [90m 428 |[39m       )[33m;[39m[0m

      at PlaybookService.warn 
(src/lib/playbooks/playbook-service.ts:425:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [PlaybookService] Failed to fetch plant plant-1, 
using defaults: TypeError: A dynamic import callback 
was invoked without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\src\lib\playbooks\playbook-service.ts:400:7)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\node_modules\@babel\runtime\helpers\asyncToGene
rator.js:14:12)
          at PlaybookService.apply [as getPlantInfo] (C:
\Users\Peter\GrowBro\src\lib\playbooks\playbook-service.
ts:394:29)
          at PlaybookService.getPlantInfo (C:\Users\Pete
r\GrowBro\src\lib\playbooks\playbook-service.ts:360:30)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\node_modules\@babel\runtime\helpers\asyncToGene
rator.js:14:12)
          at PlaybookService.apply [as 
generateAndScheduleTasks] (C:\Users\Peter\GrowBro\src\li
b\playbooks\playbook-service.ts:355:41)
          at PlaybookService.generateAndScheduleTasks (C
:\Users\Peter\GrowBro\src\lib\playbooks\playbook-service
.ts:290:36)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 423 |[39m       }[33m;[39m
     [90m 424 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 425 |[39m       
console[33m.[39mwarn(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 426 |[39m         [32m`[PlaybookService] 
Failed to fetch plant ${plantId}, using 
defaults:`[39m[33m,[39m
     [90m 427 |[39m         error
     [90m 428 |[39m       )[33m;[39m[0m

      at PlaybookService.warn 
(src/lib/playbooks/playbook-service.ts:425:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [PlaybookService] Failed to fetch plant plant-1, 
using defaults: TypeError: A dynamic import callback 
was invoked without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\src\lib\playbooks\playbook-service.ts:400:7)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\node_modules\@babel\runtime\helpers\asyncToGene
rator.js:14:12)
          at PlaybookService.apply [as getPlantInfo] (C:
\Users\Peter\GrowBro\src\lib\playbooks\playbook-service.
ts:394:29)
          at PlaybookService.getPlantInfo (C:\Users\Pete
r\GrowBro\src\lib\playbooks\playbook-service.ts:360:30)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at PlaybookService.<anonymous> (C:\Users\Peter
\GrowBro\node_modules\@babel\runtime\helpers\asyncToGene
rator.js:14:12)
          at PlaybookService.apply [as 
generateAndScheduleTasks] (C:\Users\Peter\GrowBro\src\li
b\playbooks\playbook-service.ts:355:41)
          at PlaybookService.generateAndScheduleTasks (C
:\Users\Peter\GrowBro\src\lib\playbooks\playbook-service
.ts:290:36)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 423 |[39m       }[33m;[39m
     [90m 424 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 425 |[39m       
console[33m.[39mwarn(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 426 |[39m         [32m`[PlaybookService] 
Failed to fetch plant ${plantId}, using 
defaults:`[39m[33m,[39m
     [90m 427 |[39m         error
     [90m 428 |[39m       )[33m;[39m[0m

      at PlaybookService.warn 
(src/lib/playbooks/playbook-service.ts:425:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ PlaybookService ÔÇ║ 
validateOneActivePlaybookPerPlant ÔÇ║ returns false 
when different playbook is already applied

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 342 |[39m       )[33m;[39m
     [90m 343 |[39m
    [31m[1m>[22m[39m[90m 344 |[39m       expect(is
Valid)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 345 |[39m     })[33m;[39m
     [90m 346 |[39m
     [90m 347 |[39m     test([32m'returns true when 
completed playbook exists for plant'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toBe 
(src/lib/playbooks/playbook-service.test.ts:344:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ PlaybookService ÔÇ║ 
validateOneActivePlaybookPerPlant ÔÇ║ returns false 
when pending playbook exists for plant

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 376 |[39m       )[33m;[39m
     [90m 377 |[39m
    [31m[1m>[22m[39m[90m 378 |[39m       expect(is
Valid)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 379 |[39m     })[33m;[39m
     [90m 380 |[39m   })[33m;[39m
     [90m 381 |[39m[0m

      at Object.toBe 
(src/lib/playbooks/playbook-service.test.ts:378:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ PlaybookService ÔÇ║ applyPlaybookToPlant ÔÇ║ 
applies playbook with idempotency key

    TypeError: this.database.get(...).query is not a 
function

    [0m [90m 443 |[39m     [36mconst[39m tasks 
[33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39mdatabase
     [90m 444 |[39m       [33m.[39m[36mget[39m[33
m<[39m[33mTaskModel[39m[33m>[39m([32m'tasks'[39m)
    [31m[1m>[22m[39m[90m 445 |[39m       [33m.[3
9mquery([33mQ[39m[33m.[39mwhere([32m'id'[39m[33m,
[39m [33mQ[39m[33m.[39moneOf(taskIds)))
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 446 |[39m       
[33m.[39mfetch()[33m;[39m
     [90m 447 |[39m
     [90m 448 |[39m     [90m// Process in batches to 
avoid blocking UI thread[39m[0m

      at PlaybookService.query 
(src/lib/playbooks/playbook-service.ts:445:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at PlaybookService.<anonymous> (node_modules/@babe
l/runtime/helpers/asyncToGenerator.js:14:12)
      at PlaybookService.apply [as 
scheduleTaskNotifications] 
(src/lib/playbooks/playbook-service.ts:441:42)
      at PlaybookService.scheduleTaskNotifications 
(src/lib/playbooks/playbook-service.ts:366:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ PlaybookService ÔÇ║ applyPlaybookToPlant ÔÇ║ 
returns existing result for duplicate idempotency key

    TypeError: this.database.get(...).query is not a 
function

    [0m [90m 443 |[39m     [36mconst[39m tasks 
[33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39mdatabase
     [90m 444 |[39m       [33m.[39m[36mget[39m[33
m<[39m[33mTaskModel[39m[33m>[39m([32m'tasks'[39m)
    [31m[1m>[22m[39m[90m 445 |[39m       [33m.[3
9mquery([33mQ[39m[33m.[39mwhere([32m'id'[39m[33m,
[39m [33mQ[39m[33m.[39moneOf(taskIds)))
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 446 |[39m       
[33m.[39mfetch()[33m;[39m
     [90m 447 |[39m
     [90m 448 |[39m     [90m// Process in batches to 
avoid blocking UI thread[39m[0m

      at PlaybookService.query 
(src/lib/playbooks/playbook-service.ts:445:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at PlaybookService.<anonymous> (node_modules/@babe
l/runtime/helpers/asyncToGenerator.js:14:12)
      at PlaybookService.apply [as 
scheduleTaskNotifications] 
(src/lib/playbooks/playbook-service.ts:441:42)
      at PlaybookService.scheduleTaskNotifications 
(src/lib/playbooks/playbook-service.ts:366:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ PlaybookService ÔÇ║ applyPlaybookToPlant ÔÇ║ 
throws error when plant has active playbook

    expect(received).rejects.toThrow(expected)

    Expected substring: "Plant already has an active 
playbook"
    Received message:   "this.database.get(...).query 
is not a function"

        [0m [90m 443 |[39m     [36mconst[39m tasks 
[33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39mdatabase
         [90m 444 |[39m       [33m.[39m[36mget[39m
[33m<[39m[33mTaskModel[39m[33m>[39m([32m'tasks'[
39m)
        [31m[1m>[22m[39m[90m 445 |[39m       [33m
.[39mquery([33mQ[39m[33m.[39mwhere([32m'id'[39m[
33m,[39m [33mQ[39m[33m.[39moneOf(taskIds)))
         [90m     |[39m        [31m[1m^[22m[39m
         [90m 446 |[39m       
[33m.[39mfetch()[33m;[39m
         [90m 447 |[39m
         [90m 448 |[39m     [90m// Process in 
batches to avoid blocking UI thread[39m[0m

      at PlaybookService.query 
(src/lib/playbooks/playbook-service.ts:445:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at PlaybookService.<anonymous> (node_modules/@babe
l/runtime/helpers/asyncToGenerator.js:14:12)
      at PlaybookService.apply [as 
scheduleTaskNotifications] 
(src/lib/playbooks/playbook-service.ts:441:42)
      at PlaybookService.scheduleTaskNotifications 
(src/lib/playbooks/playbook-service.ts:366:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow 
(src/lib/playbooks/playbook-service.test.ts:504:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ PlaybookService ÔÇ║ applyPlaybookToPlant ÔÇ║ 
allows multiple playbooks when allowMultiple is true

    TypeError: this.database.get(...).query is not a 
function

    [0m [90m 443 |[39m     [36mconst[39m tasks 
[33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39mdatabase
     [90m 444 |[39m       [33m.[39m[36mget[39m[33
m<[39m[33mTaskModel[39m[33m>[39m([32m'tasks'[39m)
    [31m[1m>[22m[39m[90m 445 |[39m       [33m.[3
9mquery([33mQ[39m[33m.[39mwhere([32m'id'[39m[33m,
[39m [33mQ[39m[33m.[39moneOf(taskIds)))
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 446 |[39m       
[33m.[39mfetch()[33m;[39m
     [90m 447 |[39m
     [90m 448 |[39m     [90m// Process in batches to 
avoid blocking UI thread[39m[0m

      at PlaybookService.query 
(src/lib/playbooks/playbook-service.ts:445:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at PlaybookService.<anonymous> (node_modules/@babe
l/runtime/helpers/asyncToGenerator.js:14:12)
      at PlaybookService.apply [as 
scheduleTaskNotifications] 
(src/lib/playbooks/playbook-service.ts:441:42)
      at PlaybookService.scheduleTaskNotifications 
(src/lib/playbooks/playbook-service.ts:366:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ PlaybookService ÔÇ║ applyPlaybookToPlant ÔÇ║ 
tracks performance metrics

    TypeError: this.database.get(...).query is not a 
function

    [0m [90m 443 |[39m     [36mconst[39m tasks 
[33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39mdatabase
     [90m 444 |[39m       [33m.[39m[36mget[39m[33
m<[39m[33mTaskModel[39m[33m>[39m([32m'tasks'[39m)
    [31m[1m>[22m[39m[90m 445 |[39m       [33m.[3
9mquery([33mQ[39m[33m.[39mwhere([32m'id'[39m[33m,
[39m [33mQ[39m[33m.[39moneOf(taskIds)))
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 446 |[39m       
[33m.[39mfetch()[33m;[39m
     [90m 447 |[39m
     [90m 448 |[39m     [90m// Process in batches to 
avoid blocking UI thread[39m[0m

      at PlaybookService.query 
(src/lib/playbooks/playbook-service.ts:445:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at PlaybookService.<anonymous> (node_modules/@babe
l/runtime/helpers/asyncToGenerator.js:14:12)
      at PlaybookService.apply [as 
scheduleTaskNotifications] 
(src/lib/playbooks/playbook-service.ts:441:42)
      at PlaybookService.scheduleTaskNotifications 
(src/lib/playbooks/playbook-service.ts:366:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/api/strains/utils.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.log
      [auth] onAuthStateChange INITIAL_SESSION false

      at log (src/lib/auth/index.tsx:404:13)

  ÔùÅ Strains Utilities ÔÇ║ 
normalizeGrowCharacteristics ÔÇ║ normalizes complete 
grow data

    expect(received).toEqual(expected) // deep equality

    - Expected  - 4
    + Received  + 8

      Object {
        "difficulty": "beginner",
        "flowering_time": Object {
    -     "label": undefined,
    +     "label": "Varies",
          "max_weeks": 10,
          "min_weeks": 8,
        },
        "height": Object {
          "indoor_cm": 100,
    -     "label": undefined,
    +     "label": "Not reported",
          "outdoor_cm": 200,
        },
        "indoor_suitable": true,
        "outdoor_suitable": false,
        "yield": Object {
          "indoor": Object {
    -       "label": undefined,
    +       "label": "Not reported",
            "max_grams": 500,
    +       "max_oz": undefined,
            "min_grams": 400,
    +       "min_oz": undefined,
          },
          "outdoor": Object {
    -       "label": undefined,
    +       "label": "Not reported",
            "max_grams": 800,
    +       "max_oz": undefined,
            "min_grams": 600,
    +       "min_oz": undefined,
          },
        },
      }

    [0m [90m 349 |[39m       }[33m;[39m
     [90m 350 |[39m       [36mconst[39m result 
[33m=[39m 
normalizeGrowCharacteristics(input)[33m;[39m
    [31m[1m>[22m[39m[90m 351 |[39m       
expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 352 |[39m         difficulty[33m:[39m 
[32m'beginner'[39m[33m,[39m
     [90m 353 |[39m         
indoor_suitable[33m:[39m [36mtrue[39m[33m,[39m
     [90m 354 |[39m         
outdoor_suitable[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.toEqual 
(src/api/strains/utils.test.ts:351:22)

  ÔùÅ Strains Utilities ÔÇ║ 
normalizeGrowCharacteristics ÔÇ║ provides defaults for 
missing data

    expect(received).toEqual(expected) // deep equality

    - Expected  -  3
    + Received  + 18

      Object {
        "difficulty": "intermediate",
    -   "flowering_time": Object {},
    -   "height": Object {},
    +   "flowering_time": Object {
    +     "label": "Varies",
    +     "max_weeks": undefined,
    +     "min_weeks": undefined,
    +   },
    +   "height": Object {
    +     "indoor_cm": undefined,
    +     "label": "Not reported",
    +     "outdoor_cm": undefined,
    +   },
        "indoor_suitable": true,
        "outdoor_suitable": true,
    -   "yield": Object {},
    +   "yield": Object {
    +     "indoor": Object {
    +       "label": "Not reported",
    +     },
    +     "outdoor": Object {
    +       "label": "Not reported",
    +     },
    +   },
      }

    [0m [90m 364 |[39m     test([32m'provides 
defaults for missing data'[39m[33m,[39m () 
[33m=>[39m {
     [90m 365 |[39m       [36mconst[39m result 
[33m=[39m 
normalizeGrowCharacteristics([36mnull[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 366 |[39m       
expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 367 |[39m         difficulty[33m:[39m 
[32m'intermediate'[39m[33m,[39m
     [90m 368 |[39m         
indoor_suitable[33m:[39m [36mtrue[39m[33m,[39m
     [90m 369 |[39m         
outdoor_suitable[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.toEqual 
(src/api/strains/utils.test.ts:366:22)

FAIL src/api/strains/client.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.log
      [auth] onAuthStateChange INITIAL_SESSION false

      at log (src/lib/auth/index.tsx:404:13)

  ÔùÅ StrainsApiClient ÔÇ║ getStrains ÔÇ║ fetches 
strains with default params

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrains ÔÇ║ applies 
search query with proper encoding

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrains ÔÇ║ applies 
filters correctly

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrains ÔÇ║ uses cursor 
for pagination when provided

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrains ÔÇ║ normalizes 
legacy response format

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrains ÔÇ║ handles 
direct array response

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrain ÔÇ║ fetches single 
strain by ID

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrain ÔÇ║ encodes strain 
ID properly

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ caching ÔÇ║ sends 
If-None-Match header on subsequent requests

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

FAIL src/lib/uploads/__tests__/ai-images.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ AI image uploads with consent gating ÔÇ║ 
inference upload succeeds with cloudProcessing and 
without aiTraining consent

    TypeError: FileSystem.readAsStringAsync is not a 
function

    [0m [90m 80 |[39m   [90m// Use expo-file-system 
+ base64-arraybuffer for React Native compatibility[39m
     [90m 81 |[39m   [90m// (Response.arrayBuffer() 
is not available in bare RN)[39m
    [31m[1m>[22m[39m[90m 82 |[39m   
[36mconst[39m base64 [33m=[39m [36mawait[39m [33m
FileSystem[39m[33m.[39mreadAsStringAsync(localUri[33
m,[39m {
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 83 |[39m     encoding[33m:[39m [33mFileSy
stem[39m[33m.[39m[33mEncodingType[39m[33m.[39m[3
3mBase64[39m[33m,[39m
     [90m 84 |[39m   })[33m;[39m
     [90m 85 |[39m   [36mconst[39m arrayBuffer 
[33m=[39m decode(base64)[33m;[39m[0m

      at readAsStringAsync 
(src/lib/uploads/ai-images.ts:82:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/uploads/ai-images.ts:95:2)
      at apply (src/lib/uploads/ai-images.ts:74:24)
      at doUpload (src/lib/uploads/ai-images.ts:132:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AI image upload implementation details ÔÇ║ 
training upload succeeds with both consents and records 
retention

    TypeError: FileSystem.readAsStringAsync is not a 
function

    [0m [90m 80 |[39m   [90m// Use expo-file-system 
+ base64-arraybuffer for React Native compatibility[39m
     [90m 81 |[39m   [90m// (Response.arrayBuffer() 
is not available in bare RN)[39m
    [31m[1m>[22m[39m[90m 82 |[39m   
[36mconst[39m base64 [33m=[39m [36mawait[39m [33m
FileSystem[39m[33m.[39mreadAsStringAsync(localUri[33
m,[39m {
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 83 |[39m     encoding[33m:[39m [33mFileSy
stem[39m[33m.[39m[33mEncodingType[39m[33m.[39m[3
3mBase64[39m[33m,[39m
     [90m 84 |[39m   })[33m;[39m
     [90m 85 |[39m   [36mconst[39m arrayBuffer 
[33m=[39m decode(base64)[33m;[39m[0m

      at readAsStringAsync 
(src/lib/uploads/ai-images.ts:82:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/uploads/ai-images.ts:74:24)
      at doUpload (src/lib/uploads/ai-images.ts:172:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AI image upload implementation details ÔÇ║ calls 
stripExifAndGeolocation before upload

    TypeError: FileSystem.readAsStringAsync is not a 
function

    [0m [90m 80 |[39m   [90m// Use expo-file-system 
+ base64-arraybuffer for React Native compatibility[39m
     [90m 81 |[39m   [90m// (Response.arrayBuffer() 
is not available in bare RN)[39m
    [31m[1m>[22m[39m[90m 82 |[39m   
[36mconst[39m base64 [33m=[39m [36mawait[39m [33m
FileSystem[39m[33m.[39mreadAsStringAsync(localUri[33
m,[39m {
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 83 |[39m     encoding[33m:[39m [33mFileSy
stem[39m[33m.[39m[33mEncodingType[39m[33m.[39m[3
3mBase64[39m[33m,[39m
     [90m 84 |[39m   })[33m;[39m
     [90m 85 |[39m   [36mconst[39m arrayBuffer 
[33m=[39m decode(base64)[33m;[39m[0m

      at readAsStringAsync 
(src/lib/uploads/ai-images.ts:82:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/uploads/ai-images.ts:74:24)
      at doUpload (src/lib/uploads/ai-images.ts:132:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AI image upload implementation details ÔÇ║ 
handles different MIME types and creates ArrayBuffer 
correctly

    TypeError: FileSystem.readAsStringAsync is not a 
function

    [0m [90m 80 |[39m   [90m// Use expo-file-system 
+ base64-arraybuffer for React Native compatibility[39m
     [90m 81 |[39m   [90m// (Response.arrayBuffer() 
is not available in bare RN)[39m
    [31m[1m>[22m[39m[90m 82 |[39m   
[36mconst[39m base64 [33m=[39m [36mawait[39m [33m
FileSystem[39m[33m.[39mreadAsStringAsync(localUri[33
m,[39m {
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 83 |[39m     encoding[33m:[39m [33mFileSy
stem[39m[33m.[39m[33mEncodingType[39m[33m.[39m[3
3mBase64[39m[33m,[39m
     [90m 84 |[39m   })[33m;[39m
     [90m 85 |[39m   [36mconst[39m arrayBuffer 
[33m=[39m decode(base64)[33m;[39m[0m

      at readAsStringAsync 
(src/lib/uploads/ai-images.ts:82:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/uploads/ai-images.ts:74:24)
      at doUpload (src/lib/uploads/ai-images.ts:132:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/inventory/__tests__/batch-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.error
      [BatchService] Update failed: TypeError: 
batch.update is not a function
          at update (C:\Users\Peter\GrowBro\src\lib\inve
ntory\batch-service.ts:342:20)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 350 |[39m     }[33m;[39m
     [90m 351 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 352 |[39m     
console[33m.[39merror([32m'[BatchService] Update 
failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 353 |[39m     [36mreturn[39m {
     [90m 354 |[39m       success[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 355 |[39m       error[33m:[39m error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Failed to 
update batch'[39m[33m,[39m[0m

      at error 
(src/lib/inventory/batch-service.ts:352:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [BatchService] Delete failed: TypeError: 
batch.update is not a function
          at update (C:\Users\Peter\GrowBro\src\lib\inve
ntory\batch-service.ts:381:19)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at Object.fn 
(C:\Users\Peter\GrowBro\jest-setup.ts:513:16)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply 
(C:\Users\Peter\GrowBro\jest-setup.ts:514:8)
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:397:39
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\jest-mock\build\index.js:404:13)
          at Object.mockConstructor [as write] (C:\Users
\Peter\GrowBro\node_modules\jest-mock\build\index.js:148
:19)
          at write (C:\Users\Peter\GrowBro\src\lib\inven
tory\batch-service.ts:380:20)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 388 |[39m     }[33m;[39m
     [90m 389 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 390 |[39m     
console[33m.[39merror([32m'[BatchService] Delete 
failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 391 |[39m     [36mreturn[39m {
     [90m 392 |[39m       success[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 393 |[39m       error[33m:[39m error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Failed to 
delete batch'[39m[33m,[39m[0m

      at error 
(src/lib/inventory/batch-service.ts:390:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [BatchService] Update failed: TypeError: 
batch.update is not a function
          at update (C:\Users\Peter\GrowBro\src\lib\inve
ntory\batch-service.ts:342:20)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 350 |[39m     }[33m;[39m
     [90m 351 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 352 |[39m     
console[33m.[39merror([32m'[BatchService] Update 
failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 353 |[39m     [36mreturn[39m {
     [90m 354 |[39m       success[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 355 |[39m       error[33m:[39m error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Failed to 
update batch'[39m[33m,[39m[0m

      at error 
(src/lib/inventory/batch-service.ts:352:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [BatchService] Update failed: TypeError: 
batch.update is not a function
          at update (C:\Users\Peter\GrowBro\src\lib\inve
ntory\batch-service.ts:342:20)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 350 |[39m     }[33m;[39m
     [90m 351 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 352 |[39m     
console[33m.[39merror([32m'[BatchService] Update 
failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 353 |[39m     [36mreturn[39m {
     [90m 354 |[39m       success[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 355 |[39m       error[33m:[39m error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Failed to 
update batch'[39m[33m,[39m[0m

      at error 
(src/lib/inventory/batch-service.ts:352:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [BatchService] Delete failed: TypeError: 
batch.update is not a function
          at update (C:\Users\Peter\GrowBro\src\lib\inve
ntory\batch-service.ts:381:19)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at Object.fn 
(C:\Users\Peter\GrowBro\jest-setup.ts:513:16)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply 
(C:\Users\Peter\GrowBro\jest-setup.ts:514:8)
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:397:39
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\jest-mock\build\index.js:404:13)
          at Object.mockConstructor [as write] (C:\Users
\Peter\GrowBro\node_modules\jest-mock\build\index.js:148
:19)
          at write (C:\Users\Peter\GrowBro\src\lib\inven
tory\batch-service.ts:380:20)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 388 |[39m     }[33m;[39m
     [90m 389 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 390 |[39m     
console[33m.[39merror([32m'[BatchService] Delete 
failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 391 |[39m     [36mreturn[39m {
     [90m 392 |[39m       success[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 393 |[39m       error[33m:[39m error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Failed to 
delete batch'[39m[33m,[39m[0m

      at error 
(src/lib/inventory/batch-service.ts:390:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ BatchService ÔÇ║ addBatch ÔÇ║ creates batch with 
valid data

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "LOT-001"
    Received: undefined

    [0m [90m 56 |[39m       expect(result[33m.[39ms
uccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 57 |[39m       expect(result[33m.[39mdata)
[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 58 |[39m       expect(res
ult[33m.[39mdata[33m?[39m[33m.[39mlotNumber)[33m.
[39mtoBe([32m'LOT-001'[39m)[33m;[39m
     [90m    |[39m                                    
  [31m[1m^[22m[39m
     [90m 59 |[39m       expect(result[33m.[39mdata
[33m?[39m[33m.[39mquantity)[33m.[39mtoBe([35m100[
39m)[33m;[39m
     [90m 60 |[39m       expect(result[33m.[39mdata
[33m?[39m[33m.[39mcostPerUnitMinor)[33m.[39mtoBe([
35m1500[39m)[33m;[39m
     [90m 61 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:58:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ addBatch ÔÇ║ fails with 
duplicate lot number for same item

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 116 |[39m       })[33m;[39m
     [90m 117 |[39m
    [31m[1m>[22m[39m[90m 118 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mfalse[39m)
[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 119 |[39m       expect(result[33m.[39mvali
dationErrors[33m?[39m[33m.[39m[[35m0[39m][33m?[3
9m[33m.[39mmessage)[33m.[39mtoBe(
     [90m 120 |[39m         [33mBATCH_VALIDATION_ERRO
RS[39m[33m.[39m[33mDUPLICATE_LOT[39m
     [90m 121 |[39m       )[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:118:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ addBatch ÔÇ║ sets receivedAt to 
current time if not provided

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 133 |[39m
     [90m 134 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 135 |[39m       expect(re
sult[33m.[39mdata[33m?[39m[33m.[39mreceivedAt)[33
m.[39mtoBeDefined()[33m;[39m
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 136 |[39m       expect(result[33m.[39mdata
[33m![39m[33m.[39mreceivedAt[33m.[39mgetTime())[3
3m.[39mtoBeGreaterThanOrEqual(
     [90m 137 |[39m         before[33m.[39mgetTime()
     [90m 138 |[39m       )[33m;[39m[0m

      at Object.toBeDefined (src/lib/inventory/__tests__
/batch-service.test.ts:135:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatchesForItem - FEFO 
Ordering ÔÇ║ returns batches sorted by expiration date 
(FEFO)

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 0
    Received array:  []

    [0m [90m 172 |[39m       [36mconst[39m batches 
[33m=[39m [36mawait[39m 
getBatchesForItem(testItemId)[33m;[39m
     [90m 173 |[39m
    [31m[1m>[22m[39m[90m 174 |[39m       expect(ba
tches)[33m.[39mtoHaveLength([35m3[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 175 |[39m       expect(batches[[35m0[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-EARLY'[39
m)[33m;[39m [90m// Expires first[39m
     [90m 176 |[39m       expect(batches[[35m1[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-MID'[39m)
[33m;[39m
     [90m 177 |[39m       expect(batches[[35m2[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-LATE'[39m
)[33m;[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/batch-service.test.ts:174:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatchesForItem - FEFO 
Ordering ÔÇ║ places batches without expiry at the end

    expect(received).toHaveLength(expected)

    Expected length: 2
    Received length: 0
    Received array:  []

    [0m [90m 197 |[39m       [36mconst[39m batches 
[33m=[39m [36mawait[39m 
getBatchesForItem(testItemId)[33m;[39m
     [90m 198 |[39m
    [31m[1m>[22m[39m[90m 199 |[39m       expect(ba
tches)[33m.[39mtoHaveLength([35m2[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 200 |[39m       expect(batches[[35m0[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-EXPIRES'[
39m)[33m;[39m
     [90m 201 |[39m       expect(batches[[35m1[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-NO-EXPIRY'
[39m)[33m;[39m
     [90m 202 |[39m     })[33m;[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/batch-service.test.ts:199:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatchesForItem - FEFO 
Ordering ÔÇ║ excludes expired batches by default

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 224 |[39m       [36mconst[39m batches 
[33m=[39m [36mawait[39m 
getBatchesForItem(testItemId[33m,[39m 
[36mfalse[39m)[33m;[39m
     [90m 225 |[39m
    [31m[1m>[22m[39m[90m 226 |[39m       expect(ba
tches)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 227 |[39m       expect(batches[[35m0[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-VALID'[39
m)[33m;[39m
     [90m 228 |[39m     })[33m;[39m
     [90m 229 |[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/batch-service.test.ts:226:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatchesForItem - FEFO 
Ordering ÔÇ║ includes expired batches when requested

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 242 |[39m       [36mconst[39m batches 
[33m=[39m [36mawait[39m 
getBatchesForItem(testItemId[33m,[39m 
[36mtrue[39m)[33m;[39m
     [90m 243 |[39m
    [31m[1m>[22m[39m[90m 244 |[39m       expect(ba
tches)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 245 |[39m       expect(batches[[35m0[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-EXPIRED'[
39m)[33m;[39m
     [90m 246 |[39m     })[33m;[39m
     [90m 247 |[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/batch-service.test.ts:244:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatchesForItem - FEFO 
Ordering ÔÇ║ excludes batches with zero quantity

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 269 |[39m       [36mconst[39m batches 
[33m=[39m [36mawait[39m 
getBatchesForItem(testItemId)[33m;[39m
     [90m 270 |[39m
    [31m[1m>[22m[39m[90m 271 |[39m       expect(ba
tches)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 272 |[39m       expect(batches[[35m0[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-FULL'[39m
)[33m;[39m
     [90m 273 |[39m     })[33m;[39m
     [90m 274 |[39m   })[33m;[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/batch-service.test.ts:271:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatch ÔÇ║ retrieves batch by 
ID

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "LOT-GET"
    Received: undefined

    [0m [90m 286 |[39m
     [90m 287 |[39m       expect(batch)[33m.[39mnot
[33m.[39mtoBeNull()[33m;[39m
    [31m[1m>[22m[39m[90m 288 |[39m       expect(ba
tch[33m?[39m[33m.[39mlotNumber)[33m.[39mtoBe([32m
'LOT-GET'[39m)[33m;[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 289 |[39m     })[33m;[39m
     [90m 290 |[39m
     [90m 291 |[39m     test([32m'returns null for 
deleted batch'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:288:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatch ÔÇ║ returns null for 
deleted batch

    expect(received).toBeNull()

    Received: {"costPerUnitMinor": undefined, 
"createdAt": undefined, "deletedAt": undefined, 
"expiresOn": undefined, "id": "mock-id", "itemId": 
undefined, "lotNumber": undefined, "quantity": 
undefined, "receivedAt": undefined, "updatedAt": 
undefined, "userId": undefined}

    [0m [90m 300 |[39m       [36mconst[39m batch 
[33m=[39m [36mawait[39m getBatch(created[33m.[39md
ata[33m![39m[33m.[39mid)[33m;[39m
     [90m 301 |[39m
    [31m[1m>[22m[39m[90m 302 |[39m       
expect(batch)[33m.[39mtoBeNull()[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 303 |[39m     })[33m;[39m
     [90m 304 |[39m   })[33m;[39m
     [90m 305 |[39m[0m

      at Object.toBeNull (src/lib/inventory/__tests__/ba
tch-service.test.ts:302:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ updateBatchQuantity ÔÇ║ updates 
quantity with reason

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 318 |[39m       })[33m;[39m
     [90m 319 |[39m
    [31m[1m>[22m[39m[90m 320 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 321 |[39m       expect(result[33m.[39mdata
[33m?[39m[33m.[39mquantity)[33m.[39mtoBe([35m75[
39m)[33m;[39m
     [90m 322 |[39m     })[33m;[39m
     [90m 323 |[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:320:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ updateBatchQuantity ÔÇ║ creates 
movement record for quantity adjustment

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 370 |[39m       })[33m;[39m
     [90m 371 |[39m
    [31m[1m>[22m[39m[90m 372 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 373 |[39m       expect(result[33m.[39mdata
[33m?[39m[33m.[39mquantity)[33m.[39mtoBe([35m75[
39m)[33m;[39m
     [90m 374 |[39m
     [90m 375 |[39m       [90m// Verify movement 
record was created[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:372:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getTotalAvailableQuantity ÔÇ║ 
sums quantities across all batches

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 100
    Received: 0

    [0m [90m 415 |[39m       [36mconst[39m total 
[33m=[39m [36mawait[39m 
getTotalAvailableQuantity(testItemId)[33m;[39m
     [90m 416 |[39m
    [31m[1m>[22m[39m[90m 417 |[39m       
expect(total)[33m.[39mtoBe([35m100[39m)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 418 |[39m     })[33m;[39m
     [90m 419 |[39m
     [90m 420 |[39m     test([32m'excludes expired 
batches by default'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:417:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getTotalAvailableQuantity ÔÇ║ 
excludes expired batches by default

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 50
    Received: 0

    [0m [90m 439 |[39m       [36mconst[39m total 
[33m=[39m [36mawait[39m 
getTotalAvailableQuantity(testItemId[33m,[39m 
[36mfalse[39m)[33m;[39m
     [90m 440 |[39m
    [31m[1m>[22m[39m[90m 441 |[39m       
expect(total)[33m.[39mtoBe([35m50[39m)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 442 |[39m     })[33m;[39m
     [90m 443 |[39m   })[33m;[39m
     [90m 444 |[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:441:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ deleteBatch ÔÇ║ soft deletes 
batch

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 454 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m deleteBatch(created[33m.[3
9mdata[33m![39m[33m.[39mid)[33m;[39m
     [90m 455 |[39m
    [31m[1m>[22m[39m[90m 456 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 457 |[39m
     [90m 458 |[39m       [36mconst[39m batch 
[33m=[39m [36mawait[39m getBatch(created[33m.[39md
ata[33m![39m[33m.[39mid)[33m;[39m
     [90m 459 |[39m       
expect(batch)[33m.[39mtoBeNull()[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:456:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/harvest/__tests__/edge-cases.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      [OverlapDetection] Failed to check overlaps: 
Error: DB error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\harvest\__tests__\edge-cases.test.ts:89:46)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 71 |[39m     }[33m;[39m
     [90m 72 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 73 |[39m     
console[33m.[39merror([32m'[OverlapDetection] Failed 
to check overlaps:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 74 |[39m     [36mreturn[39m {
     [90m 75 |[39m       hasOverlap[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 76 |[39m       
overlappingHarvests[33m:[39m [][33m,[39m[0m

      at error 
(src/lib/harvest/overlap-detection.ts:73:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ Edge Case Guidance ÔÇ║ 
getOverlappingHarvestsGuidance ÔÇ║ should provide 
guidance for overlapping harvests

    expect(received).toContain(expected) // indexOf

    Expected substring: "overlappingHarvests"
    Received string:    
"harvest.edge_case.overlapping_harvests.title"

    [0m [90m 409 |[39m       [36mconst[39m 
guidance [33m=[39m 
getOverlappingHarvestsGuidance([32m'Test 
Plant'[39m[33m,[39m [35m2[39m)[33m;[39m
     [90m 410 |[39m
    [31m[1m>[22m[39m[90m 411 |[39m       expect(gu
idance[33m.[39mtitle)[33m.[39mtoContain([32m'overla
ppingHarvests'[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 412 |[39m       expect(guidance[33m.[39mse
verity)[33m.[39mtoBe([32m'warning'[39m)[33m;[39m
     [90m 413 |[39m       expect(guidance[33m.[39mac
tions)[33m.[39mtoHaveLength([35m3[39m)[33m;[39m
     [90m 414 |[39m       expect(guidance[33m.[39mac
tions[[35m0[39m][33m.[39mactionType)[33m.[39mtoBe(
[32m'navigate'[39m)[33m;[39m[0m

      at Object.toContain 
(src/lib/harvest/__tests__/edge-cases.test.ts:411:30)

  ÔùÅ Edge Case Guidance ÔÇ║ 
getMissingDryWeightGuidance ÔÇ║ should provide guidance 
for missing dry weight

    expect(received).toContain(expected) // indexOf

    Expected substring: "missingDryWeight"
    Received string:    
"harvest.edge_case.missing_dry_weight.title"

    [0m [90m 420 |[39m       [36mconst[39m 
guidance [33m=[39m 
getMissingDryWeightGuidance()[33m;[39m
     [90m 421 |[39m
    [31m[1m>[22m[39m[90m 422 |[39m       expect(gu
idance[33m.[39mtitle)[33m.[39mtoContain([32m'missin
gDryWeight'[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 423 |[39m       expect(guidance[33m.[39mse
verity)[33m.[39mtoBe([32m'error'[39m)[33m;[39m
     [90m 424 |[39m       
expect(guidance[33m.[39mactions[33m.[39msome((a) 
[33m=>[39m a[33m.[39mactionType [33m===[39m [32m'
fix'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 425 |[39m     })[33m;[39m[0m

      at Object.toContain 
(src/lib/harvest/__tests__/edge-cases.test.ts:422:30)

  ÔùÅ Edge Case Guidance ÔÇ║ getUnusualDurationGuidance 
ÔÇ║ should provide guidance for too short duration

    expect(received).toContain(expected) // indexOf

    Expected substring: "durationTooShort"
    Received string:    
"harvest.edge_case.duration_too_short.title"

    [0m [90m 435 |[39m       })[33m;[39m
     [90m 436 |[39m
    [31m[1m>[22m[39m[90m 437 |[39m       expect(gu
idance[33m.[39mtitle)[33m.[39mtoContain([32m'durati
onTooShort'[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 438 |[39m       expect(guidance[33m.[39mse
verity)[33m.[39mtoBe([32m'warning'[39m)[33m;[39m
     [90m 439 |[39m       expect(guidance[33m.[39mac
tions)[33m.[39mtoHaveLength([35m3[39m)[33m;[39m
     [90m 440 |[39m     })[33m;[39m[0m

      at Object.toContain 
(src/lib/harvest/__tests__/edge-cases.test.ts:437:30)

  ÔùÅ Edge Case Guidance ÔÇ║ getUnusualDurationGuidance 
ÔÇ║ should provide guidance for too long duration

    expect(received).toContain(expected) // indexOf

    Expected substring: "durationTooLong"
    Received string:    
"harvest.edge_case.duration_too_long.title"

    [0m [90m 448 |[39m       })[33m;[39m
     [90m 449 |[39m
    [31m[1m>[22m[39m[90m 450 |[39m       expect(gu
idance[33m.[39mtitle)[33m.[39mtoContain([32m'durati
onTooLong'[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 451 |[39m       expect(guidance[33m.[39mse
verity)[33m.[39mtoBe([32m'info'[39m)[33m;[39m
     [90m 452 |[39m     })[33m;[39m
     [90m 453 |[39m   })[33m;[39m[0m

      at Object.toContain 
(src/lib/harvest/__tests__/edge-cases.test.ts:450:30)

  ÔùÅ Edge Case Guidance ÔÇ║ 
getHarvestValidationGuidance ÔÇ║ should return multiple 
guidance messages for multiple issues

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 469 |[39m       expect(guidance)[33m.[
39mtoHaveLength([35m3[39m)[33m;[39m
     [90m 470 |[39m       
expect(guidance[33m.[39msome((g) [33m=>[39m g[33m.
[39mtitle[33m.[39mincludes([32m'overlapping'[39m)))
[33m.[39mtoBe([36mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 471 |[39m       
expect(guidance[33m.[39msome((g) [33m=>[39m g[33m.
[39mtitle[33m.[39mincludes([32m'missingDryWeight'[39
m)))[33m.[39mtoBe(
     [90m     |[39m                                   
                                       
[31m[1m^[22m[39m
     [90m 472 |[39m         [36mtrue[39m
     [90m 473 |[39m       )[33m;[39m
     [90m 474 |[39m       
expect(guidance[33m.[39msome((g) [33m=>[39m g[33m.
[39mtitle[33m.[39mincludes([32m'syncConflict'[39m)))
[33m.[39mtoBe([36mtrue[39m)[33m;[39m[0m

      at Object.toBe 
(src/lib/harvest/__tests__/edge-cases.test.ts:471:74)

  ÔùÅ Edge Case Guidance ÔÇ║ 
getHarvestValidationGuidance ÔÇ║ should include clock 
skew guidance

    expect(received).toContain(expected) // indexOf

    Expected substring: "clockSkew"
    Received string:    
"harvest.edge_case.clock_skew.title"

    [0m [90m 495 |[39m
     [90m 496 |[39m       expect(guidance)[33m.[39mt
oHaveLength([35m1[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 497 |[39m       expect(gu
idance[[35m0[39m][33m.[39mtitle)[33m.[39mtoContain
([32m'clockSkew'[39m)[33m;[39m
     [90m     |[39m                                 
[31m[1m^[22m[39m
     [90m 498 |[39m     })[33m;[39m
     [90m 499 |[39m   })[33m;[39m
     [90m 500 |[39m[0m

      at Object.toContain 
(src/lib/harvest/__tests__/edge-cases.test.ts:497:33)

PASS src/lib/moderation/appeals-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.error
      [AppealsService] Failed to get appeal status: 
TypeError: _supabase.supabase.from(...).select(...).eq(.
..).is(...).single is not a function
          at single (C:\Users\Peter\GrowBro\src\lib\mode
ration\appeals-service.ts:184:8)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\appeals-service.ts:192:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\appeals-service.ts:175:38)
          at getAppealStatus (C:\Users\Peter\GrowBro\src
\lib\moderation\appeals-service.ts:472:26)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\appeals-service.ts:508:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\appeals-service.ts:465:44)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\appeals-service.test.ts:361:51)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 187 |[39m     [36mreturn[39m data 
[36mas[39m [33mAppeal[39m[33m;[39m
     [90m 188 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 189 |[39m     
console[33m.[39merror([32m'[AppealsService] Failed 
to get appeal status:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 190 |[39m     [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 191 |[39m   }
     [90m 192 |[39m }[0m

      at error 
(src/lib/moderation/appeals-service.ts:189:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/appeals-service.ts:192:2)
      at apply 
(src/lib/moderation/appeals-service.ts:175:38)
      at getAppealStatus 
(src/lib/moderation/appeals-service.ts:472:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/appeals-service.ts:508:2)
      at apply 
(src/lib/moderation/appeals-service.ts:465:44)
      at Object.<anonymous> 
(src/lib/moderation/appeals-service.test.ts:361:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      [AppealsService] Failed to get appeal status: 
TypeError: _supabase.supabase.from(...).select(...).eq(.
..).is(...).single is not a function
          at single (C:\Users\Peter\GrowBro\src\lib\mode
ration\appeals-service.ts:184:8)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\appeals-service.ts:175:38)
          at getAppealStatus (C:\Users\Peter\GrowBro\src
\lib\moderation\appeals-service.ts:472:26)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\appeals-service.ts:465:44)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\appeals-service.test.ts:385:51)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 187 |[39m     [36mreturn[39m data 
[36mas[39m [33mAppeal[39m[33m;[39m
     [90m 188 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 189 |[39m     
console[33m.[39merror([32m'[AppealsService] Failed 
to get appeal status:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 190 |[39m     [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 191 |[39m   }
     [90m 192 |[39m }[0m

      at error 
(src/lib/moderation/appeals-service.ts:189:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/appeals-service.ts:175:38)
      at getAppealStatus 
(src/lib/moderation/appeals-service.ts:472:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/appeals-service.ts:465:44)
      at Object.<anonymous> 
(src/lib/moderation/appeals-service.test.ts:385:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/moderation/__tests__/integration-workflows.
test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Complete 
Notice-and-Action Workflow ÔÇ║ should process report 
from submission to decision with SoR

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Appeals Workflow 
with Human Review ÔÇ║ should process appeal from 
submission to reversal

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Appeals Workflow 
with Human Review ÔÇ║ should escalate to ODS when 
internal appeal exhausted

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Trusted Flagger 
Priority Processing ÔÇ║ should prioritize trusted 
flagger reports

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Age-Gating 
Enforcement Workflow ÔÇ║ should enforce age-gating for 
cannabis content

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Age-Gating 
Enforcement Workflow ÔÇ║ should apply safer defaults 
for minors

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Geo-Restriction 
Workflow ÔÇ║ should apply geo-restrictions with SoR 
notification

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ SLA Compliance 
Workflow ÔÇ║ should escalate reports approaching SLA 
deadline

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

FAIL src/api/strains/use-prefetch-strain.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.log
      [auth] onAuthStateChange INITIAL_SESSION false

      at log (src/lib/auth/index.tsx:404:13)

  ÔùÅ usePrefetchStrain ÔÇ║ usePrefetchStrainsPage ÔÇ║ 
prefetches strains page with default params

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
        "gcTime": 600000,
        "initialPageParam": undefined,
    -   "queryFn": Any<Function>,
    +   "queryFn": [Function queryFn],
        "queryKey": Array [
    -     "strains",
    +     "strains-infinite",
    +     undefined,
    +     undefined,
    +     20,
        ],
        "staleTime": 300000,
      },

    Number of calls: 1

    [0m [90m 71 |[39m       })[33m;[39m
     [90m 72 |[39m
    [31m[1m>[22m[39m[90m 73 |[39m       expect(moc
kQueryClient[33m.[39mprefetchInfiniteQuery)[33m.[39m
toHaveBeenCalledWith({
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 74 |[39m         queryKey[33m:[39m 
[[32m'strains'[39m][33m,[39m
     [90m 75 |[39m         queryFn[33m:[39m 
expect[33m.[39many([33mFunction[39m)[33m,[39m
     [90m 76 |[39m         
initialPageParam[33m:[39m undefined[33m,[39m[0m

      at Object.toHaveBeenCalledWith 
(src/api/strains/use-prefetch-strain.test.ts:73:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ usePrefetchStrain ÔÇ║ usePrefetchStrainsPage ÔÇ║ 
prefetches strains page with filters

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
        "gcTime": 600000,
        "initialPageParam": undefined,
    -   "queryFn": Any<Function>,
    +   "queryFn": [Function queryFn],
        "queryKey": Array [
    -     "strains",
    +     "strains-infinite",
    +     "OG Kush",
    +     Object {
    +       "effects": Array [
    +         "Relaxed",
    +         "Happy",
    +       ],
    +       "race": "indica",
    +       "thcMax": 25,
    +       "thcMin": 15,
    +     },
    +     10,
        ],
        "staleTime": 300000,
      },

    Number of calls: 1

    [0m [90m 110 |[39m       })[33m;[39m
     [90m 111 |[39m
    [31m[1m>[22m[39m[90m 112 |[39m       expect(mo
ckQueryClient[33m.[39mprefetchInfiniteQuery)[33m.[39
mtoHaveBeenCalledWith({
     [90m     |[39m                                   
                  [31m[1m^[22m[39m
     [90m 113 |[39m         queryKey[33m:[39m 
[[32m'strains'[39m][33m,[39m
     [90m 114 |[39m         queryFn[33m:[39m 
expect[33m.[39many([33mFunction[39m)[33m,[39m
     [90m 115 |[39m         
initialPageParam[33m:[39m undefined[33m,[39m[0m

      at Object.toHaveBeenCalledWith 
(src/api/strains/use-prefetch-strain.test.ts:112:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/playbooks/i18n/__tests__/translations.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ English translations ÔÇ║ should have 
valid ICU format for pluralization

    TypeError: Cannot read properties of undefined 
(reading 'total_weeks_one')

    [0m [90m  9 |[39m
     [90m 10 |[39m         [90m// Check 
pluralization patterns[39m
    [31m[1m>[22m[39m[90m 11 |[39m         expect(p
laybooks[33m.[39mselection[33m.[39mpreview[33m.[39
mtotal_weeks_one)[33m.[39mtoContain(
     [90m    |[39m                                    
        [31m[1m^[22m[39m
     [90m 12 |[39m           [32m'{{count}}'[39m
     [90m 13 |[39m         )[33m;[39m
     [90m 14 |[39m         expect(playbooks[33m.[39m
selection[33m.[39mpreview[33m.[39mtotal_weeks_other)
[33m.[39mtoContain([0m

      at Object.total_weeks_one (src/lib/playbooks/i18n/
__tests__/translations.test.ts:11:44)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ English translations ÔÇ║ should have 
valid ICU format for interpolation

    TypeError: Cannot read properties of undefined 
(reading 'confidence')

    [0m [90m 51 |[39m
     [90m 52 |[39m         [90m// Check 
interpolation patterns[39m
    [31m[1m>[22m[39m[90m 53 |[39m         expect(p
laybooks[33m.[39madjustments[33m.[39mconfidence)[33
m.[39mtoContain([32m'{{percent}}'[39m)[33m;[39m
     [90m    |[39m                                    
  [31m[1m^[22m[39m
     [90m 54 |[39m         expect(playbooks[33m.[39m
save_as_template_description)[33m.[39mtoContain(
     [90m 55 |[39m           
[32m'{{percentage}}'[39m
     [90m 56 |[39m         )[33m;[39m[0m

      at Object.confidence (src/lib/playbooks/i18n/__tes
ts__/translations.test.ts:53:38)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ English translations ÔÇ║ should have 
valid accessibility labels with interpolation

    expect(received).toContain(expected) // indexOf

    Matcher error: received value must not be null nor 
undefined

    Received has value: undefined

    [0m [90m 76 |[39m         [36mconst[39m { 
playbooks } [33m=[39m (enTranslations [36mas[39m 
any)[33m.[39mcommunity[33m;[39m
     [90m 77 |[39m
    [31m[1m>[22m[39m[90m 78 |[39m         expect(p
laybooks[33m.[39maccessibility[33m.[39mplaybook_card
)[33m.[39mtoContain([32m'{{name}}'[39m)[33m;[39m
     [90m    |[39m                                    
                   [31m[1m^[22m[39m
     [90m 79 |[39m         expect(playbooks[33m.[39m
accessibility[33m.[39mplaybook_card)[33m.[39mtoConta
in([32m'{{setup}}'[39m)[33m;[39m
     [90m 80 |[39m         expect(playbooks[33m.[39m
accessibility[33m.[39mplaybook_card)[33m.[39mtoConta
in([32m'{{weeks}}'[39m)[33m;[39m
     [90m 81 |[39m         expect(playbooks[33m.[39m
accessibility[33m.[39mplaybook_card)[33m.[39mtoConta
in([32m'{{tasks}}'[39m)[33m;[39m[0m

      at Object.toContain (src/lib/playbooks/i18n/__test
s__/translations.test.ts:78:55)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ German translations ÔÇ║ should have 
valid ICU format for pluralization

    TypeError: Cannot read properties of undefined 
(reading 'total_weeks_one')

    [0m [90m 122 |[39m
     [90m 123 |[39m         [90m// Check 
pluralization patterns[39m
    [31m[1m>[22m[39m[90m 124 |[39m         expect(
playbooks[33m.[39mselection[33m.[39mpreview[33m.[3
9mtotal_weeks_one)[33m.[39mtoContain(
     [90m     |[39m                                   
         [31m[1m^[22m[39m
     [90m 125 |[39m           [32m'{{count}}'[39m
     [90m 126 |[39m         )[33m;[39m
     [90m 127 |[39m         expect(playbooks[33m.[39
mselection[33m.[39mpreview[33m.[39mtotal_weeks_other
)[33m.[39mtoContain([0m

      at Object.total_weeks_one (src/lib/playbooks/i18n/
__tests__/translations.test.ts:124:44)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ German translations ÔÇ║ should have 
valid ICU format for interpolation

    TypeError: Cannot read properties of undefined 
(reading 'confidence')

    [0m [90m 164 |[39m
     [90m 165 |[39m         [90m// Check 
interpolation patterns[39m
    [31m[1m>[22m[39m[90m 166 |[39m         expect(
playbooks[33m.[39madjustments[33m.[39mconfidence)[3
3m.[39mtoContain([32m'{{percent}}'[39m)[33m;[39m
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 167 |[39m         expect(playbooks[33m.[39
msave_as_template_description)[33m.[39mtoContain(
     [90m 168 |[39m           
[32m'{{percentage}}'[39m
     [90m 169 |[39m         )[33m;[39m[0m

      at Object.confidence (src/lib/playbooks/i18n/__tes
ts__/translations.test.ts:166:38)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ German translations ÔÇ║ should have 
valid accessibility labels with interpolation

    expect(received).toContain(expected) // indexOf

    Matcher error: received value must not be null nor 
undefined

    Received has value: undefined

    [0m [90m 189 |[39m         [36mconst[39m { 
playbooks } [33m=[39m (deTranslations [36mas[39m 
any)[33m.[39mcommunity[33m;[39m
     [90m 190 |[39m
    [31m[1m>[22m[39m[90m 191 |[39m         expect(
playbooks[33m.[39maccessibility[33m.[39mplaybook_car
d)[33m.[39mtoContain([32m'{{name}}'[39m)[33m;[39m
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 192 |[39m         expect(playbooks[33m.[39
maccessibility[33m.[39mplaybook_card)[33m.[39mtoCont
ain([32m'{{setup}}'[39m)[33m;[39m
     [90m 193 |[39m         expect(playbooks[33m.[39
maccessibility[33m.[39mplaybook_card)[33m.[39mtoCont
ain([32m'{{weeks}}'[39m)[33m;[39m
     [90m 194 |[39m         expect(playbooks[33m.[39
maccessibility[33m.[39mplaybook_card)[33m.[39mtoCont
ain([32m'{{tasks}}'[39m)[33m;[39m[0m

      at Object.toContain (src/lib/playbooks/i18n/__test
s__/translations.test.ts:191:55)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Translation key parity ÔÇ║ should have 
matching nested keys for selection

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 3

    @@ -4,10 +4,13 @@
        "10",
        "11",
        "12",
        "13",
        "14",
    +   "15",
    +   "16",
    +   "17",
        "2",
        "3",
        "4",
        "5",
        "6",

    [0m [90m 246 |[39m         )[33m;[39m
     [90m 247 |[39m
    [31m[1m>[22m[39m[90m 248 |[39m         expect(
enKeys[33m.[39msort())[33m.[39mtoEqual(deKeys[33m.
[39msort())[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 249 |[39m       })[33m;[39m
     [90m 250 |[39m
     [90m 251 |[39m       test([32m'should have 
matching nested keys for 
schedule.shift'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toEqual (src/lib/playbooks/i18n/__tests_
_/translations.test.ts:248:31)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Translation key parity ÔÇ║ should have 
matching nested keys for schedule.shift

    expect(received).toEqual(expected) // deep equality

    - Expected  - 3
    + Received  + 0

    @@ -3,13 +3,10 @@
        "1",
        "10",
        "11",
        "12",
        "13",
    -   "14",
    -   "15",
    -   "16",
        "2",
        "3",
        "4",
        "5",
        "6",

    [0m [90m 257 |[39m         )[33m;[39m
     [90m 258 |[39m
    [31m[1m>[22m[39m[90m 259 |[39m         expect(
enKeys[33m.[39msort())[33m.[39mtoEqual(deKeys[33m.
[39msort())[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 260 |[39m       })[33m;[39m
     [90m 261 |[39m
     [90m 262 |[39m       test([32m'should have 
matching nested keys for trichome'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toEqual (src/lib/playbooks/i18n/__tests_
_/translations.test.ts:259:31)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Translation key parity ÔÇ║ should have 
matching nested keys for trichome

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 1

    @@ -3,10 +3,11 @@
        "1",
        "10",
        "11",
        "12",
        "13",
    +   "14",
        "2",
        "3",
        "4",
        "5",
        "6",

    [0m [90m 268 |[39m         )[33m;[39m
     [90m 269 |[39m
    [31m[1m>[22m[39m[90m 270 |[39m         expect(
enKeys[33m.[39msort())[33m.[39mtoEqual(deKeys[33m.
[39msort())[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 271 |[39m       })[33m;[39m
     [90m 272 |[39m
     [90m 273 |[39m       test([32m'should have 
matching nested keys for community'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toEqual (src/lib/playbooks/i18n/__tests_
_/translations.test.ts:270:31)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Translation key parity ÔÇ║ should have 
matching nested keys for community

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 1

    @@ -7,10 +7,11 @@
        "13",
        "14",
        "15",
        "16",
        "17",
    +   "18",
        "2",
        "3",
        "4",
        "5",
        "6",

    [0m [90m 279 |[39m         )[33m;[39m
     [90m 280 |[39m
    [31m[1m>[22m[39m[90m 281 |[39m         expect(
enKeys[33m.[39msort())[33m.[39mtoEqual(deKeys[33m.
[39msort())[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 282 |[39m       })[33m;[39m
     [90m 283 |[39m
     [90m 284 |[39m       test([32m'should have 
matching nested keys for accessibility'[39m[33m,[39m 
() [33m=>[39m {[0m

      at Object.toEqual (src/lib/playbooks/i18n/__tests_
_/translations.test.ts:281:31)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Translation key parity ÔÇ║ should have 
matching nested keys for accessibility

    expect(received).toEqual(expected) // deep equality

    - Expected  - 4
    + Received  + 0

    @@ -26,14 +26,10 @@
        "30",
        "31",
        "32",
        "33",
        "34",
    -   "35",
    -   "36",
    -   "37",
    -   "38",
        "4",
        "5",
        "6",
        "7",
        "8",

    [0m [90m 290 |[39m         )[33m;[39m
     [90m 291 |[39m
    [31m[1m>[22m[39m[90m 292 |[39m         expect(
enKeys[33m.[39msort())[33m.[39mtoEqual(deKeys[33m.
[39msort())[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 293 |[39m       })[33m;[39m
     [90m 294 |[39m     })[33m;[39m
     [90m 295 |[39m[0m

      at Object.toEqual (src/lib/playbooks/i18n/__tests_
_/translations.test.ts:292:31)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Phases translations ÔÇ║ should have all 
phase translations in English

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 298 |[39m         [36mconst[39m { 
phases } [33m=[39m (enTranslations [36mas[39m 
any)[33m.[39mcommunity[33m;[39m
     [90m 299 |[39m
    [31m[1m>[22m[39m[90m 300 |[39m         expect(
phases[33m.[39mseedling)[33m.[39mtoBeDefined()[33m;
[39m
     [90m     |[39m                                 
[31m[1m^[22m[39m
     [90m 301 |[39m         expect(phases[33m.[39mve
g)[33m.[39mtoBeDefined()[33m;[39m
     [90m 302 |[39m         expect(phases[33m.[39mfl
ower)[33m.[39mtoBeDefined()[33m;[39m
     [90m 303 |[39m         expect(phases[33m.[39mha
rvest)[33m.[39mtoBeDefined()[33m;[39m[0m

      at Object.toBeDefined (src/lib/playbooks/i18n/__te
sts__/translations.test.ts:300:33)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Phases translations ÔÇ║ should have all 
phase translations in German

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 307 |[39m         [36mconst[39m { 
phases } [33m=[39m (deTranslations [36mas[39m 
any)[33m.[39mcommunity[33m;[39m
     [90m 308 |[39m
    [31m[1m>[22m[39m[90m 309 |[39m         expect(
phases[33m.[39mseedling)[33m.[39mtoBeDefined()[33m;
[39m
     [90m     |[39m                                 
[31m[1m^[22m[39m
     [90m 310 |[39m         expect(phases[33m.[39mve
g)[33m.[39mtoBeDefined()[33m;[39m
     [90m 311 |[39m         expect(phases[33m.[39mfl
ower)[33m.[39mtoBeDefined()[33m;[39m
     [90m 312 |[39m         expect(phases[33m.[39mha
rvest)[33m.[39mtoBeDefined()[33m;[39m[0m

      at Object.toBeDefined (src/lib/playbooks/i18n/__te
sts__/translations.test.ts:309:33)

FAIL src/lib/moderation/__tests__/dsa-transparency-clien
t.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ Schema 
Validation ÔÇ║ should submit SoR with all required DSA 
fields

    TypeError: client.submitSoR is not a function

    [0m [90m 67 |[39m       })[33m;[39m
     [90m 68 |[39m
    [31m[1m>[22m[39m[90m 69 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m       expect(result[33m.[39msucce
ss)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 72 |[39m       expect(result[33m.[39mtrans
parencyDbId)[33m.[39mtoBe([32m'ec-db-id-456'[39m)[3
3m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:69:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ Schema 
Validation ÔÇ║ should reject SoR missing required fields

    TypeError: client.submitSoR is not a function

    [0m [90m 90 |[39m       } [36mas[39m 
any[33m;[39m
     [90m 91 |[39m
    [31m[1m>[22m[39m[90m 92 |[39m       
[36mawait[39m expect(client[33m.[39msubmitSoR(invali
dSoR))[33m.[39mrejects[33m.[39mtoThrow(
     [90m    |[39m                           
[31m[1m^[22m[39m
     [90m 93 |[39m         [35m/missing required 
field/i[39m
     [90m 94 |[39m       )[33m;[39m
     [90m 95 |[39m     })[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:92:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ Schema 
Validation ÔÇ║ should validate decisionGround enum 
values

    TypeError: client.submitSoR is not a function

    [0m [90m 117 |[39m       }[33m;[39m
     [90m 118 |[39m
    [31m[1m>[22m[39m[90m 119 |[39m       
[36mawait[39m expect(client[33m.[39msubmitSoR(invali
dSoR))[33m.[39mrejects[33m.[39mtoThrow(
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 120 |[39m         [35m/invalid 
decisionGround/i[39m
     [90m 121 |[39m       )[33m;[39m
     [90m 122 |[39m     })[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:119:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 4xx 
Error Handling ÔÇ║ should handle 400 Bad Request as 
permanent error

    TypeError: client.submitSoR is not a function

    [0m [90m 136 |[39m       })[33m;[39m
     [90m 137 |[39m
    [31m[1m>[22m[39m[90m 138 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 139 |[39m
     [90m 140 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 141 |[39m       expect(result[33m.[39merro
r)[33m.[39mtoMatchObject({[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:138:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 4xx 
Error Handling ÔÇ║ should handle 401 Unauthorized as 
permanent error

    TypeError: client.submitSoR is not a function

    [0m [90m 159 |[39m       })[33m;[39m
     [90m 160 |[39m
    [31m[1m>[22m[39m[90m 161 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 162 |[39m
     [90m 163 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 164 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'perman
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:161:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 4xx 
Error Handling ÔÇ║ should handle 403 Forbidden as 
permanent error

    TypeError: client.submitSoR is not a function

    [0m [90m 179 |[39m       })[33m;[39m
     [90m 180 |[39m
    [31m[1m>[22m[39m[90m 181 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 182 |[39m
     [90m 183 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 184 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'perman
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:181:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 4xx 
Error Handling ÔÇ║ should handle 422 Unprocessable 
Entity as permanent error

    TypeError: client.submitSoR is not a function

    [0m [90m 202 |[39m       })[33m;[39m
     [90m 203 |[39m
    [31m[1m>[22m[39m[90m 204 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 205 |[39m
     [90m 206 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 207 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'perman
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:204:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 4xx 
Error Handling ÔÇ║ should handle 429 Rate Limit as 
transient error

    TypeError: client.submitSoR is not a function

    [0m [90m 223 |[39m       })[33m;[39m
     [90m 224 |[39m
    [31m[1m>[22m[39m[90m 225 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 226 |[39m
     [90m 227 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 228 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'transi
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:225:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 5xx 
Error Handling ÔÇ║ should handle 500 Internal Server 
Error as transient

    TypeError: client.submitSoR is not a function

    [0m [90m 245 |[39m       })[33m;[39m
     [90m 246 |[39m
    [31m[1m>[22m[39m[90m 247 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 248 |[39m
     [90m 249 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 250 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'transi
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:247:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 5xx 
Error Handling ÔÇ║ should handle 502 Bad Gateway as 
transient

    TypeError: client.submitSoR is not a function

    [0m [90m 264 |[39m       })[33m;[39m
     [90m 265 |[39m
    [31m[1m>[22m[39m[90m 266 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 267 |[39m
     [90m 268 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 269 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'transi
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:266:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 5xx 
Error Handling ÔÇ║ should handle 503 Service 
Unavailable as transient

    TypeError: client.submitSoR is not a function

    [0m [90m 283 |[39m       })[33m;[39m
     [90m 284 |[39m
    [31m[1m>[22m[39m[90m 285 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 286 |[39m
     [90m 287 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 288 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'transi
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:285:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 5xx 
Error Handling ÔÇ║ should handle 504 Gateway Timeout as 
transient

    TypeError: client.submitSoR is not a function

    [0m [90m 302 |[39m       })[33m;[39m
     [90m 303 |[39m
    [31m[1m>[22m[39m[90m 304 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 305 |[39m
     [90m 306 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 307 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'transi
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:304:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 
Network Error Handling ÔÇ║ should handle network 
timeout as transient

    TypeError: client.submitSoR is not a function

    [0m [90m 316 |[39m       
mockFetch[33m.[39mmockRejectedValueOnce([36mnew[39m 
[33mError[39m([32m'Network timeout'[39m))[33m;[39m
     [90m 317 |[39m
    [31m[1m>[22m[39m[90m 318 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 319 |[39m
     [90m 320 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 321 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'transi
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:318:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 
Network Error Handling ÔÇ║ should handle connection 
refused as transient

    TypeError: client.submitSoR is not a function

    [0m [90m 328 |[39m       
mockFetch[33m.[39mmockRejectedValueOnce([36mnew[39m 
[33mError[39m([32m'ECONNREFUSED'[39m))[33m;[39m
     [90m 329 |[39m
    [31m[1m>[22m[39m[90m 330 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 331 |[39m
     [90m 332 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 333 |[39m       expect(result[33m.[39mretr
yable)[33m.[39mtoBe([36mtrue[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:330:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 
Idempotency ÔÇ║ should include idempotency key in 
request headers

    TypeError: client.submitSoR is not a function

    [0m [90m 346 |[39m       })[33m;[39m
     [90m 347 |[39m
    [31m[1m>[22m[39m[90m 348 |[39m       
[36mawait[39m 
client[33m.[39msubmitSoR(validSoR[33m,[39m 
idempotencyKey)[33m;[39m
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 349 |[39m
     [90m 350 |[39m       
expect(mockFetch)[33m.[39mtoHaveBeenCalledWith(
     [90m 351 |[39m         
expect[33m.[39many([33mString[39m)[33m,[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:348:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 
Idempotency ÔÇ║ should handle 409 Conflict for 
duplicate submission

    TypeError: client.submitSoR is not a function

    [0m [90m 372 |[39m       })[33m;[39m
     [90m 373 |[39m
    [31m[1m>[22m[39m[90m 374 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR[33m,[39m 
idempotencyKey)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 375 |[39m
     [90m 376 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m [90m// 
Treat as success[39m
     [90m 377 |[39m       expect(result[33m.[39mtran
sparencyDbId)[33m.[39mtoBe([32m'ec-db-id-existing'[3
9m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:374:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ Batch 
Submission ÔÇ║ should submit batch of SoRs (1-100)

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 402 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
client[33m.[39msubmitBatch(sorBatch)[33m;[39m
     [90m 403 |[39m
    [31m[1m>[22m[39m[90m 404 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 405 |[39m       expect(result[33m.[39macce
pted)[33m.[39mtoBe([35m50[39m)[33m;[39m
     [90m 406 |[39m       expect(result[33m.[39mreje
cted)[33m.[39mtoBe([35m0[39m)[33m;[39m
     [90m 407 |[39m       expect(result[33m.[39mresu
lts)[33m.[39mtoHaveLength([35m50[39m)[33m;[39m[0m

      at Object.toBe (src/lib/moderation/__tests__/dsa-t
ransparency-client.test.ts:404:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ Batch 
Submission ÔÇ║ should reject batch exceeding 100 SoRs

    expect(received).rejects.toThrow(expected)

    Expected pattern: /batch size exceeds maximum/i
    Received message: "Batch size must be at most 100, 
got 101"

        [0m [90m 162 |[39m
         [90m 163 |[39m     [36mif[39m 
(statements[33m.[39mlength [33m>[39m 
[33mBATCH_SIZE_MAX[39m) {
        [31m[1m>[22m[39m[90m 164 |[39m       
[36mthrow[39m [36mnew[39m [33mError[39m(
         [90m     |[39m             
[31m[1m^[22m[39m
         [90m 165 |[39m         [32m`Batch size must 
be at most ${BATCH_SIZE_MAX}, got 
${statements.length}`[39m
         [90m 166 |[39m       )[33m;[39m
         [90m 167 |[39m     }[0m

      at DSATransparencyClient.<anonymous> 
(src/lib/moderation/dsa-transparency-client.ts:164:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at DSATransparencyClient.<anonymous> (node_modules
/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at DSATransparencyClient.apply [as submitBatch] 
(src/lib/moderation/dsa-transparency-client.ts:143:20)
      at Object.submitBatch (src/lib/moderation/__tests_
_/dsa-transparency-client.test.ts:415:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/moderation/__tests__/ds
a-transparency-client.test.ts:415:58)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ Batch 
Submission ÔÇ║ should handle partial batch failures

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 440 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
client[33m.[39msubmitBatch(sorBatch)[33m;[39m
     [90m 441 |[39m
    [31m[1m>[22m[39m[90m 442 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 443 |[39m       expect(result[33m.[39macce
pted)[33m.[39mtoBe([35m8[39m)[33m;[39m
     [90m 444 |[39m       expect(result[33m.[39mreje
cted)[33m.[39mtoBe([35m2[39m)[33m;[39m
     [90m 445 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/moderation/__tests__/dsa-t
ransparency-client.test.ts:442:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ PII 
Verification ÔÇ║ should reject SoR containing PII fields

    TypeError: client.submitSoR is not a function

    [0m [90m 454 |[39m       }[33m;[39m
     [90m 455 |[39m
    [31m[1m>[22m[39m[90m 456 |[39m       
[36mawait[39m expect(client[33m.[39msubmitSoR(sorWit
hPII))[33m.[39mrejects[33m.[39mtoThrow(
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 457 |[39m         [35m/contains PII 
fields/i[39m
     [90m 458 |[39m       )[33m;[39m
     [90m 459 |[39m     })[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:456:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ PII 
Verification ÔÇ║ should accept SoR with only 
pseudonymized identifiers

    TypeError: client.submitSoR is not a function

    [0m [90m 468 |[39m       })[33m;[39m
     [90m 469 |[39m
    [31m[1m>[22m[39m[90m 470 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 471 |[39m
     [90m 472 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 473 |[39m       [90m// Verify no PII in 
request body[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:470:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/notifications/push-receiver-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

  ÔùÅ PushReceiverService ÔÇ║ setupNotificationHandlers 
ÔÇ║ should set up notification handler with correct 
settings

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 19 |[39m
     [90m 20 |[39m [36masync[39m [36mfunction[39m 
setupMockNotifications() {
    [31m[1m>[22m[39m[90m 21 |[39m   
[36mconst[39m { [36mdefault[39m[33m:[39m 
[33mNotifications[39m } [33m=[39m [36mawait[39m [
36mimport[39m([32m'expo-notifications'[39m)[33m;[39
m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 22 |[39m   [36mconst[39m 
anyNotifications[33m:[39m any [33m=[39m 
[33mNotifications[39m [36mas[39m any[33m;[39m
     [90m 23 |[39m   [36mreturn[39m 
anyNotifications[33m;[39m
     [90m 24 |[39m }[0m

      at 
src/lib/notifications/push-receiver-service.test.ts:21:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/notifications/push-receiver-serv
ice.test.ts:24:2)
      at apply (src/lib/notifications/push-receiver-serv
ice.test.ts:20:38)
      at Object.setupMockNotifications (src/lib/notifica
tions/push-receiver-service.test.ts:28:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ PushReceiverService ÔÇ║ setupNotificationHandlers 
ÔÇ║ should register foreground and response listeners

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 19 |[39m
     [90m 20 |[39m [36masync[39m [36mfunction[39m 
setupMockNotifications() {
    [31m[1m>[22m[39m[90m 21 |[39m   
[36mconst[39m { [36mdefault[39m[33m:[39m 
[33mNotifications[39m } [33m=[39m [36mawait[39m [
36mimport[39m([32m'expo-notifications'[39m)[33m;[39
m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 22 |[39m   [36mconst[39m 
anyNotifications[33m:[39m any [33m=[39m 
[33mNotifications[39m [36mas[39m any[33m;[39m
     [90m 23 |[39m   [36mreturn[39m 
anyNotifications[33m;[39m
     [90m 24 |[39m }[0m

      at 
src/lib/notifications/push-receiver-service.test.ts:21:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/notifications/push-receiver-serv
ice.test.ts:20:38)
      at Object.setupMockNotifications (src/lib/notifica
tions/push-receiver-service.test.ts:48:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ PushReceiverService ÔÇ║ setupNotificationHandlers 
ÔÇ║ should remove existing subscriptions before 
creating new ones

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 19 |[39m
     [90m 20 |[39m [36masync[39m [36mfunction[39m 
setupMockNotifications() {
    [31m[1m>[22m[39m[90m 21 |[39m   
[36mconst[39m { [36mdefault[39m[33m:[39m 
[33mNotifications[39m } [33m=[39m [36mawait[39m [
36mimport[39m([32m'expo-notifications'[39m)[33m;[39
m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 22 |[39m   [36mconst[39m 
anyNotifications[33m:[39m any [33m=[39m 
[33mNotifications[39m [36mas[39m any[33m;[39m
     [90m 23 |[39m   [36mreturn[39m 
anyNotifications[33m;[39m
     [90m 24 |[39m }[0m

      at 
src/lib/notifications/push-receiver-service.test.ts:21:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/notifications/push-receiver-serv
ice.test.ts:20:38)
      at Object.setupMockNotifications (src/lib/notifica
tions/push-receiver-service.test.ts:63:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ PushReceiverService ÔÇ║ 
removeNotificationHandlers ÔÇ║ should remove all 
notification subscriptions

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 19 |[39m
     [90m 20 |[39m [36masync[39m [36mfunction[39m 
setupMockNotifications() {
    [31m[1m>[22m[39m[90m 21 |[39m   
[36mconst[39m { [36mdefault[39m[33m:[39m 
[33mNotifications[39m } [33m=[39m [36mawait[39m [
36mimport[39m([32m'expo-notifications'[39m)[33m;[39
m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 22 |[39m   [36mconst[39m 
anyNotifications[33m:[39m any [33m=[39m 
[33mNotifications[39m [36mas[39m any[33m;[39m
     [90m 23 |[39m   [36mreturn[39m 
anyNotifications[33m;[39m
     [90m 24 |[39m }[0m

      at 
src/lib/notifications/push-receiver-service.test.ts:21:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/notifications/push-receiver-serv
ice.test.ts:20:38)
      at Object.setupMockNotifications (src/lib/notifica
tions/push-receiver-service.test.ts:84:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ PushReceiverService ÔÇ║ 
handleNotificationResponse ÔÇ║ should navigate to deep 
link when provided

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 108 |[39m [36mfunction[39m 
testHandleNotificationResponse() {
     [90m 109 |[39m   it([32m'should navigate to 
deep link when provided'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 110 |[39m     
[36mconst[39m { [33mDeepLinkService[39m } 
[33m=[39m [36mawait[39m [36mimport[39m(
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 111 |[39m       
[32m'@/lib/notifications/deep-link-service'[39m
     [90m 112 |[39m     )[33m;[39m
     [90m 113 |[39m     [36mconst[39m mockHandle 
[33m=[39m jest[0m

      at Object.<anonymous> (src/lib/notifications/push-
receiver-service.test.ts:110:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/assessment/__tests__/playbook-integration.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ PlaybookIntegrationService ÔÇ║ suggestAdjustments 
ÔÇ║ stage-specific adjustments ÔÇ║ should include 
stage-specific adjustments when stage metadata is 
available

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 268 |[39m         
expect(result[33m.[39madjustments[33m.[39msome(adj 
[33m=>[39m
     [90m 269 |[39m           adj[33m.[39mdescriptio
n[33m.[39mincludes([32m'reduced strength'[39m)
    [31m[1m>[22m[39m[90m 270 |[39m         
))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m            [31m[1m^[22m[39m
     [90m 271 |[39m       })[33m;[39m
     [90m 272 |[39m
     [90m 273 |[39m       it([32m'should not include 
stage-specific adjustments when stage metadata is 
missing'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/assessment/__tests__/playb
ook-integration.test.ts:270:12)

  ÔùÅ suggestPlaybookAdjustments (convenience function) 
ÔÇ║ should work with assessmentId provided

    ReferenceError: mockAssessment is not defined

    [0m [90m 338 |[39m   it([32m'should work with 
assessmentId provided'[39m[33m,[39m () [33m=>[39m {
     [90m 339 |[39m     [36mconst[39m result 
[33m=[39m suggestPlaybookAdjustments({
    [31m[1m>[22m[39m[90m 340 |[39m       
assessment[33m:[39m mockAssessment[33m,[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 341 |[39m       plan[33m:[39m 
mockPlan[33m,[39m
     [90m 342 |[39m       context[33m:[39m 
mockContext[33m,[39m
     [90m 343 |[39m       assessmentId[33m:[39m 
[32m'convenience-test-123'[39m[33m,[39m[0m

      at Object.mockAssessment (src/lib/assessment/__tes
ts__/playbook-integration.test.ts:340:19)

  ÔùÅ suggestPlaybookAdjustments (convenience function) 
ÔÇ║ should work without assessmentId provided

    ReferenceError: mockAssessment is not defined

    [0m [90m 350 |[39m   it([32m'should work 
without assessmentId provided'[39m[33m,[39m () 
[33m=>[39m {
     [90m 351 |[39m     [36mconst[39m result 
[33m=[39m suggestPlaybookAdjustments({
    [31m[1m>[22m[39m[90m 352 |[39m       
assessment[33m:[39m mockAssessment[33m,[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 353 |[39m       plan[33m:[39m 
mockPlan[33m,[39m
     [90m 354 |[39m       context[33m:[39m 
mockContext[33m,[39m
     [90m 355 |[39m       [90m// assessmentId not 
provided[39m[0m

      at Object.mockAssessment (src/lib/assessment/__tes
ts__/playbook-integration.test.ts:352:19)

  ÔùÅ suggestPlaybookAdjustments (convenience function) 
ÔÇ║ should return same result as service method

    ReferenceError: mockAssessment is not defined

    [0m [90m 362 |[39m   it([32m'should return same 
result as service method'[39m[33m,[39m () 
[33m=>[39m {
     [90m 363 |[39m     [36mconst[39m options 
[33m=[39m {
    [31m[1m>[22m[39m[90m 364 |[39m       
assessment[33m:[39m mockAssessment[33m,[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 365 |[39m       plan[33m:[39m 
mockPlan[33m,[39m
     [90m 366 |[39m       context[33m:[39m 
mockContext[33m,[39m
     [90m 367 |[39m       assessmentId[33m:[39m 
[32m'comparison-test'[39m[33m,[39m[0m

      at Object.mockAssessment (src/lib/assessment/__tes
ts__/playbook-integration.test.ts:364:19)

FAIL src/lib/assessment/__tests__/assessment-feedback-se
rvice.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ AssessmentFeedbackService ÔÇ║ submitFeedback ÔÇ║ 
should create feedback record with all fields

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "test-assessment-1"
    Received: undefined

    [0m [90m 31 |[39m
     [90m 32 |[39m       
expect(feedback)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 33 |[39m       expect(fee
dback[33m.[39massessmentId)[33m.[39mtoBe(options[33
m.[39massessmentId)[33m;[39m
     [90m    |[39m                                    
 [31m[1m^[22m[39m
     [90m 34 |[39m       expect(feedback[33m.[39mhel
pful)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 35 |[39m       expect(feedback[33m.[39miss
ueResolved)[33m.[39mtoBe([32m'yes'[39m)[33m;[39m
     [90m 36 |[39m       expect(feedback[33m.[39mnot
es)[33m.[39mtoBe(options[33m.[39mnotes)[33m;[39m[
0m

      at Object.toBe (src/lib/assessment/__tests__/asses
sment-feedback-service.test.ts:33:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AssessmentFeedbackService ÔÇ║ submitFeedback ÔÇ║ 
should create feedback without optional fields

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "test-assessment-2"
    Received: undefined

    [0m [90m 61 |[39m
     [90m 62 |[39m       
expect(feedback)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 63 |[39m       expect(fee
dback[33m.[39massessmentId)[33m.[39mtoBe(options[33
m.[39massessmentId)[33m;[39m
     [90m    |[39m                                    
 [31m[1m^[22m[39m
     [90m 64 |[39m       expect(feedback[33m.[39mhel
pful)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 65 |[39m       expect(feedback[33m.[39miss
ueResolved)[33m.[39mtoBeNull()[33m;[39m
     [90m 66 |[39m       expect(feedback[33m.[39mnot
es)[33m.[39mtoBeNull()[33m;[39m[0m

      at Object.toBe (src/lib/assessment/__tests__/asses
sment-feedback-service.test.ts:63:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AssessmentFeedbackService ÔÇ║ submitFeedback ÔÇ║ 
should truncate notes to 500 characters

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 500
    Received: undefined

    [0m [90m 78 |[39m       [33mCREATED_ASSESSMENT_I
DS[39m[33m.[39madd(options[33m.[39massessmentId)[3
3m;[39m
     [90m 79 |[39m
    [31m[1m>[22m[39m[90m 80 |[39m       expect(fee
dback[33m.[39mnotes[33m?[39m[33m.[39mlength)[33m.
[39mtoBe([35m500[39m)[33m;[39m
     [90m    |[39m                                    
  [31m[1m^[22m[39m
     [90m 81 |[39m     })[33m;[39m
     [90m 82 |[39m
     [90m 83 |[39m     it([32m'should trim 
whitespace from notes'[39m[33m,[39m [36masync[39m 
() [33m=>[39m {[0m

      at Object.toBe (src/lib/assessment/__tests__/asses
sment-feedback-service.test.ts:80:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AssessmentFeedbackService ÔÇ║ submitFeedback ÔÇ║ 
should trim whitespace from notes

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Test notes with spaces"
    Received: undefined

    [0m [90m 91 |[39m       [33mCREATED_ASSESSMENT_I
DS[39m[33m.[39madd(options[33m.[39massessmentId)[3
3m;[39m
     [90m 92 |[39m
    [31m[1m>[22m[39m[90m 93 |[39m       expect(fee
dback[33m.[39mnotes)[33m.[39mtoBe([32m'Test notes 
with spaces'[39m)[33m;[39m
     [90m    |[39m                              
[31m[1m^[22m[39m
     [90m 94 |[39m     })[33m;[39m
     [90m 95 |[39m   })[33m;[39m
     [90m 96 |[39m[0m

      at Object.toBe (src/lib/assessment/__tests__/asses
sment-feedback-service.test.ts:93:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AssessmentFeedbackService ÔÇ║ 
getAssessmentFeedback ÔÇ║ should return feedback for 
existing assessment

    expect(received).not.toBeNull()

    Received: null

    [0m [90m 108 |[39m         [36mawait[39m feedba
ckService[33m.[39mgetAssessmentFeedback([32m'test-ass
essment-5'[39m)[33m;[39m
     [90m 109 |[39m
    [31m[1m>[22m[39m[90m 110 |[39m       expect(fe
edback)[33m.[39mnot[33m.[39mtoBeNull()[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 111 |[39m       expect(feedback[33m?[39m[
33m.[39massessmentId)[33m.[39mtoBe([32m'test-assessm
ent-5'[39m)[33m;[39m
     [90m 112 |[39m     })[33m;[39m
     [90m 113 |[39m[0m

      at Object.toBeNull (src/lib/assessment/__tests__/a
ssessment-feedback-service.test.ts:110:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AssessmentFeedbackService ÔÇ║ 
hasAssessmentFeedback ÔÇ║ should return true when 
feedback exists

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 131 |[39m         [36mawait[39m feedba
ckService[33m.[39mhasAssessmentFeedback([32m'test-ass
essment-6'[39m)[33m;[39m
     [90m 132 |[39m
    [31m[1m>[22m[39m[90m 133 |[39m       expect(ha
sFeedback)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 134 |[39m     })[33m;[39m
     [90m 135 |[39m
     [90m 136 |[39m     it([32m'should return false 
when feedback does not exist'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/assessment/__tests__/asses
sment-feedback-service.test.ts:133:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AssessmentFeedbackService ÔÇ║ getFeedbackStats 
ÔÇ║ should calculate correct feedback statistics

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 4
    Received:    0

    [0m [90m 173 |[39m       [36mconst[39m stats 
[33m=[39m [36mawait[39m 
feedbackService[33m.[39mgetFeedbackStats()[33m;[39m
     [90m 174 |[39m
    [31m[1m>[22m[39m[90m 175 |[39m       expect(st
ats[33m.[39mtotal)[33m.[39mtoBeGreaterThanOrEqual([
35m4[39m)[33m;[39m
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 176 |[39m       expect(stats[33m.[39mhelpf
ul)[33m.[39mtoBeGreaterThanOrEqual([35m3[39m)[33m;
[39m
     [90m 177 |[39m       expect(stats[33m.[39mnotHe
lpful)[33m.[39mtoBeGreaterThanOrEqual([35m1[39m)[33
m;[39m
     [90m 178 |[39m       expect(stats[33m.[39mresol
ved)[33m.[39mtoBeGreaterThanOrEqual([35m1[39m)[33m;
[39m[0m

      at Object.toBeGreaterThanOrEqual (src/lib/assessme
nt/__tests__/assessment-feedback-service.test.ts:175:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)


  ÔùÅ Test suite failed to run

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 183 |[39m
     [90m 184 |[39m   afterAll([36masync[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 185 |[39m     
[36mconst[39m { [33mQ[39m } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db'[39m)[33m;[39m
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 186 |[39m     [36mawait[39m 
database[33m.[39mwrite([36masync[39m () 
[33m=>[39m {
     [90m 187 |[39m       [36mconst[39m toDelete 
[33m=[39m [36mawait[39m database
     [90m 188 |[39m         [33m.[39m[36mget[39m[
33m<[39m[33mAssessmentFeedbackModel[39m[33m>[39m([
32m'assessment_feedback'[39m)[0m

      at Object.<anonymous> (src/lib/assessment/__tests_
_/assessment-feedback-service.test.ts:185:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/nutrient-engine/services/template-service.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ Template Service ÔÇ║ validateTemplate ÔÇ║ 
propagates phase validation errors with context

    expect(received).toThrow(expected)

    Expected pattern: /Phase 1.*vegetative/
    Received message: "Phase 1 (veg): Duration must be 
between 1 and 365 days, got -1"

        [0m [90m 237 |[39m     } [36mcatch[39m 
(error) {
         [90m 238 |[39m       [36mif[39m (error 
[36minstanceof[39m [33mTemplateValidationError[39m) 
{
        [31m[1m>[22m[39m[90m 239 |[39m         
[36mthrow[39m [36mnew[39m 
[33mTemplateValidationError[39m(
         [90m     |[39m               
[31m[1m^[22m[39m
         [90m 240 |[39m           [32m`Phase ${index 
+ 1} (${phase.phase}): ${error.message}`[39m[33m,[39m
         [90m 241 |[39m           
[32m`phases[${index}].${error.field}`[39m
         [90m 242 |[39m         )[33m;[39m[0m

      at src/lib/nutrient-engine/services/template-servi
ce.ts:239:15
                at Array.forEach (<anonymous>)
      at forEach (src/lib/nutrient-engine/services/templ
ate-service.ts:234:18)
      at src/lib/nutrient-engine/services/template-servi
ce.test.ts:356:36
      at Object.<anonymous> 
(node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] 
(node_modules/expect/build/index.js:320:21)
      at Object.toThrow (src/lib/nutrient-engine/service
s/template-service.test.ts:356:48)
      at Object.toThrow (src/lib/nutrient-engine/service
s/template-service.test.ts:356:48)

FAIL src/lib/task-notifications.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ TaskNotificationService scheduleTaskReminder 
success ÔÇ║ uses reminderAtUtc when provided

    expect(received).resolves.toBe()

    Received promise rejected instead of resolved
    Rejected to value: [TypeError: Cannot read 
properties of undefined (reading 'DATE')]

    [0m [90m 62 |[39m     })[33m;[39m
     [90m 63 |[39m
    [31m[1m>[22m[39m[90m 64 |[39m     
[36mawait[39m 
expect(service[33m.[39mscheduleTaskReminder(task 
[36mas[39m any))[33m.[39mresolves[33m.[39mtoBe(
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 65 |[39m       
[32m'mock-notification-id'[39m
     [90m 66 |[39m     )[33m;[39m
     [90m 67 |[39m   })[33m;[39m[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect 
(src/lib/task-notifications.test.ts:64:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ TaskNotificationService scheduleTaskReminder 
success ÔÇ║ falls back to dueAtUtc when reminderAtUtc 
is missing

    expect(received).resolves.toBe()

    Received promise rejected instead of resolved
    Rejected to value: [TypeError: Cannot read 
properties of undefined (reading 'DATE')]

    [0m [90m 75 |[39m     })[33m;[39m
     [90m 76 |[39m
    [31m[1m>[22m[39m[90m 77 |[39m     
[36mawait[39m 
expect(service[33m.[39mscheduleTaskReminder(task 
[36mas[39m any))[33m.[39mresolves[33m.[39mtoBe(
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 78 |[39m       
[32m'mock-notification-id'[39m
     [90m 79 |[39m     )[33m;[39m
     [90m 80 |[39m   })[33m;[39m[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect 
(src/lib/task-notifications.test.ts:77:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ TaskNotificationService scheduleTaskReminder 
success ÔÇ║ handles string timestamps

    expect(received).resolves.toBe()

    Received promise rejected instead of resolved
    Rejected to value: [TypeError: Cannot read 
properties of undefined (reading 'DATE')]

    [0m [90m 86 |[39m     })[33m;[39m
     [90m 87 |[39m
    [31m[1m>[22m[39m[90m 88 |[39m     
[36mawait[39m 
expect(service[33m.[39mscheduleTaskReminder(task 
[36mas[39m any))[33m.[39mresolves[33m.[39mtoBe(
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 89 |[39m       
[32m'mock-notification-id'[39m
     [90m 90 |[39m     )[33m;[39m
     [90m 91 |[39m   })[33m;[39m[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect 
(src/lib/task-notifications.test.ts:88:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/inventory/__tests__/movement-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ Movement Service ÔÇ║ createMovement ÔÇ║ should 
create a valid receipt movement

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "mock-id"
    Received: undefined

    [0m [90m 217 |[39m       expect(result[33m.[39m
success)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 218 |[39m       expect(result[33m.[39mmove
ment)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 219 |[39m       expect(re
sult[33m.[39mmovement[33m?[39m[33m.[39mitemId)[33
m.[39mtoBe(testItem[33m.[39mid)[33m;[39m
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 220 |[39m       expect(result[33m.[39mmove
ment[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'rec
eipt'[39m)[33m;[39m
     [90m 221 |[39m       expect(result[33m.[39mmove
ment[33m?[39m[33m.[39mquantityDelta)[33m.[39mtoBe(
[35m500[39m)[33m;[39m
     [90m 222 |[39m       expect(result[33m.[39mmove
ment[33m?[39m[33m.[39mcostPerUnitMinor)[33m.[39mto
Be([35m45[39m)[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:219:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ createMovement ÔÇ║ should 
create a valid consumption movement

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "consumption"
    Received: undefined

    [0m [90m 239 |[39m       expect(result[33m.[39m
success)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 240 |[39m       expect(result[33m.[39mmove
ment)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 241 |[39m       expect(re
sult[33m.[39mmovement[33m?[39m[33m.[39mtype)[33m.
[39mtoBe([32m'consumption'[39m)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 242 |[39m       expect(result[33m.[39mmove
ment[33m?[39m[33m.[39mquantityDelta)[33m.[39mtoBe(
[33m-[39m[35m100[39m)[33m;[39m
     [90m 243 |[39m       expect(result[33m.[39mmove
ment[33m?[39m[33m.[39mtaskId)[33m.[39mtoBe([32m't
ask-123'[39m)[33m;[39m
     [90m 244 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:241:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ createMovement ÔÇ║ should 
return existing movement on duplicate external_key

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 264 |[39m       [36mconst[39m result2 
[33m=[39m [36mawait[39m 
createMovement(request)[33m;[39m
     [90m 265 |[39m       expect(result2[33m.[39msuc
cess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 266 |[39m       expect(re
sult2[33m.[39misIdempotentDuplicate)[33m.[39mtoBe([
36mtrue[39m)[33m;[39m
     [90m     |[39m                                   
          [31m[1m^[22m[39m
     [90m 267 |[39m       expect(result2[33m.[39mmov
ement[33m?[39m[33m.[39mid)[33m.[39mtoBe(result1[3
3m.[39mmovement[33m?[39m[33m.[39mid)[33m;[39m
     [90m 268 |[39m     })[33m;[39m
     [90m 269 |[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:266:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ 
createMovementWithBatchUpdate ÔÇ║ should atomically 
create movement and update batch quantity

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 301 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
createMovementWithBatchUpdate(request)[33m;[39m
     [90m 302 |[39m
    [31m[1m>[22m[39m[90m 303 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 304 |[39m       expect(result[33m.[39mmove
ment)[33m.[39mtoBeDefined()[33m;[39m
     [90m 305 |[39m
     [90m 306 |[39m       [90m// Verify batch 
quantity was updated[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:303:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ 
createMovementWithBatchUpdate ÔÇ║ should fail if batch 
quantity would go negative

    expect(received).toContain(expected) // indexOf

    Expected substring: "Insufficient batch quantity"
    Received string:    "batch.update is not a function"

    [0m [90m 324 |[39m
     [90m 325 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 326 |[39m       expect(re
sult[33m.[39merror)[33m.[39mtoContain([32m'Insuffic
ient batch quantity'[39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 327 |[39m
     [90m 328 |[39m       [90m// Verify batch 
quantity was not changed[39m
     [90m 329 |[39m       [36mconst[39m 
unchangedBatch [33m=[39m [36mawait[39m database[0m

      at Object.toContain (src/lib/inventory/__tests__/m
ovement-service.test.ts:326:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ 
createMovementWithBatchUpdate ÔÇ║ should handle 
idempotency with batch updates

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 349 |[39m       [90m// First call[39m
     [90m 350 |[39m       [36mconst[39m result1 
[33m=[39m [36mawait[39m 
createMovementWithBatchUpdate(request)[33m;[39m
    [31m[1m>[22m[39m[90m 351 |[39m       expect(re
sult1[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 352 |[39m       expect(result1[33m.[39misI
dempotentDuplicate)[33m.[39mtoBe([36mfalse[39m)[33m
;[39m
     [90m 353 |[39m
     [90m 354 |[39m       [36mconst[39m 
batchAfterFirst [33m=[39m [36mawait[39m database[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:351:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ 
createMovementWithBatchUpdate ÔÇ║ should handle UNIQUE 
constraint violation gracefully

    TypeError: batch.update is not a function

    [0m [90m 394 |[39m           [33m.[39m[36mget
[39m[33m<[39m[33mInventoryBatchModel[39m[33m>[39m(
[32m'inventory_batches'[39m)
     [90m 395 |[39m           
[33m.[39mfind(testBatch[33m.[39mid)[33m;[39m
    [31m[1m>[22m[39m[90m 396 |[39m         
[36mawait[39m batch[33m.[39mupdate((record) 
[33m=>[39m {
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 397 |[39m           
record[33m.[39mquantity [33m=[39m 
record[33m.[39mquantity [33m+[39m 
request[33m.[39mquantityDelta[33m;[39m
     [90m 398 |[39m         })[33m;[39m
     [90m 399 |[39m[0m

      at update (src/lib/inventory/__tests__/movement-se
rvice.test.ts:396:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ getMovementsForItem ÔÇ║ 
should retrieve all movements for an item

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 0
    Received array:  []

    [0m [90m 492 |[39m       [36mconst[39m 
movements [33m=[39m [36mawait[39m 
getMovementsForItem(testItem[33m.[39mid)[33m;[39m
     [90m 493 |[39m
    [31m[1m>[22m[39m[90m 494 |[39m       expect(mo
vements)[33m.[39mtoHaveLength([35m3[39m)[33m;[39m
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 495 |[39m       [90m// Should be sorted by 
created_at desc[39m
     [90m 496 |[39m       [90m// Debug: log the 
actual order[39m
     [90m 497 |[39m       console[33m.[39mlog([0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/movement-service.test.ts:494:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ getMovementsForItem ÔÇ║ 
should filter movements by type

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 509 |[39m       })[33m;[39m
     [90m 510 |[39m
    [31m[1m>[22m[39m[90m 511 |[39m       expect(mo
vements)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 512 |[39m       expect(movements[[35m0[39m
][33m.[39mtype)[33m.[39mtoBe([32m'consumption'[39m
)[33m;[39m
     [90m 513 |[39m     })[33m;[39m
     [90m 514 |[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/movement-service.test.ts:511:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ getMovementsForTask ÔÇ║ 
should retrieve movements linked to a task

    expect(received).toHaveLength(expected)

    Expected length: 2
    Received length: 0
    Received array:  []

    [0m [90m 547 |[39m       [36mconst[39m 
movements [33m=[39m [36mawait[39m 
getMovementsForTask(taskId)[33m;[39m
     [90m 548 |[39m
    [31m[1m>[22m[39m[90m 549 |[39m       expect(mo
vements)[33m.[39mtoHaveLength([35m2[39m)[33m;[39m
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 550 |[39m       
expect(movements[33m.[39mevery((m) [33m=>[39m 
m[33m.[39mtaskId [33m===[39m 
taskId))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 551 |[39m     })[33m;[39m
     [90m 552 |[39m   })[33m;[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/movement-service.test.ts:549:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ getMovementByExternalKey ÔÇ║ 
should retrieve movement by external key

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "test-ext-key-001"
    Received: undefined

    [0m [90m 568 |[39m
     [90m 569 |[39m       
expect(movement)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 570 |[39m       expect(mo
vement[33m?[39m[33m.[39mexternalKey)[33m.[39mtoBe(
externalKey)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 571 |[39m     })[33m;[39m
     [90m 572 |[39m
     [90m 573 |[39m     it([32m'should return null 
if external key not found'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:570:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ calculateStockFromMovements 
ÔÇ║ should calculate current stock from movements

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 450
    Received: 0

    [0m [90m 605 |[39m       [36mconst[39m stock 
[33m=[39m [36mawait[39m calculateStockFromMovements(
testItem[33m.[39mid)[33m;[39m
     [90m 606 |[39m
    [31m[1m>[22m[39m[90m 607 |[39m       
expect(stock)[33m.[39mtoBe([35m450[39m)[33m;[39m 
[90m// 500 - 100 + 50[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 608 |[39m     })[33m;[39m
     [90m 609 |[39m   })[33m;[39m
     [90m 610 |[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:607:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ 
calculateTotalCostFromMovements ÔÇ║ should calculate 
total cost from movements

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 7500
    Received: 0

    [0m [90m 630 |[39m       [36mconst[39m 
totalCost [33m=[39m 
calculateTotalCostFromMovements(movements)[33m;[39m
     [90m 631 |[39m
    [31m[1m>[22m[39m[90m 632 |[39m       expect(to
talCost)[33m.[39mtoBe([35m7500[39m)[33m;[39m 
[90m// (100 * 50) + (50 * 50)[39m
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 633 |[39m     })[33m;[39m
     [90m 634 |[39m
     [90m 635 |[39m     it([32m'should ignore 
movements without cost'[39m[33m,[39m [36masync[39m 
() [33m=>[39m {[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:632:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/assessment/__tests__/image-storage.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Failed to get/create device secret: Error: Secure 
store error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:143:9
)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 35 |[39m   } [36mcatch[39m (error) {
     [90m 36 |[39m     [90m// Preserve original 
error so callers can see the underlying cause[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
console[33m.[39merror([32m'Failed to get/create 
device secret:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 38 |[39m     [36mif[39m (error 
[36minstanceof[39m [33mError[39m) [36mthrow[39m 
error[33m;[39m
     [90m 39 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([33mString[39m(error))[33m;[39m
     [90m 40 |[39m   }[0m

      at error 
(src/lib/assessment/image-storage.ts:37:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to compute integrity hash: Error: Hash 
failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:168:9
)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 68 |[39m     [36mreturn[39m 
digest[33m;[39m
     [90m 69 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 70 |[39m     
console[33m.[39merror([32m'Failed to compute 
integrity hash:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 71 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to compute integrity 
hash'[39m)[33m;[39m
     [90m 72 |[39m   }
     [90m 73 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:70:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to compute filename key: Error: Read failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:204:9
)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 106 |[39m     [36mreturn[39m 
hmac[33m.[39mtoString()[33m;[39m
     [90m 107 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 108 |[39m     
console[33m.[39merror([32m'Failed to compute 
filename key:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 109 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to compute filename 
key'[39m)[33m;[39m
     [90m 110 |[39m   }
     [90m 111 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:108:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to store image: Error: [FileSystem] 
Document directory unavailable. Ensure expo-file-system 
is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:128:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:160:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:117:33)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:215:3
8)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 155 |[39m     [36mreturn[39m { 
filenameKey[33m,[39m integritySha256[33m,[39m 
storedUri }[33m;[39m
     [90m 156 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 157 |[39m     
console[33m.[39merror([32m'Failed to store 
image:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 158 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
image'[39m)[33m;[39m
     [90m 159 |[39m   }
     [90m 160 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:157:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:160:2)
      at apply 
(src/lib/assessment/image-storage.ts:117:33)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:215:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to store image: Error: [FileSystem] 
Document directory unavailable. Ensure expo-file-system 
is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:128:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:117:33)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:236:2
3)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 155 |[39m     [36mreturn[39m { 
filenameKey[33m,[39m integritySha256[33m,[39m 
storedUri }[33m;[39m
     [90m 156 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 157 |[39m     
console[33m.[39merror([32m'Failed to store 
image:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 158 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
image'[39m)[33m;[39m
     [90m 159 |[39m   }
     [90m 160 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:157:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:117:33)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:236:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to store image: Error: [FileSystem] 
Document directory unavailable. Ensure expo-file-system 
is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:128:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:117:33)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:246:2
3)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 155 |[39m     [36mreturn[39m { 
filenameKey[33m,[39m integritySha256[33m,[39m 
storedUri }[33m;[39m
     [90m 156 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 157 |[39m     
console[33m.[39merror([32m'Failed to store 
image:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 158 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
image'[39m)[33m;[39m
     [90m 159 |[39m   }
     [90m 160 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:157:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:117:33)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:246:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to store image: Error: [FileSystem] 
Document directory unavailable. Ensure expo-file-system 
is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:128:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:117:33)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:261:3
0)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 155 |[39m     [36mreturn[39m { 
filenameKey[33m,[39m integritySha256[33m,[39m 
storedUri }[33m;[39m
     [90m 156 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 157 |[39m     
console[33m.[39merror([32m'Failed to store 
image:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 158 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
image'[39m)[33m;[39m
     [90m 159 |[39m   }
     [90m 160 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:157:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:117:33)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:261:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to store thumbnail: Error: [FileSystem] 
Document directory unavailable. Ensure expo-file-system 
is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:178:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:203:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:165:37)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:272:4
2)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 198 |[39m     [36mreturn[39m 
storedUri[33m;[39m
     [90m 199 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 200 |[39m     
console[33m.[39merror([32m'Failed to store 
thumbnail:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 201 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
thumbnail'[39m)[33m;[39m
     [90m 202 |[39m   }
     [90m 203 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:200:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:203:2)
      at apply 
(src/lib/assessment/image-storage.ts:165:37)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:272:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to store thumbnail: Error: [FileSystem] 
Document directory unavailable. Ensure expo-file-system 
is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:178:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:165:37)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:292:2
7)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 198 |[39m     [36mreturn[39m 
storedUri[33m;[39m
     [90m 199 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 200 |[39m     
console[33m.[39merror([32m'Failed to store 
thumbnail:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 201 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
thumbnail'[39m)[33m;[39m
     [90m 202 |[39m   }
     [90m 203 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:200:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:165:37)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:292:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to store thumbnail: Error: [FileSystem] 
Document directory unavailable. Ensure expo-file-system 
is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:178:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:165:37)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:306:2
7)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 198 |[39m     [36mreturn[39m 
storedUri[33m;[39m
     [90m 199 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 200 |[39m     
console[33m.[39merror([32m'Failed to store 
thumbnail:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 201 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
thumbnail'[39m)[33m;[39m
     [90m 202 |[39m   }
     [90m 203 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:200:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:165:37)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:306:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to store thumbnail: Error: [FileSystem] 
Document directory unavailable. Ensure expo-file-system 
is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:178:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:165:37)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:327:2
3)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 198 |[39m     [36mreturn[39m 
storedUri[33m;[39m
     [90m 199 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 200 |[39m     
console[33m.[39merror([32m'Failed to store 
thumbnail:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 201 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
thumbnail'[39m)[33m;[39m
     [90m 202 |[39m   }
     [90m 203 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:200:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:165:37)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:327:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to delete assessment images: Error: 
[FileSystem] Document directory unavailable. Ensure 
expo-file-system is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:215:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 221 |[39m     }
     [90m 222 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 223 |[39m     
console[33m.[39merror([32m'Failed to delete 
assessment images:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 224 |[39m     [90m// Don't throw - 
deletion should be idempotent[39m
     [90m 225 |[39m   }
     [90m 226 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:223:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      Failed to delete assessment images: Error: 
[FileSystem] Document directory unavailable. Ensure 
expo-file-system is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:215:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 221 |[39m     }
     [90m 222 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 223 |[39m     
console[33m.[39merror([32m'Failed to delete 
assessment images:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 224 |[39m     [90m// Don't throw - 
deletion should be idempotent[39m
     [90m 225 |[39m   }
     [90m 226 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:223:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      Failed to delete assessment images: Error: 
[FileSystem] Document directory unavailable. Ensure 
expo-file-system is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:215:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 221 |[39m     }
     [90m 222 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 223 |[39m     
console[33m.[39merror([32m'Failed to delete 
assessment images:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 224 |[39m     [90m// Don't throw - 
deletion should be idempotent[39m
     [90m 225 |[39m   }
     [90m 226 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:223:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      Failed to delete assessment images: Error: 
[FileSystem] Document directory unavailable. Ensure 
expo-file-system is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:215:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 221 |[39m     }
     [90m 222 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 223 |[39m     
console[33m.[39merror([32m'Failed to delete 
assessment images:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 224 |[39m     [90m// Don't throw - 
deletion should be idempotent[39m
     [90m 225 |[39m   }
     [90m 226 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:223:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      Failed to cleanup old assessments: Error: 
[FileSystem] Document directory unavailable. Ensure 
expo-file-system is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:275:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:307:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:271:44)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:407:4
9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 302 |[39m     [36mreturn[39m 
deletedCount[33m;[39m
     [90m 303 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 304 |[39m     
console[33m.[39merror([32m'Failed to cleanup old 
assessments:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 305 |[39m     [36mreturn[39m 
[35m0[39m[33m;[39m
     [90m 306 |[39m   }
     [90m 307 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:304:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:307:2)
      at apply 
(src/lib/assessment/image-storage.ts:271:44)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:407:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to cleanup old assessments: Error: 
[FileSystem] Document directory unavailable. Ensure 
expo-file-system is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:275:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:271:44)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:432:3
4)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 302 |[39m     [36mreturn[39m 
deletedCount[33m;[39m
     [90m 303 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 304 |[39m     
console[33m.[39merror([32m'Failed to cleanup old 
assessments:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 305 |[39m     [36mreturn[39m 
[35m0[39m[33m;[39m
     [90m 306 |[39m   }
     [90m 307 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:304:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:271:44)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:432:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to cleanup old assessments: Error: 
[FileSystem] Document directory unavailable. Ensure 
expo-file-system is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:275:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:271:44)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:454:4
9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 302 |[39m     [36mreturn[39m 
deletedCount[33m;[39m
     [90m 303 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 304 |[39m     
console[33m.[39merror([32m'Failed to cleanup old 
assessments:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 305 |[39m     [36mreturn[39m 
[35m0[39m[33m;[39m
     [90m 306 |[39m   }
     [90m 307 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:304:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:271:44)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:454:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to cleanup old assessments: Error: 
[FileSystem] Document directory unavailable. Ensure 
expo-file-system is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:275:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:271:44)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:465:4
9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 302 |[39m     [36mreturn[39m 
deletedCount[33m;[39m
     [90m 303 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 304 |[39m     
console[33m.[39merror([32m'Failed to cleanup old 
assessments:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 305 |[39m     [36mreturn[39m 
[35m0[39m[33m;[39m
     [90m 306 |[39m   }
     [90m 307 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:304:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:271:44)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:465:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to get storage size: Error: [FileSystem] 
Document directory unavailable. Ensure expo-file-system 
is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:256:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:265:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:254:47)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:477:5
2)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 260 |[39m     [36mreturn[39m 
[36mawait[39m 
computeDirSize([33mASSESSMENT_DIR[39m)[33m;[39m
     [90m 261 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 262 |[39m     
console[33m.[39merror([32m'Failed to get storage 
size:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 263 |[39m     [36mreturn[39m 
[35m0[39m[33m;[39m
     [90m 264 |[39m   }
     [90m 265 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:262:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:265:2)
      at apply 
(src/lib/assessment/image-storage.ts:254:47)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:477:52)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to get storage size: Error: [FileSystem] 
Document directory unavailable. Ensure expo-file-system 
is properly linked.
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:19:11)
          at getDocumentDirectoryUri (C:\Users\Peter\Gro
wBro\src\lib\assessment\assessment-paths.ts:31:13)
          at C:\Users\Peter\GrowBro\src\lib\assessment\i
mage-storage.ts:256:44
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\asses
sment\image-storage.ts:254:47)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-storage.test.ts:497:5
2)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 260 |[39m     [36mreturn[39m 
[36mawait[39m 
computeDirSize([33mASSESSMENT_DIR[39m)[33m;[39m
     [90m 261 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 262 |[39m     
console[33m.[39merror([32m'Failed to get storage 
size:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 263 |[39m     [36mreturn[39m 
[35m0[39m[33m;[39m
     [90m 264 |[39m   }
     [90m 265 |[39m }[0m

      at error 
(src/lib/assessment/image-storage.ts:262:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:254:47)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:497:52)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ storeImage ÔÇ║ should store 
image with content-addressable filename

    Failed to store image

    [0m [90m 156 |[39m   } [36mcatch[39m (error) {
     [90m 157 |[39m     
console[33m.[39merror([32m'Failed to store 
image:'[39m[33m,[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 158 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
image'[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 159 |[39m   }
     [90m 160 |[39m }
     [90m 161 |[39m[0m

      at src/lib/assessment/image-storage.ts:158:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:160:2)
      at apply 
(src/lib/assessment/image-storage.ts:117:33)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:215:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ storeImage ÔÇ║ should sanitize 
assessmentId to prevent path traversal

    Failed to store image

    [0m [90m 156 |[39m   } [36mcatch[39m (error) {
     [90m 157 |[39m     
console[33m.[39merror([32m'Failed to store 
image:'[39m[33m,[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 158 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
image'[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 159 |[39m   }
     [90m 160 |[39m }
     [90m 161 |[39m[0m

      at src/lib/assessment/image-storage.ts:158:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:117:33)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:236:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ storeImage ÔÇ║ should add image 
to cache manager

    Failed to store image

    [0m [90m 156 |[39m   } [36mcatch[39m (error) {
     [90m 157 |[39m     
console[33m.[39merror([32m'Failed to store 
image:'[39m[33m,[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 158 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
image'[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 159 |[39m   }
     [90m 160 |[39m }
     [90m 161 |[39m[0m

      at src/lib/assessment/image-storage.ts:158:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:117:33)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:246:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ storeThumbnail ÔÇ║ should store 
thumbnail with filename key suffix

    Failed to store thumbnail

    [0m [90m 199 |[39m   } [36mcatch[39m (error) {
     [90m 200 |[39m     
console[33m.[39merror([32m'Failed to store 
thumbnail:'[39m[33m,[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
thumbnail'[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 202 |[39m   }
     [90m 203 |[39m }
     [90m 204 |[39m[0m

      at src/lib/assessment/image-storage.ts:201:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:203:2)
      at apply 
(src/lib/assessment/image-storage.ts:165:37)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:272:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ storeThumbnail ÔÇ║ should 
sanitize assessmentId to prevent path traversal

    Failed to store thumbnail

    [0m [90m 199 |[39m   } [36mcatch[39m (error) {
     [90m 200 |[39m     
console[33m.[39merror([32m'Failed to store 
thumbnail:'[39m[33m,[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
thumbnail'[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 202 |[39m   }
     [90m 203 |[39m }
     [90m 204 |[39m[0m

      at src/lib/assessment/image-storage.ts:201:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:165:37)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:292:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ storeThumbnail ÔÇ║ should add 
thumbnail to cache manager

    Failed to store thumbnail

    [0m [90m 199 |[39m   } [36mcatch[39m (error) {
     [90m 200 |[39m     
console[33m.[39merror([32m'Failed to store 
thumbnail:'[39m[33m,[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
thumbnail'[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 202 |[39m   }
     [90m 203 |[39m }
     [90m 204 |[39m[0m

      at src/lib/assessment/image-storage.ts:201:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:165:37)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:306:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ deleteAssessmentImages ÔÇ║ 
should remove from cache and delete directory

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: StringContaining "assessment-123", 
{"idempotent": true}

    Number of calls: 0

    [0m [90m 349 |[39m         mockAssessmentId
     [90m 350 |[39m       )[33m;[39m
    [31m[1m>[22m[39m[90m 351 |[39m       expect([
33mFileSystem[39m[33m.[39mdeleteAsync)[33m.[39mtoHa
veBeenCalledWith(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 352 |[39m         expect[33m.[39mstringCon
taining(mockAssessmentId)[33m,[39m
     [90m 353 |[39m         { idempotent[33m:[39m 
[36mtrue[39m }
     [90m 354 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/assessment
/__tests__/image-storage.test.ts:351:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Image Storage ÔÇ║ deleteAssessmentImages ÔÇ║ 
should sanitize assessmentId to prevent path traversal

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 
"file:///documents/assessments/______root/"

    Number of calls: 0

    [0m [90m 364 |[39m       [36mawait[39m 
deleteAssessmentImages(maliciousId)[33m;[39m
     [90m 365 |[39m
    [31m[1m>[22m[39m[90m 366 |[39m       expect([
33mFileSystem[39m[33m.[39mgetInfoAsync)[33m.[39mtoH
aveBeenCalledWith(
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 367 |[39m         [32m`file:///documents/as
sessments/${sanitizedId}/`[39m
     [90m 368 |[39m       )[33m;[39m
     [90m 369 |[39m     })[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/assessment
/__tests__/image-storage.test.ts:366:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Image Storage ÔÇ║ cleanupOldAssessments ÔÇ║ 
should delete assessments older than retention period

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: StringContaining "old_assessment", 
{"idempotent": true}

    Number of calls: 0

    [0m [90m 407 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
cleanupOldAssessments([35m90[39m)[33m;[39m
     [90m 408 |[39m
    [31m[1m>[22m[39m[90m 409 |[39m       expect([
33mFileSystem[39m[33m.[39mdeleteAsync)[33m.[39mtoHa
veBeenCalledWith(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 410 |[39m         expect[33m.[39mstringCon
taining([32m'old_assessment'[39m)[33m,[39m
     [90m 411 |[39m         { idempotent[33m:[39m 
[36mtrue[39m }
     [90m 412 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/assessment
/__tests__/image-storage.test.ts:409:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Image Storage ÔÇ║ cleanupOldAssessments ÔÇ║ 
should sanitize assessmentId to prevent path traversal

    expect(jest.fn()).toHaveBeenNthCalledWith(n, 
...expected)

    n: 2
    Expected: "file:///documents/assessments/___escape/"

    Number of calls: 0

    [0m [90m 432 |[39m       [36mawait[39m 
cleanupOldAssessments([35m90[39m)[33m;[39m
     [90m 433 |[39m
    [31m[1m>[22m[39m[90m 434 |[39m       expect([
33mFileSystem[39m[33m.[39mgetInfoAsync)[33m.[39mtoH
aveBeenNthCalledWith(
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 435 |[39m         [35m2[39m[33m,[39m
     [90m 436 |[39m         [32m`file:///documents/as
sessments/${sanitizedId}/`[39m
     [90m 437 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenNthCalledWith (src/lib/assessm
ent/__tests__/image-storage.test.ts:434:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Image Storage ÔÇ║ getAssessmentStorageSize ÔÇ║ 
should recursively calculate total size of all files in 
subdirectories

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 4500
    Received: 0

    [0m [90m 497 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
getAssessmentStorageSize()[33m;[39m
     [90m 498 |[39m
    [31m[1m>[22m[39m[90m 499 |[39m       expect(re
sult)[33m.[39mtoBe([35m4500[39m)[33m;[39m [90m// 
1000 + 2000 + 1500[39m
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 500 |[39m     })[33m;[39m
     [90m 501 |[39m   })[33m;[39m
     [90m 502 |[39m })[33m;[39m[0m

      at Object.toBe (src/lib/assessment/__tests__/image
-storage.test.ts:499:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/notifications/notification-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ NotificationManager Initialization ÔÇ║ 
initializes when permissions already granted

    TypeError: (0 , 
_iosCategories.registerNotificationCategories) is not a 
function

    [0m [90m 76 |[39m
     [90m 77 |[39m       [36mif[39m 
([33mPlatform[39m[33m.[39m[33mOS[39m 
[33m===[39m [32m'ios'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mawait[39m 
registerNotificationCategories()[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 79 |[39m       }
     [90m 80 |[39m
     [90m 81 |[39m       [36mconst[39m 
permissionGranted [33m=[39m[0m

      at 
src/lib/notifications/notification-manager.ts:78:45
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation 
(src/lib/notifications/notification-manager.ts:351:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at NotificationManager.operation 
(src/lib/notifications/notification-manager.ts:372:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as processQueue] 
(src/lib/notifications/notification-manager.ts:361:29)
      at processQueue 
(src/lib/notifications/notification-manager.ts:357:12)
      at NotificationManager.<anonymous> 
(src/lib/notifications/notification-manager.ts:348:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
enqueueOperation] 
(src/lib/notifications/notification-manager.ts:347:33)
      at NotificationManager.enqueueOperation 
(src/lib/notifications/notification-manager.ts:71:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as initialize] 
(src/lib/notifications/notification-manager.ts:70:19)
      at Object.initialize (src/lib/notifications/notifi
cation-manager.test.ts:199:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Initialization ÔÇ║ 
initializes without user information

    TypeError: (0 , 
_iosCategories.registerNotificationCategories) is not a 
function

    [0m [90m 76 |[39m
     [90m 77 |[39m       [36mif[39m 
([33mPlatform[39m[33m.[39m[33mOS[39m 
[33m===[39m [32m'ios'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mawait[39m 
registerNotificationCategories()[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 79 |[39m       }
     [90m 80 |[39m
     [90m 81 |[39m       [36mconst[39m 
permissionGranted [33m=[39m[0m

      at 
src/lib/notifications/notification-manager.ts:78:45
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation 
(src/lib/notifications/notification-manager.ts:351:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at NotificationManager.operation 
(src/lib/notifications/notification-manager.ts:372:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as processQueue] 
(src/lib/notifications/notification-manager.ts:361:29)
      at processQueue 
(src/lib/notifications/notification-manager.ts:357:12)
      at NotificationManager.<anonymous> 
(src/lib/notifications/notification-manager.ts:348:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
enqueueOperation] 
(src/lib/notifications/notification-manager.ts:347:33)
      at NotificationManager.enqueueOperation 
(src/lib/notifications/notification-manager.ts:71:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as initialize] 
(src/lib/notifications/notification-manager.ts:70:19)
      at Object.initialize (src/lib/notifications/notifi
cation-manager.test.ts:216:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Initialization ÔÇ║ skips 
registration when permission denied

    TypeError: (0 , 
_iosCategories.registerNotificationCategories) is not a 
function

    [0m [90m 76 |[39m
     [90m 77 |[39m       [36mif[39m 
([33mPlatform[39m[33m.[39m[33mOS[39m 
[33m===[39m [32m'ios'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mawait[39m 
registerNotificationCategories()[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 79 |[39m       }
     [90m 80 |[39m
     [90m 81 |[39m       [36mconst[39m 
permissionGranted [33m=[39m[0m

      at 
src/lib/notifications/notification-manager.ts:78:45
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation 
(src/lib/notifications/notification-manager.ts:351:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at NotificationManager.operation 
(src/lib/notifications/notification-manager.ts:372:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as processQueue] 
(src/lib/notifications/notification-manager.ts:361:29)
      at processQueue 
(src/lib/notifications/notification-manager.ts:357:12)
      at NotificationManager.<anonymous> 
(src/lib/notifications/notification-manager.ts:348:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
enqueueOperation] 
(src/lib/notifications/notification-manager.ts:347:33)
      at NotificationManager.enqueueOperation 
(src/lib/notifications/notification-manager.ts:71:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as initialize] 
(src/lib/notifications/notification-manager.ts:70:19)
      at Object.initialize (src/lib/notifications/notifi
cation-manager.test.ts:230:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Permissions ÔÇ║ requests 
permissions successfully

    TypeError: (0 , 
_iosCategories.registerNotificationCategories) is not a 
function

    [0m [90m 76 |[39m
     [90m 77 |[39m       [36mif[39m 
([33mPlatform[39m[33m.[39m[33mOS[39m 
[33m===[39m [32m'ios'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mawait[39m 
registerNotificationCategories()[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 79 |[39m       }
     [90m 80 |[39m
     [90m 81 |[39m       [36mconst[39m 
permissionGranted [33m=[39m[0m

      at 
src/lib/notifications/notification-manager.ts:78:45
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation 
(src/lib/notifications/notification-manager.ts:351:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at NotificationManager.operation 
(src/lib/notifications/notification-manager.ts:372:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as processQueue] 
(src/lib/notifications/notification-manager.ts:361:29)
      at processQueue 
(src/lib/notifications/notification-manager.ts:357:12)
      at NotificationManager.<anonymous> 
(src/lib/notifications/notification-manager.ts:348:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
enqueueOperation] 
(src/lib/notifications/notification-manager.ts:347:33)
      at NotificationManager.enqueueOperation 
(src/lib/notifications/notification-manager.ts:71:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as initialize] 
(src/lib/notifications/notification-manager.ts:70:19)
      at Object.initialize (src/lib/notifications/notifi
cation-manager.test.ts:246:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Permissions ÔÇ║ returns 
denial when permission request fails

    TypeError: Cannot read properties of undefined 
(reading 'requestNotificationPermission')

    [0m [90m 123 |[39m         }[33m;[39m
     [90m 124 |[39m
    [31m[1m>[22m[39m[90m 125 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m [33m
PermissionManager[39m[33m.[39mrequestNotificationPerm
ission()[33m;[39m
     [90m     |[39m                                   
           [31m[1m^[22m[39m
     [90m 126 |[39m       [36mif[39m (result 
[33m===[39m [32m'granted'[39m) {
     [90m 127 |[39m         [36mawait[39m 
registerAndroidChannels()[33m;[39m
     [90m 128 |[39m         [36mif[39m 
([36mthis[39m[33m.[39mcurrentUserId) {[0m

      at requestNotificationPermission 
(src/lib/notifications/notification-manager.ts:125:46)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation 
(src/lib/notifications/notification-manager.ts:351:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at NotificationManager.operation 
(src/lib/notifications/notification-manager.ts:372:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as processQueue] 
(src/lib/notifications/notification-manager.ts:361:29)
      at processQueue 
(src/lib/notifications/notification-manager.ts:357:12)
      at NotificationManager.<anonymous> 
(src/lib/notifications/notification-manager.ts:348:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
enqueueOperation] 
(src/lib/notifications/notification-manager.ts:347:33)
      at NotificationManager.enqueueOperation 
(src/lib/notifications/notification-manager.ts:118:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
requestPermissions] 
(src/lib/notifications/notification-manager.ts:117:27)
      at Object.requestPermissions (src/lib/notification
s/notification-manager.test.ts:266:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Local Notifications ÔÇ║ 
schedules local reminder through service

    TypeError: Cannot read properties of undefined 
(reading 'scheduleExactNotification')

    [0m [90m 215 |[39m     
threadId[33m?[39m[33m:[39m string[33m;[39m
     [90m 216 |[39m   })[33m:[39m 
[33mPromise[39m[33m<[39m[33mstring[39m[33m>[39m 
{
    [31m[1m>[22m[39m[90m 217 |[39m     
[36mreturn[39m [33mLocalNotificationService[39m[33m
.[39mscheduleExactNotification({
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 218 |[39m       title[33m:[39m 
request[33m.[39mtitle[33m,[39m
     [90m 219 |[39m       body[33m:[39m 
request[33m.[39mbody[33m,[39m
     [90m 220 |[39m       data[33m:[39m 
request[33m.[39mdata[33m,[39m[0m

      at NotificationManager.scheduleExactNotification 
(src/lib/notifications/notification-manager.ts:217:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
scheduleLocalReminder] 
(src/lib/notifications/notification-manager.ts:209:30)
      at Object.scheduleLocalReminder (src/lib/notificat
ions/notification-manager.test.ts:277:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Mutex Handling ÔÇ║ serializes 
concurrent initialize calls

    TypeError: (0 , 
_iosCategories.registerNotificationCategories) is not a 
function

    [0m [90m 76 |[39m
     [90m 77 |[39m       [36mif[39m 
([33mPlatform[39m[33m.[39m[33mOS[39m 
[33m===[39m [32m'ios'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mawait[39m 
registerNotificationCategories()[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 79 |[39m       }
     [90m 80 |[39m
     [90m 81 |[39m       [36mconst[39m 
permissionGranted [33m=[39m[0m

      at 
src/lib/notifications/notification-manager.ts:78:45
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation 
(src/lib/notifications/notification-manager.ts:351:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at NotificationManager.operation 
(src/lib/notifications/notification-manager.ts:372:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as processQueue] 
(src/lib/notifications/notification-manager.ts:361:29)
      at processQueue 
(src/lib/notifications/notification-manager.ts:357:12)
      at NotificationManager.<anonymous> 
(src/lib/notifications/notification-manager.ts:348:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
enqueueOperation] 
(src/lib/notifications/notification-manager.ts:347:33)
      at NotificationManager.enqueueOperation 
(src/lib/notifications/notification-manager.ts:71:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as initialize] 
(src/lib/notifications/notification-manager.ts:70:19)
      at Object.initialize (src/lib/notifications/notifi
cation-manager.test.ts:307:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Mutex Handling ÔÇ║ prevents 
operations once disposed

    TypeError: Cannot read properties of undefined 
(reading 'stopTokenListener')

    [0m [90m 232 |[39m     }
     [90m 233 |[39m     [33mPushReceiverService[39m
[33m.[39mremoveNotificationHandlers()[33m;[39m
    [31m[1m>[22m[39m[90m 234 |[39m     [33mPushNo
tificationService[39m[33m.[39mstopTokenListener()[33
m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 235 |[39m     
[36mthis[39m[33m.[39mlistenerUserId [33m=[39m 
[36mnull[39m[33m;[39m
     [90m 236 |[39m   }
     [90m 237 |[39m[0m

      at NotificationManager.stopTokenListener [as 
dispose] 
(src/lib/notifications/notification-manager.ts:234:29)
      at Object.dispose (src/lib/notifications/notificat
ion-manager.test.ts:325:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Dispose ÔÇ║ cleans up token 
listener and subscriptions

    TypeError: Cannot read properties of undefined 
(reading 'stopTokenListener')

    [0m [90m 232 |[39m     }
     [90m 233 |[39m     [33mPushReceiverService[39m
[33m.[39mremoveNotificationHandlers()[33m;[39m
    [31m[1m>[22m[39m[90m 234 |[39m     [33mPushNo
tificationService[39m[33m.[39mstopTokenListener()[33
m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 235 |[39m     
[36mthis[39m[33m.[39mlistenerUserId [33m=[39m 
[36mnull[39m[33m;[39m
     [90m 236 |[39m   }
     [90m 237 |[39m[0m

      at NotificationManager.stopTokenListener [as 
dispose] 
(src/lib/notifications/notification-manager.ts:234:29)
      at Object.dispose (src/lib/notifications/notificat
ion-manager.test.ts:341:13)

FAIL 
src/lib/utils/__tests__/flashlist-performance.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ FlashList Performance Tests ÔÇ║ Rendering 
Performance ÔÇ║ should render 100 items efficiently

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 40 |[39m
     [90m 41 |[39m       render(
    [31m[1m>[22m[39m[90m 42 |[39m         
[33m<[39m[33mFlashList[39m
     [90m    |[39m         [31m[1m^[22m[39m
     [90m 43 |[39m           data[33m=[39m{tasks}
     [90m 44 |[39m           renderItem[33m=[39m{({ 
item }) [33m=>[39m [33m<[39m[33mTaskItem[39m 
item[33m=[39m{item} [33m/[39m[33m>[39m}
     [90m 45 |[39m           
testID[33m=[39m[32m"task-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:42:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Rendering 
Performance ÔÇ║ should render 1000 items efficiently

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 59 |[39m
     [90m 60 |[39m       render(
    [31m[1m>[22m[39m[90m 61 |[39m         
[33m<[39m[33mFlashList[39m
     [90m    |[39m         [31m[1m^[22m[39m
     [90m 62 |[39m           data[33m=[39m{tasks}
     [90m 63 |[39m           renderItem[33m=[39m{({ 
item }) [33m=>[39m [33m<[39m[33mTaskItem[39m 
item[33m=[39m{item} [33m/[39m[33m>[39m}
     [90m 64 |[39m           
testID[33m=[39m[32m"task-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:61:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Rendering 
Performance ÔÇ║ should render 5000 items efficiently

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 78 |[39m
     [90m 79 |[39m       render(
    [31m[1m>[22m[39m[90m 80 |[39m         
[33m<[39m[33mFlashList[39m
     [90m    |[39m         [31m[1m^[22m[39m
     [90m 81 |[39m           data[33m=[39m{tasks}
     [90m 82 |[39m           renderItem[33m=[39m{({ 
item }) [33m=>[39m [33m<[39m[33mTaskItem[39m 
item[33m=[39m{item} [33m/[39m[33m>[39m}
     [90m 83 |[39m           
testID[33m=[39m[32m"task-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:80:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Memory Usage ÔÇ║ 
should not leak memory with large datasets

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m  98 |[39m
     [90m  99 |[39m       [36mconst[39m { unmount } 
[33m=[39m render(
    [31m[1m>[22m[39m[90m 100 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 101 |[39m           data[33m=[39m{tasks}
     [90m 102 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 103 |[39m           
testID[33m=[39m[32m"task-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:100:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Scroll 
Performance ÔÇ║ should handle rapid data updates

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 131 |[39m       [36mconst[39m 
initialTasks [33m=[39m 
generateTasks([35m100[39m)[33m;[39m
     [90m 132 |[39m       [36mconst[39m { rerender 
} [33m=[39m render(
    [31m[1m>[22m[39m[90m 133 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 134 |[39m           
data[33m=[39m{initialTasks}
     [90m 135 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 136 |[39m           
testID[33m=[39m[32m"task-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:133:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Item Size 
Estimation ÔÇ║ should work without estimatedItemSize 
(FlashList v2 auto-sizing)

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 165 |[39m
     [90m 166 |[39m       render(
    [31m[1m>[22m[39m[90m 167 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 168 |[39m           data[33m=[39m{tasks}
     [90m 169 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 170 |[39m           [90m// No 
estimatedItemSize - FlashList v2 should handle 
this[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:167:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Item Size 
Estimation ÔÇ║ should handle variable item heights

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 195 |[39m
     [90m 196 |[39m       render(
    [31m[1m>[22m[39m[90m 197 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 198 |[39m           data[33m=[39m{tasks}
     [90m 199 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mVariableHeightItem[39m 
item[33m=[39m{item} [33m/[39m[33m>[39m}
     [90m 200 |[39m           
testID[33m=[39m[32m"task-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:197:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Playbook-specific 
scenarios ÔÇ║ should handle task timeline with 1000+ 
tasks

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 214 |[39m
     [90m 215 |[39m       render(
    [31m[1m>[22m[39m[90m 216 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 217 |[39m           data[33m=[39m{tasks}
     [90m 218 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 219 |[39m           
testID[33m=[39m[32m"playbook-timeline"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:216:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Playbook-specific 
scenarios ÔÇ║ should handle phase-grouped tasks 
efficiently

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 245 |[39m
     [90m 246 |[39m       render(
    [31m[1m>[22m[39m[90m 247 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 248 |[39m           data[33m=[39m{tasks}
     [90m 249 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 250 |[39m           
testID[33m=[39m[32m"phase-grouped-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:247:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Playbook-specific 
scenarios ÔÇ║ should handle filtered task views

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 268 |[39m
     [90m 269 |[39m       render(
    [31m[1m>[22m[39m[90m 270 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 271 |[39m           
data[33m=[39m{completedTasks}
     [90m 272 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 273 |[39m           
testID[33m=[39m[32m"filtered-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:270:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Performance 
Metrics ÔÇ║ should track render count for performance 
monitoring

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 294 |[39m
     [90m 295 |[39m       render(
    [31m[1m>[22m[39m[90m 296 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 297 |[39m           data[33m=[39m{tasks}
     [90m 298 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTrackedTaskItem[39m 
item[33m=[39m{item} [33m/[39m[33m>[39m}
     [90m 299 |[39m           
testID[33m=[39m[32m"tracked-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:296:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Performance 
Metrics ÔÇ║ should measure frame drops during updates

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 311 |[39m       [36mconst[39m tasks 
[33m=[39m generateTasks([35m500[39m)[33m;[39m
     [90m 312 |[39m       [36mconst[39m { rerender 
} [33m=[39m render(
    [31m[1m>[22m[39m[90m 313 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 314 |[39m           data[33m=[39m{tasks}
     [90m 315 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 316 |[39m           
testID[33m=[39m[32m"frame-test-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:313:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Edge Cases ÔÇ║ 
should handle empty list

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 354 |[39m     it([32m'should handle 
empty list'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m 355 |[39m       render(
    [31m[1m>[22m[39m[90m 356 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 357 |[39m           data[33m=[39m{[]}
     [90m 358 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 359 |[39m           
testID[33m=[39m[32m"empty-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:356:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Edge Cases ÔÇ║ 
should handle single item

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 370 |[39m
     [90m 371 |[39m       render(
    [31m[1m>[22m[39m[90m 372 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 373 |[39m           data[33m=[39m{tasks}
     [90m 374 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 375 |[39m           
testID[33m=[39m[32m"single-item-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:372:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Edge Cases ÔÇ║ 
should handle very large items

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 394 |[39m
     [90m 395 |[39m       render(
    [31m[1m>[22m[39m[90m 396 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 397 |[39m           data[33m=[39m{tasks}
     [90m 398 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mLargeTaskItem[39m 
item[33m=[39m{item} [33m/[39m[33m>[39m}
     [90m 399 |[39m           
testID[33m=[39m[32m"large-item-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:396:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/__tests__/sync-engine.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.info
      SYNC: API_BASE is empty; sync is disabled 
(expected in dev)

      at Object.logMethod (src/lib/sync-engine.ts:170:3)

  ÔùÅ Sync Engine ÔÇ║ Offline-First Behavior ÔÇ║ should 
queue changes when offline

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

    [0m [90m 285 |[39m
     [90m 286 |[39m       [36mconst[39m 
pendingCount [33m=[39m [36mawait[39m 
getPendingChangesCount()[33m;[39m
    [31m[1m>[22m[39m[90m 287 |[39m       expect(pe
ndingCount)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;
[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 288 |[39m     })[33m;[39m
     [90m 289 |[39m
     [90m 290 |[39m     it([32m'should handle 
Last-Write-Wins conflict resolution'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toBeGreaterThan 
(src/lib/__tests__/sync-engine.test.ts:287:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/settings/__tests__/form-preservation.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ Form Preservation Service ÔÇ║ preserveFormState 
ÔÇ║ saves form state to storage

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ preserveFormState 
ÔÇ║ includes validation state and dirty fields

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ restoreFormState 
ÔÇ║ returns null if no preserved state exists

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ restoreFormState 
ÔÇ║ returns preserved state if exists and not expired

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ restoreFormState 
ÔÇ║ returns null and clears if TTL expired

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ restoreFormState 
ÔÇ║ returns null and clears if parse error

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ clearPreservedState 
ÔÇ║ deletes preserved state from storage

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ 
clearAllPreservedStates ÔÇ║ deletes all preserved 
states from storage

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ hasPreservedState 
ÔÇ║ returns true if preserved state exists

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ hasPreservedState 
ÔÇ║ returns false if preserved state does not exist

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

FAIL src/lib/__tests__/sentry-pii-leak-sentinel.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ Sentry PII Leak Sentinel ÔÇ║ beforeSend Hook - 
PII Detection ÔÇ║ redacts Cookie and Set-Cookie headers

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "[REDACTED]"
    Received: undefined

    [0m [90m 194 |[39m
     [90m 195 |[39m       expect(scrubbed)[33m.[39mn
ot[33m.[39mtoBeNull()[33m;[39m
    [31m[1m>[22m[39m[90m 196 |[39m       expect(sc
rubbed[33m?[39m[33m.[39mrequest[33m?[39m[33m.[39
mheaders[33m?[39m[33m.[39m[33mCookie[39m)[33m.[3
9mtoBe([32m'[REDACTED]'[39m)[33m;[39m
     [90m     |[39m                                   
               [31m[1m^[22m[39m
     [90m 197 |[39m       expect(scrubbed[33m?[39m[
33m.[39mrequest[33m?[39m[33m.[39mheaders[33m?[39m
[33m.[39m[[32m'Set-Cookie'[39m])[33m.[39mtoBe([32
m'[REDACTED]'[39m)[33m;[39m
     [90m 198 |[39m     })[33m;[39m
     [90m 199 |[39m[0m

      at Object.toBe (src/lib/__tests__/sentry-pii-leak-
sentinel.test.ts:196:50)

  ÔùÅ Sentry PII Leak Sentinel ÔÇ║ beforeSend Hook - 
PII Detection ÔÇ║ removes email from user context

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "[EMAIL_REDACTED]"
    Received: undefined

    [0m [90m 239 |[39m
     [90m 240 |[39m       expect(scrubbed)[33m.[39mn
ot[33m.[39mtoBeNull()[33m;[39m
    [31m[1m>[22m[39m[90m 241 |[39m       expect(sc
rubbed[33m?[39m[33m.[39muser[33m?[39m[33m.[39mem
ail)[33m.[39mtoBe([32m'[EMAIL_REDACTED]'[39m)[33m;
[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 242 |[39m     })[33m;[39m
     [90m 243 |[39m
     [90m 244 |[39m     test([32m'returns null if 
crashReporting consent is not given'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/__tests__/sentry-pii-leak-
sentinel.test.ts:241:37)

  ÔùÅ Sentry PII Leak Sentinel ÔÇ║ beforeBreadcrumb 
Hook - PII Detection ÔÇ║ scrubs HTTP request data in 
HTTP-type breadcrumbs

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "[REDACTED]"
    Received: undefined

    [0m [90m 300 |[39m
     [90m 301 |[39m       expect(scrubbed)[33m.[39mn
ot[33m.[39mtoBeNull()[33m;[39m
    [31m[1m>[22m[39m[90m 302 |[39m       expect(sc
rubbed[33m?[39m[33m.[39mdata[33m?[39m[33m.[39mhe
aders[33m?[39m[33m.[39m[33mAuthorization[39m)[33m
.[39mtoBe([32m'[REDACTED]'[39m)[33m;[39m
     [90m     |[39m                                   
                   [31m[1m^[22m[39m
     [90m 303 |[39m       expect(scrubbed[33m?[39m[
33m.[39mdata[33m?[39m[33m.[39mheaders[33m?[39m[3
3m.[39m[33mCookie[39m)[33m.[39mtoBe([32m'[REDACTED
]'[39m)[33m;[39m
     [90m 304 |[39m       expect(scrubbed[33m?[39m[
33m.[39mdata[33m?[39m[33m.[39mbody)[33m.[39mtoBe(
[32m'[REDACTED_AUTH_ENDPOINT]'[39m)[33m;[39m
     [90m 305 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/__tests__/sentry-pii-leak-
sentinel.test.ts:302:54)

FAIL src/lib/inventory/__tests__/deduction-integration.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      DEBUG: entry.unit = ml itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = units itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = units itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = ml itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = seeds itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = ml itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = units itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: result = {
        "success": false,
        "movements": [],
        "error": "Validation failed: Unit mismatch: 
entry uses 'units' but item requires 'undefined'",
        "idempotencyKey": 
"deduction:insufficient-test:694160081"
      }

      at Object.log (src/lib/inventory/__tests__/deducti
on-integration.test.ts:400:15)

    console.log
      DEBUG: entry.unit = ml itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = units itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = ml itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Basic 
Deduction ÔÇ║ should deduce inventory successfully with 
task completion

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 104 |[39m       })[33m;[39m
     [90m 105 |[39m
    [31m[1m>[22m[39m[90m 106 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 107 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 108 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mquantityDelta)[33m.[39mto
Be([33m-[39m[35m100[39m)[33m;[39m
     [90m 109 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mcostPerUnitMinor)[33m.[39
mtoBe([35m50[39m)[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/deduct
ion-integration.test.ts:106:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Basic 
Deduction ÔÇ║ should prevent duplicate deductions with 
idempotency key

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 149 |[39m       [90m// First 
deduction[39m
     [90m 150 |[39m       [36mconst[39m result1 
[33m=[39m [36mawait[39m 
deduceInventory(database[33m,[39m 
deductionRequest)[33m;[39m
    [31m[1m>[22m[39m[90m 151 |[39m       expect(re
sult1[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 152 |[39m       expect(result1[33m.[39mmov
ements)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 153 |[39m
     [90m 154 |[39m       [90m// Second deduction 
with same key[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/deduct
ion-integration.test.ts:151:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Basic 
Deduction ÔÇ║ should return resolved deduction map with 
actual deducted quantities in idempotency retries

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 198 |[39m       [90m// First deduction 
- should deduct 25 units[39m
     [90m 199 |[39m       [36mconst[39m result1 
[33m=[39m [36mawait[39m 
deduceInventory(database[33m,[39m 
deductionRequest)[33m;[39m
    [31m[1m>[22m[39m[90m 200 |[39m       expect(re
sult1[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 201 |[39m       expect(result1[33m.[39mmov
ements)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 202 |[39m       expect(result1[33m.[39mmov
ements[[35m0[39m][33m.[39mquantityDelta)[33m.[39mt
oBe([33m-[39m[35m25[39m)[33m;[39m
     [90m 203 |[39m       expect(result1[33m.[39mded
uctionMap)[33m.[39mtoHaveLength([35m1[39m)[33m;[39
m[0m

      at Object.toBe (src/lib/inventory/__tests__/deduct
ion-integration.test.ts:200:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ FEFO Picking 
ÔÇ║ should consume from batch expiring soonest (FEFO)

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 269 |[39m       })[33m;[39m
     [90m 270 |[39m
    [31m[1m>[22m[39m[90m 271 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 272 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 273 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mbatchId)[33m.[39mtoBe(bat
ch2[33m.[39mid)[33m;[39m
     [90m 274 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mcostPerUnitMinor)[33m.[39
mtoBe([35m60[39m)[33m;[39m [90m// FIFO cost from 
batch2[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/deduct
ion-integration.test.ts:271:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ FEFO Picking 
ÔÇ║ should exclude expired batches by default

    expect(received).toHaveLength(expected)

    Matcher error: received value must have a length 
property whose value must be a number

    Received has value: undefined

    [0m [90m 322 |[39m
     [90m 323 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 324 |[39m       expect(re
sult[33m.[39minsufficientItems)[33m.[39mtoHaveLength
([35m1[39m)[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 325 |[39m       expect(result[33m.[39minsu
fficientItems[33m![39m[[35m0[39m][33m.[39mavailabl
e)[33m.[39mtoBe([35m0[39m)[33m;[39m
     [90m 326 |[39m     })[33m;[39m
     [90m 327 |[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/deduction-integration.test.ts:324:40)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ FEFO Picking 
ÔÇ║ should allow expired batch consumption with override

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 360 |[39m       })[33m;[39m
     [90m 361 |[39m
    [31m[1m>[22m[39m[90m 362 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 363 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 364 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mbatchId)[33m.[39mtoBe(exp
iredBatch[33m.[39mid)[33m;[39m
     [90m 365 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/deduct
ion-integration.test.ts:362:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Insufficient 
Stock Handling ÔÇ║ should return insufficient stock 
error with recovery options

    expect(received).toHaveLength(expected)

    Matcher error: received value must have a length 
property whose value must be a number

    Received has value: undefined

    [0m [90m 401 |[39m
     [90m 402 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 403 |[39m       expect(re
sult[33m.[39minsufficientItems)[33m.[39mtoHaveLength
([35m1[39m)[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 404 |[39m
     [90m 405 |[39m       [36mconst[39m error 
[33m=[39m result[33m.[39minsufficientItems[33m![39
m[[35m0[39m][33m;[39m
     [90m 406 |[39m       expect(error[33m.[39mrequi
red)[33m.[39mtoBe([35m50[39m)[33m;[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/deduction-integration.test.ts:403:40)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Insufficient 
Stock Handling ÔÇ║ should handle partial completion 
consuming available stock

    TypeError: Cannot read properties of undefined 
(reading '0')

    [0m [90m 446 |[39m
     [90m 447 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 448 |[39m       
[36mconst[39m error [33m=[39m result[33m.[39minsuf
ficientItems[33m![39m[[35m0[39m][33m;[39m
     [90m     |[39m                                   
          [31m[1m^[22m[39m
     [90m 449 |[39m
     [90m 450 |[39m       [90m// Handle partial 
completion[39m
     [90m 451 |[39m       [36mconst[39m movements 
[33m=[39m [36mawait[39m handlePartialComplete({[0m

      at Object.<anonymous> (src/lib/inventory/__tests__
/deduction-integration.test.ts:448:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Insufficient 
Stock Handling ÔÇ║ should handle skip deduction with 
marker movement

    TypeError: Cannot read properties of undefined 
(reading '0')

    [0m [90m 490 |[39m
     [90m 491 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 492 |[39m       
[36mconst[39m error [33m=[39m result[33m.[39minsuf
ficientItems[33m![39m[[35m0[39m][33m;[39m
     [90m     |[39m                                   
          [31m[1m^[22m[39m
     [90m 493 |[39m
     [90m 494 |[39m       [90m// Handle skip[39m
     [90m 495 |[39m       [36mconst[39m movements 
[33m=[39m [36mawait[39m handleSkipDeduction({[0m

      at Object.<anonymous> (src/lib/inventory/__tests__
/deduction-integration.test.ts:492:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Multi-Batch 
Consumption ÔÇ║ should split consumption across 
multiple batches with FIFO costing

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 554 |[39m       })[33m;[39m
     [90m 555 |[39m
    [31m[1m>[22m[39m[90m 556 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 557 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m2[39m)[33m;[39m
     [90m 558 |[39m
     [90m 559 |[39m       [90m// First movement from 
batch1 (50ml @ $0.50)[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/deduct
ion-integration.test.ts:556:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/media/__tests__/photo-storage-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Failed to hash and store original: Error: Storage 
full
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-storage-service.test.ts:11
4:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 617 |[39m     [36mreturn[39m 
targetFileUri[33m;[39m
     [90m 618 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 619 |[39m     
console[33m.[39merror([32m`Failed to hash and store 
${variant}:`[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 620 |[39m     [36mthrow[39m 
error[33m;[39m
     [90m 621 |[39m   }
     [90m 622 |[39m }[0m

      at error 
(src/lib/media/photo-storage-service.ts:619:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to capture and store photo: Error: Storage 
full
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-storage-service.test.ts:11
4:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 579 |[39m     }[33m;[39m
     [90m 580 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 581 |[39m     
console[33m.[39merror([32m'Failed to capture and 
store photo:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 582 |[39m     [36mthrow[39m 
error[33m;[39m
     [90m 583 |[39m   }
     [90m 584 |[39m }[0m

      at error 
(src/lib/media/photo-storage-service.ts:581:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      Photo variant original already exists: 
abc123hash.jpg

      at log 
(src/lib/media/photo-storage-service.ts:610:15)

    console.error
      Failed to hash and store original: Error: Copy 
failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-storage-service.test.ts:19
0:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 617 |[39m     [36mreturn[39m 
targetFileUri[33m;[39m
     [90m 618 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 619 |[39m     
console[33m.[39merror([32m`Failed to hash and store 
${variant}:`[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 620 |[39m     [36mthrow[39m 
error[33m;[39m
     [90m 621 |[39m   }
     [90m 622 |[39m }[0m

      at error 
(src/lib/media/photo-storage-service.ts:619:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to get storage info: Error: Access denied
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-storage-service.test.ts:25
6:15)
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:397:39
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\jest-mock\build\index.js:404:13)
          at Object.mockConstructor [as 
readDirectoryAsync] (C:\Users\Peter\GrowBro\node_modules
\jest-mock\build\index.js:148:19)
          at readDirectoryAsync (C:\Users\Peter\GrowBro\
src\lib\media\photo-storage-service.ts:641:42)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 663 |[39m     }[33m;[39m
     [90m 664 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 665 |[39m     
console[33m.[39merror([32m'Failed to get storage 
info:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 666 |[39m     [36mthrow[39m 
error[33m;[39m
     [90m 667 |[39m   }
     [90m 668 |[39m }[0m

      at error 
(src/lib/media/photo-storage-service.ts:665:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      Failed to detect orphans: Error: List failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-storage-service.test.ts:33
7:15)
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:397:39
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\jest-mock\build\index.js:404:13)
          at Object.mockConstructor [as 
readDirectoryAsync] (C:\Users\Peter\GrowBro\node_modules
\jest-mock\build\index.js:148:19)
          at readDirectoryAsync (C:\Users\Peter\GrowBro\
src\lib\media\photo-storage-service.ts:695:40)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 709 |[39m     [36mreturn[39m 
orphans[33m;[39m
     [90m 710 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 711 |[39m     
console[33m.[39merror([32m'Failed to detect 
orphans:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 712 |[39m     [36mreturn[39m [][33m;[39m
     [90m 713 |[39m   }
     [90m 714 |[39m }[0m

      at error 
(src/lib/media/photo-storage-service.ts:711:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      Failed to get photo files: Error: List failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-storage-service.test.ts:45
2:15)
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:397:39
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\jest-mock\build\index.js:404:13)
          at Object.mockConstructor [as 
readDirectoryAsync] (C:\Users\Peter\GrowBro\node_modules
\jest-mock\build\index.js:148:19)
          at readDirectoryAsync (C:\Users\Peter\GrowBro\
src\lib\media\photo-storage-service.ts:765:40)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 783 |[39m     [36mreturn[39m 
files[33m;[39m
     [90m 784 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 785 |[39m     
console[33m.[39merror([32m'Failed to get photo 
files:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 786 |[39m     [36mreturn[39m [][33m;[39m
     [90m 787 |[39m   }
     [90m 788 |[39m }[0m

      at error 
(src/lib/media/photo-storage-service.ts:785:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ photo-storage-service ÔÇ║ downloadRemoteImage ÔÇ║ 
should download and store remote image successfully

    Remote image host "example.com" is not allowlisted

    [0m [90m 241 |[39m
     [90m 242 |[39m   [36mif[39m ([33m![39mallowed
RemoteImageHosts[33m.[39mhas(host)) {
    [31m[1m>[22m[39m[90m 243 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Remote image host "${host}" is 
not allowlisted`[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 244 |[39m   }
     [90m 245 |[39m
     [90m 246 |[39m   [36mif[39m ([0m

      at assertAllowedRemoteUri 
(src/lib/media/photo-storage-service.ts:243:11)
      at assertAllowedRemoteUri 
(src/lib/media/photo-storage-service.ts:59:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/media/photo-storage-service.ts:133:2)
      at apply 
(src/lib/media/photo-storage-service.ts:55:42)
      at Object.<anonymous> (src/lib/media/__tests__/pho
to-storage-service.test.ts:489:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ photo-storage-service ÔÇ║ downloadRemoteImage ÔÇ║ 
should throw error when FileSystem is unavailable

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 510 |[39m         [90m// Re-import a 
fresh instance of the module under test so it reads 
the[39m
     [90m 511 |[39m         [90m// mocked Paths 
during module initialization.[39m
    [31m[1m>[22m[39m[90m 512 |[39m         
[36mconst[39m { downloadRemoteImage[33m:[39m 
downloadRemoteImageFresh } [33m=[39m [36mawait[39m 
[36mimport[39m(
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 513 |[39m           
[32m'../photo-storage-service'[39m
     [90m 514 |[39m         )[33m;[39m
     [90m 515 |[39m[0m

      at Object.<anonymous> (src/lib/media/__tests__/pho
to-storage-service.test.ts:512:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ photo-storage-service ÔÇ║ downloadRemoteImage ÔÇ║ 
should handle fetch errors

    expect(received).rejects.toThrow(expected)

    Expected substring: "Failed to fetch remote image: 
Network error"
    Received message:   "Remote image host 
\"example.com\" is not allowlisted"

        [0m [90m 241 |[39m
         [90m 242 |[39m   [36mif[39m ([33m![39mall
owedRemoteImageHosts[33m.[39mhas(host)) {
        [31m[1m>[22m[39m[90m 243 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Remote image host "${host}" is 
not allowlisted`[39m)[33m;[39m
         [90m     |[39m           [31m[1m^[22m[39m
         [90m 244 |[39m   }
         [90m 245 |[39m
         [90m 246 |[39m   [36mif[39m ([0m

      at assertAllowedRemoteUri 
(src/lib/media/photo-storage-service.ts:243:11)
      at assertAllowedRemoteUri 
(src/lib/media/photo-storage-service.ts:59:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/media/photo-storage-service.ts:55:42)
      at Object.<anonymous> (src/lib/media/__tests__/pho
to-storage-service.test.ts:540:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/media/__tests__/photo-s
torage-service.test.ts:541:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ photo-storage-service ÔÇ║ downloadRemoteImage ÔÇ║ 
should reject non-image content types

    expect(received).rejects.toThrow(expected)

    Expected substring: "Remote file is not an image"
    Received message:   "Remote image host 
\"example.com\" is not allowlisted"

        [0m [90m 241 |[39m
         [90m 242 |[39m   [36mif[39m ([33m![39mall
owedRemoteImageHosts[33m.[39mhas(host)) {
        [31m[1m>[22m[39m[90m 243 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Remote image host "${host}" is 
not allowlisted`[39m)[33m;[39m
         [90m     |[39m           [31m[1m^[22m[39m
         [90m 244 |[39m   }
         [90m 245 |[39m
         [90m 246 |[39m   [36mif[39m ([0m

      at assertAllowedRemoteUri 
(src/lib/media/photo-storage-service.ts:243:11)
      at assertAllowedRemoteUri 
(src/lib/media/photo-storage-service.ts:59:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/media/photo-storage-service.ts:55:42)
      at Object.<anonymous> (src/lib/media/__tests__/pho
to-storage-service.test.ts:562:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/media/__tests__/photo-s
torage-service.test.ts:563:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/harvest/harvest-notification-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      [NotificationMonitoring] Schedule failed: {
        type: 'target',
        harvestId: 'harvest-123',
        stage: 'drying',
        error: "Cannot read properties of undefined 
(reading 'TIME_INTERVAL')"
      }

    [0m [90m 60 |[39m
     [90m 61 |[39m     [36mif[39m ([33m![39mparams
[33m.[39mresult[33m.[39mscheduled) {
    [31m[1m>[22m[39m[90m 62 |[39m       
console[33m.[39mwarn([32m'[NotificationMonitoring] 
Schedule failed:'[39m[33m,[39m {
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 63 |[39m         type[33m:[39m 
params[33m.[39mtype[33m,[39m
     [90m 64 |[39m         harvestId[33m:[39m 
params[33m.[39mharvestId[33m,[39m
     [90m 65 |[39m         stage[33m:[39m 
params[33m.[39mstage[33m,[39m[0m

      at warn 
(src/lib/harvest/notification-monitoring.ts:62:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.warn
      [NotificationMonitoring] Schedule failed: {
        type: 'target',
        harvestId: 'harvest-123',
        stage: 'drying',
        error: "Cannot read properties of undefined 
(reading 'TIME_INTERVAL')"
      }

    [0m [90m 60 |[39m
     [90m 61 |[39m     [36mif[39m ([33m![39mparams
[33m.[39mresult[33m.[39mscheduled) {
    [31m[1m>[22m[39m[90m 62 |[39m       
console[33m.[39mwarn([32m'[NotificationMonitoring] 
Schedule failed:'[39m[33m,[39m {
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 63 |[39m         type[33m:[39m 
params[33m.[39mtype[33m,[39m
     [90m 64 |[39m         harvestId[33m:[39m 
params[33m.[39mharvestId[33m,[39m
     [90m 65 |[39m         stage[33m:[39m 
params[33m.[39mstage[33m,[39m[0m

      at warn 
(src/lib/harvest/notification-monitoring.ts:62:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.warn
      [NotificationMonitoring] Schedule failed: {
        type: 'overdue',
        harvestId: 'harvest-123',
        stage: 'drying',
        error: "Cannot read properties of undefined 
(reading 'TIME_INTERVAL')"
      }

    [0m [90m 60 |[39m
     [90m 61 |[39m     [36mif[39m ([33m![39mparams
[33m.[39mresult[33m.[39mscheduled) {
    [31m[1m>[22m[39m[90m 62 |[39m       
console[33m.[39mwarn([32m'[NotificationMonitoring] 
Schedule failed:'[39m[33m,[39m {
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 63 |[39m         type[33m:[39m 
params[33m.[39mtype[33m,[39m
     [90m 64 |[39m         harvestId[33m:[39m 
params[33m.[39mharvestId[33m,[39m
     [90m 65 |[39m         stage[33m:[39m 
params[33m.[39mstage[33m,[39m[0m

      at warn 
(src/lib/harvest/notification-monitoring.ts:62:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.warn
      [NotificationMonitoring] Schedule failed: {
        type: 'target',
        harvestId: 'harvest-123',
        stage: 'drying',
        error: "Cannot read properties of undefined 
(reading 'TIME_INTERVAL')"
      }

    [0m [90m 60 |[39m
     [90m 61 |[39m     [36mif[39m ([33m![39mparams
[33m.[39mresult[33m.[39mscheduled) {
    [31m[1m>[22m[39m[90m 62 |[39m       
console[33m.[39mwarn([32m'[NotificationMonitoring] 
Schedule failed:'[39m[33m,[39m {
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 63 |[39m         type[33m:[39m 
params[33m.[39mtype[33m,[39m
     [90m 64 |[39m         harvestId[33m:[39m 
params[33m.[39mharvestId[33m,[39m
     [90m 65 |[39m         stage[33m:[39m 
params[33m.[39mstage[33m,[39m[0m

      at warn 
(src/lib/harvest/notification-monitoring.ts:62:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [NotificationMonitoring] Rehydration completed: {
        totalHarvests: 1,
        notificationsScheduled: 0,
        notificationsCancelled: 0,
        errors: 1,
        durationMs: 1,
        successRate: '0.0%'
      }

      at log 
(src/lib/harvest/notification-monitoring.ts:113:13)

    console.error
      [NotificationMonitoring] HIGH ERROR RATE in 
rehydration: { errorRate: '100.0%', totalErrors: 1, 
totalHarvests: 1 }

    [0m [90m 122 |[39m     [90m// Alert on high 
error rate[39m
     [90m 123 |[39m     [36mif[39m 
(stats[33m.[39mtotalHarvests [33m>[39m [35m0[39m 
[33m&&[39m stats[33m.[39merrors [33m/[39m 
stats[33m.[39mtotalHarvests [33m>[39m 
[35m0.3[39m) {
    [31m[1m>[22m[39m[90m 124 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 125 |[39m         
[32m'[NotificationMonitoring] HIGH ERROR RATE in 
rehydration:'[39m[33m,[39m
     [90m 126 |[39m         {
     [90m 127 |[39m           errorRate[33m:[39m 
[32m`${((stats.errors / stats.totalHarvests) * 
100).toFixed(1)}%`[39m[33m,[39m[0m

      at error 
(src/lib/harvest/notification-monitoring.ts:124:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.warn
      [NotificationMonitoring] Schedule failed: {
        type: 'target',
        harvestId: 'harvest-123',
        stage: 'drying',
        error: "Cannot read properties of undefined 
(reading 'TIME_INTERVAL')"
      }

    [0m [90m 60 |[39m
     [90m 61 |[39m     [36mif[39m ([33m![39mparams
[33m.[39mresult[33m.[39mscheduled) {
    [31m[1m>[22m[39m[90m 62 |[39m       
console[33m.[39mwarn([32m'[NotificationMonitoring] 
Schedule failed:'[39m[33m,[39m {
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 63 |[39m         type[33m:[39m 
params[33m.[39mtype[33m,[39m
     [90m 64 |[39m         harvestId[33m:[39m 
params[33m.[39mharvestId[33m,[39m
     [90m 65 |[39m         stage[33m:[39m 
params[33m.[39mstage[33m,[39m[0m

      at warn 
(src/lib/harvest/notification-monitoring.ts:62:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [NotificationMonitoring] Rehydration completed: {
        totalHarvests: 1,
        notificationsScheduled: 0,
        notificationsCancelled: 0,
        errors: 1,
        durationMs: 3,
        successRate: '0.0%'
      }

      at log 
(src/lib/harvest/notification-monitoring.ts:113:13)

    console.error
      [NotificationMonitoring] HIGH ERROR RATE in 
rehydration: { errorRate: '100.0%', totalErrors: 1, 
totalHarvests: 1 }

    [0m [90m 122 |[39m     [90m// Alert on high 
error rate[39m
     [90m 123 |[39m     [36mif[39m 
(stats[33m.[39mtotalHarvests [33m>[39m [35m0[39m 
[33m&&[39m stats[33m.[39merrors [33m/[39m 
stats[33m.[39mtotalHarvests [33m>[39m 
[35m0.3[39m) {
    [31m[1m>[22m[39m[90m 124 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 125 |[39m         
[32m'[NotificationMonitoring] HIGH ERROR RATE in 
rehydration:'[39m[33m,[39m
     [90m 126 |[39m         {
     [90m 127 |[39m           errorRate[33m:[39m 
[32m`${((stats.errors / stats.totalHarvests) * 
100).toFixed(1)}%`[39m[33m,[39m[0m

      at error 
(src/lib/harvest/notification-monitoring.ts:124:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.warn
      [NotificationMonitoring] Schedule failed: {
        type: 'target',
        harvestId: 'harvest-123',
        stage: 'drying',
        error: "Cannot read properties of undefined 
(reading 'TIME_INTERVAL')"
      }

    [0m [90m 60 |[39m
     [90m 61 |[39m     [36mif[39m ([33m![39mparams
[33m.[39mresult[33m.[39mscheduled) {
    [31m[1m>[22m[39m[90m 62 |[39m       
console[33m.[39mwarn([32m'[NotificationMonitoring] 
Schedule failed:'[39m[33m,[39m {
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 63 |[39m         type[33m:[39m 
params[33m.[39mtype[33m,[39m
     [90m 64 |[39m         harvestId[33m:[39m 
params[33m.[39mharvestId[33m,[39m
     [90m 65 |[39m         stage[33m:[39m 
params[33m.[39mstage[33m,[39m[0m

      at warn 
(src/lib/harvest/notification-monitoring.ts:62:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [NotificationMonitoring] Rehydration completed: {
        totalHarvests: 1,
        notificationsScheduled: 0,
        notificationsCancelled: 0,
        errors: 1,
        durationMs: 1,
        successRate: '0.0%'
      }

      at log 
(src/lib/harvest/notification-monitoring.ts:113:13)

    console.error
      [NotificationMonitoring] HIGH ERROR RATE in 
rehydration: { errorRate: '100.0%', totalErrors: 1, 
totalHarvests: 1 }

    [0m [90m 122 |[39m     [90m// Alert on high 
error rate[39m
     [90m 123 |[39m     [36mif[39m 
(stats[33m.[39mtotalHarvests [33m>[39m [35m0[39m 
[33m&&[39m stats[33m.[39merrors [33m/[39m 
stats[33m.[39mtotalHarvests [33m>[39m 
[35m0.3[39m) {
    [31m[1m>[22m[39m[90m 124 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 125 |[39m         
[32m'[NotificationMonitoring] HIGH ERROR RATE in 
rehydration:'[39m[33m,[39m
     [90m 126 |[39m         {
     [90m 127 |[39m           errorRate[33m:[39m 
[32m`${((stats.errors / stats.totalHarvests) * 
100).toFixed(1)}%`[39m[33m,[39m[0m

      at error 
(src/lib/harvest/notification-monitoring.ts:124:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Harvest Notification Service ÔÇ║ 
scheduleStageReminder ÔÇ║ should schedule target 
duration notification successfully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 106 |[39m       )[33m;[39m
     [90m 107 |[39m
    [31m[1m>[22m[39m[90m 108 |[39m       expect(re
sult[33m.[39mscheduled)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 109 |[39m       expect(result[33m.[39mnoti
ficationId)[33m.[39mtoBe([32m'notification-id-123'[3
9m)[33m;[39m
     [90m 110 |[39m       expect([33mNotifications[3
9m[33m.[39mscheduleNotificationAsync)[33m.[39mtoHave
BeenCalledWith(
     [90m 111 |[39m         
expect[33m.[39mobjectContaining({[0m

      at Object.toBe (src/lib/harvest/harvest-notificati
on-service.test.ts:108:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Harvest Notification Service ÔÇ║ 
scheduleStageReminder ÔÇ║ should request permissions if 
not granted

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 175 |[39m         [33mNotificationHandl
er[39m[33m.[39mrequestPermissionWithPrimer
     [90m 176 |[39m       
)[33m.[39mtoHaveBeenCalled()[33m;[39m
    [31m[1m>[22m[39m[90m 177 |[39m       expect(re
sult[33m.[39mscheduled)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 178 |[39m     })[33m;[39m
     [90m 179 |[39m
     [90m 180 |[39m     it([32m'should handle 
permission denial gracefully'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/harvest/harvest-notificati
on-service.test.ts:177:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Harvest Notification Service ÔÇ║ 
scheduleOverdueReminder ÔÇ║ should schedule overdue 
notification successfully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 210 |[39m       )[33m;[39m
     [90m 211 |[39m
    [31m[1m>[22m[39m[90m 212 |[39m       expect(re
sult[33m.[39mscheduled)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 213 |[39m       expect(result[33m.[39mnoti
ficationId)[33m.[39mtoBe([32m'notification-id-123'[3
9m)[33m;[39m
     [90m 214 |[39m       expect([33mNotifications[3
9m[33m.[39mscheduleNotificationAsync)[33m.[39mtoHave
BeenCalledWith(
     [90m 215 |[39m         
expect[33m.[39mobjectContaining({[0m

      at Object.toBe (src/lib/harvest/harvest-notificati
on-service.test.ts:212:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/auth/connectivity-handler.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

  ÔùÅ connectivity-handler ÔÇ║ useConnectivityHandler 
ÔÇ║ should subscribe to connectivity changes

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: Any<Function>

    Number of calls: 0

    [0m [90m 86 |[39m       [36mconst[39m { 
unmount } [33m=[39m renderHook(() [33m=>[39m 
useConnectivityHandler())[33m;[39m
     [90m 87 |[39m
    [31m[1m>[22m[39m[90m 88 |[39m       expect(moc
kOnConnectivityChange)[33m.[39mtoHaveBeenCalledWith(
     [90m    |[39m                                    
    [31m[1m^[22m[39m
     [90m 89 |[39m         
expect[33m.[39many([33mFunction[39m)
     [90m 90 |[39m       )[33m;[39m
     [90m 91 |[39m[0m

      at Object.toHaveBeenCalledWith 
(src/lib/auth/connectivity-handler.test.ts:88:40)

  ÔùÅ connectivity-handler ÔÇ║ useConnectivityHandler 
ÔÇ║ should validate session when connectivity is 
restored

    TypeError: connectivityCallback is not a function

    [0m [90m 109 |[39m
     [90m 110 |[39m       [90m// Simulate going 
offline[39m
    [31m[1m>[22m[39m[90m 111 |[39m       
connectivityCallback[33m![39m({
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 112 |[39m         type[33m:[39m 
[32m'wifi'[39m[33m,[39m
     [90m 113 |[39m         isConnected[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 114 |[39m         
isInternetReachable[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.connectivityCallback 
(src/lib/auth/connectivity-handler.test.ts:111:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ connectivity-handler ÔÇ║ useConnectivityHandler 
ÔÇ║ should not validate if already online

    TypeError: connectivityCallback is not a function

    [0m [90m 146 |[39m
     [90m 147 |[39m       [90m// Simulate staying 
online[39m
    [31m[1m>[22m[39m[90m 148 |[39m       
connectivityCallback[33m![39m({
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 149 |[39m         type[33m:[39m 
[32m'wifi'[39m[33m,[39m
     [90m 150 |[39m         isConnected[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 151 |[39m         
isInternetReachable[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.connectivityCallback 
(src/lib/auth/connectivity-handler.test.ts:148:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ connectivity-handler ÔÇ║ useConnectivityHandler 
ÔÇ║ should handle failed session validation

    TypeError: connectivityCallback is not a function

    [0m [90m 179 |[39m
     [90m 180 |[39m       [90m// Simulate offline 
then online[39m
    [31m[1m>[22m[39m[90m 181 |[39m       
connectivityCallback[33m![39m({
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 182 |[39m         type[33m:[39m 
[32m'wifi'[39m[33m,[39m
     [90m 183 |[39m         isConnected[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 184 |[39m         
isInternetReachable[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.connectivityCallback 
(src/lib/auth/connectivity-handler.test.ts:181:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/moderation/moderation-notification-service.
test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      [ModerationNotifications] Failed to send SoR 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:159:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 93 |[39m       }
     [90m 94 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 95 |[39m       
console[33m.[39merror(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 96 |[39m         
[32m'[ModerationNotifications] Failed to send SoR 
notification:'[39m[33m,[39m
     [90m 97 |[39m         error
     [90m 98 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:95:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send SoR 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 93 |[39m       }
     [90m 94 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 95 |[39m       
console[33m.[39merror(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 96 |[39m         
[32m'[ModerationNotifications] Failed to send SoR 
notification:'[39m[33m,[39m
     [90m 97 |[39m         error
     [90m 98 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:95:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send decision 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 134 |[39m       })[33m;[39m
     [90m 135 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 136 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 137 |[39m         
[32m'[ModerationNotifications] Failed to send decision 
notification:'[39m[33m,[39m
     [90m 138 |[39m         error
     [90m 139 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:136:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send decision 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 134 |[39m       })[33m;[39m
     [90m 135 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 136 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 137 |[39m         
[32m'[ModerationNotifications] Failed to send decision 
notification:'[39m[33m,[39m
     [90m 138 |[39m         error
     [90m 139 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:136:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send appeal 
deadline notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 177 |[39m       })[33m;[39m
     [90m 178 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 179 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 180 |[39m         
[32m'[ModerationNotifications] Failed to send appeal 
deadline notification:'[39m[33m,[39m
     [90m 181 |[39m         error
     [90m 182 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:179:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send appeal 
deadline notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 177 |[39m       })[33m;[39m
     [90m 178 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 179 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 180 |[39m         
[32m'[ModerationNotifications] Failed to send appeal 
deadline notification:'[39m[33m,[39m
     [90m 181 |[39m         error
     [90m 182 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:179:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to schedule 
appeal reminder: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 221 |[39m       })[33m;[39m
     [90m 222 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 223 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 224 |[39m         
[32m'[ModerationNotifications] Failed to schedule 
appeal reminder:'[39m[33m,[39m
     [90m 225 |[39m         error
     [90m 226 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:223:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send SLA 
breach alert: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 258 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mlogModeratorAlert(data)[33m;[39m
     [90m 259 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 260 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 261 |[39m         
[32m'[ModerationNotifications] Failed to send SLA 
breach alert:'[39m[33m,[39m
     [90m 262 |[39m         error
     [90m 263 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:260:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send SLA 
breach alert: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 258 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mlogModeratorAlert(data)[33m;[39m
     [90m 259 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 260 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 261 |[39m         
[32m'[ModerationNotifications] Failed to send SLA 
breach alert:'[39m[33m,[39m
     [90m 262 |[39m         error
     [90m 263 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:260:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send SLA 
warning: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 291 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mlogModeratorAlert(data)[33m;[39m
     [90m 292 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 293 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 294 |[39m         
[32m'[ModerationNotifications] Failed to send SLA 
warning:'[39m[33m,[39m
     [90m 295 |[39m         error
     [90m 296 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:293:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send SLA 
warning: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 291 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mlogModeratorAlert(data)[33m;[39m
     [90m 292 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 293 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 294 |[39m         
[32m'[ModerationNotifications] Failed to send SLA 
warning:'[39m[33m,[39m
     [90m 295 |[39m         error
     [90m 296 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:293:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send 
escalation alert: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 331 |[39m       })[33m;[39m
     [90m 332 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 333 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 334 |[39m         
[32m'[ModerationNotifications] Failed to send 
escalation alert:'[39m[33m,[39m
     [90m 335 |[39m         error
     [90m 336 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:333:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send decision 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 134 |[39m       })[33m;[39m
     [90m 135 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 136 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 137 |[39m         
[32m'[ModerationNotifications] Failed to send decision 
notification:'[39m[33m,[39m
     [90m 138 |[39m         error
     [90m 139 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:136:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send decision 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 134 |[39m       })[33m;[39m
     [90m 135 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 136 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 137 |[39m         
[32m'[ModerationNotifications] Failed to send decision 
notification:'[39m[33m,[39m
     [90m 138 |[39m         error
     [90m 139 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:136:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send decision 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 134 |[39m       })[33m;[39m
     [90m 135 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 136 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 137 |[39m         
[32m'[ModerationNotifications] Failed to send decision 
notification:'[39m[33m,[39m
     [90m 138 |[39m         error
     [90m 139 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:136:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send decision 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 134 |[39m       })[33m;[39m
     [90m 135 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 136 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 137 |[39m         
[32m'[ModerationNotifications] Failed to send decision 
notification:'[39m[33m,[39m
     [90m 138 |[39m         error
     [90m 139 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:136:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send decision 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 134 |[39m       })[33m;[39m
     [90m 135 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 136 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 137 |[39m         
[32m'[ModerationNotifications] Failed to send decision 
notification:'[39m[33m,[39m
     [90m 138 |[39m         error
     [90m 139 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:136:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send decision 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 134 |[39m       })[33m;[39m
     [90m 135 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 136 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 137 |[39m         
[32m'[ModerationNotifications] Failed to send decision 
notification:'[39m[33m,[39m
     [90m 138 |[39m         error
     [90m 139 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:136:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send decision 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 134 |[39m       })[33m;[39m
     [90m 135 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 136 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 137 |[39m         
[32m'[ModerationNotifications] Failed to send decision 
notification:'[39m[33m,[39m
     [90m 138 |[39m         error
     [90m 139 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:136:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send SoR 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 93 |[39m       }
     [90m 94 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 95 |[39m       
console[33m.[39merror(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 96 |[39m         
[32m'[ModerationNotifications] Failed to send SoR 
notification:'[39m[33m,[39m
     [90m 97 |[39m         error
     [90m 98 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:95:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send SoR 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 93 |[39m       }
     [90m 94 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 95 |[39m       
console[33m.[39merror(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 96 |[39m         
[32m'[ModerationNotifications] Failed to send SoR 
notification:'[39m[33m,[39m
     [90m 97 |[39m         error
     [90m 98 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:95:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send SoR 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 93 |[39m       }
     [90m 94 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 95 |[39m       
console[33m.[39merror(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 96 |[39m         
[32m'[ModerationNotifications] Failed to send SoR 
notification:'[39m[33m,[39m
     [90m 97 |[39m         error
     [90m 98 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:95:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send SoR 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 93 |[39m       }
     [90m 94 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 95 |[39m       
console[33m.[39merror(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 96 |[39m         
[32m'[ModerationNotifications] Failed to send SoR 
notification:'[39m[33m,[39m
     [90m 97 |[39m         error
     [90m 98 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:95:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [ModerationNotifications] Failed to send SoR 
notification: Error: Notification failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-notification-service.test.
ts:170:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 93 |[39m       }
     [90m 94 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 95 |[39m       
console[33m.[39merror(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 96 |[39m         
[32m'[ModerationNotifications] Failed to send SoR 
notification:'[39m[33m,[39m
     [90m 97 |[39m         error
     [90m 98 |[39m       )[33m;[39m[0m

      at ModerationNotificationService.error (src/lib/mo
deration/moderation-notification-service.ts:95:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ ModerationNotificationService ÔÇ║ 
sendSLABreachAlert ÔÇ║ should log moderator alert

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "moderator_alert_log"

    Number of calls: 0

    [0m [90m 328 |[39m       [36mawait[39m service
[33m.[39msendSLABreachAlert(alertData)[33m;[39m
     [90m 329 |[39m
    [31m[1m>[22m[39m[90m 330 |[39m       expect(su
pabase[33m.[39m[36mfrom[39m)[33m.[39mtoHaveBeenCal
ledWith([32m'moderator_alert_log'[39m)[33m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 331 |[39m     })[33m;[39m
     [90m 332 |[39m   })[33m;[39m
     [90m 333 |[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/moderation-notification-service.test.ts:330:29)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModerationNotificationService ÔÇ║ Email 
notification requirements ÔÇ║ should send email for 
content removal

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "send-moderation-email", Any<Object>

    Number of calls: 0

    [0m [90m 429 |[39m       [36mawait[39m service
[33m.[39msendStatementOfReasons(userId[33m,[39m 
decision[33m,[39m mockStatement)[33m;[39m
     [90m 430 |[39m
    [31m[1m>[22m[39m[90m 431 |[39m       expect(su
pabase[33m.[39mfunctions[33m.[39minvoke)[33m.[39mt
oHaveBeenCalledWith(
     [90m     |[39m                                   
      [31m[1m^[22m[39m
     [90m 432 |[39m         
[32m'send-moderation-email'[39m[33m,[39m
     [90m 433 |[39m         
expect[33m.[39many([33mObject[39m)
     [90m 434 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/moderation-notification-service.test.ts:431:41)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModerationNotificationService ÔÇ║ Email 
notification requirements ÔÇ║ should send email for 
account suspension

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "send-moderation-email", Any<Object>

    Number of calls: 0

    [0m [90m 444 |[39m       [36mawait[39m service
[33m.[39msendStatementOfReasons(userId[33m,[39m 
decision[33m,[39m mockStatement)[33m;[39m
     [90m 445 |[39m
    [31m[1m>[22m[39m[90m 446 |[39m       expect(su
pabase[33m.[39mfunctions[33m.[39minvoke)[33m.[39mt
oHaveBeenCalledWith(
     [90m     |[39m                                   
      [31m[1m^[22m[39m
     [90m 447 |[39m         
[32m'send-moderation-email'[39m[33m,[39m
     [90m 448 |[39m         
expect[33m.[39many([33mObject[39m)
     [90m 449 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/moderation-notification-service.test.ts:446:41)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModerationNotificationService ÔÇ║ Appeal deadline 
calculation ÔÇ║ should calculate 14-day deadline for 
content removal

    TypeError: Cannot read properties of undefined 
(reading '1')

    [0m [90m 474 |[39m
     [90m 475 |[39m       [36mconst[39m emailCall 
[33m=[39m 
(supabase[33m.[39mfunctions[33m.[39minvoke 
[36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmo
ck[33m.[39mcalls[[35m0[39m][33m;[39m
    [31m[1m>[22m[39m[90m 476 |[39m       
[36mconst[39m appealDeadline [33m=[39m 
[36mnew[39m [33mDate[39m(emailCall[[35m1[39m][33m
.[39mbody[33m.[39mappealDeadline)[33m;[39m
     [90m     |[39m                                   
             [31m[1m^[22m[39m
     [90m 477 |[39m       [36mconst[39m daysDiff 
[33m=[39m [33mMath[39m[33m.[39mceil(
     [90m 478 |[39m         
(appealDeadline[33m.[39mgetTime() [33m-[39m 
[33mDate[39m[33m.[39mnow()) [33m/[39m 
([35m1000[39m [33m*[39m [35m60[39m [33m*[39m 
[35m60[39m [33m*[39m [35m24[39m)
     [90m 479 |[39m       )[33m;[39m[0m

      at Object.<anonymous> (src/lib/moderation/moderati
on-notification-service.test.ts:476:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModerationNotificationService ÔÇ║ Appeal deadline 
calculation ÔÇ║ should calculate 30-day deadline for 
account suspension

    TypeError: Cannot read properties of undefined 
(reading '1')

    [0m [90m 492 |[39m
     [90m 493 |[39m       [36mconst[39m emailCall 
[33m=[39m 
(supabase[33m.[39mfunctions[33m.[39minvoke 
[36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmo
ck[33m.[39mcalls[[35m0[39m][33m;[39m
    [31m[1m>[22m[39m[90m 494 |[39m       
[36mconst[39m appealDeadline [33m=[39m 
[36mnew[39m [33mDate[39m(emailCall[[35m1[39m][33m
.[39mbody[33m.[39mappealDeadline)[33m;[39m
     [90m     |[39m                                   
             [31m[1m^[22m[39m
     [90m 495 |[39m       [36mconst[39m daysDiff 
[33m=[39m [33mMath[39m[33m.[39mceil(
     [90m 496 |[39m         
(appealDeadline[33m.[39mgetTime() [33m-[39m 
[33mDate[39m[33m.[39mnow()) [33m/[39m 
([35m1000[39m [33m*[39m [35m60[39m [33m*[39m 
[35m60[39m [33m*[39m [35m24[39m)
     [90m 497 |[39m       )[33m;[39m[0m

      at Object.<anonymous> (src/lib/moderation/moderati
on-notification-service.test.ts:494:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/assessment/__tests__/model-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ ModelManager ÔÇ║ initialize ÔÇ║ should initialize 
successfully and load metadata

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "file:///models/", {"intermediates": true}

    Number of calls: 0

    [0m [90m 83 |[39m
     [90m 84 |[39m       expect(mockGetModelPaths)[33
m.[39mtoHaveBeenCalled()[33m;[39m
    [31m[1m>[22m[39m[90m 85 |[39m       expect(moc
kFileSystem[33m.[39mmakeDirectoryAsync)[33m.[39mtoHa
veBeenCalledWith(
     [90m    |[39m                                    
             [31m[1m^[22m[39m
     [90m 86 |[39m         
mockModelPaths[33m.[39mbaseDir[33m,[39m
     [90m 87 |[39m         { intermediates[33m:[39m 
[36mtrue[39m }
     [90m 88 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/assessment
/__tests__/model-manager.test.ts:85:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModelManager ÔÇ║ initialize ÔÇ║ should throw 
error on initialization failure

    expect(received).rejects.toThrow()

    Received promise resolved instead of rejected
    Resolved to value: undefined

    [0m [90m 105 |[39m       )[33m;[39m
     [90m 106 |[39m
    [31m[1m>[22m[39m[90m 107 |[39m       
[36mawait[39m expect(modelManager[33m.[39minitialize
())[33m.[39mrejects[33m.[39mtoThrow(
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 108 |[39m         [32m'Failed to 
initialize model manager'[39m
     [90m 109 |[39m       )[33m;[39m
     [90m 110 |[39m     })[33m;[39m[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect (src/lib/assessment/__tests__/mod
el-manager.test.ts:107:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/inventory/__tests__/inventory-sync-integrat
ion.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ Inventory Sync Integration ÔÇ║ Offline CRUD 
Operations (Requirement 7.4) ÔÇ║ should create 
inventory item offline and queue for sync

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Test Nutrient"
    Received: undefined

    [0m [90m 50 |[39m
     [90m 51 |[39m       
expect(item)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 52 |[39m       
expect(item[33m.[39mname)[33m.[39mtoBe([32m'Test 
Nutrient'[39m)[33m;[39m
     [90m    |[39m                         
[31m[1m^[22m[39m
     [90m 53 |[39m       expect(item[33m.[39mtrackin
gMode)[33m.[39mtoBe([32m'batched'[39m)[33m;[39m
     [90m 54 |[39m
     [90m 55 |[39m       [90m// Verify item is in 
local database[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:52:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Offline CRUD 
Operations (Requirement 7.4) ÔÇ║ should create batch 
offline with proper relations

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "mock-id"
    Received: undefined

    [0m [90m 83 |[39m
     [90m 84 |[39m       
expect(batch)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 85 |[39m       expect(bat
ch[33m.[39mitemId)[33m.[39mtoBe(item[33m.[39mid)[
33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 86 |[39m       expect(batch[33m.[39mlotNum
ber)[33m.[39mtoBe([32m'LOT-2025-001'[39m)[33m;[39m
     [90m 87 |[39m       expect(batch[33m.[39mquanti
ty)[33m.[39mtoBe([35m100[39m)[33m;[39m
     [90m 88 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:85:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Offline CRUD 
Operations (Requirement 7.4) ÔÇ║ should create movement 
offline (create-only)

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "receipt"
    Received: undefined

    [0m [90m 117 |[39m
     [90m 118 |[39m       
expect(movement)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 119 |[39m       expect(mo
vement[33m.[39mtype)[33m.[39mtoBe([32m'receipt'[39
m)[33m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 120 |[39m       expect(movement[33m.[39mqu
antityDelta)[33m.[39mtoBe([35m500[39m)[33m;[39m
     [90m 121 |[39m       expect(movement[33m.[39mex
ternalKey)[33m.[39mtoBe([32m'test-receipt-001'[39m)
[33m;[39m
     [90m 122 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:119:29)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Movement 
Immutability (Requirements 1.4, 10.6) ÔÇ║ should not 
allow updating movements

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 100
    Received: undefined

    [0m [90m 156 |[39m
     [90m 157 |[39m       
expect(movement)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 158 |[39m       expect(mo
vement[33m.[39mquantityDelta)[33m.[39mtoBe([35m100
[39m)[33m;[39m
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 159 |[39m
     [90m 160 |[39m       [90m// Note: Client-side 
update is technically possible in WatermelonDB,[39m
     [90m 161 |[39m       [90m// but sync-engine.ts 
filters out updated/deleted movements before 
push[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:158:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Movement 
Immutability (Requirements 1.4, 10.6) ÔÇ║ should 
support idempotency via external_key

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "idempotent-receipt-123"
    Received: undefined

    [0m [90m 195 |[39m
     [90m 196 |[39m       
expect(movement1)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 197 |[39m       expect(mo
vement1[33m.[39mexternalKey)[33m.[39mtoBe(externalKe
y)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 198 |[39m
     [90m 199 |[39m       [90m// Check for existing 
movement with same external_key before creating 
duplicate[39m
     [90m 200 |[39m       [36mconst[39m 
existingMovement [33m=[39m [36mawait[39m 
movementsCollection[0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:197:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Offline Workflow 
(Requirement 7.4) ÔÇ║ should support flight-mode 
workflow: create item ÔåÆ add batch ÔåÆ consume

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 1000
    Received: undefined

    [0m [90m 239 |[39m       })[33m;[39m
     [90m 240 |[39m
    [31m[1m>[22m[39m[90m 241 |[39m       expect(ba
tch[33m.[39mquantity)[33m.[39mtoBe([35m1000[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 242 |[39m
     [90m 243 |[39m       [90m// Step 3: Consume via 
task offline[39m
     [90m 244 |[39m       [36mconst[39m 
consumptionMovement[33m:[39m 
[33mInventoryMovementModel[39m [33m=[39m 
[36mawait[39m database[33m.[39mwrite([0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:241:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Sync Field 
Integrity ÔÇ║ should store server sync fields correctly

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 1
    Received: undefined

    [0m [90m 293 |[39m       })[33m;[39m
     [90m 294 |[39m
    [31m[1m>[22m[39m[90m 295 |[39m       expect(it
em[33m.[39mserverRevision)[33m.[39mtoBe([35m1[39m)
[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 296 |[39m       expect(item[33m.[39mserver
UpdatedAtMs)[33m.[39mtoBeDefined()[33m;[39m
     [90m 297 |[39m     })[33m;[39m
     [90m 298 |[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:295:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Sync Field 
Integrity ÔÇ║ should support soft delete via deleted_at 
tombstones

    TypeError: item.markAsDeleted is not a function

    [0m [90m 312 |[39m       [90m// Mark as 
deleted[39m
     [90m 313 |[39m       [36mawait[39m 
database[33m.[39mwrite([36masync[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 314 |[39m         
[36mawait[39m 
item[33m.[39mmarkAsDeleted()[33m;[39m
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 315 |[39m       })[33m;[39m
     [90m 316 |[39m
     [90m 317 |[39m       [90m// Verify deletedAt 
timestamp is set (WatermelonDB field name)[39m[0m

      at markAsDeleted (src/lib/inventory/__tests__/inve
ntory-sync-integration.test.ts:314:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/inventory/__tests__/inven
tory-sync-integration.test.ts:313:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/moderation/config/moderation-config.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ ModerationConfig ÔÇ║ Feature Flags ÔÇ║ all 
features disabled in production by default

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 153 |[39m
     [90m 154 |[39m       expect(config[33m.[39menvi
ronment)[33m.[39mtoBe([32m'production'[39m)[33m;[3
9m
    [31m[1m>[22m[39m[90m 155 |[39m       expect(co
nfig[33m.[39mfeatures[33m.[39mcontentReporting)[33m
.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                                   
             [31m[1m^[22m[39m
     [90m 156 |[39m       expect(config[33m.[39mfeat
ures[33m.[39mmoderationQueue)[33m.[39mtoBe([36mfals
e[39m)[33m;[39m
     [90m 157 |[39m       expect(config[33m.[39mfeat
ures[33m.[39mappeals)[33m.[39mtoBe([36mfalse[39m)
[33m;[39m
     [90m 158 |[39m       expect(config[33m.[39mfeat
ures[33m.[39modsIntegration)[33m.[39mtoBe([36mfalse
[39m)[33m;[39m[0m

      at Object.toBe (src/lib/moderation/config/moderati
on-config.test.ts:155:48)

  ÔùÅ ModerationConfig ÔÇ║ Feature Flags ÔÇ║ features 
enabled in development by default

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 176 |[39m       expect(config[33m.[39m
environment)[33m.[39mtoBe([32m'development'[39m)[33
m;[39m
     [90m 177 |[39m       expect(config[33m.[39mfeat
ures[33m.[39mcontentReporting)[33m.[39mtoBe([36mtru
e[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m       expect(co
nfig[33m.[39mfeatures[33m.[39mmoderationQueue)[33m.
[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                                   
            [31m[1m^[22m[39m
     [90m 179 |[39m       expect(config[33m.[39mfeat
ures[33m.[39mappeals)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m 180 |[39m
     [90m 181 |[39m       
process[33m.[39menv[33m.[39m[33mAPP_ENV[39m 
[33m=[39m originalEnv[33m;[39m[0m

      at Object.toBe (src/lib/moderation/config/moderati
on-config.test.ts:178:47)

FAIL src/lib/community/__tests__/offline-workflow-integr
ation.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: LIKE, 
attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 1 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: 
COMMENT, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 1 failed: [
        {
          "code": "invalid_type",
          "expected": "string",
          "received": "undefined",
          "path": [
            "postId"
          ],
          "message": "Required"
        }
      ]

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 1 will retry in 1000ms

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:325:15)

    console.log
      [OutboxProcessor] Processing 3 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: LIKE, 
attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 1 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processing entry 2, op: 
COMMENT, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 2 failed: [
        {
          "code": "invalid_type",
          "expected": "string",
          "received": "undefined",
          "path": [
            "postId"
          ],
          "message": "Required"
        }
      ]

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 2 will retry in 1000ms

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:325:15)

    console.log
      [OutboxProcessor] Processing entry 3, op: UNLIKE, 
attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 3 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: LIKE, 
attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 1 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: 
DELETE_POST, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 1 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: 
DELETE_POST, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 1 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: 
DELETE_POST, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 1 failed: expired

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 1 will retry in 1000ms

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:325:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 2, op: 
UNDO_DELETE_POST, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 2 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 3, op: 
UNDO_DELETE_COMMENT, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 3 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 4, op: 
UNDO_DELETE_POST, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 4 failed: expired

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 4 will retry in 1000ms

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:325:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 5, op: 
DELETE_POST, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 5 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 6, op: 
UNDO_DELETE_POST, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 6 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: LIKE, 
attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 1 failed: Not found

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 1 dropped (404)

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:306:17)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: 
COMMENT, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 1 failed: [
        {
          "code": "invalid_type",
          "expected": "string",
          "received": "undefined",
          "path": [
            "postId"
          ],
          "message": "Required"
        }
      ]

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 1 will retry in 1000ms

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:325:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: LIKE, 
attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 1 failed: Network error

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 1 will retry in 1000ms

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:325:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Entry 1 exceeded max retries, 
marking as failed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:109:19)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: LIKE, 
attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 1 failed: Network error

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 1 will retry in 1000ms

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:325:15)

  ÔùÅ Offline Workflow Integration Tests ÔÇ║ Complete 
offline workflow ÔÇ║ should queue comment while offline 
and sync on reconnect

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"body": "Offline comment", "post_id": 
"post-1"}, "idem-key-1", "client-tx-1"

    Number of calls: 0

    [0m [90m 121 |[39m       [36mawait[39m 
processor[33m.[39mprocessQueue()[33m;[39m
     [90m 122 |[39m
    [31m[1m>[22m[39m[90m 123 |[39m       expect(mo
ckApiClient[33m.[39mcreateComment)[33m.[39mtoHaveBee
nCalledWith(
     [90m     |[39m                                   
        [31m[1m^[22m[39m
     [90m 124 |[39m         { post_id[33m:[39m 
[32m'post-1'[39m[33m,[39m body[33m:[39m 
[32m'Offline comment'[39m }[33m,[39m
     [90m 125 |[39m         
mockEntry[33m.[39midempotencyKey[33m,[39m
     [90m 126 |[39m         
mockEntry[33m.[39mclientTxId[0m

      at Object.toHaveBeenCalledWith (src/lib/community/
__tests__/offline-workflow-integration.test.ts:123:43)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Offline Workflow Integration Tests ÔÇ║ Complete 
offline workflow ÔÇ║ should process multiple queued 
actions in FIFO order

    expect(jest.fn()).toHaveBeenCalledTimes(expected)

    Expected number of calls: 1
    Received number of calls: 0

    [0m [90m 153 |[39m       [90m// Verify FIFO 
order (check that all operations completed)[39m
     [90m 154 |[39m       expect(mockApiClient[33m.[
39mlikePost)[33m.[39mtoHaveBeenCalledTimes([35m1[39m
)[33m;[39m
    [31m[1m>[22m[39m[90m 155 |[39m       expect(mo
ckApiClient[33m.[39mcreateComment)[33m.[39mtoHaveBee
nCalledTimes([35m1[39m)[33m;[39m
     [90m     |[39m                                   
        [31m[1m^[22m[39m
     [90m 156 |[39m       expect(mockApiClient[33m.[
39munlikePost)[33m.[39mtoHaveBeenCalledTimes([35m1[3
9m)[33m;[39m
     [90m 157 |[39m     })[33m;[39m
     [90m 158 |[39m   })[33m;[39m[0m

      at Object.toHaveBeenCalledTimes (src/lib/community
/__tests__/offline-workflow-integration.test.ts:155:43)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Offline Workflow Integration Tests ÔÇ║ Target 
deleted scenarios ÔÇ║ should drop comment action when 
post is deleted

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

    [0m [90m 438 |[39m       [36mawait[39m 
processor[33m.[39mprocessQueue()[33m;[39m
     [90m 439 |[39m
    [31m[1m>[22m[39m[90m 440 |[39m       expect(mo
ckEntry[33m.[39mdestroyPermanently)[33m.[39mtoHaveBe
enCalled()[33m;[39m
     [90m     |[39m                                   
         [31m[1m^[22m[39m
     [90m 441 |[39m     })[33m;[39m
     [90m 442 |[39m   })[33m;[39m
     [90m 443 |[39m[0m

      at Object.toHaveBeenCalled (src/lib/community/__te
sts__/offline-workflow-integration.test.ts:440:44)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/assessment/__tests__/cloud-inference-client
.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      [CloudInferenceClient] Inference failed after 
1ms: TypeError: Crypto.randomUUID is not a function
          at CloudInferenceClient.randomUUID (C:\Users\P
eter\GrowBro\src\lib\assessment\cloud-inference-client.t
s:42:62)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at CloudInferenceClient.<anonymous> (C:\Users\
Peter\GrowBro\node_modules\@babel\runtime\helpers\asyncT
oGenerator.js:14:12)
          at CloudInferenceClient.apply [as predict] (C:
\Users\Peter\GrowBro\src\lib\assessment\cloud-inference-
client.ts:33:16)
          at Object.predict (C:\Users\Peter\GrowBro\src\
lib\assessment\__tests__\cloud-inference-client.test.ts:
165:33)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 83 |[39m     } [36mcatch[39m (error) {
     [90m 84 |[39m       [36mconst[39m 
processingTimeMs [33m=[39m 
[33mDate[39m[33m.[39mnow() [33m-[39m 
startTime[33m;[39m
    [31m[1m>[22m[39m[90m 85 |[39m       
console[33m.[39merror(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 86 |[39m         
[32m`[CloudInferenceClient] Inference failed after 
${processingTimeMs}ms:`[39m[33m,[39m
     [90m 87 |[39m         error
     [90m 88 |[39m       )[33m;[39m[0m

      at CloudInferenceClient.error 
(src/lib/assessment/cloud-inference-client.ts:85:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CloudInferenceClient.<anonymous> (node_modules/
@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at CloudInferenceClient.apply [as predict] 
(src/lib/assessment/cloud-inference-client.ts:33:16)
      at Object.predict (src/lib/assessment/__tests__/cl
oud-inference-client.test.ts:165:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      [CloudInferenceClient] Inference failed after 
1ms: TypeError: Crypto.randomUUID is not a function
          at CloudInferenceClient.randomUUID (C:\Users\P
eter\GrowBro\src\lib\assessment\cloud-inference-client.t
s:42:62)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at CloudInferenceClient.<anonymous> (C:\Users\
Peter\GrowBro\node_modules\@babel\runtime\helpers\asyncT
oGenerator.js:14:12)
          at CloudInferenceClient.apply [as predict] (C:
\Users\Peter\GrowBro\src\lib\assessment\cloud-inference-
client.ts:33:16)
          at Object.predict (C:\Users\Peter\GrowBro\src\
lib\assessment\__tests__\cloud-inference-client.test.ts:
204:14)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 83 |[39m     } [36mcatch[39m (error) {
     [90m 84 |[39m       [36mconst[39m 
processingTimeMs [33m=[39m 
[33mDate[39m[33m.[39mnow() [33m-[39m 
startTime[33m;[39m
    [31m[1m>[22m[39m[90m 85 |[39m       
console[33m.[39merror(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 86 |[39m         
[32m`[CloudInferenceClient] Inference failed after 
${processingTimeMs}ms:`[39m[33m,[39m
     [90m 87 |[39m         error
     [90m 88 |[39m       )[33m;[39m[0m

      at CloudInferenceClient.error 
(src/lib/assessment/cloud-inference-client.ts:85:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CloudInferenceClient.<anonymous> (node_modules/
@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at CloudInferenceClient.apply [as predict] 
(src/lib/assessment/cloud-inference-client.ts:33:16)
      at Object.predict (src/lib/assessment/__tests__/cl
oud-inference-client.test.ts:204:14)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      [CloudInferenceClient] Inference failed after 
3ms: {
        code: 'MODEL_FAILURE',
        message: 'Model execution failed',
        category: 'server',
        retryable: true,
        httpStatus: undefined,
        details: undefined
      }

    [0m [90m 83 |[39m     } [36mcatch[39m (error) {
     [90m 84 |[39m       [36mconst[39m 
processingTimeMs [33m=[39m 
[33mDate[39m[33m.[39mnow() [33m-[39m 
startTime[33m;[39m
    [31m[1m>[22m[39m[90m 85 |[39m       
console[33m.[39merror(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 86 |[39m         
[32m`[CloudInferenceClient] Inference failed after 
${processingTimeMs}ms:`[39m[33m,[39m
     [90m 87 |[39m         error
     [90m 88 |[39m       )[33m;[39m[0m

      at CloudInferenceClient.error 
(src/lib/assessment/cloud-inference-client.ts:85:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [CloudInferenceClient] Inference failed after 
0ms: TypeError: Crypto.randomUUID is not a function
          at CloudInferenceClient.randomUUID (C:\Users\P
eter\GrowBro\src\lib\assessment\cloud-inference-client.t
s:42:62)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at CloudInferenceClient.<anonymous> (C:\Users\
Peter\GrowBro\node_modules\@babel\runtime\helpers\asyncT
oGenerator.js:14:12)
          at CloudInferenceClient.apply [as predict] (C:
\Users\Peter\GrowBro\src\lib\assessment\cloud-inference-
client.ts:33:16)
          at Object.predict (C:\Users\Peter\GrowBro\src\
lib\assessment\__tests__\cloud-inference-client.test.ts:
245:33)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 83 |[39m     } [36mcatch[39m (error) {
     [90m 84 |[39m       [36mconst[39m 
processingTimeMs [33m=[39m 
[33mDate[39m[33m.[39mnow() [33m-[39m 
startTime[33m;[39m
    [31m[1m>[22m[39m[90m 85 |[39m       
console[33m.[39merror(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 86 |[39m         
[32m`[CloudInferenceClient] Inference failed after 
${processingTimeMs}ms:`[39m[33m,[39m
     [90m 87 |[39m         error
     [90m 88 |[39m       )[33m;[39m[0m

      at CloudInferenceClient.error 
(src/lib/assessment/cloud-inference-client.ts:85:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CloudInferenceClient.<anonymous> (node_modules/
@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at CloudInferenceClient.apply [as predict] 
(src/lib/assessment/cloud-inference-client.ts:33:16)
      at Object.predict (src/lib/assessment/__tests__/cl
oud-inference-client.test.ts:245:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ CloudInferenceClient ÔÇ║ uploads images and 
returns inference result

    TypeError: Crypto.randomUUID is not a function

    [0m [90m 40 |[39m     [36mtry[39m {
     [90m 41 |[39m       [90m// Use provided 
idempotency key or generate new one[39m
    [31m[1m>[22m[39m[90m 42 |[39m       
[36mconst[39m requestIdempotencyKey [33m=[39m 
idempotencyKey [33m||[39m 
[33mCrypto[39m[33m.[39mrandomUUID()[33m;[39m
     [90m    |[39m                                    
                          [31m[1m^[22m[39m
     [90m 43 |[39m
     [90m 44 |[39m       [90m// Upload images to 
storage and get signed URLs[39m
     [90m 45 |[39m       [36mconst[39m 
uploadedImages [33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39muploadImages(photos[33m,[39m 
assessmentId)[33m;[39m[0m

      at CloudInferenceClient.randomUUID 
(src/lib/assessment/cloud-inference-client.ts:42:62)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CloudInferenceClient.<anonymous> (node_modules/
@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at CloudInferenceClient.apply [as predict] 
(src/lib/assessment/cloud-inference-client.ts:33:16)
      at Object.predict (src/lib/assessment/__tests__/cl
oud-inference-client.test.ts:165:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ CloudInferenceClient ÔÇ║ throws when edge 
function responds with error payload

    expect(received).rejects.toMatchObject(expected)

    - Expected  - 5
    + Received  + 1

    - Object {
    -   "code": "MODEL_FAILURE",
    -   "message": "Model execution failed",
    -   "retryable": true,
    - }
    + [TypeError: Crypto.randomUUID is not a function]

    [0m [90m 207 |[39m         
assessmentId[33m:[39m 
[32m'assessment-1'[39m[33m,[39m
     [90m 208 |[39m       })
    [31m[1m>[22m[39m[90m 209 |[39m     
)[33m.[39mrejects[33m.[39mtoMatchObject({
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 210 |[39m       code[33m:[39m 
[32m'MODEL_FAILURE'[39m[33m,[39m
     [90m 211 |[39m       message[33m:[39m 
[32m'Model execution failed'[39m[33m,[39m
     [90m 212 |[39m       retryable[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.toMatchObject 
(node_modules/expect/build/index.js:218:22)
      at Object.toMatchObject (src/lib/assessment/__test
s__/cloud-inference-client.test.ts:209:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ CloudInferenceClient ÔÇ║ uses provided 
idempotency key instead of generating new one

    Model execution failed



  ÔùÅ CloudInferenceClient ÔÇ║ handles 409 conflict by 
treating as successful upload

    TypeError: Crypto.randomUUID is not a function

    [0m [90m 40 |[39m     [36mtry[39m {
     [90m 41 |[39m       [90m// Use provided 
idempotency key or generate new one[39m
    [31m[1m>[22m[39m[90m 42 |[39m       
[36mconst[39m requestIdempotencyKey [33m=[39m 
idempotencyKey [33m||[39m 
[33mCrypto[39m[33m.[39mrandomUUID()[33m;[39m
     [90m    |[39m                                    
                          [31m[1m^[22m[39m
     [90m 43 |[39m
     [90m 44 |[39m       [90m// Upload images to 
storage and get signed URLs[39m
     [90m 45 |[39m       [36mconst[39m 
uploadedImages [33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39muploadImages(photos[33m,[39m 
assessmentId)[33m;[39m[0m

      at CloudInferenceClient.randomUUID 
(src/lib/assessment/cloud-inference-client.ts:42:62)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CloudInferenceClient.<anonymous> (node_modules/
@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at CloudInferenceClient.apply [as predict] 
(src/lib/assessment/cloud-inference-client.ts:33:16)
      at Object.predict (src/lib/assessment/__tests__/cl
oud-inference-client.test.ts:245:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/moderation/sor-submission-orchestrator.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Statement not found for queue item queue-1

    [0m [90m 219 |[39m
     [90m 220 |[39m           [36mif[39m 
([33m![39mstatement) {
    [31m[1m>[22m[39m[90m 221 |[39m             
console[33m.[39merror([32m`Statement not found for 
queue item ${queueItem.id}`[39m)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 222 |[39m             
[36mcontinue[39m[33m;[39m
     [90m 223 |[39m           }
     [90m 224 |[39m[0m

      at SoRSubmissionOrchestrator.error (src/lib/modera
tion/sor-submission-orchestrator.ts:221:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ SoRSubmissionOrchestrator ÔÇ║ submit - happy path 
ÔÇ║ handles queue enqueue failure

    expect(received).toContain(expected) // indexOf

    Expected substring: "Failed to enqueue SoR"
    Received string:    "Database connection failed"

    [0m [90m 243 |[39m
     [90m 244 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 245 |[39m       expect(re
sult[33m.[39merror)[33m.[39mtoContain([32m'Failed 
to enqueue SoR'[39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 246 |[39m       expect(result[33m.[39mwasQ
ueued)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 247 |[39m     })[33m;[39m
     [90m 248 |[39m[0m

      at Object.toContain (src/lib/moderation/sor-submis
sion-orchestrator.test.ts:245:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ SoRSubmissionOrchestrator ÔÇ║ submit - happy path 
ÔÇ║ handles API submission failure within circuit 
breaker

    expect(received).toContain(expected) // indexOf

    Expected substring: "Submission failed"
    Received string:    "API timeout"

    [0m [90m 328 |[39m       expect(result[33m.[39m
wasQueued)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 329 |[39m       expect(result[33m.[39mgrac
efullyDegraded)[33m.[39mtoBe([36mtrue[39m)[33m;[39
m
    [31m[1m>[22m[39m[90m 330 |[39m       expect(re
sult[33m.[39merror)[33m.[39mtoContain([32m'Submissi
on failed'[39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 331 |[39m
     [90m 332 |[39m       [90m// Verify status 
update was called with failure[39m
     [90m 333 |[39m       expect(sorExportQueueManager
[33m.[39mupdateStatus)[33m.[39mtoHaveBeenCalledWith(
{[0m

      at Object.toContain (src/lib/moderation/sor-submis
sion-orchestrator.test.ts:330:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ SoRSubmissionOrchestrator ÔÇ║ processPendingQueue 
ÔÇ║ handles empty queue gracefully

    expect(received).not.toHaveBeenCalled()

    Matcher error: received value must be a mock or spy 
function

    Received has type:  function
    Received has value: [Function fetchStatement]

    [0m [90m 411 |[39m       [36mawait[39m 
orchestrator[33m.[39mprocessPendingQueue()[33m;[39m
     [90m 412 |[39m
    [31m[1m>[22m[39m[90m 413 |[39m       expect(or
chestrator[[32m'fetchStatement'[39m])[33m.[39mnot[3
3m.[39mtoHaveBeenCalled()[33m;[39m
     [90m     |[39m                                   
               [31m[1m^[22m[39m
     [90m 414 |[39m       expect(orchestrator[33m.[3
9msubmit)[33m.[39mnot[33m.[39mtoHaveBeenCalled()[33
m;[39m
     [90m 415 |[39m     })[33m;[39m
     [90m 416 |[39m[0m

      at Object.toHaveBeenCalled (src/lib/moderation/sor
-submission-orchestrator.test.ts:413:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ SoRSubmissionOrchestrator ÔÇ║ processPendingQueue 
ÔÇ║ handles individual item processing errors gracefully

    expect(received).not.toHaveBeenCalled()

    Matcher error: received value must be a mock or spy 
function

    Received has type:  function
    Received has value: [Function submit]

    [0m [90m 447 |[39m       [90m// Should not 
throw, should log error[39m
     [90m 448 |[39m       [36mawait[39m expect(orche
strator[33m.[39mprocessPendingQueue())[33m.[39mresol
ves[33m.[39mnot[33m.[39mtoThrow()[33m;[39m
    [31m[1m>[22m[39m[90m 449 |[39m       expect(or
chestrator[33m.[39msubmit)[33m.[39mnot[33m.[39mtoH
aveBeenCalled()[33m;[39m
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 450 |[39m     })[33m;[39m
     [90m 451 |[39m   })[33m;[39m
     [90m 452 |[39m[0m

      at Object.toHaveBeenCalled (src/lib/moderation/sor
-submission-orchestrator.test.ts:449:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ SoRSubmissionOrchestrator ÔÇ║ health checks ÔÇ║ 
reports unhealthy system when latency SLA breached

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 518 |[39m       [36mconst[39m health 
[33m=[39m [36mawait[39m 
orchestrator[33m.[39mcheckHealth()[33m;[39m
     [90m 519 |[39m
    [31m[1m>[22m[39m[90m 520 |[39m       expect(he
alth[33m.[39mhealthy)[33m.[39mtoBe([36mfalse[39m)
[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 521 |[39m       expect(health[33m.[39mlate
ncySLABreached)[33m.[39mtoBe([36mtrue[39m)[33m;[39
m
     [90m 522 |[39m     })[33m;[39m
     [90m 523 |[39m   })[33m;[39m[0m

      at Object.toBe (src/lib/moderation/sor-submission-
orchestrator.test.ts:520:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/community/idempotency-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ IdempotencyService ÔÇ║ processWithIdempotency ÔÇ║ 
processes new request successfully

    TypeError: _supabase.supabase.from(...).update is 
not a function

    [0m [90m 182 |[39m     [36mawait[39m supabase
     [90m 183 |[39m       
[33m.[39m[36mfrom[39m([32m'idempotency_keys'[39m)
    [31m[1m>[22m[39m[90m 184 |[39m       
[33m.[39mupdate({
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 185 |[39m         status[33m:[39m 
[32m'failed'[39m[33m,[39m
     [90m 186 |[39m         error_details[33m:[39m 
errorDetails[33m,[39m
     [90m 187 |[39m         expires_at[33m:[39m 
[36mnew[39m [33mDate[39m([0m

      at IdempotencyService.update 
(src/lib/community/idempotency-service.ts:184:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at IdempotencyService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at IdempotencyService.apply [as markAsFailed] 
(src/lib/community/idempotency-service.ts:166:29)
      at IdempotencyService.markAsFailed 
(src/lib/community/idempotency-service.ts:69:18)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ IdempotencyService ÔÇ║ processWithIdempotency ÔÇ║ 
returns cached result for completed request

    TypeError: _supabase.supabase.from(...).update is 
not a function

    [0m [90m 182 |[39m     [36mawait[39m supabase
     [90m 183 |[39m       
[33m.[39m[36mfrom[39m([32m'idempotency_keys'[39m)
    [31m[1m>[22m[39m[90m 184 |[39m       
[33m.[39mupdate({
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 185 |[39m         status[33m:[39m 
[32m'failed'[39m[33m,[39m
     [90m 186 |[39m         error_details[33m:[39m 
errorDetails[33m,[39m
     [90m 187 |[39m         expires_at[33m:[39m 
[36mnew[39m [33mDate[39m([0m

      at IdempotencyService.update 
(src/lib/community/idempotency-service.ts:184:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at IdempotencyService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at IdempotencyService.apply [as markAsFailed] 
(src/lib/community/idempotency-service.ts:166:29)
      at IdempotencyService.markAsFailed 
(src/lib/community/idempotency-service.ts:69:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ IdempotencyService ÔÇ║ processWithIdempotency ÔÇ║ 
throws error for processing request

    expect(received).rejects.toThrow(expected)

    Expected substring: "Request already being 
processed"
    Received message:   
"_supabase.supabase.from(...).update is not a function"

        [0m [90m 182 |[39m     [36mawait[39m 
supabase
         [90m 183 |[39m       
[33m.[39m[36mfrom[39m([32m'idempotency_keys'[39m)
        [31m[1m>[22m[39m[90m 184 |[39m       
[33m.[39mupdate({
         [90m     |[39m        [31m[1m^[22m[39m
         [90m 185 |[39m         status[33m:[39m 
[32m'failed'[39m[33m,[39m
         [90m 186 |[39m         
error_details[33m:[39m errorDetails[33m,[39m
         [90m 187 |[39m         expires_at[33m:[39m 
[36mnew[39m [33mDate[39m([0m

      at IdempotencyService.update 
(src/lib/community/idempotency-service.ts:184:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at IdempotencyService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at IdempotencyService.apply [as markAsFailed] 
(src/lib/community/idempotency-service.ts:166:29)
      at IdempotencyService.markAsFailed 
(src/lib/community/idempotency-service.ts:69:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow 
(src/lib/community/idempotency-service.test.ts:138:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ IdempotencyService ÔÇ║ processWithIdempotency ÔÇ║ 
handles operation failure and marks as failed

    expect(received).rejects.toThrow(expected)

    Expected substring: "Operation failed"
    Received message:   
"_supabase.supabase.from(...).update is not a function"

        [0m [90m 182 |[39m     [36mawait[39m 
supabase
         [90m 183 |[39m       
[33m.[39m[36mfrom[39m([32m'idempotency_keys'[39m)
        [31m[1m>[22m[39m[90m 184 |[39m       
[33m.[39mupdate({
         [90m     |[39m        [31m[1m^[22m[39m
         [90m 185 |[39m         status[33m:[39m 
[32m'failed'[39m[33m,[39m
         [90m 186 |[39m         
error_details[33m:[39m errorDetails[33m,[39m
         [90m 187 |[39m         expires_at[33m:[39m 
[36mnew[39m [33mDate[39m([0m

      at IdempotencyService.update 
(src/lib/community/idempotency-service.ts:184:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at IdempotencyService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at IdempotencyService.apply [as markAsFailed] 
(src/lib/community/idempotency-service.ts:166:29)
      at IdempotencyService.markAsFailed 
(src/lib/community/idempotency-service.ts:69:18)
                at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow 
(src/lib/community/idempotency-service.test.ts:179:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ IdempotencyService ÔÇ║ processWithIdempotency ÔÇ║ 
throws error when key claim fails due to existing key

    expect(received).rejects.toThrow(expected)

    Expected substring: "Request already being 
processed"
    Received message:   
"_supabase.supabase.from(...).update is not a function"

        [0m [90m 182 |[39m     [36mawait[39m 
supabase
         [90m 183 |[39m       
[33m.[39m[36mfrom[39m([32m'idempotency_keys'[39m)
        [31m[1m>[22m[39m[90m 184 |[39m       
[33m.[39mupdate({
         [90m     |[39m        [31m[1m^[22m[39m
         [90m 185 |[39m         status[33m:[39m 
[32m'failed'[39m[33m,[39m
         [90m 186 |[39m         
error_details[33m:[39m errorDetails[33m,[39m
         [90m 187 |[39m         expires_at[33m:[39m 
[36mnew[39m [33mDate[39m([0m

      at IdempotencyService.update 
(src/lib/community/idempotency-service.ts:184:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at IdempotencyService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at IdempotencyService.apply [as markAsFailed] 
(src/lib/community/idempotency-service.ts:166:29)
      at IdempotencyService.markAsFailed 
(src/lib/community/idempotency-service.ts:69:18)
                at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow 
(src/lib/community/idempotency-service.test.ts:213:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ IdempotencyService ÔÇ║ cleanupExpiredKeys ÔÇ║ 
cleans up expired keys successfully

    expect(received).resolves.toBeUndefined()

    Received promise rejected instead of resolved
    Rejected to value: [TypeError: 
_supabase.supabase.from(...).delete(...).lt is not a 
function]

    [0m [90m 226 |[39m       })[33m;[39m
     [90m 227 |[39m
    [31m[1m>[22m[39m[90m 228 |[39m       
[36mawait[39m expect(service[33m.[39mcleanupExpiredK
eys())[33m.[39mresolves[33m.[39mtoBeUndefined()[33m
;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 229 |[39m       expect(mockDelete)[33m.[39
mtoHaveBeenCalled()[33m;[39m
     [90m 230 |[39m     })[33m;[39m
     [90m 231 |[39m[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect 
(src/lib/community/idempotency-service.test.ts:228:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ IdempotencyService ÔÇ║ cleanupExpiredKeys ÔÇ║ 
throws error on cleanup failure

    expect(received).rejects.toThrow(expected)

    Expected substring: "Failed to cleanup expired 
keys: Cleanup failed"
    Received message:   
"_supabase.supabase.from(...).delete(...).lt is not a 
function"

        [0m [90m 277 |[39m       
[33m.[39m[36mfrom[39m([32m'idempotency_keys'[39m)
         [90m 278 |[39m       
[33m.[39m[36mdelete[39m()
        [31m[1m>[22m[39m[90m 279 |[39m       
[33m.[39mlt([32m'expires_at'[39m[33m,[39m 
[36mnew[39m [33mDate[39m()[33m.[39mtoISOString())
         [90m     |[39m        [31m[1m^[22m[39m
         [90m 280 |[39m       
[33m.[39m[36min[39m([32m'status'[39m[33m,[39m 
[[32m'completed'[39m[33m,[39m 
[32m'failed'[39m])[33m;[39m
         [90m 281 |[39m
         [90m 282 |[39m     [36mif[39m (error) {[0m

      at IdempotencyService.lt 
(src/lib/community/idempotency-service.ts:279:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at IdempotencyService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at IdempotencyService.apply [as 
cleanupExpiredKeys] 
(src/lib/community/idempotency-service.ts:275:27)
      at Object.cleanupExpiredKeys 
(src/lib/community/idempotency-service.test.ts:242:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow 
(src/lib/community/idempotency-service.test.ts:242:58)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/media/photo-access.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ photo-access (PHPicker path) ÔÇ║ returns 
granted=false on cancel

    expect(received).toEqual(expected) // deep equality

    Expected: []
    Received: undefined

    [0m [90m 18 |[39m     [36mconst[39m res 
[33m=[39m [36mawait[39m 
requestSelectedPhotos()[33m;[39m
     [90m 19 |[39m     expect(res[33m.[39mgranted)[
33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 20 |[39m     expect(res[
33m.[39mselection)[33m.[39mtoEqual([])[33m;[39m
     [90m    |[39m                           
[31m[1m^[22m[39m
     [90m 21 |[39m     expect(res[33m.[39mreselectio
nSupported)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 22 |[39m     expect([33mImagePicker[39m[3
3m.[39mlaunchImageLibraryAsync)[33m.[39mtoHaveBeenCal
ledTimes([35m1[39m)[33m;[39m
     [90m 23 |[39m   })[33m;[39m[0m

      at Object.toEqual 
(src/lib/media/photo-access.test.ts:20:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/inventory/__tests__/movement-integration.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Idempotency with external_key ÔÇ║ should 
return same movement on retry with same external_key

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 75 |[39m       [36mconst[39m result2 
[33m=[39m [36mawait[39m 
createMovement(request)[33m;[39m
     [90m 76 |[39m       expect(result2[33m.[39msucc
ess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 77 |[39m       expect(res
ult2[33m.[39misIdempotentDuplicate)[33m.[39mtoBe([3
6mtrue[39m)[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 78 |[39m       expect(result2[33m.[39mmove
ment[33m?[39m[33m.[39mid)[33m.[39mtoBe(movementId1
)[33m;[39m
     [90m 79 |[39m
     [90m 80 |[39m       [90m// Third retry[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-integration.test.ts:77:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Idempotency with external_key ÔÇ║ should 
handle batch updates idempotently

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 106 |[39m       [90m// First attempt - 
should update batch[39m
     [90m 107 |[39m       [36mconst[39m result1 
[33m=[39m [36mawait[39m 
createMovementWithBatchUpdate(request)[33m;[39m
    [31m[1m>[22m[39m[90m 108 |[39m       expect(re
sult1[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 109 |[39m       expect(result1[33m.[39misI
dempotentDuplicate)[33m.[39mtoBe([36mfalse[39m)[33m
;[39m
     [90m 110 |[39m
     [90m 111 |[39m       [36mconst[39m 
batchAfterFirst [33m=[39m [36mawait[39m database[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-integration.test.ts:108:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Idempotency with external_key ÔÇ║ should 
handle different requests with unique external_keys

    expect(received).not.toBe(expected) // Object.is 
equality

    Expected: not "mock-id"

    [0m [90m 164 |[39m       expect(result1[33m.[39
msuccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 165 |[39m       expect(result2[33m.[39msuc
cess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 166 |[39m       expect(re
sult1[33m.[39mmovement[33m?[39m[33m.[39mid)[33m.
[39mnot[33m.[39mtoBe(result2[33m.[39mmovement[33m?
[39m[33m.[39mid)[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 167 |[39m
     [90m 168 |[39m       [36mconst[39m movements 
[33m=[39m [36mawait[39m 
getMovementsForItem(testItem[33m.[39mid)[33m;[39m
     [90m 169 |[39m       expect(movements)[33m.[39m
toHaveLength([35m2[39m)[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-integration.test.ts:166:40)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Concurrent operations with same 
external_key ÔÇ║ should handle concurrent creation 
attempts

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

    [0m [90m 201 |[39m         (r) [33m=>[39m 
r[33m.[39misIdempotentDuplicate
     [90m 202 |[39m       
)[33m.[39mlength[33m;[39m
    [31m[1m>[22m[39m[90m 203 |[39m       expect(du
plicateCount)[33m.[39mtoBeGreaterThan([35m0[39m)[33
m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 204 |[39m
     [90m 205 |[39m       [90m// All should return 
same movement ID[39m
     [90m 206 |[39m       [36mconst[39m movementIds 
[33m=[39m results[33m.[39mmap((r) [33m=>[39m r[33
m.[39mmovement[33m?[39m[33m.[39mid)[33m;[39m[0m

      at Object.toBeGreaterThan (src/lib/inventory/__tes
ts__/movement-integration.test.ts:203:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Concurrent operations with same 
external_key ÔÇ║ should handle concurrent batch updates

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 238 |[39m       [90m// All should 
succeed[39m
     [90m 239 |[39m       
results[33m.[39mforEach((result) [33m=>[39m {
    [31m[1m>[22m[39m[90m 240 |[39m         expect(
result[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 241 |[39m       })[33m;[39m
     [90m 242 |[39m
     [90m 243 |[39m       [90m// Verify batch was 
only updated once[39m[0m

      at toBe (src/lib/inventory/__tests__/movement-inte
gration.test.ts:240:32)
          at Array.forEach (<anonymous>)
      at Object.forEach (src/lib/inventory/__tests__/mov
ement-integration.test.ts:239:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Transaction rollback scenarios ÔÇ║ should 
rollback movement if batch update fails

    expect(received).toContain(expected) // indexOf

    Expected substring: "Insufficient batch quantity"
    Received string:    "batch.update is not a function"

    [0m [90m 263 |[39m
     [90m 264 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 265 |[39m       expect(re
sult[33m.[39merror)[33m.[39mtoContain([32m'Insuffic
ient batch quantity'[39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 266 |[39m
     [90m 267 |[39m       [90m// Verify no movement 
was created[39m
     [90m 268 |[39m       [36mconst[39m movements 
[33m=[39m [36mawait[39m getMovementsForItem(testItem
[33m.[39mid)[33m;[39m[0m

      at Object.toContain (src/lib/inventory/__tests__/m
ovement-integration.test.ts:265:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Transaction rollback scenarios ÔÇ║ should 
maintain atomicity across multiple movements

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 291 |[39m       })[33m;[39m
     [90m 292 |[39m
    [31m[1m>[22m[39m[90m 293 |[39m       expect(re
sult1[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 294 |[39m
     [90m 295 |[39m       [36mconst[39m 
batchAfterFirst [33m=[39m [36mawait[39m database
     [90m 296 |[39m         [33m.[39m[36mget[39m[
33m<[39m[33mInventoryBatchModel[39m[33m>[39m([32m'
inventory_batches'[39m)[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-integration.test.ts:293:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ External key lookup and retrieval ÔÇ║ 
should retrieve movement by external_key

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "lookup-1768559097312"
    Received: undefined

    [0m [90m 340 |[39m
     [90m 341 |[39m       
expect(retrieved)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 342 |[39m       expect(re
trieved[33m?[39m[33m.[39mexternalKey)[33m.[39mtoBe
(externalKey)[33m;[39m
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 343 |[39m       expect(retrieved[33m?[39m
[33m.[39mitemId)[33m.[39mtoBe(testItem[33m.[39mid)
[33m;[39m
     [90m 344 |[39m       expect(retrieved[33m?[39m
[33m.[39mquantityDelta)[33m.[39mtoBe([33m-[39m[35m
50[39m)[33m;[39m
     [90m 345 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-integration.test.ts:342:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Movement immutability verification ÔÇ║ 
should enforce append-only behavior for movements

    expect(received).toBe(expected) // Object.is 
equality

    Expected: -100
    Received: undefined

    [0m [90m 366 |[39m
     [90m 367 |[39m       [90m// Verify original 
movement values[39m
    [31m[1m>[22m[39m[90m 368 |[39m       expect(or
iginalMovement[33m.[39mquantityDelta)[33m.[39mtoBe(
[33m-[39m[35m100[39m)[33m;[39m
     [90m     |[39m                                   
           [31m[1m^[22m[39m
     [90m 369 |[39m       expect(originalMovement[33m
.[39mreason)[33m.[39mtoBe([32m'Original'[39m)[33m;
[39m
     [90m 370 |[39m
     [90m 371 |[39m       [90m// Create corrective 
movement instead of updating[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-integration.test.ts:368:46)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Movement immutability verification ÔÇ║ 
should require new movement for corrections

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 0
    Received array:  []

    [0m [90m 430 |[39m
     [90m 431 |[39m       [36mconst[39m movements 
[33m=[39m [36mawait[39m 
getMovementsForItem(testItem[33m.[39mid)[33m;[39m
    [31m[1m>[22m[39m[90m 432 |[39m       expect(mo
vements)[33m.[39mtoHaveLength([35m3[39m)[33m;[39m
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 433 |[39m
     [90m 434 |[39m       [90m// Net effect: -100 + 
100 - 75 = -75[39m
     [90m 435 |[39m       [36mconst[39m netQuantity 
[33m=[39m movements[33m.[39mreduce([0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/movement-integration.test.ts:432:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/harvest/harvest-error-handler.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ handleBusinessLogicError ÔÇ║ should include 
update weight action for dry weight errors

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 280 |[39m     [36mconst[39m result 
[33m=[39m handleBusinessLogicError(error[33m,[39m 
mockT)[33m;[39m
     [90m 281 |[39m
    [31m[1m>[22m[39m[90m 282 |[39m     expect(resu
lt[33m.[39mactions[33m?[39m[33m.[39msome((a) 
[33m=>[39m a[33m.[39maction [33m===[39m 
[32m'update_weight'[39m))[33m.[39mtoBe(
     [90m     |[39m                                   
                                    [31m[1m^[22m[39m
     [90m 283 |[39m       [36mtrue[39m
     [90m 284 |[39m     )[33m;[39m
     [90m 285 |[39m   })[33m;[39m[0m

      at Object.toBe 
(src/lib/harvest/harvest-error-handler.test.ts:282:71)

  ÔùÅ handleHarvestError ÔÇ║ should route business 
logic errors correctly

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 355 |[39m     [36mconst[39m result 
[33m=[39m handleHarvestError(error[33m,[39m 
mockT)[33m;[39m
     [90m 356 |[39m
    [31m[1m>[22m[39m[90m 357 |[39m     expect(resu
lt[33m.[39mshouldShowBanner)[33m.[39mtoBe([36mtrue
[39m)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 358 |[39m   })[33m;[39m
     [90m 359 |[39m
     [90m 360 |[39m   it([32m'should route 
consistency errors correctly'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe 
(src/lib/harvest/harvest-error-handler.test.ts:357:37)

FAIL src/lib/sentry-utils.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ sentry-utils ÔÇ║ sanitizeTextPII ÔÇ║ redacts 
phone numbers

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Call [PHONE_REDACTED] or 
[PHONE_REDACTED]"
    Received: "Call ([PHONE_REDACTED] or 
[PHONE_REDACTED]"

    [0m [90m 19 |[39m       [36mconst[39m input 
[33m=[39m [32m'Call (555) 123-4567 or 
555-123-4567'[39m[33m;[39m
     [90m 20 |[39m       [36mconst[39m result 
[33m=[39m sanitizeTextPII(input)[33m;[39m
    [31m[1m>[22m[39m[90m 21 |[39m       
expect(result)[33m.[39mtoBe([32m'Call 
[PHONE_REDACTED] or [PHONE_REDACTED]'[39m)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 22 |[39m     })[33m;[39m
     [90m 23 |[39m
     [90m 24 |[39m     test([32m'redacts API 
keys'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBe 
(src/lib/sentry-utils.test.ts:21:22)

  ÔùÅ sentry-utils ÔÇ║ sanitizeTextPII ÔÇ║ handles 
multiple sensitive patterns

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Email: [EMAIL_REDACTED], Phone: 
[PHONE_REDACTED], API: [API_KEY_REDACTED]"
    Received: "Email: [EMAIL_REDACTED], Phone: 
[PHONE_REDACTED], API: sk_test_abcdef123456"

    [0m [90m 31 |[39m       [36mconst[39m input 
[33m=[39m [32m'Email: test@example.com, Phone: 
555-123-4567, API: sk_test_abcdef123456'[39m[33m;[39m
     [90m 32 |[39m       [36mconst[39m result 
[33m=[39m sanitizeTextPII(input)[33m;[39m
    [31m[1m>[22m[39m[90m 33 |[39m       
expect(result)[33m.[39mtoBe([32m'Email: 
[EMAIL_REDACTED], Phone: [PHONE_REDACTED], API: 
[API_KEY_REDACTED]'[39m)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 34 |[39m     })[33m;[39m
     [90m 35 |[39m   })[33m;[39m
     [90m 36 |[39m[0m

      at Object.toBe 
(src/lib/sentry-utils.test.ts:33:22)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ handles 
mixed-type arrays

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 1

      Array [
        "[EMAIL_REDACTED]",
        42,
        Object {
    -     "apiKey": "[API_KEY_REDACTED]",
    +     "apiKey": "sk_live_arrayitem",
        },
        null,
        undefined,
        true,
      ]

    [0m [90m 91 |[39m       ][33m;[39m
     [90m 92 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII(input)[33m;[39m
    [31m[1m>[22m[39m[90m 93 |[39m       
expect(result)[33m.[39mtoEqual([
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 94 |[39m         
[32m'[EMAIL_REDACTED]'[39m[33m,[39m
     [90m 95 |[39m         [35m42[39m[33m,[39m
     [90m 96 |[39m         { apiKey[33m:[39m 
[32m'[API_KEY_REDACTED]'[39m }[33m,[39m[0m

      at Object.toEqual 
(src/lib/sentry-utils.test.ts:93:22)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ handles 
Maps

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 1

      Object {
        "42": "number key",
    -   "apiKey": "[API_KEY_REDACTED]",
    +   "apiKey": "sk_live_mapvalue",
        "email": "[EMAIL_REDACTED]",
      }

    [0m [90m 107 |[39m       
map[33m.[39m[36mset[39m([35m42[39m[33m,[39m 
[32m'number key'[39m)[33m;[39m
     [90m 108 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII(map)[33m;[39m
    [31m[1m>[22m[39m[90m 109 |[39m       
expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 110 |[39m         email[33m:[39m 
[32m'[EMAIL_REDACTED]'[39m[33m,[39m
     [90m 111 |[39m         apiKey[33m:[39m 
[32m'[API_KEY_REDACTED]'[39m[33m,[39m
     [90m 112 |[39m         [32m'42'[39m[33m:[39m 
[32m'number key'[39m[33m,[39m[0m

      at Object.toEqual 
(src/lib/sentry-utils.test.ts:109:22)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ handles 
Sets

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 1

      Array [
        "[EMAIL_REDACTED]",
    -   "[API_KEY_REDACTED]",
    +   "sk_live_setvalue",
        42,
      ]

    [0m [90m 121 |[39m       ])[33m;[39m
     [90m 122 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII([36mset[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 123 |[39m       
expect(result)[33m.[39mtoEqual([
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 124 |[39m         
[32m'[EMAIL_REDACTED]'[39m[33m,[39m
     [90m 125 |[39m         
[32m'[API_KEY_REDACTED]'[39m[33m,[39m
     [90m 126 |[39m         
[35m42[39m[33m,[39m[0m

      at Object.toEqual 
(src/lib/sentry-utils.test.ts:123:22)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ handles 
Axios-like objects

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "[AUTH_HEADER_REDACTED]"
    Received: "Bearer sk_live_configheader"

    [0m [90m 149 |[39m       }[33m;[39m
     [90m 150 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII(axiosError)[33m;[39m
    [31m[1m>[22m[39m[90m 151 |[39m       expect(re
sult[33m.[39mconfig[33m.[39mheaders[33m.[39mauthor
ization)[33m.[39mtoBe([32m'[AUTH_HEADER_REDACTED]'[3
9m)[33m;[39m
     [90m     |[39m                                   
                [31m[1m^[22m[39m
     [90m 152 |[39m       expect(result[33m.[39mrequ
est[33m.[39m_header)[33m.[39mtoBe([32m'[AUTH_HEADER
_REDACTED]'[39m)[33m;[39m
     [90m 153 |[39m       expect(result[33m.[39mresp
onse[33m.[39mdata[33m.[39muser[33m.[39memail)[33m
.[39mtoBe([32m'[EMAIL_REDACTED]'[39m)[33m;[39m
     [90m 154 |[39m       expect(result[33m.[39mmess
age)[33m.[39mtoBe([32m'Request 
failed'[39m)[33m;[39m[0m

      at Object.toBe 
(src/lib/sentry-utils.test.ts:151:51)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ preserves 
Date objects

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Date

    Received value has no prototype
    Received value: "2020-01-01T00:00:00.000Z"

    [0m [90m 159 |[39m       [36mconst[39m input 
[33m=[39m { created[33m:[39m date }[33m;[39m
     [90m 160 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII(input)[33m;[39m
    [31m[1m>[22m[39m[90m 161 |[39m       expect(re
sult[33m.[39mcreated)[33m.[39mtoBeInstanceOf([33mDa
te[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 162 |[39m       expect(result[33m.[39mcrea
ted[33m.[39mtoISOString())[33m.[39mtoBe(date[33m.[
39mtoISOString())[33m;[39m
     [90m 163 |[39m     })[33m;[39m
     [90m 164 |[39m[0m

      at Object.toBeInstanceOf 
(src/lib/sentry-utils.test.ts:161:30)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ preserves 
RegExp objects

    expect(received).toBeInstanceOf(expected)

    Expected constructor: RegExp

    Received value has no prototype
    Received value: "/test/gi"

    [0m [90m 167 |[39m       [36mconst[39m input 
[33m=[39m { pattern[33m:[39m regex }[33m;[39m
     [90m 168 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII(input)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       expect(re
sult[33m.[39mpattern)[33m.[39mtoBeInstanceOf([33mRe
gExp[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 170 |[39m       expect(result[33m.[39mpatt
ern[33m.[39mtoString())[33m.[39mtoBe(regex[33m.[39
mtoString())[33m;[39m
     [90m 171 |[39m     })[33m;[39m
     [90m 172 |[39m[0m

      at Object.toBeInstanceOf 
(src/lib/sentry-utils.test.ts:169:30)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ handles 
complex nested structures

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "[EMAIL_REDACTED]"
    Received: "user1@example.com"

    [0m [90m 218 |[39m       }[33m;[39m
     [90m 219 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII(input)[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m       expect(re
sult[33m.[39musers[[35m0[39m][33m.[39memail)[33m.
[39mtoBe([32m'[EMAIL_REDACTED]'[39m)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 221 |[39m       expect(result[33m.[39muser
s[[35m0[39m][33m.[39mprofile[33m?[39m[33m.[39mph
one)[33m.[39mtoBe([32m'[PHONE_REDACTED]'[39m)[33m;
[39m
     [90m 222 |[39m       expect(result[33m.[39muser
s[[35m0[39m][33m.[39mprofile[33m?[39m[33m.[39mad
dress)[33m.[39mtoBe([32m'[ADDRESS_REDACTED]'[39m)[3
3m;[39m
     [90m 223 |[39m       expect(result[33m.[39muser
s[[35m1[39m][33m.[39memail)[33m.[39mtoBe([32m'[EM
AIL_REDACTED]'[39m)[33m;[39m[0m

      at Object.toBe 
(src/lib/sentry-utils.test.ts:220:37)

FAIL src/lib/inventory/notifications/__tests__/exact-ala
rm-coordinator.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      captureCategorizedErrorSync suppressed (module 
load failed).

    [0m [90m 716 |[39m     
[33m.[39m[36mcatch[39m(() [33m=>[39m {
     [90m 717 |[39m       [36mif[39m 
(process[33m.[39menv[33m.[39m[33mNODE_ENV[39m 
[33m!==[39m [32m'production'[39m) {
    [31m[1m>[22m[39m[90m 718 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 719 |[39m           
[32m'captureCategorizedErrorSync suppressed (module 
load failed).'[39m
     [90m 720 |[39m         )[33m;[39m
     [90m 721 |[39m       }[0m

      at warn (src/lib/sentry-utils.ts:718:17)

    console.warn
      captureCategorizedErrorSync suppressed (module 
load failed).

    [0m [90m 716 |[39m     
[33m.[39m[36mcatch[39m(() [33m=>[39m {
     [90m 717 |[39m       [36mif[39m 
(process[33m.[39menv[33m.[39m[33mNODE_ENV[39m 
[33m!==[39m [32m'production'[39m) {
    [31m[1m>[22m[39m[90m 718 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 719 |[39m           
[32m'captureCategorizedErrorSync suppressed (module 
load failed).'[39m
     [90m 720 |[39m         )[33m;[39m
     [90m 721 |[39m       }[0m

      at warn (src/lib/sentry-utils.ts:718:17)

    console.warn
      captureCategorizedErrorSync suppressed (module 
load failed).

    [0m [90m 716 |[39m     
[33m.[39m[36mcatch[39m(() [33m=>[39m {
     [90m 717 |[39m       [36mif[39m 
(process[33m.[39menv[33m.[39m[33mNODE_ENV[39m 
[33m!==[39m [32m'production'[39m) {
    [31m[1m>[22m[39m[90m 718 |[39m         
console[33m.[39mwarn(
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 719 |[39m           
[32m'captureCategorizedErrorSync suppressed (module 
load failed).'[39m
     [90m 720 |[39m         )[33m;[39m
     [90m 721 |[39m       }[0m

      at warn (src/lib/sentry-utils.ts:718:17)

  ÔùÅ ExactAlarmCoordinator ÔÇ║ requestPermission ÔÇ║ 
should launch settings when user enables

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

    [0m [90m 215 |[39m       [36mawait[39m [33mExa
ctAlarmCoordinator[39m[33m.[39mrequestPermission()[3
3m;[39m
     [90m 216 |[39m
    [31m[1m>[22m[39m[90m 217 |[39m       expect([
33mLinking[39m[33m.[39mopenSettings)[33m.[39mtoHave
BeenCalled()[33m;[39m
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 218 |[39m     })[33m;[39m
     [90m 219 |[39m   })[33m;[39m
     [90m 220 |[39m[0m

      at Object.toHaveBeenCalled (src/lib/inventory/noti
fications/__tests__/exact-alarm-coordinator.test.ts:217:
36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/__tests__/analytics.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ ConsentGatedAnalytics ÔÇ║ PII Sanitization ÔÇ║ 
removes nutrient_feature_usage context field when it 
contains only PII

    expect(received).toBeUndefined()

    Received: "[redacted_email] [redacted_phone]"

    [0m [90m 349 |[39m       [36mconst[39m 
sanitizedPayload [33m=[39m 
events[[35m0[39m][33m.[39mpayload [36mas[39m 
any[33m;[39m
     [90m 350 |[39m       expect(sanitizedPayload[33m
.[39mfeature)[33m.[39mtoBe([32m'acknowledge_alert'[
39m)[33m;[39m
    [31m[1m>[22m[39m[90m 351 |[39m       expect(sa
nitizedPayload[33m.[39mcontext)[33m.[39mtoBeUndefine
d()[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 352 |[39m     })[33m;[39m
     [90m 353 |[39m
     [90m 354 |[39m     it([32m'truncates 
nutrient_feature_usage context field to 200 
characters'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBeUndefined 
(src/lib/__tests__/analytics.test.ts:351:40)

  ÔùÅ ConsentGatedAnalytics ÔÇ║ PII Sanitization ÔÇ║ 
truncates nutrient_feature_usage context field to 200 
characters

    expect(received).toContain(expected) // indexOf

    Expected substring: "[redacted_email]"
    Received string:    "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
A"

    [0m [90m 366 |[39m       [36mconst[39m 
sanitizedPayload [33m=[39m 
events[[35m0[39m][33m.[39mpayload [36mas[39m 
any[33m;[39m
     [90m 367 |[39m       expect(sanitizedPayload[33m
.[39mcontext[33m?[39m[33m.[39mlength)[33m.[39mtoB
eLessThanOrEqual([35m200[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 368 |[39m       expect(sa
nitizedPayload[33m.[39mcontext)[33m.[39mtoContain([
32m'[redacted_email]'[39m)[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 369 |[39m     })[33m;[39m
     [90m 370 |[39m
     [90m 371 |[39m     it([32m'sanitizes various 
PII patterns in nutrient_feature_usage 
context'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toContain 
(src/lib/__tests__/analytics.test.ts:368:40)

  ÔùÅ ConsentGatedAnalytics ÔÇ║ PII Sanitization ÔÇ║ 
sanitizes various PII patterns in 
nutrient_feature_usage context

    expect(received).toContain(expected) // indexOf

    Expected substring: "[redacted_token]"
    Received string:    "User action: [redacted_url] 
Contact: [redacted_email] or call 
[redacted_phone]Payment: card[redacted_phone]Extra 
spaces and tabs here"

    [0m [90m 386 |[39m       [36mconst[39m context 
[33m=[39m 
sanitizedPayload[33m.[39mcontext[33m;[39m
     [90m 387 |[39m       expect(context)[33m.[39mto
Contain([32m'[redacted_url]'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 388 |[39m       expect(co
ntext)[33m.[39mtoContain([32m'[redacted_token]'[39m)
[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 389 |[39m       expect(context)[33m.[39mto
Contain([32m'[redacted_email]'[39m)[33m;[39m
     [90m 390 |[39m       expect(context)[33m.[39mto
Contain([32m'[redacted_phone]'[39m)[33m;[39m
     [90m 391 |[39m       expect(context)[33m.[39mto
Contain([32m'[redacted_card]'[39m)[33m;[39m[0m

      at Object.toContain 
(src/lib/__tests__/analytics.test.ts:388:23)

FAIL src/lib/playbooks/analytics/__tests__/metrics-aggre
gator.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [MetricsAggregator] Summary: {
        health: {
          overall: 'healthy',
          notifications: 'healthy',
          sync: 'healthy',
          issues: []
        },
        metrics: {
          notifications: {
            totalScheduled: 0,
            totalDelivered: 0,
            totalMissed: 0,
            deliveryRate: 0,
            averageDelayMs: 0,
            lastCalculated: 1768559101922
          },
          sync: {
            totalSyncs: 0,
            successfulSyncs: 0,
            failedSyncs: 0,
            averageLatencyMs: 0,
            failRate: 0,
            lastCalculated: 1768559101922
          },
          conflicts: {
            totalConflicts: 0,
            resolvedByServer: 0,
            resolvedByClient: 0,
            manualResolutions: 0,
            restoredCount: 0,
            lastCalculated: 1768559101922
          },
          timestamp: 1768559101922
        }
      }

      at MetricsAggregator.log [as emitSummary] (src/lib
/playbooks/analytics/metrics-aggregator.ts:114:13)

    console.log
      [NotificationMetrics] Summary: {
        totalScheduled: 0,
        totalDelivered: 0,
        totalMissed: 0,
        deliveryRate: 0,
        averageDelayMs: 0,
        lastCalculated: 1768559101935
      }

      at NotificationMetricsTracker.log [as 
emitSummary] (src/lib/playbooks/analytics/notification-m
etrics.ts:157:13)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

  ÔùÅ MetricsAggregator ÔÇ║ Health Status ÔÇ║ should 
report degraded status with low delivery rate

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "degraded"
    Received: "healthy"

    [0m [90m 104 |[39m
     [90m 105 |[39m       [36mconst[39m health 
[33m=[39m 
metricsAggregator[33m.[39mgetHealthStatus()[33m;[39m
    [31m[1m>[22m[39m[90m 106 |[39m       expect(he
alth[33m.[39mnotifications)[33m.[39mtoBe([32m'degra
ded'[39m)[33m;[39m
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 107 |[39m       expect(health[33m.[39missu
es[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[3
9m)[33m;[39m
     [90m 108 |[39m     })[33m;[39m
     [90m 109 |[39m[0m

      at Object.toBe (src/lib/playbooks/analytics/__test
s__/metrics-aggregator.test.ts:106:36)

  ÔùÅ MetricsAggregator ÔÇ║ Health Status ÔÇ║ should 
report unhealthy status with very low delivery rate

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "unhealthy"
    Received: "healthy"

    [0m [90m 128 |[39m
     [90m 129 |[39m       [36mconst[39m health 
[33m=[39m 
metricsAggregator[33m.[39mgetHealthStatus()[33m;[39m
    [31m[1m>[22m[39m[90m 130 |[39m       expect(he
alth[33m.[39mnotifications)[33m.[39mtoBe([32m'unhea
lthy'[39m)[33m;[39m
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 131 |[39m     })[33m;[39m
     [90m 132 |[39m
     [90m 133 |[39m     it([32m'should report 
degraded status with high sync failure 
rate'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/playbooks/analytics/__test
s__/metrics-aggregator.test.ts:130:36)

  ÔùÅ MetricsAggregator ÔÇ║ Metrics Report ÔÇ║ should 
include health issues in report

    expect(received).toContain(expected) // indexOf

    Expected substring: "Issues"
    Received string:    "=== Playbook Metrics Report 
===┬À
    Overall Health: HEALTHY┬À
    --- Notifications ---
    Delivery Rate: 80.0%
    Average Delay: 1.0s
    Total Scheduled: 0
    Total Delivered: 16
    Total Missed: 4┬À
    --- Sync ---
    Success Rate: 100.0%
    Average Latency: 0.0s
    Total Syncs: 0
    Successful: 0
    Failed: 0┬À
    --- Conflicts ---
    Total Conflicts: 0
    Resolved by Server: 0
    Resolved by Client: 0
    Manual Resolutions: 0
    Restored: 0"

    [0m [90m 194 |[39m
     [90m 195 |[39m       [36mconst[39m report 
[33m=[39m metricsAggregator[33m.[39mgetMetricsReport
()[33m;[39m
    [31m[1m>[22m[39m[90m 196 |[39m       expect(re
port)[33m.[39mtoContain([32m'Issues'[39m)[33m;[39m
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 197 |[39m     })[33m;[39m
     [90m 198 |[39m   })[33m;[39m
     [90m 199 |[39m[0m

      at Object.toContain (src/lib/playbooks/analytics/_
_tests__/metrics-aggregator.test.ts:196:22)

FAIL src/lib/watermelon-models/__tests__/cached-strain.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      [CachedStrainModel] Failed to parse strains data 
SyntaxError: "undefined" is not valid JSON
          at JSON.parse (<anonymous>)
          at CachedStrainModel.parse (C:\Users\Peter\Gro
wBro\src\lib\watermelon-models\cached-strain.ts:26:19)
          at Object.parsedStrains (C:\Users\Peter\GrowBr
o\src\lib\watermelon-models\__tests__\cached-strain.test
.ts:48:26)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 26 |[39m       [36mreturn[39m [33mJSO
N[39m[33m.[39mparse([36mthis[39m[33m.[39mstrainsD
ata) [36mas[39m [33mStrain[39m[][33m;[39m
     [90m 27 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 28 |[39m       
console[33m.[39merror([32m'[CachedStrainModel] 
Failed to parse strains data'[39m[33m,[39m 
error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 29 |[39m       [36mreturn[39m 
[][33m;[39m
     [90m 30 |[39m     }
     [90m 31 |[39m   }[0m

      at CachedStrainModel.error 
(src/lib/watermelon-models/cached-strain.ts:28:15)
      at Object.parsedStrains (src/lib/watermelon-models
/__tests__/cached-strain.test.ts:48:26)

  ÔùÅ CachedStrainModel - parsedStrains ÔÇ║ parses 
valid JSON strains data correctly

    expect(received).toHaveLength(expected)

    Expected length: 2
    Received length: 0
    Received array:  []

    [0m [90m 48 |[39m     [36mconst[39m parsed 
[33m=[39m model[33m.[39mparsedStrains[33m;[39m
     [90m 49 |[39m
    [31m[1m>[22m[39m[90m 50 |[39m     expect(parse
d)[33m.[39mtoHaveLength([35m2[39m)[33m;[39m
     [90m    |[39m                    
[31m[1m^[22m[39m
     [90m 51 |[39m     expect(parsed[[35m0[39m][33m
.[39mname)[33m.[39mtoBe([32m'OG 
Kush'[39m)[33m;[39m
     [90m 52 |[39m     expect(parsed[[35m1[39m][33m
.[39mname)[33m.[39mtoBe([32m'Blue 
Dream'[39m)[33m;[39m
     [90m 53 |[39m   })[33m;[39m[0m

      at Object.toHaveLength (src/lib/watermelon-models/
__tests__/cached-strain.test.ts:50:20)

  ÔùÅ CachedStrainModel - isExpired ÔÇ║ returns true 
when current time is after expiresAt

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 94 |[39m     })[33m;[39m
     [90m 95 |[39m
    [31m[1m>[22m[39m[90m 96 |[39m     expect(model
[33m.[39misExpired)[33m.[39mtoBe([36mtrue[39m)[33
m;[39m
     [90m    |[39m                             
[31m[1m^[22m[39m
     [90m 97 |[39m   })[33m;[39m
     [90m 98 |[39m
     [90m 99 |[39m   test([32m'returns false when 
current time is before expiresAt'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/watermelon-models/__tests_
_/cached-strain.test.ts:96:29)

  ÔùÅ CachedStrainModel - ageInSeconds ÔÇ║ calculates 
age correctly

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 119
    Received:    NaN

    [0m [90m 131 |[39m
     [90m 132 |[39m     [90m// Allow 1 second 
tolerance for test execution time[39m
    [31m[1m>[22m[39m[90m 133 |[39m     expect(age)
[33m.[39mtoBeGreaterThanOrEqual([35m119[39m)[33m;[
39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 134 |[39m     expect(age)[33m.[39mtoBeLess
ThanOrEqual([35m121[39m)[33m;[39m
     [90m 135 |[39m   })[33m;[39m
     [90m 136 |[39m })[33m;[39m[0m

      at Object.toBeGreaterThanOrEqual (src/lib/watermel
on-models/__tests__/cached-strain.test.ts:133:17)

FAIL src/lib/notifications/background-handler.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
handleBackgroundMessage ÔÇ║ should handle iOS 
background messages

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 25 |[39m
     [90m 26 |[39m [36masync[39m [36mfunction[39m 
setupMockStorage() {
    [31m[1m>[22m[39m[90m 27 |[39m   
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 28 |[39m     
[32m'@/lib/notifications/notification-storage'[39m
     [90m 29 |[39m   )[33m;[39m
     [90m 30 |[39m   [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at 
src/lib/notifications/background-handler.test.ts:27:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/background-handler.test.ts:33:2)
      at apply 
(src/lib/notifications/background-handler.test.ts:26:32)
      at Object.setupMockStorage 
(src/lib/notifications/background-handler.test.ts:45:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
handleBackgroundMessage ÔÇ║ should handle Android 
messages when not in Doze mode

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 25 |[39m
     [90m 26 |[39m [36masync[39m [36mfunction[39m 
setupMockStorage() {
    [31m[1m>[22m[39m[90m 27 |[39m   
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 28 |[39m     
[32m'@/lib/notifications/notification-storage'[39m
     [90m 29 |[39m   )[33m;[39m
     [90m 30 |[39m   [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at 
src/lib/notifications/background-handler.test.ts:27:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/background-handler.test.ts:26:32)
      at Object.setupMockStorage 
(src/lib/notifications/background-handler.test.ts:61:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
handleBackgroundMessage ÔÇ║ should queue messages when 
in Doze mode on Android

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 75 |[39m     
[33mPlatform[39m[33m.[39m[33mOS[39m [33m=[39m 
[32m'android'[39m[33m;[39m
     [90m 76 |[39m     [33mBackgroundNotificationHand
ler[39m[33m.[39msetDozeMode([36mtrue[39m)[33m;[39
m
    [31m[1m>[22m[39m[90m 77 |[39m     
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 78 |[39m       
[32m'@/lib/notifications/notification-storage'[39m
     [90m 79 |[39m     )[33m;[39m
     [90m 80 |[39m     [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/notifications/background-handler.test.ts:77:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
handleBackgroundMessage ÔÇ║ should handle errors 
gracefully

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 88 |[39m   it([32m'should handle 
errors gracefully'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m 89 |[39m     
[33mPlatform[39m[33m.[39m[33mOS[39m [33m=[39m 
[32m'android'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 90 |[39m     
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 91 |[39m       
[32m'@/lib/notifications/notification-storage'[39m
     [90m 92 |[39m     )[33m;[39m
     [90m 93 |[39m     [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/notifications/background-handler.test.ts:90:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
processPendingTasks ÔÇ║ success scenarios ÔÇ║ should 
process all queued tasks

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 25 |[39m
     [90m 26 |[39m [36masync[39m [36mfunction[39m 
setupMockStorage() {
    [31m[1m>[22m[39m[90m 27 |[39m   
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 28 |[39m     
[32m'@/lib/notifications/notification-storage'[39m
     [90m 29 |[39m   )[33m;[39m
     [90m 30 |[39m   [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at 
src/lib/notifications/background-handler.test.ts:27:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/background-handler.test.ts:26:32)
      at Object.setupMockStorage (src/lib/notifications/
background-handler.test.ts:122:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
processPendingTasks ÔÇ║ success scenarios ÔÇ║ should 
clear queue after processing

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 25 |[39m
     [90m 26 |[39m [36masync[39m [36mfunction[39m 
setupMockStorage() {
    [31m[1m>[22m[39m[90m 27 |[39m   
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 28 |[39m     
[32m'@/lib/notifications/notification-storage'[39m
     [90m 29 |[39m   )[33m;[39m
     [90m 30 |[39m   [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at 
src/lib/notifications/background-handler.test.ts:27:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/background-handler.test.ts:26:32)
      at Object.setupMockStorage (src/lib/notifications/
background-handler.test.ts:144:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
processPendingTasks ÔÇ║ error handling ÔÇ║ should 
handle errors in pending tasks and re-queue failed tasks

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 160 |[39m     [33mBackgroundNotificatio
nHandler[39m[33m.[39msetDozeMode([36mfalse[39m)[33
m;[39m
     [90m 161 |[39m
    [31m[1m>[22m[39m[90m 162 |[39m     
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 163 |[39m       
[32m'@/lib/notifications/notification-storage'[39m
     [90m 164 |[39m     )[33m;[39m
     [90m 165 |[39m     [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/notifications/background-handler.test.ts:162:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
processPendingTasks ÔÇ║ error handling ÔÇ║ should throw 
aggregated error when all tasks fail

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 188 |[39m     [33mBackgroundNotificatio
nHandler[39m[33m.[39msetDozeMode([36mfalse[39m)[33
m;[39m
     [90m 189 |[39m
    [31m[1m>[22m[39m[90m 190 |[39m     
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 191 |[39m       
[32m'@/lib/notifications/notification-storage'[39m
     [90m 192 |[39m     )[33m;[39m
     [90m 193 |[39m     [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/notifications/background-handler.test.ts:190:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ state 
management ÔÇ║ should return correct pending task count

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 0
    Received: 3

    [0m [90m 214 |[39m     [33mBackgroundNotificatio
nHandler[39m[33m.[39msetDozeMode([36mtrue[39m)[33m
;[39m
     [90m 215 |[39m
    [31m[1m>[22m[39m[90m 216 |[39m     expect([33
mBackgroundNotificationHandler[39m[33m.[39mgetPending
TaskCount())[33m.[39mtoBe([35m0[39m)[33m;[39m
     [90m     |[39m                                   
                              [31m[1m^[22m[39m
     [90m 217 |[39m
     [90m 218 |[39m     [36mawait[39m [33mBackgroun
dNotificationHandler[39m[33m.[39mhandleBackgroundMess
age(mockMessage)[33m;[39m
     [90m 219 |[39m     expect([33mBackgroundNotifica
tionHandler[39m[33m.[39mgetPendingTaskCount())[33m.
[39mtoBe([35m1[39m)[33m;[39m[0m

      at Object.toBe (src/lib/notifications/background-h
andler.test.ts:216:65)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/moderation/moderation-metrics-queries.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [ModerationMetrics] Calculating appeal reversal 
rate for period: {
        startDate: 2024-01-01T00:00:00.000Z,
        endDate: 2024-01-31T00:00:00.000Z
      }

      at log 
(src/lib/moderation/moderation-metrics-queries.ts:45:11)

    console.log
      [ModerationMetrics] Calculating appeal reversal 
rate for period: {
        startDate: 2024-01-01T00:00:00.000Z,
        endDate: 2024-01-31T00:00:00.000Z
      }

      at log 
(src/lib/moderation/moderation-metrics-queries.ts:45:11)

    console.log
      [ModerationMetrics] Appeal reversal rate 
calculated: {
        metricName: 'appeal_reversal_rate_period',
        value: 50,
        timestamp: 2026-01-16T10:25:03.347Z,
        metadata: {
          startDate: 2024-01-01T00:00:00.000Z,
          endDate: 2024-01-31T00:00:00.000Z,
          totalAppeals: 4,
          reversedAppeals: 2
        }
      }

      at log 
(src/lib/moderation/moderation-metrics-queries.ts:88:13)

    console.error
      [ModerationMetrics] Error persisting metric: 
TypeError: _supabase.supabase.from(...).insert is not a 
function
          at insert (C:\Users\Peter\GrowBro\src\lib\mode
ration\moderation-metrics-queries.ts:23:65)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:36:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:21:29)
          at persistMetric (C:\Users\Peter\GrowBro\src\l
ib\moderation\moderation-metrics-queries.ts:89:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 32 |[39m     }
     [90m 33 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 34 |[39m     
console[33m.[39merror([32m'[ModerationMetrics] Error 
persisting metric:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 35 |[39m   }
     [90m 36 |[39m }
     [90m 37 |[39m[0m

      at error 
(src/lib/moderation/moderation-metrics-queries.ts:34:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/moderation-metrics-queries.ts:36:2)
      at apply 
(src/lib/moderation/moderation-metrics-queries.ts:21:29)
      at persistMetric 
(src/lib/moderation/moderation-metrics-queries.ts:89:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [ModerationMetrics] Calculating appeal reversal 
rate for period: {
        startDate: 2024-01-01T00:00:00.000Z,
        endDate: 2024-01-31T00:00:00.000Z
      }

      at log 
(src/lib/moderation/moderation-metrics-queries.ts:45:11)

    console.error
      [ModerationMetrics] Failed to query appeals: 
Error: Database connection failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-metrics-queries.test.tsx:1
05:26)
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:397:39
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\jest-mock\build\index.js:404:13)
          at Object.mockConstructor [as is] (C:\Users\Pe
ter\GrowBro\node_modules\jest-mock\build\index.js:148:19
)
          at is (C:\Users\Peter\GrowBro\src\lib\moderati
on\moderation-metrics-queries.ts:58:8)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:41:50)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-metrics-queries.test.tsx:1
18:55)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 59 |[39m
     [90m 60 |[39m     [36mif[39m (error) {
    [31m[1m>[22m[39m[90m 61 |[39m       
console[33m.[39merror([32m'[ModerationMetrics] 
Failed to query appeals:'[39m[33m,[39m 
error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 62 |[39m       [36mreturn[39m 
[35m0[39m[33m;[39m
     [90m 63 |[39m     }
     [90m 64 |[39m[0m

      at error 
(src/lib/moderation/moderation-metrics-queries.ts:61:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [ModerationMetrics] Calculating appeal reversal 
rate for period: {
        startDate: 2024-01-01T00:00:00.000Z,
        endDate: 2024-01-31T00:00:00.000Z
      }

      at log 
(src/lib/moderation/moderation-metrics-queries.ts:45:11)

    console.log
      [ModerationMetrics] Appeal reversal rate 
calculated: {
        metricName: 'appeal_reversal_rate_period',
        value: 100,
        timestamp: 2026-01-16T10:25:03.402Z,
        metadata: {
          startDate: 2024-01-01T00:00:00.000Z,
          endDate: 2024-01-31T00:00:00.000Z,
          totalAppeals: 1,
          reversedAppeals: 1
        }
      }

      at log 
(src/lib/moderation/moderation-metrics-queries.ts:88:13)

    console.error
      [ModerationMetrics] Error persisting metric: 
TypeError: _supabase.supabase.from(...).insert is not a 
function
          at insert (C:\Users\Peter\GrowBro\src\lib\mode
ration\moderation-metrics-queries.ts:23:65)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:21:29)
          at persistMetric (C:\Users\Peter\GrowBro\src\l
ib\moderation\moderation-metrics-queries.ts:89:10)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 32 |[39m     }
     [90m 33 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 34 |[39m     
console[33m.[39merror([32m'[ModerationMetrics] Error 
persisting metric:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 35 |[39m   }
     [90m 36 |[39m }
     [90m 37 |[39m[0m

      at error 
(src/lib/moderation/moderation-metrics-queries.ts:34:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/moderation-metrics-queries.ts:21:29)
      at persistMetric 
(src/lib/moderation/moderation-metrics-queries.ts:89:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [ModerationMetrics] Getting appeal metrics for 
period: {
        startDate: 2024-01-01T00:00:00.000Z,
        endDate: 2024-01-31T00:00:00.000Z
      }

      at log (src/lib/moderation/moderation-metrics-quer
ies.ts:108:11)

    console.error
      [ModerationMetrics] Error getting appeal metrics: 
TypeError: _supabase.supabase.from(...).select(...).gte(
...).lte(...).eq is not a function
          at eq (C:\Users\Peter\GrowBro\src\lib\moderati
on\moderation-metrics-queries.ts:170:6)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:179:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:161:36)
          at queryResolvedAppeals (C:\Users\Peter\GrowBr
o\src\lib\moderation\moderation-metrics-queries.ts:111:2
7)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:159:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:104:39)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-metrics-queries.test.tsx:1
67:44)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 149 |[39m     }[33m;[39m
     [90m 150 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 151 |[39m     
console[33m.[39merror([32m'[ModerationMetrics] Error 
getting appeal metrics:'[39m[33m,[39m 
error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 152 |[39m     [36mreturn[39m {
     [90m 153 |[39m       totalAppeals[33m:[39m 
[35m0[39m[33m,[39m
     [90m 154 |[39m       upheldAppeals[33m:[39m 
[35m0[39m[33m,[39m[0m

      at error (src/lib/moderation/moderation-metrics-qu
eries.ts:151:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [ModerationMetrics] Getting ODS metrics for 
period: {
        startDate: 2024-01-01T00:00:00.000Z,
        endDate: 2024-01-31T00:00:00.000Z
      }

      at log (src/lib/moderation/moderation-metrics-quer
ies.ts:236:11)

    console.log
      [ModerationMetrics] ODS metrics calculated: {
        totalEscalations: 0,
        upheldByODS: 0,
        rejectedByODS: 0,
        averageResolutionDays: 0
      }

      at log (src/lib/moderation/moderation-metrics-quer
ies.ts:261:13)

    console.error
      [ModerationMetrics] Error persisting metric: 
TypeError: _supabase.supabase.from(...).insert is not a 
function
          at insert (C:\Users\Peter\GrowBro\src\lib\mode
ration\moderation-metrics-queries.ts:23:65)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:21:29)
          at persistMetric (C:\Users\Peter\GrowBro\src\l
ib\moderation\moderation-metrics-queries.ts:375:10)
          at persistODSMetrics (C:\Users\Peter\GrowBro\s
rc\lib\moderation\moderation-metrics-queries.ts:263:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 32 |[39m     }
     [90m 33 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 34 |[39m     
console[33m.[39merror([32m'[ModerationMetrics] Error 
persisting metric:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 35 |[39m   }
     [90m 36 |[39m }
     [90m 37 |[39m[0m

      at error 
(src/lib/moderation/moderation-metrics-queries.ts:34:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/moderation-metrics-queries.ts:21:29)
      at persistMetric (src/lib/moderation/moderation-me
trics-queries.ts:375:10)
      at persistODSMetrics 
(src/lib/moderation/moderation-metrics-queries.ts:263:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [ModerationMetrics] Error persisting metric: 
TypeError: _supabase.supabase.from(...).insert is not a 
function
          at insert (C:\Users\Peter\GrowBro\src\lib\mode
ration\moderation-metrics-queries.ts:23:65)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:21:29)
          at persistMetric (C:\Users\Peter\GrowBro\src\l
ib\moderation\moderation-metrics-queries.ts:375:10)
          at persistODSMetrics (C:\Users\Peter\GrowBro\s
rc\lib\moderation\moderation-metrics-queries.ts:263:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 32 |[39m     }
     [90m 33 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 34 |[39m     
console[33m.[39merror([32m'[ModerationMetrics] Error 
persisting metric:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 35 |[39m   }
     [90m 36 |[39m }
     [90m 37 |[39m[0m

      at error 
(src/lib/moderation/moderation-metrics-queries.ts:34:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/moderation-metrics-queries.ts:21:29)
      at persistMetric (src/lib/moderation/moderation-me
trics-queries.ts:375:10)
      at persistODSMetrics 
(src/lib/moderation/moderation-metrics-queries.ts:263:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [ModerationMetrics] Error persisting metric: 
TypeError: _supabase.supabase.from(...).insert is not a 
function
          at insert (C:\Users\Peter\GrowBro\src\lib\mode
ration\moderation-metrics-queries.ts:23:65)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:21:29)
          at persistMetric (C:\Users\Peter\GrowBro\src\l
ib\moderation\moderation-metrics-queries.ts:375:10)
          at persistODSMetrics (C:\Users\Peter\GrowBro\s
rc\lib\moderation\moderation-metrics-queries.ts:263:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 32 |[39m     }
     [90m 33 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 34 |[39m     
console[33m.[39merror([32m'[ModerationMetrics] Error 
persisting metric:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 35 |[39m   }
     [90m 36 |[39m }
     [90m 37 |[39m[0m

      at error 
(src/lib/moderation/moderation-metrics-queries.ts:34:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/moderation-metrics-queries.ts:21:29)
      at persistMetric (src/lib/moderation/moderation-me
trics-queries.ts:375:10)
      at persistODSMetrics 
(src/lib/moderation/moderation-metrics-queries.ts:263:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [ModerationMetrics] Getting ODS metrics for 
period: {
        startDate: 2024-01-01T00:00:00.000Z,
        endDate: 2024-01-31T00:00:00.000Z
      }

      at log (src/lib/moderation/moderation-metrics-quer
ies.ts:236:11)

    console.log
      [ModerationMetrics] ODS metrics calculated: {
        totalEscalations: 4,
        upheldByODS: 1,
        rejectedByODS: 1,
        averageResolutionDays: 10
      }

      at log (src/lib/moderation/moderation-metrics-quer
ies.ts:261:13)

    console.error
      [ModerationMetrics] Error persisting metric: 
TypeError: _supabase.supabase.from(...).insert is not a 
function
          at insert (C:\Users\Peter\GrowBro\src\lib\mode
ration\moderation-metrics-queries.ts:23:65)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:21:29)
          at persistMetric (C:\Users\Peter\GrowBro\src\l
ib\moderation\moderation-metrics-queries.ts:375:10)
          at persistODSMetrics (C:\Users\Peter\GrowBro\s
rc\lib\moderation\moderation-metrics-queries.ts:263:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 32 |[39m     }
     [90m 33 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 34 |[39m     
console[33m.[39merror([32m'[ModerationMetrics] Error 
persisting metric:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 35 |[39m   }
     [90m 36 |[39m }
     [90m 37 |[39m[0m

      at error 
(src/lib/moderation/moderation-metrics-queries.ts:34:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/moderation-metrics-queries.ts:21:29)
      at persistMetric (src/lib/moderation/moderation-me
trics-queries.ts:375:10)
      at persistODSMetrics 
(src/lib/moderation/moderation-metrics-queries.ts:263:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [ModerationMetrics] Error persisting metric: 
TypeError: _supabase.supabase.from(...).insert is not a 
function
          at insert (C:\Users\Peter\GrowBro\src\lib\mode
ration\moderation-metrics-queries.ts:23:65)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:21:29)
          at persistMetric (C:\Users\Peter\GrowBro\src\l
ib\moderation\moderation-metrics-queries.ts:375:10)
          at persistODSMetrics (C:\Users\Peter\GrowBro\s
rc\lib\moderation\moderation-metrics-queries.ts:263:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 32 |[39m     }
     [90m 33 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 34 |[39m     
console[33m.[39merror([32m'[ModerationMetrics] Error 
persisting metric:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 35 |[39m   }
     [90m 36 |[39m }
     [90m 37 |[39m[0m

      at error 
(src/lib/moderation/moderation-metrics-queries.ts:34:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/moderation-metrics-queries.ts:21:29)
      at persistMetric (src/lib/moderation/moderation-me
trics-queries.ts:375:10)
      at persistODSMetrics 
(src/lib/moderation/moderation-metrics-queries.ts:263:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [ModerationMetrics] Error persisting metric: 
TypeError: _supabase.supabase.from(...).insert is not a 
function
          at insert (C:\Users\Peter\GrowBro\src\lib\mode
ration\moderation-metrics-queries.ts:23:65)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:21:29)
          at persistMetric (C:\Users\Peter\GrowBro\src\l
ib\moderation\moderation-metrics-queries.ts:375:10)
          at persistODSMetrics (C:\Users\Peter\GrowBro\s
rc\lib\moderation\moderation-metrics-queries.ts:263:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 32 |[39m     }
     [90m 33 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 34 |[39m     
console[33m.[39merror([32m'[ModerationMetrics] Error 
persisting metric:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 35 |[39m   }
     [90m 36 |[39m }
     [90m 37 |[39m[0m

      at error 
(src/lib/moderation/moderation-metrics-queries.ts:34:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/moderation-metrics-queries.ts:21:29)
      at persistMetric (src/lib/moderation/moderation-me
trics-queries.ts:375:10)
      at persistODSMetrics 
(src/lib/moderation/moderation-metrics-queries.ts:263:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [ModerationMetrics] Getting ODS metrics for 
period: {
        startDate: 2024-01-01T00:00:00.000Z,
        endDate: 2024-01-31T00:00:00.000Z
      }

      at log (src/lib/moderation/moderation-metrics-quer
ies.ts:236:11)

    console.error
      [ModerationMetrics] Failed to query ODS 
escalations: Error: Database connection failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-metrics-queries.test.tsx:2
71:24)
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:397:39
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\jest-mock\build\index.js:404:13)
          at Object.mockConstructor [as is] (C:\Users\Pe
ter\GrowBro\node_modules\jest-mock\build\index.js:148:19
)
          at is (C:\Users\Peter\GrowBro\src\lib\moderati
on\moderation-metrics-queries.ts:286:6)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:277:35)
          at queryODSEscalations (C:\Users\Peter\GrowBro
\src\lib\moderation\moderation-metrics-queries.ts:239:31
)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:232:36)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\moderation\moderation-metrics-queries.test.tsx:2
83:41)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 287 |[39m
     [90m 288 |[39m   [36mif[39m (error) {
    [31m[1m>[22m[39m[90m 289 |[39m     
console[33m.[39merror(
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 290 |[39m       [32m'[ModerationMetrics] 
Failed to query ODS escalations:'[39m[33m,[39m
     [90m 291 |[39m       error
     [90m 292 |[39m     )[33m;[39m[0m

      at error (src/lib/moderation/moderation-metrics-qu
eries.ts:289:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.log
      [ModerationMetrics] Getting ODS metrics for 
period: {
        startDate: 2024-01-01T00:00:00.000Z,
        endDate: 2024-01-31T00:00:00.000Z
      }

      at log (src/lib/moderation/moderation-metrics-quer
ies.ts:236:11)

    console.log
      [ModerationMetrics] ODS metrics calculated: {
        totalEscalations: 1,
        upheldByODS: 1,
        rejectedByODS: 0,
        averageResolutionDays: 10
      }

      at log (src/lib/moderation/moderation-metrics-quer
ies.ts:261:13)

    console.error
      [ModerationMetrics] Error persisting metric: 
TypeError: _supabase.supabase.from(...).insert is not a 
function
          at insert (C:\Users\Peter\GrowBro\src\lib\mode
ration\moderation-metrics-queries.ts:23:65)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:21:29)
          at persistMetric (C:\Users\Peter\GrowBro\src\l
ib\moderation\moderation-metrics-queries.ts:375:10)
          at persistODSMetrics (C:\Users\Peter\GrowBro\s
rc\lib\moderation\moderation-metrics-queries.ts:263:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 32 |[39m     }
     [90m 33 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 34 |[39m     
console[33m.[39merror([32m'[ModerationMetrics] Error 
persisting metric:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 35 |[39m   }
     [90m 36 |[39m }
     [90m 37 |[39m[0m

      at error 
(src/lib/moderation/moderation-metrics-queries.ts:34:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/moderation-metrics-queries.ts:21:29)
      at persistMetric (src/lib/moderation/moderation-me
trics-queries.ts:375:10)
      at persistODSMetrics 
(src/lib/moderation/moderation-metrics-queries.ts:263:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [ModerationMetrics] Error persisting metric: 
TypeError: _supabase.supabase.from(...).insert is not a 
function
          at insert (C:\Users\Peter\GrowBro\src\lib\mode
ration\moderation-metrics-queries.ts:23:65)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:21:29)
          at persistMetric (C:\Users\Peter\GrowBro\src\l
ib\moderation\moderation-metrics-queries.ts:375:10)
          at persistODSMetrics (C:\Users\Peter\GrowBro\s
rc\lib\moderation\moderation-metrics-queries.ts:263:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 32 |[39m     }
     [90m 33 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 34 |[39m     
console[33m.[39merror([32m'[ModerationMetrics] Error 
persisting metric:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 35 |[39m   }
     [90m 36 |[39m }
     [90m 37 |[39m[0m

      at error 
(src/lib/moderation/moderation-metrics-queries.ts:34:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/moderation-metrics-queries.ts:21:29)
      at persistMetric (src/lib/moderation/moderation-me
trics-queries.ts:375:10)
      at persistODSMetrics 
(src/lib/moderation/moderation-metrics-queries.ts:263:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [ModerationMetrics] Error persisting metric: 
TypeError: _supabase.supabase.from(...).insert is not a 
function
          at insert (C:\Users\Peter\GrowBro\src\lib\mode
ration\moderation-metrics-queries.ts:23:65)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\moder
ation\moderation-metrics-queries.ts:21:29)
          at persistMetric (C:\Users\Peter\GrowBro\src\l
ib\moderation\moderation-metrics-queries.ts:375:10)
          at persistODSMetrics (C:\Users\Peter\GrowBro\s
rc\lib\moderation\moderation-metrics-queries.ts:263:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 32 |[39m     }
     [90m 33 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 34 |[39m     
console[33m.[39merror([32m'[ModerationMetrics] Error 
persisting metric:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 35 |[39m   }
     [90m 36 |[39m }
     [90m 37 |[39m[0m

      at error 
(src/lib/moderation/moderation-metrics-queries.ts:34:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/moderation/moderation-metrics-queries.ts:21:29)
      at persistMetric (src/lib/moderation/moderation-me
trics-queries.ts:375:10)
      at persistODSMetrics 
(src/lib/moderation/moderation-metrics-queries.ts:263:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModerationMetricsQueries ÔÇ║ 
calculateAppealReversalRate ÔÇ║ filters appeals by date 
range

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "submitted_at", "2024-01-01T00:00:00.000Z"

    Number of calls: 0

    [0m [90m 147 |[39m       expect(mockSupabase[33m
.[39m[36mfrom[39m)[33m.[39mtoHaveBeenCalledWith([3
2m'appeals'[39m)[33m;[39m
     [90m 148 |[39m       expect(mockFrom[33m.[39mse
lect)[33m.[39mtoHaveBeenCalledWith([32m'decision'[39
m)[33m;[39m
    [31m[1m>[22m[39m[90m 149 |[39m       expect(mo
ckFrom[33m.[39mselect()[33m.[39mgte)[33m.[39mtoHav
eBeenCalledWith(
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 150 |[39m         
[32m'submitted_at'[39m[33m,[39m
     [90m 151 |[39m         
period[33m.[39mstartDate[33m.[39mtoISOString()
     [90m 152 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/moderation-metrics-queries.test.tsx:149:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModerationMetricsQueries ÔÇ║ getAppealMetrics ÔÇ║ 
returns hardcoded metrics (placeholder - needs real 
implementation)

    expect(received).toEqual(expected) // deep equality

    - Expected  - 4
    + Received  + 4

      Object {
    -   "rejectedAppeals": 85,
    -   "reversalRate": 15,
    -   "totalAppeals": 100,
    -   "upheldAppeals": 15,
    +   "rejectedAppeals": 0,
    +   "reversalRate": 0,
    +   "totalAppeals": 0,
    +   "upheldAppeals": 0,
      }

    [0m [90m 167 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
getAppealMetrics(period)[33m;[39m
     [90m 168 |[39m
    [31m[1m>[22m[39m[90m 169 |[39m       
expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 170 |[39m         totalAppeals[33m:[39m 
[35m100[39m[33m,[39m
     [90m 171 |[39m         upheldAppeals[33m:[39m 
[35m15[39m[33m,[39m
     [90m 172 |[39m         
rejectedAppeals[33m:[39m [35m85[39m[33m,[39m[0m

      at Object.toEqual (src/lib/moderation/moderation-m
etrics-queries.test.tsx:169:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/harvest/__tests__/harvest-redaction.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      [RedactionValidation] Sensitive field present: 
user_id

    [0m [90m 213 |[39m   [36mfor[39m 
([36mconst[39m key [36mof[39m sensitiveKeys) {
     [90m 214 |[39m     [36mif[39m (key 
[36min[39m redacted) {
    [31m[1m>[22m[39m[90m 215 |[39m       
console[33m.[39merror([32m`[RedactionValidation] 
Sensitive field present: ${key}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 216 |[39m       [36mreturn[39m 
[36mfalse[39m[33m;[39m
     [90m 217 |[39m     }
     [90m 218 |[39m   }[0m

      at error 
(src/lib/harvest/harvest-redaction.ts:215:15)
      at Object.<anonymous> (src/lib/harvest/__tests__/h
arvest-redaction.test.ts:145:40)

    console.error
      [RedactionValidation] Missing redaction metadata

    [0m [90m 220 |[39m   [90m// Check redaction 
metadata[39m
     [90m 221 |[39m   [36mif[39m 
([33m![39mredacted[33m.[39mredacted_at [33m||[39m 
[33m![39mredacted[33m.[39mredaction_version) {
    [31m[1m>[22m[39m[90m 222 |[39m     
console[33m.[39merror([32m'[RedactionValidation] 
Missing redaction metadata'[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 223 |[39m     [36mreturn[39m 
[36mfalse[39m[33m;[39m
     [90m 224 |[39m   }
     [90m 225 |[39m[0m

      at error 
(src/lib/harvest/harvest-redaction.ts:222:13)
      at Object.<anonymous> (src/lib/harvest/__tests__/h
arvest-redaction.test.ts:155:40)

    console.error
      [SummaryRedactionValidation] Sensitive field 
present: user_id

    [0m [90m 241 |[39m   [36mfor[39m 
([36mconst[39m key [36mof[39m sensitiveKeys) {
     [90m 242 |[39m     [36mif[39m (key 
[36min[39m summary) {
    [31m[1m>[22m[39m[90m 243 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 244 |[39m         
[32m`[SummaryRedactionValidation] Sensitive field 
present: ${key}`[39m
     [90m 245 |[39m       )[33m;[39m
     [90m 246 |[39m       [36mreturn[39m 
[36mfalse[39m[33m;[39m[0m

      at error 
(src/lib/harvest/harvest-redaction.ts:243:15)
      at Object.<anonymous> (src/lib/harvest/__tests__/h
arvest-redaction.test.ts:297:47)

    console.error
      [SummaryRedactionValidation] Missing redaction 
metadata

    [0m [90m 250 |[39m   [90m// Check redaction 
metadata[39m
     [90m 251 |[39m   [36mif[39m 
([33m![39msummary[33m.[39mredacted_at [33m||[39m 
[33m![39msummary[33m.[39mredaction_version) {
    [31m[1m>[22m[39m[90m 252 |[39m     console[33
m.[39merror([32m'[SummaryRedactionValidation] Missing 
redaction metadata'[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 253 |[39m     [36mreturn[39m 
[36mfalse[39m[33m;[39m
     [90m 254 |[39m   }
     [90m 255 |[39m[0m

      at error 
(src/lib/harvest/harvest-redaction.ts:252:13)
      at Object.<anonymous> (src/lib/harvest/__tests__/h
arvest-redaction.test.ts:307:47)

  ÔùÅ Harvest Redaction ÔÇ║ createHarvestSharingSummary 
ÔÇ║ should calculate average duration

    expect(received).toBeCloseTo(expected, precision)

    Expected: 7.33
    Received: 9.333333333333334

    Expected precision:    2
    Expected difference: < 0.005
    Received difference:   2.003333333333334

    [0m [90m 206 |[39m
     [90m 207 |[39m       [90m// (6 days + 7 days + 
9 days) / 3 = 7.33 days (floored durations)[39m
    [31m[1m>[22m[39m[90m 208 |[39m       expect(su
mmary[33m.[39mavg_duration_days)[33m.[39mtoBeCloseTo
([35m7.33[39m[33m,[39m [35m2[39m)[33m;[39m
     [90m     |[39m                                   
      [31m[1m^[22m[39m
     [90m 209 |[39m     })[33m;[39m
     [90m 210 |[39m
     [90m 211 |[39m     it([32m'should count 
stages'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBeCloseTo (src/lib/harvest/__tests__/h
arvest-redaction.test.ts:208:41)

FAIL src/lib/watermelon-models/__tests__/assessment-requ
est.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ sanitizePhotos ÔÇ║ returns empty array for 
non-array input

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 108 |[39m
     [90m 109 |[39m   test([32m'returns empty array 
for non-array input'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 110 |[39m     expect(sani
tizePhotos(undefined))[33m.[39mtoEqual([])[33m;[39m
     [90m     |[39m                          
[31m[1m^[22m[39m
     [90m 111 |[39m     
expect(sanitizePhotos([36mnull[39m [36mas[39m 
any))[33m.[39mtoEqual([])[33m;[39m
     [90m 112 |[39m     
expect(sanitizePhotos([32m'not an array'[39m 
[36mas[39m any))[33m.[39mtoEqual([])[33m;[39m
     [90m 113 |[39m     expect(sanitizePhotos({} 
[36mas[39m any))[33m.[39mtoEqual([])[33m;[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:110:26)

  ÔùÅ sanitizePhotos ÔÇ║ filters out photos with 
missing or empty id

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 116 |[39m   test([32m'filters out 
photos with missing or empty id'[39m[33m,[39m () 
[33m=>[39m {
     [90m 117 |[39m     [36mconst[39m photos 
[33m=[39m [mockValidPhoto[33m,[39m 
mockPhotoWithInvalidId][33m;[39m
    [31m[1m>[22m[39m[90m 118 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos(photos)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 119 |[39m
     [90m 120 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 121 |[39m     expect(result[[35m0[39m][33
m.[39mid)[33m.[39mtoBe([32m'photo-1'[39m)[33m;[39
m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:118:34)

  ÔùÅ sanitizePhotos ÔÇ║ filters out photos with 
missing or empty uri

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 124 |[39m   test([32m'filters out 
photos with missing or empty uri'[39m[33m,[39m () 
[33m=>[39m {
     [90m 125 |[39m     [36mconst[39m photos 
[33m=[39m [mockValidPhoto[33m,[39m 
mockPhotoWithInvalidUri][33m;[39m
    [31m[1m>[22m[39m[90m 126 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos(photos)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 127 |[39m
     [90m 128 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 129 |[39m     expect(result[[35m0[39m][33
m.[39mid)[33m.[39mtoBe([32m'photo-1'[39m)[33m;[39
m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:126:34)

  ÔùÅ sanitizePhotos ÔÇ║ filters out photos with 
whitespace-only id or uri

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 136 |[39m       { 
[33m...[39mmockValidPhoto[33m,[39m uri[33m:[39m 
[32m'\t\n  '[39m }[33m,[39m
     [90m 137 |[39m     ][33m;[39m
    [31m[1m>[22m[39m[90m 138 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos(photosWithWhitespace)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 139 |[39m
     [90m 140 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 141 |[39m     expect(result[[35m0[39m][33
m.[39mid)[33m.[39mtoBe([32m'photo-1'[39m)[33m;[39
m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:138:34)

  ÔùÅ sanitizePhotos ÔÇ║ limits results to MAX_PHOTOS 
after filtering

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 150 |[39m     }))[33m;[39m
     [90m 151 |[39m
    [31m[1m>[22m[39m[90m 152 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos(manyPhotos)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 153 |[39m     expect(result)[33m.[39mtoHav
eLength([35m10[39m)[33m;[39m
     [90m 154 |[39m   })[33m;[39m
     [90m 155 |[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:152:34)

  ÔùÅ sanitizePhotos ÔÇ║ coerces timestamp to number 
with fallback to Date.now()

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 155 |[39m
     [90m 156 |[39m   test([32m'coerces timestamp to 
number with fallback to Date.now()'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 157 |[39m     
[36mconst[39m result [33m=[39m sanitizePhotos([mockP
hotoWithInvalidTimestamp])[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 158 |[39m
     [90m 159 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 160 |[39m     expect([36mtypeof[39m result
[[35m0[39m][33m.[39mtimestamp)[33m.[39mtoBe([32m'
number'[39m)[33m;[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:157:34)

  ÔùÅ sanitizePhotos ÔÇ║ preserves valid timestamp as 
number

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 163 |[39m
     [90m 164 |[39m   test([32m'preserves valid 
timestamp as number'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 165 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos([mockValidPhoto])[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 166 |[39m
     [90m 167 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 168 |[39m     expect(result[[35m0[39m][33
m.[39mtimestamp)[33m.[39mtoBe([35m1234567890[39m)[
33m;[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:165:34)

  ÔùÅ sanitizePhotos ÔÇ║ sets default qualityScore when 
missing

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 170 |[39m
     [90m 171 |[39m   test([32m'sets default 
qualityScore when missing'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 172 |[39m     
[36mconst[39m result [33m=[39m sanitizePhotos([mockP
hotoWithMissingQualityScore])[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 173 |[39m
     [90m 174 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 175 |[39m     expect(result[[35m0[39m][33
m.[39mqualityScore)[33m.[39mtoEqual({[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:172:34)

  ÔùÅ sanitizePhotos ÔÇ║ preserves existing 
qualityScore when present

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 181 |[39m
     [90m 182 |[39m   test([32m'preserves existing 
qualityScore when present'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 183 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos([mockValidPhoto])[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 184 |[39m
     [90m 185 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 186 |[39m     expect(result[[35m0[39m][33
m.[39mqualityScore)[33m.[39mtoEqual({[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:183:34)

  ÔùÅ sanitizePhotos ÔÇ║ restricts metadata to only 
width and height

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 192 |[39m
     [90m 193 |[39m   test([32m'restricts metadata 
to only width and height'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 194 |[39m     
[36mconst[39m result [33m=[39m sanitizePhotos([mockP
hotoWithComplexMetadata])[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 195 |[39m
     [90m 196 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 197 |[39m     expect(result[[35m0[39m][33
m.[39mmetadata)[33m.[39mtoEqual({[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:194:34)

  ÔùÅ sanitizePhotos ÔÇ║ defaults metadata width and 
height to 0 when missing or invalid

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 219 |[39m     }[33m;[39m
     [90m 220 |[39m
    [31m[1m>[22m[39m[90m 221 |[39m     
[36mconst[39m result1 [33m=[39m 
sanitizePhotos([photoWithMissingMetadata])[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 222 |[39m     [36mconst[39m result2 
[33m=[39m 
sanitizePhotos([photoWithInvalidMetadata])[33m;[39m
     [90m 223 |[39m
     [90m 224 |[39m     expect(result1[[35m0[39m][3
3m.[39mmetadata)[33m.[39mtoEqual({ width[33m:[39m 
[35m0[39m[33m,[39m height[33m:[39m [35m0[39m 
})[33m;[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:221:35)

  ÔùÅ sanitizePhotos ÔÇ║ handles complex filtering and 
transformation in one pass

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 236 |[39m     ][33m;[39m
     [90m 237 |[39m
    [31m[1m>[22m[39m[90m 238 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos(mixedPhotos)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 239 |[39m
     [90m 240 |[39m     expect(result)[33m.[39mtoHav
eLength([35m3[39m)[33m;[39m [90m// Only valid 
photos should remain[39m
     [90m 241 |[39m     
expect(result[33m.[39mmap((p) [33m=>[39m p[33m.[39
mid))[33m.[39mtoEqual([[32m'photo-1'[39m[33m,[39m 
[32m'photo-4'[39m[33m,[39m 
[32m'photo-5'[39m])[33m;[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:238:34)

  ÔùÅ sanitizePhotos ÔÇ║ returns empty array when all 
photos are filtered out

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 262 |[39m     ][33m;[39m
     [90m 263 |[39m
    [31m[1m>[22m[39m[90m 264 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos(invalidPhotos)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 265 |[39m     
expect(result)[33m.[39mtoEqual([])[33m;[39m
     [90m 266 |[39m   })[33m;[39m
     [90m 267 |[39m })[33m;[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:264:34)

FAIL 
src/lib/inventory/__tests__/task-integration.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      DEBUG: entry.unit = ml itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = ml itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = ml itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = units itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = units itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = units itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = ml itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = ml itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

    console.log
      DEBUG: entry.unit = ml itemUnit = undefined 
item.id = mock-id

      at log 
(src/lib/inventory/deduction-validators.ts:128:11)

  ÔùÅ Task Workflow Integration ÔÇ║ Feeding Task 
Deduction (Requirement 3.1) ÔÇ║ should deduct nutrients 
with fixed quantity

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 139 |[39m
     [90m 140 |[39m       [90m// Assert: Verify 
successful deduction[39m
    [31m[1m>[22m[39m[90m 141 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 142 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 143 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mitemId)[33m.[39mtoBe(nutr
ientItem[33m.[39mid)[33m;[39m
     [90m 144 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mquantityDelta)[33m.[39mto
Be([33m-[39m[35m100[39m)[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:141:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Task Workflow Integration ÔÇ║ Feeding Task 
Deduction (Requirement 3.1) ÔÇ║ should scale nutrients 
per plant count

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 189 |[39m
     [90m 190 |[39m       [90m// Assert: Verify 
scaled deduction (50ml ├ù 5 plants = 250ml)[39m
    [31m[1m>[22m[39m[90m 191 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 192 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mquantityDelta)[33m.[39mto
Be([33m-[39m[35m250[39m)[33m;[39m
     [90m 193 |[39m
     [90m 194 |[39m       [36mconst[39m batches 
[33m=[39m [36mawait[39m db[0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:191:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Task Workflow Integration ÔÇ║ Feeding Task 
Deduction (Requirement 3.1) ÔÇ║ should handle 
insufficient stock gracefully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "INSUFFICIENT_STOCK"
    Received: "Validation failed: Unit mismatch: entry 
uses 'ml' but item requires 'undefined'"

    [0m [90m 235 |[39m       [90m// Assert: Verify 
insufficient stock error[39m
     [90m 236 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 237 |[39m       expect(re
sult[33m.[39merror)[33m.[39mtoBe([32m'INSUFFICIENT_
STOCK'[39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 238 |[39m       expect(result[33m.[39minsu
fficientItems)[33m.[39mtoHaveLength([35m1[39m)[33m;
[39m
     [90m 239 |[39m       expect(result[33m.[39minsu
fficientItems[33m![39m[[35m0[39m])[33m.[39mtoEqual
({
     [90m 240 |[39m         itemId[33m:[39m 
nutrientItem[33m.[39mid[33m,[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:237:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Task Workflow Integration ÔÇ║ Harvest Task 
Deduction (Requirement 3.2) ÔÇ║ should deduct 
containers on harvest completion

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 287 |[39m
     [90m 288 |[39m       [90m// Assert: Verify 
container deduction[39m
    [31m[1m>[22m[39m[90m 289 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 290 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 291 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mquantityDelta)[33m.[39mto
Be([33m-[39m[35m3[39m)[33m;[39m
     [90m 292 |[39m       [90m// Movements are 
created with consumption type (verified by 
quantityDelta being negative)[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:289:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Task Workflow Integration ÔÇ║ Harvest Task 
Deduction (Requirement 3.2) ÔÇ║ should deduct multiple 
items in harvest workflow

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 353 |[39m
     [90m 354 |[39m       [90m// Assert: Verify both 
items deducted[39m
    [31m[1m>[22m[39m[90m 355 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 356 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m2[39m)[33m;[39m
     [90m 357 |[39m
     [90m 358 |[39m       [36mconst[39m 
containerMovement [33m=[39m 
result[33m.[39mmovements[33m.[39mfind([0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:355:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Task Workflow Integration ÔÇ║ Idempotency 
(Requirement 3.3) ÔÇ║ should prevent double-deduction 
on retry

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 418 |[39m
     [90m 419 |[39m       [90m// Assert: Second 
request should be idempotent[39m
    [31m[1m>[22m[39m[90m 420 |[39m       expect(re
sult1[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 421 |[39m       expect(result2[33m.[39msuc
cess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 422 |[39m
     [90m 423 |[39m       [90m// Verify only one 
movement created[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:420:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Task Workflow Integration ÔÇ║ FIFO Cost Tracking 
(Requirement 9.3) ÔÇ║ should preserve batch cost in 
movements

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 479 |[39m
     [90m 480 |[39m       [90m// Assert: Verify 
movement preserves batch cost[39m
    [31m[1m>[22m[39m[90m 481 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 482 |[39m
     [90m 483 |[39m       [36mconst[39m movements 
[33m=[39m [36mawait[39m db
     [90m 484 |[39m         [33m.[39m[36mget[39m[
33m<[39m[33mInventoryMovementModel[39m[33m>[39m([3
2m'inventory_movements'[39m)[0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:481:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/assessment/__tests__/assessment-analytics-f
eedback.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ getFeedbackStats ÔÇ║ should return limited stats 
for all historical data when days=0

    TypeError: query.extend is not a function

    [0m [90m 34 |[39m   [36mif[39m (days 
[33m===[39m [35m0[39m) {
     [90m 35 |[39m     [90m// WatermelonDB Query 
doesn't have `.limit` ÔÇö use `Q.take` via `extend`[39m
    [31m[1m>[22m[39m[90m 36 |[39m     query 
[33m=[39m query[33m.[39mextend([33mQ[39m[33m.[39
mtake([35m50000[39m))[33m;[39m
     [90m    |[39m                   
[31m[1m^[22m[39m
     [90m 37 |[39m   }
     [90m 38 |[39m
     [90m 39 |[39m   [36mconst[39m allFeedback 
[33m=[39m [36mawait[39m 
query[33m.[39mfetch()[33m;[39m[0m

      at extend (src/lib/assessment/assessment-analytics
-feedback.ts:36:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/assessment/assessment-analytics-
feedback.ts:11:39)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/assessment-analytics-feedback.test.ts:88:41)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/assessment/__tests__/conflict-resolver.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ mergePartialUpdate ÔÇ║ adds new fields from server

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 0

      Object {
        "id": "1",
        "name": "Test",
    -   "newField": "new value",
      }

    [0m [90m 174 |[39m     [36mconst[39m merged 
[33m=[39m mergePartialUpdate(localData[33m,[39m 
serverUpdate)[33m;[39m
     [90m 175 |[39m
    [31m[1m>[22m[39m[90m 176 |[39m     
expect(merged)[33m.[39mtoEqual({
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 177 |[39m       id[33m:[39m 
[32m'1'[39m[33m,[39m
     [90m 178 |[39m       name[33m:[39m 
[32m'Test'[39m[33m,[39m
     [90m 179 |[39m       newField[33m:[39m 
[32m'new value'[39m[33m,[39m[0m

      at Object.toEqual (src/lib/assessment/__tests__/co
nflict-resolver.test.ts:176:20)

FAIL src/lib/moderation/__tests__/error-classification.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ ErrorClassifier ÔÇ║ error message pattern 
classification ÔÇ║ classifies network errors as 
transient

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "network"
    Received: "unknown"

    [0m [90m 76 |[39m       [36mconst[39m 
classified [33m=[39m 
classifier[33m.[39mclassify(error)[33m;[39m
     [90m 77 |[39m
    [31m[1m>[22m[39m[90m 78 |[39m       expect(cla
ssified[33m.[39mcategory)[33m.[39mtoBe([32m'network
'[39m)[33m;[39m
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 79 |[39m       expect(classified[33m.[39mi
sRetryable)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 80 |[39m     })[33m;[39m
     [90m 81 |[39m[0m

      at Object.toBe (src/lib/moderation/__tests__/error
-classification.test.ts:78:35)

  ÔùÅ ErrorClassifier ÔÇ║ suggested actions ÔÇ║ 
suggests escalation for SLA-critical operations

    expect(received).toContain(expected) // indexOf

    Expected substring: "manual fallback"
    Received string:    "Retry operation with 
exponential backoff"

    [0m [90m 193 |[39m       })[33m;[39m
     [90m 194 |[39m
    [31m[1m>[22m[39m[90m 195 |[39m       expect(cl
assified[33m.[39msuggestedAction)[33m.[39mtoContain(
[32m'manual fallback'[39m)[33m;[39m
     [90m     |[39m                                   
       [31m[1m^[22m[39m
     [90m 196 |[39m     })[33m;[39m
     [90m 197 |[39m   })[33m;[39m
     [90m 198 |[39m[0m

      at Object.toContain (src/lib/moderation/__tests__/
error-classification.test.ts:195:42)

  ÔùÅ ErrorClassifier ÔÇ║ singleton instance ÔÇ║ 
isPermanent method works correctly

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 222 |[39m       })[33m;[39m
     [90m 223 |[39m
    [31m[1m>[22m[39m[90m 224 |[39m       expect(er
rorClassifier[33m.[39misPermanent(permanentError))[33
m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                                   
                        [31m[1m^[22m[39m
     [90m 225 |[39m       expect(errorClassifier[33m.
[39misPermanent(transientError))[33m.[39mtoBe([36mfa
lse[39m)[33m;[39m
     [90m 226 |[39m     })[33m;[39m
     [90m 227 |[39m   })[33m;[39m[0m

      at Object.toBe (src/lib/moderation/__tests__/error
-classification.test.ts:224:59)

FAIL 
src/lib/accessibility/__tests__/harvest-labels.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ Harvest Accessibility Labels ÔÇ║ 
createStageActionA11yLabel ÔÇ║ should create label for 
advance action

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Advance to Curing stage"
    Received: "Advance to Curing"

    [0m [90m 78 |[39m         targetStage[33m:[39m 
[32m'Curing'[39m[33m,[39m
     [90m 79 |[39m       })[33m;[39m
    [31m[1m>[22m[39m[90m 80 |[39m       
expect(label)[33m.[39mtoBe([32m'Advance to Curing 
stage'[39m)[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 81 |[39m     })[33m;[39m
     [90m 82 |[39m
     [90m 83 |[39m     it([32m'should create label 
for undo action without seconds'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/accessibility/__tests__/ha
rvest-labels.test.ts:80:21)

  ÔùÅ Harvest Accessibility Labels ÔÇ║ 
createStageActionA11yHint ÔÇ║ should create hint for 
advance action

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Double-tap to advance to Drying stage"
    Received: "Double-tap to advance to Drying"

    [0m [90m 117 |[39m         
targetStage[33m:[39m [32m'Drying'[39m[33m,[39m
     [90m 118 |[39m       })[33m;[39m
    [31m[1m>[22m[39m[90m 119 |[39m       
expect(hint)[33m.[39mtoBe([32m'Double-tap to advance 
to Drying stage'[39m)[33m;[39m
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 120 |[39m     })[33m;[39m
     [90m 121 |[39m
     [90m 122 |[39m     it([32m'should create hint 
for undo action'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/accessibility/__tests__/ha
rvest-labels.test.ts:119:20)

FAIL src/lib/community/__tests__/health-monitor.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      [CommunityHealth] Failed to report to Sentry: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at CommunityHealthMonitor.<anonymous> (C:\User
s\Peter\GrowBro\src\lib\community\health-monitor.ts:175:
19)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at CommunityHealthMonitor.<anonymous> (C:\User
s\Peter\GrowBro\node_modules\@babel\runtime\helpers\asyn
cToGenerator.js:14:12)
          at CommunityHealthMonitor.apply [as 
reportToSentry] (C:\Users\Peter\GrowBro\src\lib\communit
y\health-monitor.ts:169:23)
          at Object.reportToSentry (C:\Users\Peter\GrowB
ro\src\lib\community\__tests__\health-monitor.test.ts:25
3:21)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 203 |[39m     } [36mcatch[39m (error) 
{
     [90m 204 |[39m       [90m// Silently fail if 
Sentry is not available[39m
    [31m[1m>[22m[39m[90m 205 |[39m       
console[33m.[39mwarn([32m'[CommunityHealth] Failed 
to report to Sentry:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 206 |[39m     }
     [90m 207 |[39m   }
     [90m 208 |[39m[0m

      at CommunityHealthMonitor.warn 
(src/lib/community/health-monitor.ts:205:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [CommunityHealth] Failed to report to Sentry: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at CommunityHealthMonitor.<anonymous> (C:\User
s\Peter\GrowBro\src\lib\community\health-monitor.ts:175:
19)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at CommunityHealthMonitor.<anonymous> (C:\User
s\Peter\GrowBro\node_modules\@babel\runtime\helpers\asyn
cToGenerator.js:14:12)
          at CommunityHealthMonitor.apply [as 
reportToSentry] (C:\Users\Peter\GrowBro\src\lib\communit
y\health-monitor.ts:169:23)
          at Object.reportToSentry (C:\Users\Peter\GrowB
ro\src\lib\community\__tests__\health-monitor.test.ts:28
2:21)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 203 |[39m     } [36mcatch[39m (error) 
{
     [90m 204 |[39m       [90m// Silently fail if 
Sentry is not available[39m
    [31m[1m>[22m[39m[90m 205 |[39m       
console[33m.[39mwarn([32m'[CommunityHealth] Failed 
to report to Sentry:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 206 |[39m     }
     [90m 207 |[39m   }
     [90m 208 |[39m[0m

      at CommunityHealthMonitor.warn 
(src/lib/community/health-monitor.ts:205:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [CommunityHealth] Failed to report to Sentry: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at CommunityHealthMonitor.<anonymous> (C:\User
s\Peter\GrowBro\src\lib\community\health-monitor.ts:175:
19)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at CommunityHealthMonitor.<anonymous> (C:\User
s\Peter\GrowBro\node_modules\@babel\runtime\helpers\asyn
cToGenerator.js:14:12)
          at CommunityHealthMonitor.apply [as 
reportToSentry] (C:\Users\Peter\GrowBro\src\lib\communit
y\health-monitor.ts:169:23)
          at Object.reportToSentry (C:\Users\Peter\GrowB
ro\src\lib\community\__tests__\health-monitor.test.ts:31
4:21)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 203 |[39m     } [36mcatch[39m (error) 
{
     [90m 204 |[39m       [90m// Silently fail if 
Sentry is not available[39m
    [31m[1m>[22m[39m[90m 205 |[39m       
console[33m.[39mwarn([32m'[CommunityHealth] Failed 
to report to Sentry:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 206 |[39m     }
     [90m 207 |[39m   }
     [90m 208 |[39m[0m

      at CommunityHealthMonitor.warn 
(src/lib/community/health-monitor.ts:205:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ CommunityHealthMonitor ÔÇ║ Sentry integration ÔÇ║ 
should not report to Sentry when healthy

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 229 |[39m       [36mawait[39m 
monitor[33m.[39mreportToSentry(result)[33m;[39m
     [90m 230 |[39m
    [31m[1m>[22m[39m[90m 231 |[39m       
[36mconst[39m [33mSentry[39m [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@sentry/react-nat
ive'[39m)[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 232 |[39m       expect([33mSentry[39m[33m
.[39maddBreadcrumb)[33m.[39mnot[33m.[39mtoHaveBeenC
alled()[33m;[39m
     [90m 233 |[39m       expect([33mSentry[39m[33m
.[39mcaptureMessage)[33m.[39mnot[33m.[39mtoHaveBeen
Called()[33m;[39m
     [90m 234 |[39m     })[33m;[39m[0m

      at Object.<anonymous> (src/lib/community/__tests__
/health-monitor.test.ts:231:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CommunityHealthMonitor ÔÇ║ Sentry integration ÔÇ║ 
should report degraded status to Sentry

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 253 |[39m       [36mawait[39m 
monitor[33m.[39mreportToSentry(result)[33m;[39m
     [90m 254 |[39m
    [31m[1m>[22m[39m[90m 255 |[39m       
[36mconst[39m [33mSentry[39m [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@sentry/react-nat
ive'[39m)[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 256 |[39m       expect([33mSentry[39m[33m
.[39maddBreadcrumb)[33m.[39mtoHaveBeenCalledWith(
     [90m 257 |[39m         
expect[33m.[39mobjectContaining({
     [90m 258 |[39m           category[33m:[39m 
[32m'community.health'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/community/__tests__
/health-monitor.test.ts:255:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CommunityHealthMonitor ÔÇ║ Sentry integration ÔÇ║ 
should capture critical alerts as Sentry messages

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 282 |[39m       [36mawait[39m 
monitor[33m.[39mreportToSentry(result)[33m;[39m
     [90m 283 |[39m
    [31m[1m>[22m[39m[90m 284 |[39m       
[36mconst[39m [33mSentry[39m [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@sentry/react-nat
ive'[39m)[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 285 |[39m       expect([33mSentry[39m[33m
.[39mcaptureMessage)[33m.[39mtoHaveBeenCalledWith(
     [90m 286 |[39m         
expect[33m.[39mstringContaining([32m'Real-time 
latency P95 exceeds 3s threshold'[39m)[33m,[39m
     [90m 287 |[39m         
expect[33m.[39mobjectContaining({[0m

      at Object.<anonymous> (src/lib/community/__tests__
/health-monitor.test.ts:284:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CommunityHealthMonitor ÔÇ║ Sentry integration ÔÇ║ 
should sanitize metrics for privacy

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 314 |[39m       [36mawait[39m 
monitor[33m.[39mreportToSentry(result)[33m;[39m
     [90m 315 |[39m
    [31m[1m>[22m[39m[90m 316 |[39m       
[36mconst[39m [33mSentry[39m [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@sentry/react-nat
ive'[39m)[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 317 |[39m       [36mconst[39m 
breadcrumbCall [33m=[39m 
([33mSentry[39m[33m.[39maddBreadcrumb [36mas[39m 
jest[33m.[39m[33mMock[39m)[33m.[39mmock
     [90m 318 |[39m         
[33m.[39mcalls[[35m0[39m][[35m0[39m][33m;[39m
     [90m 319 |[39m[0m

      at Object.<anonymous> (src/lib/community/__tests__
/health-monitor.test.ts:316:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/__tests__/watermelon-migrations.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [test-debug] watermelon-migrations test file 
loaded

      at Object.log 
(src/lib/__tests__/watermelon-migrations.test.ts:13:9)

    console.log
      [test-debug] watermelon-migrations test started

      at Object.log 
(src/lib/__tests__/watermelon-migrations.test.ts:31:13)

    console.log
      [test-debug] watermelon-migrations test finished

      at Object.log 
(src/lib/__tests__/watermelon-migrations.test.ts:36:13)

  ÔùÅ WatermelonDB migrations ÔÇ║ has schema version 35

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 35
    Received: 38

    [0m [90m 40 |[39m [36mconst[39m 
testSchemaVersion [33m=[39m () [33m=>[39m {
     [90m 41 |[39m   it([32m'has schema version 
35'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 42 |[39m     
expect((schema [36mas[39m any)[33m.[39mversion)[33m
.[39mtoBe([35m35[39m)[33m;[39m
     [90m    |[39m                                    
 [31m[1m^[22m[39m
     [90m 43 |[39m   })[33m;[39m
     [90m 44 |[39m }[33m;[39m
     [90m 45 |[39m[0m

      at Object.toBe 
(src/lib/__tests__/watermelon-migrations.test.ts:42:37)

FAIL src/lib/notifications/deep-link-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ DeepLinkService.handle ÔÇ║ defers protected 
navigation when authentication fails

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     router[33m:[39m { 
push[33m:[39m jest[33m.[39mfn() }[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mconst[39m module [33m=[39m [36mawait[39m [36m
import[39m([32m'./deep-link-service'[39m)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m  8 |[39m   [36mconst[39m { router } 
[33m=[39m [36mawait[39m 
[36mimport[39m([32m'expo-router'[39m)[33m;[39m
     [90m  9 |[39m   [36mreturn[39m {
     [90m 10 |[39m     
[33mDeepLinkService[39m[33m:[39m module[33m.[39m[
33mDeepLinkService[39m[33m,[39m[0m

      at 
src/lib/notifications/deep-link-service.test.ts:7:15
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/deep-link-service.test.ts:13:2)
      at apply 
(src/lib/notifications/deep-link-service.test.ts:3:27)
      at Object.loadService 
(src/lib/notifications/deep-link-service.test.ts:31:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DeepLinkService.handle ÔÇ║ navigates to protected 
path when authenticated

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     router[33m:[39m { 
push[33m:[39m jest[33m.[39mfn() }[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mconst[39m module [33m=[39m [36mawait[39m [36m
import[39m([32m'./deep-link-service'[39m)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m  8 |[39m   [36mconst[39m { router } 
[33m=[39m [36mawait[39m 
[36mimport[39m([32m'expo-router'[39m)[33m;[39m
     [90m  9 |[39m   [36mreturn[39m {
     [90m 10 |[39m     
[33mDeepLinkService[39m[33m:[39m module[33m.[39m[
33mDeepLinkService[39m[33m,[39m[0m

      at 
src/lib/notifications/deep-link-service.test.ts:7:15
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/deep-link-service.test.ts:3:27)
      at Object.loadService 
(src/lib/notifications/deep-link-service.test.ts:47:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DeepLinkService.handle ÔÇ║ allows public paths 
without authentication

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     router[33m:[39m { 
push[33m:[39m jest[33m.[39mfn() }[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mconst[39m module [33m=[39m [36mawait[39m [36m
import[39m([32m'./deep-link-service'[39m)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m  8 |[39m   [36mconst[39m { router } 
[33m=[39m [36mawait[39m 
[36mimport[39m([32m'expo-router'[39m)[33m;[39m
     [90m  9 |[39m   [36mreturn[39m {
     [90m 10 |[39m     
[33mDeepLinkService[39m[33m:[39m module[33m.[39m[
33mDeepLinkService[39m[33m,[39m[0m

      at 
src/lib/notifications/deep-link-service.test.ts:7:15
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/deep-link-service.test.ts:3:27)
      at Object.loadService 
(src/lib/notifications/deep-link-service.test.ts:62:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DeepLinkService.handle ÔÇ║ handles post deep link 
without comment

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     router[33m:[39m { 
push[33m:[39m jest[33m.[39mfn() }[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mconst[39m module [33m=[39m [36mawait[39m [36m
import[39m([32m'./deep-link-service'[39m)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m  8 |[39m   [36mconst[39m { router } 
[33m=[39m [36mawait[39m 
[36mimport[39m([32m'expo-router'[39m)[33m;[39m
     [90m  9 |[39m   [36mreturn[39m {
     [90m 10 |[39m     
[33mDeepLinkService[39m[33m:[39m module[33m.[39m[
33mDeepLinkService[39m[33m,[39m[0m

      at 
src/lib/notifications/deep-link-service.test.ts:7:15
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/deep-link-service.test.ts:3:27)
      at Object.loadService 
(src/lib/notifications/deep-link-service.test.ts:77:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DeepLinkService.handle ÔÇ║ handles post deep link 
with comment scrolling

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     router[33m:[39m { 
push[33m:[39m jest[33m.[39mfn() }[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mconst[39m module [33m=[39m [36mawait[39m [36m
import[39m([32m'./deep-link-service'[39m)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m  8 |[39m   [36mconst[39m { router } 
[33m=[39m [36mawait[39m 
[36mimport[39m([32m'expo-router'[39m)[33m;[39m
     [90m  9 |[39m   [36mreturn[39m {
     [90m 10 |[39m     
[33mDeepLinkService[39m[33m:[39m module[33m.[39m[
33mDeepLinkService[39m[33m,[39m[0m

      at 
src/lib/notifications/deep-link-service.test.ts:7:15
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/deep-link-service.test.ts:3:27)
      at Object.loadService 
(src/lib/notifications/deep-link-service.test.ts:87:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/playbooks/__tests__/ai-adjustments-integrat
ion.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ AI Adjustments Integration ÔÇ║ complete flow: 
generate ÔåÆ accept ÔåÆ vote

    RangeError: Invalid time value
        at Date.toISOString (<anonymous>)

    [0m [90m 444 |[39m     [36mconst[39m daysToAdd 
[33m=[39m rootCause [33m===[39m 
[32m'skipped_tasks'[39m [33m?[39m [35m2[39m 
[33m:[39m [35m1[39m[33m;[39m
     [90m 445 |[39m     
date[33m.[39msetDate(date[33m.[39mgetDate() 
[33m+[39m daysToAdd)[33m;[39m
    [31m[1m>[22m[39m[90m 446 |[39m     
[36mreturn[39m date[33m.[39mtoISOString()[33m.[39m
split([32m'T'[39m)[[35m0[39m][33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 447 |[39m   }
     [90m 448 |[39m
     [90m 449 |[39m   [36mprivate[39m 
getAdjustmentReason(rootCause[33m:[39m 
[33mAdjustmentRootCause[39m)[33m:[39m string {[0m

      at AIAdjustmentService.toISOString [as 
calculateProposedDate] 
(src/lib/playbooks/ai-adjustment-service.ts:446:17)
      at AIAdjustmentService.calculateProposedDate 
(src/lib/playbooks/ai-adjustment-service.ts:421:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AI Adjustments Integration ÔÇ║ complete flow: 
generate ÔåÆ decline ÔåÆ cooldown

    RangeError: Invalid time value
        at Date.toISOString (<anonymous>)

    [0m [90m 444 |[39m     [36mconst[39m daysToAdd 
[33m=[39m rootCause [33m===[39m 
[32m'skipped_tasks'[39m [33m?[39m [35m2[39m 
[33m:[39m [35m1[39m[33m;[39m
     [90m 445 |[39m     
date[33m.[39msetDate(date[33m.[39mgetDate() 
[33m+[39m daysToAdd)[33m;[39m
    [31m[1m>[22m[39m[90m 446 |[39m     
[36mreturn[39m date[33m.[39mtoISOString()[33m.[39m
split([32m'T'[39m)[[35m0[39m][33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 447 |[39m   }
     [90m 448 |[39m
     [90m 449 |[39m   [36mprivate[39m 
getAdjustmentReason(rootCause[33m:[39m 
[33mAdjustmentRootCause[39m)[33m:[39m string {[0m

      at AIAdjustmentService.toISOString [as 
calculateProposedDate] 
(src/lib/playbooks/ai-adjustment-service.ts:446:17)
      at AIAdjustmentService.calculateProposedDate 
(src/lib/playbooks/ai-adjustment-service.ts:421:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/playbooks/__tests__/ai-adjustment-service.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [AIAdjustmentService] Not suggesting: 
feature_disabled

      at AIAdjustmentService.log 
(src/lib/playbooks/ai-adjustment-service.ts:125:15)

  ÔùÅ AIAdjustmentService ÔÇ║ generateSuggestions ÔÇ║ 
generates suggestion with affected tasks

    RangeError: Invalid time value
        at Date.toISOString (<anonymous>)

    [0m [90m 444 |[39m     [36mconst[39m daysToAdd 
[33m=[39m rootCause [33m===[39m 
[32m'skipped_tasks'[39m [33m?[39m [35m2[39m 
[33m:[39m [35m1[39m[33m;[39m
     [90m 445 |[39m     
date[33m.[39msetDate(date[33m.[39mgetDate() 
[33m+[39m daysToAdd)[33m;[39m
    [31m[1m>[22m[39m[90m 446 |[39m     
[36mreturn[39m date[33m.[39mtoISOString()[33m.[39m
split([32m'T'[39m)[[35m0[39m][33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 447 |[39m   }
     [90m 448 |[39m
     [90m 449 |[39m   [36mprivate[39m 
getAdjustmentReason(rootCause[33m:[39m 
[33mAdjustmentRootCause[39m)[33m:[39m string {[0m

      at AIAdjustmentService.toISOString [as 
calculateProposedDate] 
(src/lib/playbooks/ai-adjustment-service.ts:446:17)
      at AIAdjustmentService.calculateProposedDate 
(src/lib/playbooks/ai-adjustment-service.ts:421:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/nutrient-engine/services/performance-analys
is-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ performance-analysis-service ÔÇ║ 
analyzePerformanceAndGenerateLearnings ÔÇ║ should 
handle unstable fluctuations by widening both range ends

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "stable"
    Received: "rising"

    [0m [90m 277 |[39m       )[33m;[39m
     [90m 278 |[39m
    [31m[1m>[22m[39m[90m 279 |[39m       expect(re
sult[33m.[39mmetrics[33m.[39mphTrendDirection)[33m.
[39mtoBe([32m'stable'[39m)[33m;[39m
     [90m     |[39m                                   
            [31m[1m^[22m[39m
     [90m 280 |[39m
     [90m 281 |[39m       [36mconst[39m 
phSuggestion [33m=[39m 
result[33m.[39msuggestions[33m.[39mfind(
     [90m 282 |[39m         (s) [33m=>[39m 
s[33m.[39madjustmentType [33m===[39m 
[32m'ph_range'[39m[0m

      at Object.toBe (src/lib/nutrient-engine/services/p
erformance-analysis-service.test.ts:279:47)

  ÔùÅ performance-analysis-service ÔÇ║ 
analyzePerformanceAndGenerateLearnings ÔÇ║ should 
respect phase boundaries when suggesting adjustments

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 6.2
    Received:    6.4

    [0m [90m 315 |[39m
     [90m 316 |[39m       [90m// Should not exceed 
phase max boundary[39m
    [31m[1m>[22m[39m[90m 317 |[39m       expect(ph
Suggestion[33m?[39m[33m.[39msuggestedPhMax)[33m.[3
9mtoBeLessThanOrEqual(
     [90m     |[39m                                   
         [31m[1m^[22m[39m
     [90m 318 |[39m         
mockPhase[33m.[39mphRange[[35m1[39m]
     [90m 319 |[39m       )[33m;[39m
     [90m 320 |[39m     })[33m;[39m[0m

      at Object.toBeLessThanOrEqual (src/lib/nutrient-en
gine/services/performance-analysis-service.test.ts:317:4
4)

FAIL 
src/lib/nutrient-engine/utils/annual-reminder.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ annual-reminder ÔÇ║ 
getAnnualTestingEducationalContent ÔÇ║ should return 
educational tips about annual testing

    expect(received).toContain(expected) // indexOf

    Expected value: StringContaining "water quality can 
change"
    Received array: ["Source water quality can change 
seasonally or when utilities adjust treatment", "Annual 
retesting ensures your pH and EC guidance remains 
accurate", "Key parameters to test: pH, EC, alkalinity 
(as CaCOÔéâ), and hardness", "Professional lab testing 
provides most accurate results", "Home testing kits are 
acceptable for tracking trends over time", "Update your 
profile in GrowBro immediately after retesting"]

    Looks like you wanted to test for object/array 
equality with the stricter `toContain` matcher. You 
probably need to use `toContainEqual` instead.

    [0m [90m 300 |[39m
     [90m 301 |[39m       expect(content[33m.[39mlen
gth)[33m.[39mtoBeGreaterThan([35m4[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 302 |[39m       
expect(content)[33m.[39mtoContain(
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 303 |[39m         
expect[33m.[39mstringContaining([32m'water quality 
can change'[39m)
     [90m 304 |[39m       )[33m;[39m
     [90m 305 |[39m       expect(content)[33m.[39mto
Contain(expect[33m.[39mstringContaining([32m'Annual 
retesting'[39m))[33m;[39m[0m

      at Object.toContain (src/lib/nutrient-engine/utils
/annual-reminder.test.ts:302:23)

  ÔùÅ annual-reminder ÔÇ║ getWaterTestingChecklist ÔÇ║ 
should include sample collection step

    expect(received).toContain(expected) // indexOf

    Expected value: StringContaining "Collect fresh 
sample"
    Received array: ["Collect fresh sample from your 
grow water source (tap, well, RO system)", "Let tap 
water sit 24 hours if chlorinated (or use 
dechlorinator)", "Test or request lab analysis for: pH, 
EC/TDS, alkalinity, hardness", "Optional: Test for 
calcium, magnesium, iron if using well water", "Record 
all measurements with date in GrowBro", "Compare to 
previous test results to identify trends", "Adjust 
reservoir target ranges if water chemistry changed 
significantly"]

    Looks like you wanted to test for object/array 
equality with the stricter `toContain` matcher. You 
probably need to use `toContainEqual` instead.

    [0m [90m 327 |[39m       [36mconst[39m 
checklist [33m=[39m 
getWaterTestingChecklist()[33m;[39m
     [90m 328 |[39m
    [31m[1m>[22m[39m[90m 329 |[39m       
expect(checklist)[33m.[39mtoContain(
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 330 |[39m         
expect[33m.[39mstringContaining([32m'Collect fresh 
sample'[39m)
     [90m 331 |[39m       )[33m;[39m
     [90m 332 |[39m     })[33m;[39m[0m

      at Object.toContain (src/lib/nutrient-engine/utils
/annual-reminder.test.ts:329:25)

  ÔùÅ annual-reminder ÔÇ║ getWaterTestingChecklist ÔÇ║ 
should include recording results step

    expect(received).toContain(expected) // indexOf

    Expected value: StringContaining "Record"
    Received array: ["Collect fresh sample from your 
grow water source (tap, well, RO system)", "Let tap 
water sit 24 hours if chlorinated (or use 
dechlorinator)", "Test or request lab analysis for: pH, 
EC/TDS, alkalinity, hardness", "Optional: Test for 
calcium, magnesium, iron if using well water", "Record 
all measurements with date in GrowBro", "Compare to 
previous test results to identify trends", "Adjust 
reservoir target ranges if water chemistry changed 
significantly"]

    Looks like you wanted to test for object/array 
equality with the stricter `toContain` matcher. You 
probably need to use `toContainEqual` instead.

    [0m [90m 345 |[39m       [36mconst[39m 
checklist [33m=[39m 
getWaterTestingChecklist()[33m;[39m
     [90m 346 |[39m
    [31m[1m>[22m[39m[90m 347 |[39m       expect(ch
ecklist)[33m.[39mtoContain(expect[33m.[39mstringCont
aining([32m'Record'[39m))[33m;[39m
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 348 |[39m       expect(checklist)[33m.[39m
toContain(expect[33m.[39mstringContaining([32m'GrowBr
o'[39m))[33m;[39m
     [90m 349 |[39m     })[33m;[39m
     [90m 350 |[39m   })[33m;[39m[0m

      at Object.toContain (src/lib/nutrient-engine/utils
/annual-reminder.test.ts:347:25)

FAIL src/lib/moderation/transparency-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ TransparencyService ÔÇ║ Authority Export ÔÇ║ 
should generate export with PII redaction

    TypeError: this.supabase.from(...).select(...).gte(.
..).lte(...).in is not a function

    [0m [90m 707 |[39m       
[33m.[39mgte([32m'timestamp'[39m[33m,[39m 
period[33m.[39mstartDate[33m.[39mtoISOString())
     [90m 708 |[39m       
[33m.[39mlte([32m'timestamp'[39m[33m,[39m 
period[33m.[39mendDate[33m.[39mtoISOString())
    [31m[1m>[22m[39m[90m 709 |[39m       [33m.[3
9m[36min[39m([32m'event_type'[39m[33m,[39m [
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 710 |[39m         
[32m'report_submitted'[39m[33m,[39m
     [90m 711 |[39m         
[32m'decision_made'[39m[33m,[39m
     [90m 712 |[39m         
[32m'appeal_submitted'[39m[33m,[39m[0m

      at TransparencyService.<anonymous> 
(src/lib/moderation/transparency-service.ts:709:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at TransparencyService.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at TransparencyService.apply [as 
getAuditTrailForExport] 
(src/lib/moderation/transparency-service.ts:701:39)
      at TransparencyService.getAuditTrailForExport 
(src/lib/moderation/transparency-service.ts:243:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at TransparencyService.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at TransparencyService.apply [as 
exportForAuthority] 
(src/lib/moderation/transparency-service.ts:234:27)
      at Object.exportForAuthority 
(src/lib/moderation/transparency-service.test.ts:146:40)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/device-id.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ device-id ÔÇ║ getDeviceId ÔÇ║ re-checks storage 
before creating promise to handle external writes

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "externally-set-id"
    Received: "retry-id"

    [0m [90m  99 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m getDeviceId()[33m;[39m
     [90m 100 |[39m
    [31m[1m>[22m[39m[90m 101 |[39m       expect(re
sult)[33m.[39mtoBe([32m'externally-set-id'[39m)[33m
;[39m
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 102 |[39m       expect(mockStorage[33m.[39
mgetString)[33m.[39mtoHaveBeenCalledTimes([35m3[39m)
[33m;[39m
     [90m 103 |[39m       expect(mockCrypto[33m.[39m
randomUUID)[33m.[39mnot[33m.[39mtoHaveBeenCalled()[
33m;[39m
     [90m 104 |[39m       expect(mockStorage[33m.[39
m[36mset[39m)[33m.[39mnot[33m.[39mtoHaveBeenCalled
()[33m;[39m[0m

      at Object.toBe (src/lib/device-id.test.ts:101:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ device-id ÔÇ║ getDeviceIdSync ÔÇ║ returns 
temporary ID when no device ID exists

    expect(jest.fn()).toHaveBeenCalledTimes(expected)

    Expected number of calls: 1
    Received number of calls: 2

    [0m [90m 126 |[39m       
expect(result)[33m.[39mtoBe(tempId)[33m;[39m
     [90m 127 |[39m       expect(mockStorage[33m.[39
mgetString)[33m.[39mtoHaveBeenCalledWith([32m'device_
id'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 128 |[39m       expect(mo
ckCrypto[33m.[39mrandomUUID)[33m.[39mtoHaveBeenCalle
dTimes([35m1[39m)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 129 |[39m     })[33m;[39m
     [90m 130 |[39m
     [90m 131 |[39m     test([32m'triggers async 
generation when no device ID exists'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toHaveBeenCalledTimes 
(src/lib/device-id.test.ts:128:37)

  ÔùÅ device-id ÔÇ║ getDeviceIdSync ÔÇ║ triggers async 
generation when no device ID exists

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "temp-uuid-123"
    Received: "temp-final-uuid"

    [0m [90m 139 |[39m       [36mconst[39m result 
[33m=[39m getDeviceIdSync()[33m;[39m
     [90m 140 |[39m
    [31m[1m>[22m[39m[90m 141 |[39m       
expect(result)[33m.[39mtoBe(tempId)[33m;[39m
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 142 |[39m       expect(mockCrypto[33m.[39m
randomUUID)[33m.[39mtoHaveBeenCalledTimes([35m1[39m)
[33m;[39m
     [90m 143 |[39m
     [90m 144 |[39m       [90m// Flush microtasks to 
allow the background promise to resolve[39m[0m

      at Object.toBe (src/lib/device-id.test.ts:141:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/__tests__/feature-flags.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ feature-flags ÔÇ║ getFeatureFlags ÔÇ║ returns 
feature flags from environment

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 3

      Object {
    +   "aiAdjustmentsEnabled": false,
    +   "aiAdjustmentsMinConfidence": 0.7,
    +   "aiAdjustmentsMinSkippedTasks": 2,
        "strainsEnabled": true,
        "strainsFavoritesSync": false,
        "strainsOfflineCache": true,
      }

    [0m [90m 28 |[39m     test([32m'returns feature 
flags from environment'[39m[33m,[39m () [33m=>[39m 
{
     [90m 29 |[39m       [36mconst[39m flags 
[33m=[39m getFeatureFlags()[33m;[39m
    [31m[1m>[22m[39m[90m 30 |[39m       
expect(flags)[33m.[39mtoEqual({
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 31 |[39m         strainsEnabled[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 32 |[39m         
strainsFavoritesSync[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 33 |[39m         
strainsOfflineCache[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.toEqual 
(src/lib/__tests__/feature-flags.test.ts:30:21)

  ÔùÅ feature-flags ÔÇ║ getFeatureFlags ÔÇ║ uses 
default values when env vars undefined

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 3

      Object {
    +   "aiAdjustmentsEnabled": false,
    +   "aiAdjustmentsMinConfidence": 0.7,
    +   "aiAdjustmentsMinSkippedTasks": 2,
        "strainsEnabled": true,
        "strainsFavoritesSync": true,
        "strainsOfflineCache": true,
      }

    [0m [90m 44 |[39m
     [90m 45 |[39m       [36mconst[39m flags 
[33m=[39m getFeatureFlags()[33m;[39m
    [31m[1m>[22m[39m[90m 46 |[39m       
expect(flags)[33m.[39mtoEqual({
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 47 |[39m         strainsEnabled[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 48 |[39m         
strainsFavoritesSync[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 49 |[39m         
strainsOfflineCache[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.toEqual 
(src/lib/__tests__/feature-flags.test.ts:46:21)

  ÔùÅ feature-flags ÔÇ║ useFeatureFlags ÔÇ║ returns 
feature flags from store

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 4

      Object {
    +   "aiAdjustmentsEnabled": false,
    +   "aiAdjustmentsMinConfidence": 0.7,
    +   "aiAdjustmentsMinSkippedTasks": 2,
        "strainsEnabled": true,
    -   "strainsFavoritesSync": false,
    +   "strainsFavoritesSync": true,
        "strainsOfflineCache": true,
      }

    [0m [90m 57 |[39m     test([32m'returns feature 
flags from store'[39m[33m,[39m () [33m=>[39m {
     [90m 58 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m 
useFeatureFlags())[33m;[39m
    [31m[1m>[22m[39m[90m 59 |[39m       
expect(result[33m.[39mcurrent)[33m.[39mtoEqual({
     [90m    |[39m                              
[31m[1m^[22m[39m
     [90m 60 |[39m         strainsEnabled[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 61 |[39m         
strainsFavoritesSync[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 62 |[39m         
strainsOfflineCache[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.toEqual 
(src/lib/__tests__/feature-flags.test.ts:59:30)

  ÔùÅ feature-flags ÔÇ║ useFeatureFlags ÔÇ║ re-renders 
when flags refreshed

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 3

      Object {
    +   "aiAdjustmentsEnabled": false,
    +   "aiAdjustmentsMinConfidence": 0.7,
    +   "aiAdjustmentsMinSkippedTasks": 2,
        "strainsEnabled": false,
        "strainsFavoritesSync": true,
        "strainsOfflineCache": true,
      }

    [0m [90m 76 |[39m       })[33m;[39m
     [90m 77 |[39m
    [31m[1m>[22m[39m[90m 78 |[39m       
expect(result[33m.[39mcurrent)[33m.[39mtoEqual({
     [90m    |[39m                              
[31m[1m^[22m[39m
     [90m 79 |[39m         strainsEnabled[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 80 |[39m         
strainsFavoritesSync[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 81 |[39m         
strainsOfflineCache[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.toEqual 
(src/lib/__tests__/feature-flags.test.ts:78:30)

  ÔùÅ feature-flags ÔÇ║ refreshFeatureFlags ÔÇ║ updates 
store with current env values

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 89 |[39m     test([32m'updates store 
with current env values'[39m[33m,[39m () 
[33m=>[39m {
     [90m 90 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m 
useFeatureFlags())[33m;[39m
    [31m[1m>[22m[39m[90m 91 |[39m       expect(res
ult[33m.[39mcurrent[33m.[39mstrainsEnabled)[33m.[3
9mtoBe([36mtrue[39m)[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 92 |[39m
     [90m 93 |[39m       [36mconst[39m originalEnv 
[33m=[39m { [33m...[39m[33mEnv[39m }[33m;[39m
     [90m 94 |[39m       [33mObject[39m[33m.[39mas
sign([33mEnv[39m[33m,[39m { 
[33mFEATURE_STRAINS_ENABLED[39m[33m:[39m 
[36mfalse[39m })[33m;[39m[0m

      at Object.toBe 
(src/lib/__tests__/feature-flags.test.ts:91:45)

  ÔùÅ feature-flags ÔÇ║ isFeatureEnabled ÔÇ║ returns 
true for enabled features

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 105 |[39m   
describe([32m'isFeatureEnabled'[39m[33m,[39m () 
[33m=>[39m {
     [90m 106 |[39m     test([32m'returns true for 
enabled features'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 107 |[39m       expect(is
FeatureEnabled([32m'strainsEnabled'[39m))[33m.[39mto
Be([36mtrue[39m)[33m;[39m
     [90m     |[39m                                   
               [31m[1m^[22m[39m
     [90m 108 |[39m       expect(isFeatureEnabled([32
m'strainsOfflineCache'[39m))[33m.[39mtoBe([36mtrue[
39m)[33m;[39m
     [90m 109 |[39m     })[33m;[39m
     [90m 110 |[39m[0m

      at Object.toBe 
(src/lib/__tests__/feature-flags.test.ts:107:50)

  ÔùÅ feature-flags ÔÇ║ isFeatureEnabled ÔÇ║ returns 
false for disabled features

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 110 |[39m
     [90m 111 |[39m     test([32m'returns false for 
disabled features'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 112 |[39m       expect(is
FeatureEnabled([32m'strainsFavoritesSync'[39m))[33m.
[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                                   
                     [31m[1m^[22m[39m
     [90m 113 |[39m     })[33m;[39m
     [90m 114 |[39m
     [90m 115 |[39m     test([32m'returns undefined 
for invalid feature key'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe 
(src/lib/__tests__/feature-flags.test.ts:112:56)

  ÔùÅ feature-flags ÔÇ║ useFeatureFlag ÔÇ║ returns 
feature flag value for specific feature

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 129 |[39m       )[33m;[39m
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m       expect(en
abledResult[33m.[39mcurrent)[33m.[39mtoBe([36mtrue
[39m)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 132 |[39m       expect(disabledResult[33m.
[39mcurrent)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 133 |[39m     })[33m;[39m
     [90m 134 |[39m[0m

      at Object.toBe 
(src/lib/__tests__/feature-flags.test.ts:131:37)

  ÔùÅ feature-flags ÔÇ║ useFeatureFlag ÔÇ║ re-renders 
when flags refreshed

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 135 |[39m     test([32m're-renders 
when flags refreshed'[39m[33m,[39m () [33m=>[39m {
     [90m 136 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m 
useFeatureFlag([32m'strainsEnabled'[39m))[33m;[39m
    [31m[1m>[22m[39m[90m 137 |[39m       expect(re
sult[33m.[39mcurrent)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 138 |[39m
     [90m 139 |[39m       [36mconst[39m originalEnv 
[33m=[39m { [33m...[39m[33mEnv[39m }[33m;[39m
     [90m 140 |[39m       [33mObject[39m[33m.[39ma
ssign([33mEnv[39m[33m,[39m { 
[33mFEATURE_STRAINS_ENABLED[39m[33m:[39m 
[36mfalse[39m })[33m;[39m[0m

      at Object.toBe 
(src/lib/__tests__/feature-flags.test.ts:137:30)

FAIL src/lib/moderation/geo-location-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ GeoLocationService ÔÇ║ applyGeoRestriction ÔÇ║ 
should apply geo-restriction to content

    GeoLocationError: 
_supabase.supabase.from(...).select is not a function

    [0m [90m 526 |[39m
     [90m 527 |[39m     [36mconst[39m message 
[33m=[39m error [36minstanceof[39m [33mError[39m 
[33m?[39m error[33m.[39mmessage [33m:[39m 
[33mString[39m(error)[33m;[39m
    [31m[1m>[22m[39m[90m 528 |[39m     
[36mreturn[39m [36mnew[39m 
[33mGeoLocationError[39m(message[33m,[39m 
code[33m,[39m metadata)[33m;[39m
     [90m     |[39m            [31m[1m^[22m[39m
     [90m 529 |[39m   }
     [90m 530 |[39m }
     [90m 531 |[39m[0m

      at GeoLocationService.handleError 
(src/lib/moderation/geo-location-service.ts:528:12)
      at GeoLocationService.handleError 
(src/lib/moderation/geo-location-service.ts:312:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at GeoLocationService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at GeoLocationService.apply [as 
notifyGeoRestriction] 
(src/lib/moderation/geo-location-service.ts:265:29)
      at GeoLocationService.notifyGeoRestriction 
(src/lib/moderation/geo-location-service.ts:248:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ GeoLocationService ÔÇ║ applyGeoRestriction ÔÇ║ 
should expand EU region code to member states

    GeoLocationError: 
_supabase.supabase.from(...).select is not a function

    [0m [90m 526 |[39m
     [90m 527 |[39m     [36mconst[39m message 
[33m=[39m error [36minstanceof[39m [33mError[39m 
[33m?[39m error[33m.[39mmessage [33m:[39m 
[33mString[39m(error)[33m;[39m
    [31m[1m>[22m[39m[90m 528 |[39m     
[36mreturn[39m [36mnew[39m 
[33mGeoLocationError[39m(message[33m,[39m 
code[33m,[39m metadata)[33m;[39m
     [90m     |[39m            [31m[1m^[22m[39m
     [90m 529 |[39m   }
     [90m 530 |[39m }
     [90m 531 |[39m[0m

      at GeoLocationService.handleError 
(src/lib/moderation/geo-location-service.ts:528:12)
      at GeoLocationService.handleError 
(src/lib/moderation/geo-location-service.ts:312:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at GeoLocationService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at GeoLocationService.apply [as 
notifyGeoRestriction] 
(src/lib/moderation/geo-location-service.ts:265:29)
      at GeoLocationService.notifyGeoRestriction 
(src/lib/moderation/geo-location-service.ts:248:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/privacy/deletion-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ deletion-manager - deleteAccountInApp ÔÇ║ 
surfaces Supabase errors

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 2
    Received array:  [{"action": 
"account-delete-request", "details": {"deletionUrl": 
"https://growbro.app/delete-account", 
"estimatedCompletion": "2025-09-01T00:00:00Z", "jobId": 
"job-123", "reason": "test_reason", "source": 
"in_app"}, "hash": "44997610", "id": "1", "prevHash": 
"0", "t": 1768559128986}, {"action": 
"account-delete-request", "details": {"deletionUrl": 
"https://growbro.app/delete-account", "reason": 
"user_initiated_in_app", "source": "in_app"}, "hash": 
"369d5b11", "id": "2", "prevHash": "44997610", "t": 
1768559129013}]

    [0m [90m 87 |[39m
     [90m 88 |[39m     [36mconst[39m audit 
[33m=[39m [36mawait[39m getAuditLog()[33m;[39m
    [31m[1m>[22m[39m[90m 89 |[39m     expect(audit
)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m    |[39m                   
[31m[1m^[22m[39m
     [90m 90 |[39m     expect(audit[[35m0[39m][33m?
[39m[33m.[39mdetails)[33m.[39mtoEqual(
     [90m 91 |[39m       
expect[33m.[39mobjectContaining({ source[33m:[39m 
[32m'in_app'[39m })
     [90m 92 |[39m     )[33m;[39m[0m

      at Object.toHaveLength 
(src/lib/privacy/deletion-manager.test.ts:89:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ deletion-manager - data export and web deletion 
ÔÇ║ requestDeletionViaWeb queues deletion and audits 
web source

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 4
    Received array:  [{"action": 
"account-delete-request", "details": {"deletionUrl": 
"https://growbro.app/delete-account", 
"estimatedCompletion": "2025-09-01T00:00:00Z", "jobId": 
"job-123", "reason": "test_reason", "source": 
"in_app"}, "hash": "44997610", "id": "1", "prevHash": 
"0", "t": 1768559128986}, {"action": 
"account-delete-request", "details": {"deletionUrl": 
"https://growbro.app/delete-account", "reason": 
"user_initiated_in_app", "source": "in_app"}, "hash": 
"369d5b11", "id": "2", "prevHash": "44997610", "t": 
1768559129013}, {"action": "account-delete-request", 
"details": {"deletionUrl": 
"https://growbro.app/delete-account", 
"estimatedCompletion": "2025-09-01T00:00:00Z", "jobId": 
"job-123", "reason": "data_export_before_delete", 
"source": "in_app"}, "hash": "932b3f68", "id": "3", 
"prevHash": "369d5b11", "t": 1768559129201}, {"action": 
"account-delete-request", "details": {"deletionUrl": 
"https://growbro.app/delete-account", 
"estimatedCompletion": "2025-09-01T00:00:00Z", "jobId": 
"job-123", "reason": "web_self_service", "source": 
"web", "userId": "user-1"}, "hash": "2b305828", "id": 
"4", "prevHash": "932b3f68", "t": 1768559129223}]

    [0m [90m 131 |[39m
     [90m 132 |[39m     [36mconst[39m audit 
[33m=[39m [36mawait[39m getAuditLog()[33m;[39m
    [31m[1m>[22m[39m[90m 133 |[39m     expect(audi
t)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 134 |[39m     
expect(audit[[35m0[39m])[33m.[39mtoMatchObject({
     [90m 135 |[39m       details[33m:[39m 
expect[33m.[39mobjectContaining({
     [90m 136 |[39m         source[33m:[39m 
[32m'web'[39m[33m,[39m[0m

      at Object.toHaveLength 
(src/lib/privacy/deletion-manager.test.ts:133:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/watermelon-models/__tests__/favorite.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      [FavoriteModel] Failed to parse snapshot 
SyntaxError: "undefined" is not valid JSON
          at JSON.parse (<anonymous>)
          at FavoriteModel.parse (C:\Users\Peter\GrowBro
\src\lib\watermelon-models\favorite.ts:27:19)
          at Object.parsedSnapshot (C:\Users\Peter\GrowB
ro\src\lib\watermelon-models\__tests__\favorite.test.ts:
36:28)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 27 |[39m       [36mreturn[39m [33mJSO
N[39m[33m.[39mparse([36mthis[39m[33m.[39msnapshot
) [36mas[39m 
[33mFavoriteStrainSnapshot[39m[33m;[39m
     [90m 28 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 29 |[39m       
console[33m.[39merror([32m'[FavoriteModel] Failed to 
parse snapshot'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 30 |[39m       [90m// Return a safe 
default to prevent crashes[39m
     [90m 31 |[39m       [36mreturn[39m {
     [90m 32 |[39m         id[33m:[39m 
[36mthis[39m[33m.[39mstrainId[33m,[39m[0m

      at FavoriteModel.error 
(src/lib/watermelon-models/favorite.ts:29:15)
      at Object.parsedSnapshot (src/lib/watermelon-model
s/__tests__/favorite.test.ts:36:28)

  ÔùÅ FavoriteModel - parsedSnapshot ÔÇ║ parses valid 
JSON snapshot correctly

    expect(received).toEqual(expected) // deep equality

    - Expected  - 4
    + Received  + 5

      Object {
    -   "id": "strain-123",
    -   "imageUrl": "https://example.com/image.jpg",
    -   "name": "OG Kush",
    +   "id": undefined,
    +   "imageUrl": "",
    +   "name": "Unknown Strain",
        "race": "hybrid",
    -   "thc_display": "18-24%",
    +   "slug": "unknown",
    +   "thc_display": "Not reported",
      }

    [0m [90m 36 |[39m     [36mconst[39m snapshot 
[33m=[39m model[33m.[39mparsedSnapshot[33m;[39m
     [90m 37 |[39m
    [31m[1m>[22m[39m[90m 38 |[39m     
expect(snapshot)[33m.[39mtoEqual({
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 39 |[39m       id[33m:[39m 
[32m'strain-123'[39m[33m,[39m
     [90m 40 |[39m       name[33m:[39m [32m'OG 
Kush'[39m[33m,[39m
     [90m 41 |[39m       race[33m:[39m 
[32m'hybrid'[39m[33m,[39m[0m

      at Object.toEqual (src/lib/watermelon-models/__tes
ts__/favorite.test.ts:38:22)

  ÔùÅ FavoriteModel - parsedSnapshot ÔÇ║ returns safe 
default on invalid JSON

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 2

      Object {
    -   "id": "strain-123",
    +   "id": undefined,
        "imageUrl": "",
        "name": "Unknown Strain",
        "race": "hybrid",
    +   "slug": "unknown",
        "thc_display": "Not reported",
      }

    [0m [90m 61 |[39m     [36mconst[39m snapshot 
[33m=[39m model[33m.[39mparsedSnapshot[33m;[39m
     [90m 62 |[39m
    [31m[1m>[22m[39m[90m 63 |[39m     
expect(snapshot)[33m.[39mtoEqual({
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 64 |[39m       id[33m:[39m 
[32m'strain-123'[39m[33m,[39m
     [90m 65 |[39m       name[33m:[39m 
[32m'Unknown Strain'[39m[33m,[39m
     [90m 66 |[39m       race[33m:[39m 
[32m'hybrid'[39m[33m,[39m[0m

      at Object.toEqual (src/lib/watermelon-models/__tes
ts__/favorite.test.ts:63:22)

  ÔùÅ FavoriteModel - needsSync ÔÇ║ returns false when 
syncedAt is after updatedAt

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 121 |[39m     })[33m;[39m
     [90m 122 |[39m
    [31m[1m>[22m[39m[90m 123 |[39m     expect(mode
l[33m.[39mneedsSync)[33m.[39mtoBe([36mfalse[39m)[
33m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 124 |[39m   })[33m;[39m
     [90m 125 |[39m })[33m;[39m
     [90m 126 |[39m[0m

      at Object.toBe (src/lib/watermelon-models/__tests_
_/favorite.test.ts:123:29)

FAIL src/lib/watermelon-models/notification-preference.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ NotificationPreferenceModel ÔÇ║ findOrCreate ÔÇ║ 
returns existing record

    TypeError: Cannot read properties of undefined 
(reading 'fetch')

    [0m [90m 48 |[39m     it([32m'returns existing 
record'[39m[33m,[39m [36masync[39m () [33m=>[39m 
{
     [90m 49 |[39m       [36mconst[39m existing 
[33m=[39m { id[33m:[39m [32m'1'[39m[33m,[39m 
userId[33m:[39m [32m'user-123'[39m }[33m;[39m
    [31m[1m>[22m[39m[90m 50 |[39m       mockCollec
tion[33m.[39mfetch[33m.[39mmockResolvedValue([existi
ng])[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 51 |[39m
     [90m 52 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m [33mNotificationPreferenceM
odel[39m[33m.[39mfindOrCreate(
     [90m 53 |[39m         mockDatabase [36mas[39m 
any[33m,[39m[0m

      at Object.fetch (src/lib/watermelon-models/notific
ation-preference.test.ts:50:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationPreferenceModel ÔÇ║ findOrCreate ÔÇ║ 
creates new record with defaults

    TypeError: Cannot read properties of undefined 
(reading 'fetch')

    [0m [90m 60 |[39m     it([32m'creates new 
record with defaults'[39m[33m,[39m [36masync[39m 
() [33m=>[39m {
     [90m 61 |[39m       [36mconst[39m created 
[33m=[39m { id[33m:[39m [32m'2'[39m[33m,[39m 
userId[33m:[39m [32m'user-123'[39m }[33m;[39m
    [31m[1m>[22m[39m[90m 62 |[39m       mockCollec
tion[33m.[39mfetch[33m.[39mmockResolvedValue([])[33
m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 63 |[39m       mockCollection[33m.[39mcrea
te[33m.[39mmockResolvedValue(created)[33m;[39m
     [90m 64 |[39m
     [90m 65 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m [33mNotificationPreferenceM
odel[39m[33m.[39mfindOrCreate([0m

      at Object.fetch (src/lib/watermelon-models/notific
ation-preference.test.ts:62:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationPreferenceModel ÔÇ║ findOrCreate ÔÇ║ 
creates new record with custom defaults

    TypeError: Cannot read properties of undefined 
(reading 'fetch')

    [0m [90m 74 |[39m     it([32m'creates new 
record with custom defaults'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {
     [90m 75 |[39m       [36mconst[39m created 
[33m=[39m { id[33m:[39m [32m'3'[39m[33m,[39m 
userId[33m:[39m [32m'user-456'[39m }[33m;[39m
    [31m[1m>[22m[39m[90m 76 |[39m       mockCollec
tion[33m.[39mfetch[33m.[39mmockResolvedValue([])[33
m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 77 |[39m       mockCollection[33m.[39mcrea
te[33m.[39mmockResolvedValue(created)[33m;[39m
     [90m 78 |[39m
     [90m 79 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m [33mNotificationPreferenceM
odel[39m[33m.[39mfindOrCreate([0m

      at Object.fetch (src/lib/watermelon-models/notific
ation-preference.test.ts:76:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationPreferenceModel ÔÇ║ upsert ÔÇ║ is an 
alias for findOrCreate

    TypeError: Cannot read properties of undefined 
(reading 'fetch')

    [0m [90m 92 |[39m     it([32m'is an alias for 
findOrCreate'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m 93 |[39m       [36mconst[39m existing 
[33m=[39m { id[33m:[39m [32m'4'[39m[33m,[39m 
userId[33m:[39m [32m'user-789'[39m }[33m;[39m
    [31m[1m>[22m[39m[90m 94 |[39m       mockCollec
tion[33m.[39mfetch[33m.[39mmockResolvedValue([existi
ng])[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 95 |[39m
     [90m 96 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
[33mNotificationPreferenceModel[39m[33m.[39mupsert(
     [90m 97 |[39m         mockDatabase [36mas[39m 
any[33m,[39m[0m

      at Object.fetch (src/lib/watermelon-models/notific
ation-preference.test.ts:94:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationPreferenceModel ÔÇ║ concurrent 
operations ÔÇ║ handles concurrent calls

    TypeError: Cannot read properties of undefined 
(reading 'fetch')

    [0m [90m 107 |[39m   describe([32m'concurrent 
operations'[39m[33m,[39m () [33m=>[39m {
     [90m 108 |[39m     it([32m'handles concurrent 
calls'[39m[33m,[39m [36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 109 |[39m       mockColle
ction[33m.[39mfetch[33m.[39mmockResolvedValueOnce([]
)[33m;[39m
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 110 |[39m       mockCollection[33m.[39mcre
ate[33m.[39mmockResolvedValue({
     [90m 111 |[39m         id[33m:[39m 
[32m'5'[39m[33m,[39m
     [90m 112 |[39m         userId[33m:[39m 
[32m'concurrent'[39m[33m,[39m[0m

      at Object.fetch (src/lib/watermelon-models/notific
ation-preference.test.ts:109:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationPreferenceModel ÔÇ║ concurrent 
operations ÔÇ║ uses write transaction

    TypeError: Cannot read properties of undefined 
(reading 'fetch')

    [0m [90m 135 |[39m     it([32m'uses write 
transaction'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m 136 |[39m       [36mconst[39m existing 
[33m=[39m { id[33m:[39m [32m'7'[39m[33m,[39m 
userId[33m:[39m [32m'transaction'[39m }[33m;[39m
    [31m[1m>[22m[39m[90m 137 |[39m       mockColle
ction[33m.[39mfetch[33m.[39mmockResolvedValue([exist
ing])[33m;[39m
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 138 |[39m
     [90m 139 |[39m       [36mawait[39m [33mNotific
ationPreferenceModel[39m[33m.[39mfindOrCreate(
     [90m 140 |[39m         mockDatabase [36mas[39m 
any[33m,[39m[0m

      at Object.fetch (src/lib/watermelon-models/notific
ation-preference.test.ts:137:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/privacy/consent-service.getConsents.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ ConsentService.getConsents ÔÇ║ returns stored 
consent when version matches

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 2

      Object {
    -   "aiTraining": true,
    +   "aiTraining": false,
        "cloudProcessing": false,
        "crashDiagnostics": false,
        "experiments": false,
        "locale": Any<String>,
    -   "telemetry": true,
    +   "telemetry": false,
        "timestamp": Any<String>,
        "version": "2025-09-01",
      }

    [0m [90m 52 |[39m
     [90m 53 |[39m     [90m// Should return the 
stored consent values, but with updated locale and 
timestamp[39m
    [31m[1m>[22m[39m[90m 54 |[39m     
expect(result)[33m.[39mtoEqual({
     [90m    |[39m                    
[31m[1m^[22m[39m
     [90m 55 |[39m       
[33m...[39mstoredConsent[33m,[39m
     [90m 56 |[39m       timestamp[33m:[39m 
expect[33m.[39many([33mString[39m)[33m,[39m 
[90m// timestamp gets updated to current time[39m
     [90m 57 |[39m       locale[33m:[39m 
expect[33m.[39many([33mString[39m)[33m,[39m 
[90m// locale gets updated to current locale[39m[0m

      at Object.toEqual (src/lib/privacy/consent-service
.getConsents.test.ts:54:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ConsentService.getConsents - versioning ÔÇ║ 
clears and returns fresh defaults when stored version 
is outdated

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "2025-09-01"
    Received: "2024-01-01"

    [0m [90m  95 |[39m     [90m// Should have 
cleared the old data from storage[39m
     [90m  96 |[39m     [36mconst[39m stored 
[33m=[39m [36mawait[39m getSecureConfig[33m<[39m[
33mConsentState[39m[33m>[39m([33mCONSENT_KEY[39m)[
33m;[39m
    [31m[1m>[22m[39m[90m  97 |[39m     expect(stor
ed[33m?[39m[33m.[39mversion)[33m.[39mtoBe([33mCUR
RENT_CONSENT_VERSION[39m)[33m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m  98 |[39m     expect(stored[33m?[39m[33m.
[39mtelemetry)[33m.[39mtoBe([36mfalse[39m)[33m;[3
9m
     [90m  99 |[39m   })[33m;[39m
     [90m 100 |[39m })[33m;[39m[0m

      at Object.toBe (src/lib/privacy/consent-service.ge
tConsents.test.ts:97:29)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/notifications/notification-badge.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ notification-badge ÔÇ║ sanitizes badge counts

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     
setBadgeCountAsync[33m:[39m 
setBadgeCountMock[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mreturn[39m [36mimport[39m([32m'@/lib/notificati
ons/notification-badge'[39m)[33m;[39m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m  8 |[39m }
     [90m  9 |[39m
     [90m 10 |[39m 
describe([32m'notification-badge'[39m[33m,[39m () 
[33m=>[39m {[0m

      at 
src/lib/notifications/notification-badge.test.ts:7:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/notification-badge.test.ts:8:2)
      at apply 
(src/lib/notifications/notification-badge.test.ts:3:28)
      at Object.importModule 
(src/lib/notifications/notification-badge.test.ts:17:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ notification-badge ÔÇ║ updates badge count with 
sanitized value

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     
setBadgeCountAsync[33m:[39m 
setBadgeCountMock[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mreturn[39m [36mimport[39m([32m'@/lib/notificati
ons/notification-badge'[39m)[33m;[39m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m  8 |[39m }
     [90m  9 |[39m
     [90m 10 |[39m 
describe([32m'notification-badge'[39m[33m,[39m () 
[33m=>[39m {[0m

      at 
src/lib/notifications/notification-badge.test.ts:7:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/notification-badge.test.ts:3:28)
      at Object.importModule 
(src/lib/notifications/notification-badge.test.ts:26:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ notification-badge ÔÇ║ logs warning when update 
fails

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     
setBadgeCountAsync[33m:[39m 
setBadgeCountMock[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mreturn[39m [36mimport[39m([32m'@/lib/notificati
ons/notification-badge'[39m)[33m;[39m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m  8 |[39m }
     [90m  9 |[39m
     [90m 10 |[39m 
describe([32m'notification-badge'[39m[33m,[39m () 
[33m=>[39m {[0m

      at 
src/lib/notifications/notification-badge.test.ts:7:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/notification-badge.test.ts:3:28)
      at Object.importModule 
(src/lib/notifications/notification-badge.test.ts:36:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/strains/parse-percentage.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ parsePercentageRange ÔÇ║ edge cases ÔÇ║ handles 
empty string

    expect(received).toEqual(expected) // deep equality

    - Expected  - 3
    + Received  + 1

    - Object {
    -   "label": "",
    - }
    + Object {}

    [0m[0m

      at Object.<anonymous> 
(src/lib/strains/parse-percentage.test.ts:87:60)

FAIL src/lib/strains/generate-id.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ generateId ÔÇ║ generates unique IDs

    expect(received).toMatch(expected)

    Expected pattern: /^strain:[0-9a-f]{8}-[0-9a-f]{4}-[
0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/
    Received string:  "strain_1768559137408_jx42u3"

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mimport[39m { generateId } 
[36mfrom[39m [32m'./normalization'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 6 |[39m
     [90m   |[39m [31m[1m^[22m[39m
     [90m 7 |[39m 
describe([32m'generateId'[39m[33m,[39m () 
[33m=>[39m {
     [90m 8 |[39m   test([32m'generates unique 
IDs'[39m[33m,[39m () [33m=>[39m {
     [90m 9 |[39m     [36mconst[39m id1 [33m=[39m 
generateId()[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/strains/generate-id.test.ts:6:17)

PASS src/lib/__tests__/sync-coordinator.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      [SyncCoordinator] Image queue processing error: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\sync\sync-co
ordinator.ts:43:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\sync\
sync-coordinator.ts:53:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\sync\
sync-coordinator.ts:41:42)
          at processImageQueueAfterSync (C:\Users\Peter\
GrowBro\src\lib\sync\sync-coordinator.ts:199:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 49 |[39m     }
     [90m 50 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 51 |[39m     
console[33m.[39mwarn([32m'[SyncCoordinator] Image 
queue processing error:'[39m[33m,[39m 
error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 52 |[39m   }
     [90m 53 |[39m }
     [90m 54 |[39m[0m

      at warn (src/lib/sync/sync-coordinator.ts:51:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [SyncCoordinator] Plant photo sync error: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\sync\sync-co
ordinator.ts:61:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\sync\
sync-coordinator.ts:96:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\sync\
sync-coordinator.ts:59:51)
          at downloadMissingPlantPhotosAfterSync (C:\Use
rs\Peter\GrowBro\src\lib\sync\sync-coordinator.ts:204:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 92 |[39m     }
     [90m 93 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 94 |[39m     
console[33m.[39mwarn([32m'[SyncCoordinator] Plant 
photo sync error:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 95 |[39m   }
     [90m 96 |[39m }
     [90m 97 |[39m[0m

      at warn (src/lib/sync/sync-coordinator.ts:94:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [SyncCoordinator] Plant sync error: TypeError: A 
dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\sync\sync-co
ordinator.ts:104:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\sync\
sync-coordinator.ts:111:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\sync\
sync-coordinator.ts:102:35)
          at syncPlantsAfterSync (C:\Users\Peter\GrowBro
\src\lib\sync\sync-coordinator.ts:228:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 107 |[39m     [36mawait[39m 
syncPlantsBidirectional()[33m;[39m
     [90m 108 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 109 |[39m     
console[33m.[39mwarn([32m'[SyncCoordinator] Plant 
sync error:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 110 |[39m   }
     [90m 111 |[39m }
     [90m 112 |[39m[0m

      at warn (src/lib/sync/sync-coordinator.ts:109:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [SyncCoordinator] Image queue processing error: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\sync\sync-co
ordinator.ts:43:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\sync\
sync-coordinator.ts:41:42)
          at processImageQueueAfterSync (C:\Users\Peter\
GrowBro\src\lib\sync\sync-coordinator.ts:199:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 49 |[39m     }
     [90m 50 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 51 |[39m     
console[33m.[39mwarn([32m'[SyncCoordinator] Image 
queue processing error:'[39m[33m,[39m 
error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 52 |[39m   }
     [90m 53 |[39m }
     [90m 54 |[39m[0m

      at warn (src/lib/sync/sync-coordinator.ts:51:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [SyncCoordinator] Plant photo sync error: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\sync\sync-co
ordinator.ts:61:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\sync\
sync-coordinator.ts:59:51)
          at downloadMissingPlantPhotosAfterSync (C:\Use
rs\Peter\GrowBro\src\lib\sync\sync-coordinator.ts:204:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 92 |[39m     }
     [90m 93 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 94 |[39m     
console[33m.[39mwarn([32m'[SyncCoordinator] Plant 
photo sync error:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 95 |[39m   }
     [90m 96 |[39m }
     [90m 97 |[39m[0m

      at warn (src/lib/sync/sync-coordinator.ts:94:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [SyncCoordinator] Plant sync error: TypeError: A 
dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\sync\sync-co
ordinator.ts:104:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\sync\
sync-coordinator.ts:102:35)
          at syncPlantsAfterSync (C:\Users\Peter\GrowBro
\src\lib\sync\sync-coordinator.ts:228:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 107 |[39m     [36mawait[39m 
syncPlantsBidirectional()[33m;[39m
     [90m 108 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 109 |[39m     
console[33m.[39mwarn([32m'[SyncCoordinator] Plant 
sync error:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 110 |[39m   }
     [90m 111 |[39m }
     [90m 112 |[39m[0m

      at warn (src/lib/sync/sync-coordinator.ts:109:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [SyncCoordinator] Image queue processing error: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\sync\sync-co
ordinator.ts:43:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\sync\
sync-coordinator.ts:41:42)
          at processImageQueueAfterSync (C:\Users\Peter\
GrowBro\src\lib\sync\sync-coordinator.ts:199:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 49 |[39m     }
     [90m 50 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 51 |[39m     
console[33m.[39mwarn([32m'[SyncCoordinator] Image 
queue processing error:'[39m[33m,[39m 
error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 52 |[39m   }
     [90m 53 |[39m }
     [90m 54 |[39m[0m

      at warn (src/lib/sync/sync-coordinator.ts:51:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [SyncCoordinator] Plant photo sync error: 
TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\sync\sync-co
ordinator.ts:61:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\sync\
sync-coordinator.ts:59:51)
          at downloadMissingPlantPhotosAfterSync (C:\Use
rs\Peter\GrowBro\src\lib\sync\sync-coordinator.ts:204:5)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 92 |[39m     }
     [90m 93 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 94 |[39m     
console[33m.[39mwarn([32m'[SyncCoordinator] Plant 
photo sync error:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 95 |[39m   }
     [90m 96 |[39m }
     [90m 97 |[39m[0m

      at warn (src/lib/sync/sync-coordinator.ts:94:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [SyncCoordinator] Plant sync error: TypeError: A 
dynamic import callback was invoked without 
--experimental-vm-modules
          at importModuleDynamicallyCallback 
(node:internal/modules/esm/utils:264:11)
          at C:\Users\Peter\GrowBro\src\lib\sync\sync-co
ordinator.ts:104:5
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\sync\
sync-coordinator.ts:102:35)
          at syncPlantsAfterSync (C:\Users\Peter\GrowBro
\src\lib\sync\sync-coordinator.ts:228:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9) {
        code: 
'ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING_FLAG'
      }

    [0m [90m 107 |[39m     [36mawait[39m 
syncPlantsBidirectional()[33m;[39m
     [90m 108 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 109 |[39m     
console[33m.[39mwarn([32m'[SyncCoordinator] Plant 
sync error:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 110 |[39m   }
     [90m 111 |[39m }
     [90m 112 |[39m[0m

      at warn (src/lib/sync/sync-coordinator.ts:109:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS src/lib/harvest/inventory-service.test.ts (12.883 
s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.log
      [InventoryService] Retry attempt 2/3 after 1000ms

      at log 
(src/lib/harvest/inventory-service.ts:249:15)

    console.log
      [InventoryService] Retry attempt 3/3 after 2000ms

      at log 
(src/lib/harvest/inventory-service.ts:249:15)

    console.log
      [InventoryService] Retry attempt 2/3 after 1000ms

      at log 
(src/lib/harvest/inventory-service.ts:249:15)

    console.log
      [InventoryService] Retry attempt 3/3 after 2000ms

      at log 
(src/lib/harvest/inventory-service.ts:249:15)

    console.log
      [InventoryService] Retry attempt 2/3 after 1000ms

      at log 
(src/lib/harvest/inventory-service.ts:249:15)
          at Generator.throw (<anonymous>)

    console.log
      [InventoryService] Retry attempt 3/3 after 2000ms

      at log 
(src/lib/harvest/inventory-service.ts:249:15)
          at Generator.throw (<anonymous>)

    console.log
      [InventoryService] Retry attempt 2/3 after 1000ms

      at log 
(src/lib/harvest/inventory-service.ts:249:15)
          at Generator.throw (<anonymous>)

    console.log
      [InventoryService] Retry attempt 3/3 after 2000ms

      at log 
(src/lib/harvest/inventory-service.ts:249:15)
          at Generator.throw (<anonymous>)

    console.error
      [InventoryService] Failed to update local state: 
Error: DB write failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\harvest\inventory-service.test.ts:513:30)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 302 |[39m     })[33m;[39m
     [90m 303 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 304 |[39m     
console[33m.[39merror([32m'[InventoryService] Failed 
to update local state:'[39m[33m,[39m 
error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 305 |[39m     [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 306 |[39m   }
     [90m 307 |[39m }[0m

      at error 
(src/lib/harvest/inventory-service.ts:304:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [InventoryService] Local state update failed

    [0m [90m 348 |[39m
     [90m 349 |[39m   [36mif[39m 
([33m![39mlocalState) {
    [31m[1m>[22m[39m[90m 350 |[39m     
console[33m.[39mwarn([32m'[InventoryService] Local 
state update failed'[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 351 |[39m     [36mreturn[39m {
     [90m 352 |[39m       success[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 353 |[39m       harvest[33m:[39m 
[36mnull[39m[33m,[39m[0m

      at warn 
(src/lib/harvest/inventory-service.ts:350:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [InventoryService] Failed to get inventory: 
Error: DB error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\harvest\inventory-service.test.ts:585:15)
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:397:39
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\jest-mock\build\index.js:404:13)
          at Object.mockConstructor [as get] (C:\Users\P
eter\GrowBro\node_modules\jest-mock\build\index.js:103:1
9)
          at Object.get (C:\Users\Peter\GrowBro\src\lib\
harvest\inventory-service.ts:425:42)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply [as getInventoryByHarvestId] (
C:\Users\Peter\GrowBro\src\lib\harvest\inventory-service
.ts:421:46)
          at Object.getInventoryByHarvestId (C:\Users\Pe
ter\GrowBro\src\lib\harvest\inventory-service.test.ts:58
9:32)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 430 |[39m     [36mreturn[39m 
inventories[[35m0[39m] [33m?[39m[33m?[39m 
[36mnull[39m[33m;[39m
     [90m 431 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 432 |[39m     
console[33m.[39merror([32m'[InventoryService] Failed 
to get inventory:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 433 |[39m     [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 434 |[39m   }
     [90m 435 |[39m }[0m

      at Object.error 
(src/lib/harvest/inventory-service.ts:432:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as getInventoryByHarvestId] 
(src/lib/harvest/inventory-service.ts:421:46)
      at Object.getInventoryByHarvestId 
(src/lib/harvest/inventory-service.test.ts:589:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

PASS src/lib/moderation/sor-circuit-breaker.test.ts 
(10.86 s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      Circuit breaker transition: CLOSED -> OPEN at 
2026-01-16T10:25:55.789Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)
          at Generator.throw (<anonymous>)

    console.log
      Circuit breaker transition: CLOSED -> OPEN at 
2026-01-16T10:25:55.805Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)
          at Generator.throw (<anonymous>)

    console.log
      Circuit breaker transition: CLOSED -> OPEN at 
2026-01-16T10:25:55.813Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)
          at Generator.throw (<anonymous>)

    console.log
      Circuit breaker transition: OPEN -> HALF_OPEN at 
2026-01-16T10:25:57.929Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)

    console.log
      Circuit breaker transition: CLOSED -> OPEN at 
2026-01-16T10:25:57.933Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)
          at Generator.throw (<anonymous>)

    console.log
      Circuit breaker transition: OPEN -> HALF_OPEN at 
2026-01-16T10:26:00.037Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)

    console.log
      Circuit breaker transition: HALF_OPEN -> OPEN at 
2026-01-16T10:26:00.038Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)
          at Generator.throw (<anonymous>)

    console.log
      Circuit breaker transition: CLOSED -> OPEN at 
2026-01-16T10:26:00.039Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)
          at Generator.throw (<anonymous>)

    console.log
      Circuit breaker transition: OPEN -> HALF_OPEN at 
2026-01-16T10:26:02.146Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)

    console.log
      Circuit breaker transition: HALF_OPEN -> CLOSED 
at 2026-01-16T10:26:02.148Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)

    console.log
      Circuit breaker transition: CLOSED -> OPEN at 
2026-01-16T10:26:02.150Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)
          at Generator.throw (<anonymous>)

    console.log
      Circuit breaker transition: OPEN -> HALF_OPEN at 
2026-01-16T10:26:04.259Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)

    console.log
      Circuit breaker transition: HALF_OPEN -> CLOSED 
at 2026-01-16T10:26:04.259Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)

    console.log
      Circuit breaker transition: CLOSED -> OPEN at 
2026-01-16T10:26:06.372Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)

    console.log
      Circuit breaker transition: OPEN -> CLOSED at 
2026-01-16T10:26:06.373Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)

    console.log
      Circuit breaker transition: CLOSED -> OPEN at 
2026-01-16T10:26:06.374Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)

    console.log
      Circuit breaker transition: CLOSED -> OPEN at 
2026-01-16T10:26:06.375Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)

    console.log
      Circuit breaker transition: OPEN -> CLOSED at 
2026-01-16T10:26:06.375Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)

    console.log
      Circuit breaker transition: CLOSED -> OPEN at 
2026-01-16T10:26:06.387Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)
          at Generator.throw (<anonymous>)

    console.error
      Error in circuit breaker state change listener: 
Error: Listener failed
          at C:\Users\Peter\GrowBro\src\lib\moderation\s
or-circuit-breaker.test.ts:265:15
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:397:39
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:404:13
          at mockConstructor (C:\Users\Peter\GrowBro\nod
e_modules\jest-mock\build\index.js:148:19)
          at listener (C:\Users\Peter\GrowBro\src\lib\mo
deration\sor-circuit-breaker.ts:273:9)
          at Array.forEach (<anonymous>)
          at CircuitBreaker.forEach [as 
notifyStateChange] (C:\Users\Peter\GrowBro\src\lib\moder
ation\sor-circuit-breaker.ts:271:31)
          at CircuitBreaker.notifyStateChange [as 
transitionTo] (C:\Users\Peter\GrowBro\src\lib\moderation
\sor-circuit-breaker.ts:171:10)
          at CircuitBreaker.transitionTo [as onFailure] 
(C:\Users\Peter\GrowBro\src\lib\moderation\sor-circuit-b
reaker.ts:149:14)
          at CircuitBreaker.onFailure (C:\Users\Peter\Gr
owBro\src\lib\moderation\sor-circuit-breaker.ts:113:12)
          at Generator.throw (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _throw (C:\Users\Peter\GrowBro\node_modules
\@babel\runtime\helpers\asyncToGenerator.js:20:9)

    [0m [90m 273 |[39m         
listener(state)[33m;[39m
     [90m 274 |[39m       } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 275 |[39m         
console[33m.[39merror([32m'Error in circuit breaker 
state change listener:'[39m[33m,[39m 
error)[33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 276 |[39m       }
     [90m 277 |[39m     })[33m;[39m
     [90m 278 |[39m   }[0m

      at error 
(src/lib/moderation/sor-circuit-breaker.ts:275:17)
          at Array.forEach (<anonymous>)
      at CircuitBreaker.forEach [as notifyStateChange] 
(src/lib/moderation/sor-circuit-breaker.ts:271:31)
      at CircuitBreaker.notifyStateChange [as 
transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:171:10)
      at CircuitBreaker.transitionTo [as onFailure] 
(src/lib/moderation/sor-circuit-breaker.ts:149:14)
      at CircuitBreaker.onFailure 
(src/lib/moderation/sor-circuit-breaker.ts:113:12)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      Circuit breaker transition: CLOSED -> OPEN at 
2026-01-16T10:26:06.390Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)
          at Generator.throw (<anonymous>)

    console.log
      Circuit breaker transition: CLOSED -> OPEN at 
2026-01-16T10:26:06.396Z

      at CircuitBreaker.log [as transitionTo] 
(src/lib/moderation/sor-circuit-breaker.ts:173:13)
          at Generator.throw (<anonymous>)

PASS src/lib/compliance/activation-state.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/quality/analyzers/__tests__/composition.test.ts 
(5.603 s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/components/onboarding/slide-container.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/assessment/__tests__/batch-processor.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/api/strains/use-strain.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/quality/analyzers/__tests__/exposure.test.ts 
(11.181 s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/utils/levenshtein.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/components/ui/select.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.log
      [auth] onAuthStateChange INITIAL_SESSION false

      at log (src/lib/auth/index.tsx:404:13)

PASS src/lib/database/__tests__/unsafe-sql-utils.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/api/strains/use-strains-infinite.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.log
      [auth] onAuthStateChange INITIAL_SESSION false

      at log (src/lib/auth/index.tsx:404:13)

    console.info
      [useStrainsInfiniteWithCache] Supabase fetch 
failed, falling back to API Error: supabase failure
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\api\strains\use-strains-infinite.test.tsx:408:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

      at info (src/api/strains/use-strains-infinite-with
-cache.ts:151:17)
          at Generator.throw (<anonymous>)

PASS src/app/__tests__/age-gate-guard.test.tsx (5.996 s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/privacy/telemetry-client.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/nutrient-engine/services/reservoir-event-se
rvice.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/api/auth/use-sessions.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/hooks/use-plant-attention.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

PASS src/lib/moderation/appeals-queue.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.error
      [AppealsQueue] Failed to submit appeal 
FoXyWzBMPC: API error

    [0m [90m 194 |[39m     })[33m;[39m
     [90m 195 |[39m     [36mif[39m 
([33m![39mresult[33m.[39msuccess) {
    [31m[1m>[22m[39m[90m 196 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 197 |[39m         [32m`[AppealsQueue] 
Failed to submit appeal ${item.id}:`[39m[33m,[39m
     [90m 198 |[39m         result[33m.[39merror
     [90m 199 |[39m       )[33m;[39m[0m

      at AppealsQueue.error 
(src/lib/moderation/appeals-queue.ts:196:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [AppealsQueue] Failed to submit appeal 
FoXyWzBMPC: API error

    [0m [90m 194 |[39m     })[33m;[39m
     [90m 195 |[39m     [36mif[39m 
([33m![39mresult[33m.[39msuccess) {
    [31m[1m>[22m[39m[90m 196 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 197 |[39m         [32m`[AppealsQueue] 
Failed to submit appeal ${item.id}:`[39m[33m,[39m
     [90m 198 |[39m         result[33m.[39merror
     [90m 199 |[39m       )[33m;[39m[0m

      at AppealsQueue.error 
(src/lib/moderation/appeals-queue.ts:196:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [AppealsQueue] Failed to submit appeal 
FoXyWzBMPC: API error

    [0m [90m 194 |[39m     })[33m;[39m
     [90m 195 |[39m     [36mif[39m 
([33m![39mresult[33m.[39msuccess) {
    [31m[1m>[22m[39m[90m 196 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 197 |[39m         [32m`[AppealsQueue] 
Failed to submit appeal ${item.id}:`[39m[33m,[39m
     [90m 198 |[39m         result[33m.[39merror
     [90m 199 |[39m       )[33m;[39m[0m

      at AppealsQueue.error 
(src/lib/moderation/appeals-queue.ts:196:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [AppealsQueue] Failed to submit appeal 
FoXyWzBMPC: API error

    [0m [90m 194 |[39m     })[33m;[39m
     [90m 195 |[39m     [36mif[39m 
([33m![39mresult[33m.[39msuccess) {
    [31m[1m>[22m[39m[90m 196 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 197 |[39m         [32m`[AppealsQueue] 
Failed to submit appeal ${item.id}:`[39m[33m,[39m
     [90m 198 |[39m         result[33m.[39merror
     [90m 199 |[39m       )[33m;[39m[0m

      at AppealsQueue.error 
(src/lib/moderation/appeals-queue.ts:196:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      [AppealsQueue] Failed to submit appeal FoXyWzBMPC 
after all retries: Error: API error
          at AppealsQueue.<anonymous> (C:\Users\Peter\Gr
owBro\src\lib\moderation\appeals-queue.ts:200:13)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 163 |[39m     } [36mcatch[39m 
(_error) {
     [90m 164 |[39m       [90m// All retry attempts 
exhausted - persist failure status[39m
    [31m[1m>[22m[39m[90m 165 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 166 |[39m         [32m`[AppealsQueue] 
Failed to submit appeal ${item.id} after all 
retries:`[39m[33m,[39m
     [90m 167 |[39m         _error
     [90m 168 |[39m       )[33m;[39m[0m

      at AppealsQueue.error 
(src/lib/moderation/appeals-queue.ts:165:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS src/lib/moderation/moderation-queue.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

PASS src/lib/nutrient-engine/services/source-water-profi
le-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/sync/__tests__/exponential-backoff.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/strains/normalize-complete.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/harvest/weight-conversion.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/notifications/use-notification-analytics.te
st.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

PASS src/lib/community/__tests__/cache-adapter.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

PASS src/components/ui/input.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/assessment/__tests__/inference-coordinator.
test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.log
      [InferenceCoordinator] Device inference failed, 
falling back to cloud (8000ms remaining)

      at log 
(src/lib/assessment/inference-coordinator.ts:65:21)
          at Generator.throw (<anonymous>)

    console.error
      [InferenceCoordinator] Inference failed after 
0ms: {
        code: 'MISSING_PARAMETERS',
        message: 'Cloud inference requires plantContext 
and assessmentId',
        category: 'validation',
        retryable: false,
        fallbackToCloud: false
      }

    [0m [90m  96 |[39m   } [36mcatch[39m (error) {
     [90m  97 |[39m     [36mconst[39m elapsedMs 
[33m=[39m [33mDate[39m[33m.[39mnow() [33m-[39m 
startTime[33m;[39m
    [31m[1m>[22m[39m[90m  98 |[39m     
console[33m.[39merror(
     [90m     |[39m             [31m[1m^[22m[39m
     [90m  99 |[39m       
[32m`[InferenceCoordinator] Inference failed after 
${elapsedMs}ms:`[39m[33m,[39m
     [90m 100 |[39m       error
     [90m 101 |[39m     )[33m;[39m[0m

      at error 
(src/lib/assessment/inference-coordinator.ts:98:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS src/lib/auth/__tests__/settings-deep-links.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

PASS src/lib/playbooks/analytics/__tests__/notification-
metrics.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      [NotificationMetrics] Delivered notification not 
found in scheduled: unknown-notif

    [0m [90m 67 |[39m     [36mconst[39m scheduled 
[33m=[39m [36mthis[39m[33m.[39mscheduledNotificati
ons[33m.[39m[36mget[39m(notificationId)[33m;[39m
     [90m 68 |[39m     [36mif[39m 
([33m![39mscheduled) {
    [31m[1m>[22m[39m[90m 69 |[39m       
console[33m.[39mwarn(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 70 |[39m         
[32m'[NotificationMetrics] Delivered notification not 
found in scheduled:'[39m[33m,[39m
     [90m 71 |[39m         notificationId
     [90m 72 |[39m       )[33m;[39m[0m

      at NotificationMetricsTracker.warn [as 
trackDelivered] (src/lib/playbooks/analytics/notificatio
n-metrics.ts:69:15)
      at Object.trackDelivered (src/lib/playbooks/analyt
ics/__tests__/notification-metrics.test.ts:95:27)

    console.log
      [NotificationMetrics] Summary: {
        totalScheduled: 0,
        totalDelivered: 0,
        totalMissed: 0,
        deliveryRate: 0,
        averageDelayMs: 0,
        lastCalculated: 1768559214905
      }

      at NotificationMetricsTracker.log [as 
emitSummary] (src/lib/playbooks/analytics/notification-m
etrics.ts:157:13)

    console.log
      [NotificationMetrics] Summary: {
        totalScheduled: 0,
        totalDelivered: 0,
        totalMissed: 0,
        deliveryRate: 0,
        averageDelayMs: 0,
        lastCalculated: 1768559214906
      }

      at NotificationMetricsTracker.log [as 
emitSummary] (src/lib/playbooks/analytics/notification-m
etrics.ts:157:13)

    console.log
      [NotificationMetrics] Cleaned up old scheduled: 1

      at NotificationMetricsTracker.log [as 
cleanupOldScheduled] (src/lib/playbooks/analytics/notifi
cation-metrics.ts:198:15)

PASS src/lib/nutrient-engine/services/calendar-integrati
on-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.warn
      Failed to schedule notification for task task-1: 
Error: Notification error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\nutrient-engine\services\calendar-integration-se
rvice.test.ts:197:28)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 122 |[39m         } [36mcatch[39m 
(notificationError) {
     [90m 123 |[39m           [90m// Log but don't 
fail if notification scheduling fails[39m
    [31m[1m>[22m[39m[90m 124 |[39m           
console[33m.[39mwarn(
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 125 |[39m             [32m`Failed to 
schedule notification for task 
${task.id}:`[39m[33m,[39m
     [90m 126 |[39m             notificationError
     [90m 127 |[39m           )[33m;[39m[0m

      at warn (src/lib/nutrient-engine/services/calendar
-integration-service.ts:124:19)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Failed to schedule notification for task task-1: 
Error: Notification error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\nutrient-engine\services\calendar-integration-se
rvice.test.ts:197:28)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 122 |[39m         } [36mcatch[39m 
(notificationError) {
     [90m 123 |[39m           [90m// Log but don't 
fail if notification scheduling fails[39m
    [31m[1m>[22m[39m[90m 124 |[39m           
console[33m.[39mwarn(
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 125 |[39m             [32m`Failed to 
schedule notification for task 
${task.id}:`[39m[33m,[39m
     [90m 126 |[39m             notificationError
     [90m 127 |[39m           )[33m;[39m[0m

      at warn (src/lib/nutrient-engine/services/calendar
-integration-service.ts:124:19)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Failed to cancel notification for task task-1: 
Error: Cancel failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\nutrient-engine\services\calendar-integration-se
rvice.test.ts:392:32)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 246 |[39m     } [36mcatch[39m (error) 
{
     [90m 247 |[39m       [90m// Log but continue 
cancelling other notifications[39m
    [31m[1m>[22m[39m[90m 248 |[39m       
console[33m.[39mwarn([32m`Failed to cancel 
notification for task ${taskId}:`[39m[33m,[39m 
error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 249 |[39m     }
     [90m 250 |[39m   }
     [90m 251 |[39m[0m

      at warn (src/lib/nutrient-engine/services/calendar
-integration-service.ts:248:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Failed to reschedule notification for task 
task-1: Error: Reschedule failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\nutrient-engine\services\calendar-integration-se
rvice.test.ts:439:32)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 277 |[39m     } [36mcatch[39m (error) 
{
     [90m 278 |[39m       [90m// Log but continue 
rescheduling other notifications[39m
    [31m[1m>[22m[39m[90m 279 |[39m       
console[33m.[39mwarn(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 280 |[39m         [32m`Failed to 
reschedule notification for task 
${taskId}:`[39m[33m,[39m
     [90m 281 |[39m         error
     [90m 282 |[39m       )[33m;[39m[0m

      at warn (src/lib/nutrient-engine/services/calendar
-integration-service.ts:279:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS src/lib/support/help-article-cache.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Failed to evict expired articles: TypeError: 
_watermelondb.Q.lt is not a function
          at lt (C:\Users\Peter\GrowBro\src\lib\support\
help-article-cache.ts:202:33)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\suppo
rt\help-article-cache.ts:223:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\suppo
rt\help-article-cache.ts:194:36)
          at evictExpiredArticles (C:\Users\Peter\GrowBr
o\src\lib\support\help-article-cache.ts:132:11)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\suppo
rt\help-article-cache.ts:189:2)
          at apply (C:\Users\Peter\GrowBro\src\lib\suppo
rt\help-article-cache.ts:124:36)
          at Object.cacheArticles (C:\Users\Peter\GrowBr
o\src\lib\support\help-article-cache.test.ts:245:13)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m     })[33m;[39m
     [90m 220 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 221 |[39m     
console[33m.[39merror([32m'Failed to evict expired 
articles:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 222 |[39m   }
     [90m 223 |[39m }
     [90m 224 |[39m[0m

      at error 
(src/lib/support/help-article-cache.ts:221:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/support/help-article-cache.ts:223:2)
      at apply 
(src/lib/support/help-article-cache.ts:194:36)
      at evictExpiredArticles 
(src/lib/support/help-article-cache.ts:132:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/support/help-article-cache.ts:189:2)
      at apply 
(src/lib/support/help-article-cache.ts:124:36)
      at Object.cacheArticles 
(src/lib/support/help-article-cache.test.ts:245:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Failed to evict expired articles: TypeError: 
_watermelondb.Q.lt is not a function
          at lt (C:\Users\Peter\GrowBro\src\lib\support\
help-article-cache.ts:202:33)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\suppo
rt\help-article-cache.ts:194:36)
          at evictExpiredArticles (C:\Users\Peter\GrowBr
o\src\lib\support\help-article-cache.ts:132:11)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\suppo
rt\help-article-cache.ts:124:36)
          at Object.cacheArticles (C:\Users\Peter\GrowBr
o\src\lib\support\help-article-cache.test.ts:255:13)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m     })[33m;[39m
     [90m 220 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 221 |[39m     
console[33m.[39merror([32m'Failed to evict expired 
articles:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 222 |[39m   }
     [90m 223 |[39m }
     [90m 224 |[39m[0m

      at error 
(src/lib/support/help-article-cache.ts:221:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/support/help-article-cache.ts:194:36)
      at evictExpiredArticles 
(src/lib/support/help-article-cache.ts:132:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/support/help-article-cache.ts:124:36)
      at Object.cacheArticles 
(src/lib/support/help-article-cache.test.ts:255:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

PASS src/lib/performance/__tests__/time-series-uploader.
test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Failed to upload metric point: Error: Upload 
failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\performance\__tests__\time-series-uploader.test.
ts:108:13)
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:397:39
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\jest-mock\build\index.js:404:13)
          at Object.mockConstructor [as setMeasurement] 
(C:\Users\Peter\GrowBro\node_modules\jest-mock\build\ind
ex.js:148:19)
          at setMeasurement (C:\Users\Peter\GrowBro\src\
lib\performance\time-series-uploader.ts:46:12)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\performance\__tests__\time-series-uploader.test.
ts:120:37)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 63 |[39m     [36mreturn[39m 
[36mtrue[39m[33m;[39m
     [90m 64 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 65 |[39m     
console[33m.[39merror([32m'Failed to upload metric 
point:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 66 |[39m     [36mreturn[39m 
[36mfalse[39m[33m;[39m
     [90m 67 |[39m   }
     [90m 68 |[39m }[0m

      at error 
(src/lib/performance/time-series-uploader.ts:65:13)
      at Object.<anonymous> (src/lib/performance/__tests
__/time-series-uploader.test.ts:120:37)

PASS src/lib/playbooks/schedule-shifter.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/notifications/notification-analytics.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Failed to track notification open: Database error

    [0m [90m 261 |[39m
     [90m 262 |[39m     [36mif[39m (error) {
    [31m[1m>[22m[39m[90m 263 |[39m       
console[33m.[39merror([32m`Failed to track 
notification open: ${error.message}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 264 |[39m       [90m// Don't throw - this 
is non-critical tracking[39m
     [90m 265 |[39m     }
     [90m 266 |[39m   }[0m

      at NotificationAnalyticsService.error 
(src/lib/notifications/notification-analytics.ts:263:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

PASS src/lib/schemas/validator.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/harvest/lttb-downsample.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/nutrient-engine/services/alert-notification
-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      Notification permission denied - alert will be 
shown in-app only

    [0m [90m 44 |[39m     [36mconst[39m 
hasPermission [33m=[39m [36mawait[39m 
ensureNotificationPermission()[33m;[39m
     [90m 45 |[39m     [36mif[39m 
([33m![39mhasPermission) {
    [31m[1m>[22m[39m[90m 46 |[39m       
console[33m.[39mwarn(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 47 |[39m         [32m'Notification 
permission denied - alert will be shown in-app 
only'[39m
     [90m 48 |[39m       )[33m;[39m
     [90m 49 |[39m       [36mreturn[39m 
[36mnull[39m[33m;[39m[0m

      at warn (src/lib/nutrient-engine/services/alert-no
tification-service.ts:46:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.warn
      Notification permission denied - alert will be 
shown in-app only

    [0m [90m 44 |[39m     [36mconst[39m 
hasPermission [33m=[39m [36mawait[39m 
ensureNotificationPermission()[33m;[39m
     [90m 45 |[39m     [36mif[39m 
([33m![39mhasPermission) {
    [31m[1m>[22m[39m[90m 46 |[39m       
console[33m.[39mwarn(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 47 |[39m         [32m'Notification 
permission denied - alert will be shown in-app 
only'[39m
     [90m 48 |[39m       )[33m;[39m
     [90m 49 |[39m       [36mreturn[39m 
[36mnull[39m[33m;[39m[0m

      at warn (src/lib/nutrient-engine/services/alert-no
tification-service.ts:46:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

PASS src/lib/sync/__tests__/offline-queue.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/growbro-task-engine/utils.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/community/outbox-processor.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [OutboxProcessor] Processing 2 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: LIKE, 
attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 1 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processing entry 2, op: 
COMMENT, attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 2 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Skipping entry 1, not ready for 
retry

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:101:19)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Entry 1 exceeded max retries, 
marking as failed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:109:19)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: LIKE, 
attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 1 failed: Not found

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 1 dropped (404)

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:306:17)

    console.log
      [OutboxProcessor] Processing 1 entries

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:94:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: LIKE, 
attempt: 1

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.error
      [OutboxProcessor] Entry 1 failed: Network error

    [0m [90m 281 |[39m       [36mconst[39m 
errorMessage [33m=[39m
     [90m 282 |[39m         error 
[36minstanceof[39m [33mError[39m [33m?[39m 
error[33m.[39mmessage [33m:[39m [32m'Unknown 
error'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 283 |[39m       
console[33m.[39merror(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 284 |[39m         [32m`[OutboxProcessor] 
Entry ${entry.id} failed:`[39m[33m,[39m
     [90m 285 |[39m         errorMessage
     [90m 286 |[39m       )[33m;[39m[0m

      at OutboxProcessor.error 
(src/lib/community/outbox-processor.ts:283:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [OutboxProcessor] Entry 1 will retry in 1000ms

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:325:15)

    console.log
      [OutboxProcessor] Processing entry 1, op: LIKE, 
attempt: 4

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:253:13)

    console.log
      [OutboxProcessor] Entry 1 processed

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:276:15)

    console.log
      [OutboxProcessor] Processed 1 entries with 
client_tx_id: client-tx-123

      at OutboxProcessor.log 
(src/lib/community/outbox-processor.ts:195:13)

PASS src/lib/playbooks/analytics/__tests__/integration.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Event tracked: {
        type: 'playbook_apply',
        timestamp: 1768559229708,
        sessionId: '1768559229675-1tnn9onx9if',
        playbookId: 'playbook-1',
        plantId: 'plant-1',
        appliedTaskCount: 25,
        durationMs: 180,
        jobId: 'job-1'
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Event tracked: {
        type: 'playbook_task_customized',
        timestamp: 1768559229718,
        sessionId: '1768559229675-1tnn9onx9if',
        taskId: 'task-1',
        plantId: 'plant-1',
        playbookId: 'playbook-1',
        changedFields: [ 'title', 'dueDate' ],
        breaksInheritance: true
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Event tracked: {
        type: 'playbook_shift_preview',
        timestamp: 1768559229720,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        daysDelta: 3,
        affectedTaskCount: 20,
        includeCompleted: false,
        includeManuallyEdited: false
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Event tracked: {
        type: 'playbook_shift_apply',
        timestamp: 1768559229722,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        shiftId: 'shift-1',
        daysDelta: 3,
        affectedTaskCount: 20,
        durationMs: 120
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Event tracked: {
        type: 'playbook_shift_preview',
        timestamp: 1768559229733,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        daysDelta: 5,
        affectedTaskCount: 15,
        includeCompleted: false,
        includeManuallyEdited: false
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Event tracked: {
        type: 'playbook_shift_apply',
        timestamp: 1768559229735,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        shiftId: 'shift-1',
        daysDelta: 5,
        affectedTaskCount: 15,
        durationMs: 100
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Event tracked: {
        type: 'playbook_shift_undo',
        timestamp: 1768559229736,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        shiftId: 'shift-1',
        restoredTaskCount: 15,
        durationMs: 80
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Event tracked: {
        type: 'notif_scheduled',
        timestamp: 1768559229746,
        sessionId: '1768559229675-1tnn9onx9if',
        notificationId: 'notif-1',
        taskId: 'task-1',
        scheduledTime: 1768559229746,
        isExactAlarm: false
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Event tracked: {
        type: 'notif_delivered',
        timestamp: 1768559229748,
        sessionId: '1768559229675-1tnn9onx9if',
        notificationId: 'notif-1',
        taskId: 'task-1',
        scheduledTime: 1768559229746,
        actualDeliveryTime: 1768559231746,
        delayMs: 2000
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Event tracked: {
        type: 'notif_scheduled',
        timestamp: 1768559229754,
        sessionId: '1768559229675-1tnn9onx9if',
        notificationId: 'notif-1',
        taskId: 'task-1',
        scheduledTime: 1768559229754,
        isExactAlarm: false
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Flushing events: 10

      at AnalyticsService.log 
(src/lib/playbooks/analytics/service.ts:102:15)

    console.log
      [Analytics] Would send events: [
        {
          type: 'playbook_apply',
          timestamp: 1768559229708,
          sessionId: '1768559229675-1tnn9onx9if',
          playbookId: 'playbook-1',
          plantId: 'plant-1',
          appliedTaskCount: 25,
          durationMs: 180,
          jobId: 'job-1'
        },
        {
          type: 'playbook_task_customized',
          timestamp: 1768559229718,
          sessionId: '1768559229675-1tnn9onx9if',
          taskId: 'task-1',
          plantId: 'plant-1',
          playbookId: 'playbook-1',
          changedFields: [ 'title', 'dueDate' ],
          breaksInheritance: true
        },
        {
          type: 'playbook_shift_preview',
          timestamp: 1768559229720,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          daysDelta: 3,
          affectedTaskCount: 20,
          includeCompleted: false,
          includeManuallyEdited: false
        },
        {
          type: 'playbook_shift_apply',
          timestamp: 1768559229722,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          shiftId: 'shift-1',
          daysDelta: 3,
          affectedTaskCount: 20,
          durationMs: 120
        },
        {
          type: 'playbook_shift_preview',
          timestamp: 1768559229733,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          daysDelta: 5,
          affectedTaskCount: 15,
          includeCompleted: false,
          includeManuallyEdited: false
        },
        {
          type: 'playbook_shift_apply',
          timestamp: 1768559229735,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          shiftId: 'shift-1',
          daysDelta: 5,
          affectedTaskCount: 15,
          durationMs: 100
        },
        {
          type: 'playbook_shift_undo',
          timestamp: 1768559229736,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          shiftId: 'shift-1',
          restoredTaskCount: 15,
          durationMs: 80
        },
        {
          type: 'notif_scheduled',
          timestamp: 1768559229746,
          sessionId: '1768559229675-1tnn9onx9if',
          notificationId: 'notif-1',
          taskId: 'task-1',
          scheduledTime: 1768559229746,
          isExactAlarm: false
        },
        {
          type: 'notif_delivered',
          timestamp: 1768559229748,
          sessionId: '1768559229675-1tnn9onx9if',
          notificationId: 'notif-1',
          taskId: 'task-1',
          scheduledTime: 1768559229746,
          actualDeliveryTime: 1768559231746,
          delayMs: 2000
        },
        {
          type: 'notif_scheduled',
          timestamp: 1768559229754,
          sessionId: '1768559229675-1tnn9onx9if',
          notificationId: 'notif-1',
          taskId: 'task-1',
          scheduledTime: 1768559229754,
          isExactAlarm: false
        }
      ]

      at AnalyticsService.log 
(src/lib/playbooks/analytics/service.ts:218:15)

    console.log
      [Analytics] Event tracked: {
        type: 'notif_missed',
        timestamp: 1768559229857,
        sessionId: '1768559229675-1tnn9onx9if',
        notificationId: 'notif-1',
        taskId: 'task-1',
        scheduledTime: 1768559229754,
        reason: 'doze_mode'
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Event tracked: {
        type: 'sync_start',
        timestamp: 1768559229925,
        sessionId: '1768559229675-1tnn9onx9if',
        operation: 'full'
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Event tracked: {
        type: 'sync_complete',
        timestamp: 1768559229966,
        sessionId: '1768559229675-1tnn9onx9if',
        operation: 'full',
        latencyMs: 41,
        recordsSynced: 10
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Event tracked: {
        type: 'sync_start',
        timestamp: 1768559230013,
        sessionId: '1768559229675-1tnn9onx9if',
        operation: 'push'
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Event tracked: {
        type: 'sync_fail',
        timestamp: 1768559230014,
        sessionId: '1768559229675-1tnn9onx9if',
        operation: 'push',
        errorCode: 'NETWORK_ERROR',
        retryable: true,
        latencyMs: 1
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Event tracked: {
        type: 'conflict_seen',
        timestamp: 1768559230039,
        sessionId: '1768559229675-1tnn9onx9if',
        table: 'tasks',
        recordId: 'task-1',
        conflictType: 'update_update',
        resolution: 'server_wins'
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Event tracked: {
        type: 'conflict_restored',
        timestamp: 1768559230049,
        sessionId: '1768559229675-1tnn9onx9if',
        table: 'tasks',
        recordId: 'task-1',
        conflictType: 'update_update'
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Event tracked: {
        type: 'ai_suggested',
        timestamp: 1768559230080,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        suggestionId: 'suggestion-1',
        rootCause: 'nutrient_deficiency',
        confidence: 0.85,
        affectedTaskCount: 5,
        reasoning: 'Detected nitrogen deficiency based 
on leaf color'
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Event tracked: {
        type: 'ai_applied',
        timestamp: 1768559230087,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        suggestionId: 'suggestion-1',
        rootCause: 'nutrient_deficiency',
        confidence: 0.85,
        affectedTaskCount: 5,
        helpfulVote: true
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Event tracked: {
        type: 'ai_suggested',
        timestamp: 1768559230104,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        suggestionId: 'suggestion-2',
        rootCause: 'overwatering',
        confidence: 0.65,
        affectedTaskCount: 3,
        reasoning: 'Possible overwatering detected'
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Flushing events: 10

      at AnalyticsService.log 
(src/lib/playbooks/analytics/service.ts:102:15)

    console.log
      [Analytics] Would send events: [
        {
          type: 'notif_missed',
          timestamp: 1768559229857,
          sessionId: '1768559229675-1tnn9onx9if',
          notificationId: 'notif-1',
          taskId: 'task-1',
          scheduledTime: 1768559229754,
          reason: 'doze_mode'
        },
        {
          type: 'sync_start',
          timestamp: 1768559229925,
          sessionId: '1768559229675-1tnn9onx9if',
          operation: 'full'
        },
        {
          type: 'sync_complete',
          timestamp: 1768559229966,
          sessionId: '1768559229675-1tnn9onx9if',
          operation: 'full',
          latencyMs: 41,
          recordsSynced: 10
        },
        {
          type: 'sync_start',
          timestamp: 1768559230013,
          sessionId: '1768559229675-1tnn9onx9if',
          operation: 'push'
        },
        {
          type: 'sync_fail',
          timestamp: 1768559230014,
          sessionId: '1768559229675-1tnn9onx9if',
          operation: 'push',
          errorCode: 'NETWORK_ERROR',
          retryable: true,
          latencyMs: 1
        },
        {
          type: 'conflict_seen',
          timestamp: 1768559230039,
          sessionId: '1768559229675-1tnn9onx9if',
          table: 'tasks',
          recordId: 'task-1',
          conflictType: 'update_update',
          resolution: 'server_wins'
        },
        {
          type: 'conflict_restored',
          timestamp: 1768559230049,
          sessionId: '1768559229675-1tnn9onx9if',
          table: 'tasks',
          recordId: 'task-1',
          conflictType: 'update_update'
        },
        {
          type: 'ai_suggested',
          timestamp: 1768559230080,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          suggestionId: 'suggestion-1',
          rootCause: 'nutrient_deficiency',
          confidence: 0.85,
          affectedTaskCount: 5,
          reasoning: 'Detected nitrogen deficiency 
based on leaf color'
        },
        {
          type: 'ai_applied',
          timestamp: 1768559230087,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          suggestionId: 'suggestion-1',
          rootCause: 'nutrient_deficiency',
          confidence: 0.85,
          affectedTaskCount: 5,
          helpfulVote: true
        },
        {
          type: 'ai_suggested',
          timestamp: 1768559230104,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          suggestionId: 'suggestion-2',
          rootCause: 'overwatering',
          confidence: 0.65,
          affectedTaskCount: 3,
          reasoning: 'Possible overwatering detected'
        }
      ]

      at AnalyticsService.log 
(src/lib/playbooks/analytics/service.ts:218:15)

    console.log
      [Analytics] Event tracked: {
        type: 'ai_declined',
        timestamp: 1768559230123,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        suggestionId: 'suggestion-2',
        rootCause: 'overwatering',
        confidence: 0.65,
        affectedTaskCount: 3,
        helpfulVote: false
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Event tracked: {
        type: 'trichome_helper_open',
        timestamp: 1768559230158,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        phase: 'flowering'
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [Analytics] Event tracked: {
        type: 'trichome_helper_logged',
        timestamp: 1768559230164,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        assessment: 'milky',
        hasPhoto: true,
        photoCount: 3,
        harvestWindowAdjustment: 2
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Event tracked: {
        type: 'trichome_helper_logged',
        timestamp: 1768559230170,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        assessment: 'clear',
        hasPhoto: false,
        photoCount: 0,
        harvestWindowAdjustment: undefined
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)
          at Array.forEach (<anonymous>)

    console.log
      [Analytics] Event tracked: {
        type: 'trichome_helper_logged',
        timestamp: 1768559230171,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        assessment: 'milky',
        hasPhoto: false,
        photoCount: 0,
        harvestWindowAdjustment: undefined
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)
          at Array.forEach (<anonymous>)

    console.log
      [Analytics] Event tracked: {
        type: 'trichome_helper_logged',
        timestamp: 1768559230172,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        assessment: 'amber',
        hasPhoto: false,
        photoCount: 0,
        harvestWindowAdjustment: undefined
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)
          at Array.forEach (<anonymous>)

    console.log
      [Analytics] Event tracked: {
        type: 'trichome_helper_logged',
        timestamp: 1768559230173,
        sessionId: '1768559229675-1tnn9onx9if',
        plantId: 'plant-1',
        assessment: 'mixed',
        hasPhoto: false,
        photoCount: 0,
        harvestWindowAdjustment: undefined
      }

      at AnalyticsService.log [as track] 
(src/lib/playbooks/analytics/service.ts:70:15)
          at Array.forEach (<anonymous>)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [MetricsAggregator] Summary: {
        health: {
          overall: 'healthy',
          notifications: 'healthy',
          sync: 'healthy',
          issues: []
        },
        metrics: {
          notifications: {
            totalScheduled: 0,
            totalDelivered: 0,
            totalMissed: 0,
            deliveryRate: 0,
            averageDelayMs: 0,
            lastCalculated: 1768559230188
          },
          sync: {
            totalSyncs: 0,
            successfulSyncs: 0,
            failedSyncs: 0,
            averageLatencyMs: 0,
            failRate: 0,
            lastCalculated: 1768559230188
          },
          conflicts: {
            totalConflicts: 0,
            resolvedByServer: 0,
            resolvedByClient: 0,
            manualResolutions: 0,
            restoredCount: 0,
            lastCalculated: 1768559230188
          },
          timestamp: 1768559230188
        }
      }

      at MetricsAggregator.log [as emitSummary] (src/lib
/playbooks/analytics/metrics-aggregator.ts:114:13)

    console.log
      [NotificationMetrics] Summary: {
        totalScheduled: 0,
        totalDelivered: 0,
        totalMissed: 0,
        deliveryRate: 0,
        averageDelayMs: 0,
        lastCalculated: 1768559230189
      }

      at NotificationMetricsTracker.log [as 
emitSummary] (src/lib/playbooks/analytics/notification-m
etrics.ts:157:13)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Session reset: 
1768559230198-inycqfzxm2

      at AnalyticsService.log [as resetSession] 
(src/lib/playbooks/analytics/service.ts:136:15)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

    console.log
      [Analytics] Flushing events: 7

      at AnalyticsService.log 
(src/lib/playbooks/analytics/service.ts:102:15)

    console.log
      [Analytics] Would send events: [
        {
          type: 'ai_declined',
          timestamp: 1768559230123,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          suggestionId: 'suggestion-2',
          rootCause: 'overwatering',
          confidence: 0.65,
          affectedTaskCount: 3,
          helpfulVote: false
        },
        {
          type: 'trichome_helper_open',
          timestamp: 1768559230158,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          phase: 'flowering'
        },
        {
          type: 'trichome_helper_logged',
          timestamp: 1768559230164,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          assessment: 'milky',
          hasPhoto: true,
          photoCount: 3,
          harvestWindowAdjustment: 2
        },
        {
          type: 'trichome_helper_logged',
          timestamp: 1768559230170,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          assessment: 'clear',
          hasPhoto: false,
          photoCount: 0,
          harvestWindowAdjustment: undefined
        },
        {
          type: 'trichome_helper_logged',
          timestamp: 1768559230171,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          assessment: 'milky',
          hasPhoto: false,
          photoCount: 0,
          harvestWindowAdjustment: undefined
        },
        {
          type: 'trichome_helper_logged',
          timestamp: 1768559230172,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          assessment: 'amber',
          hasPhoto: false,
          photoCount: 0,
          harvestWindowAdjustment: undefined
        },
        {
          type: 'trichome_helper_logged',
          timestamp: 1768559230173,
          sessionId: '1768559229675-1tnn9onx9if',
          plantId: 'plant-1',
          assessment: 'mixed',
          hasPhoto: false,
          photoCount: 0,
          harvestWindowAdjustment: undefined
        }
      ]

      at AnalyticsService.log 
(src/lib/playbooks/analytics/service.ts:218:15)

    console.log
      [MetricsAggregator] All metrics reset

      at MetricsAggregator.log [as resetAllMetrics] (src
/lib/playbooks/analytics/metrics-aggregator.ts:176:13)

PASS src/lib/nutrient-engine/utils/calibration-calculati
ons.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/harvest/__tests__/harvest-security.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

PASS src/lib/__tests__/sync-performance.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.info
      SYNC: API_BASE is empty; sync is disabled 
(expected in dev)

      at Object.logMethod (src/lib/sync-engine.ts:170:3)

PASS src/lib/assessment/__tests__/integration/e2e-assess
ment-flow.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/nutrient-engine/services/schedule-adjustmen
t-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.warn
      Failed to revert task task-1: Error: Revert failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\nutrient-engine\services\schedule-adjustment-ser
vice.test.ts:323:32)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 222 |[39m       
revertedCount[33m++[39m[33m;[39m
     [90m 223 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 224 |[39m       
console[33m.[39mwarn([32m`Failed to revert task 
${previousTask.id}:`[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 225 |[39m     }
     [90m 226 |[39m   }
     [90m 227 |[39m[0m

      at warn (src/lib/nutrient-engine/services/schedule
-adjustment-service.ts:224:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS src/lib/moderation/trusted-flagger-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/playbooks/__tests__/phase-tracker.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/notifications/push-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/nutrient-engine/utils/alkalinity-warnings.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/playbooks/analytics/__tests__/sync-metrics.
test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      [SyncMetrics] Sync not found: unknown-sync

    [0m [90m 55 |[39m     [36mconst[39m activeSync 
[33m=[39m [36mthis[39m[33m.[39mactiveSyncs[33m.[
39m[36mget[39m(syncId)[33m;[39m
     [90m 56 |[39m     [36mif[39m 
([33m![39mactiveSync) {
    [31m[1m>[22m[39m[90m 57 |[39m       
console[33m.[39mwarn([32m'[SyncMetrics] Sync not 
found:'[39m[33m,[39m syncId)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 58 |[39m       [36mreturn[39m[33m;[39m
     [90m 59 |[39m     }
     [90m 60 |[39m[0m

      at SyncMetricsTracker.warn [as trackSyncComplete] 
(src/lib/playbooks/analytics/sync-metrics.ts:57:15)
      at Object.trackSyncComplete (src/lib/playbooks/ana
lytics/__tests__/sync-metrics.test.ts:65:19)


  ÔùÅ  Cannot log after tests are done. Did you forget 
to wait for something async in your test?
    Attempted to log "[SyncMetrics] Sync not found: 
sync-1".

    [0m [90m 55 |[39m     [36mconst[39m activeSync 
[33m=[39m [36mthis[39m[33m.[39mactiveSyncs[33m.[
39m[36mget[39m(syncId)[33m;[39m
     [90m 56 |[39m     [36mif[39m 
([33m![39mactiveSync) {
    [31m[1m>[22m[39m[90m 57 |[39m       
console[33m.[39mwarn([32m'[SyncMetrics] Sync not 
found:'[39m[33m,[39m syncId)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 58 |[39m       [36mreturn[39m[33m;[39m
     [90m 59 |[39m     }
     [90m 60 |[39m[0m

      at console.warn (node_modules/@jest/console/build/
BufferedConsole.js:191:10)
      at SyncMetricsTracker.warn [as trackSyncComplete] 
(src/lib/playbooks/analytics/sync-metrics.ts:57:15)
      at Timeout.trackSyncComplete [as _onTimeout] (src/
lib/playbooks/analytics/__tests__/sync-metrics.test.ts:9
5:21)


  ÔùÅ  Cannot log after tests are done. Did you forget 
to wait for something async in your test?
    Attempted to log "[SyncMetrics] Sync not found: 
sync-2".

    [0m [90m 55 |[39m     [36mconst[39m activeSync 
[33m=[39m [36mthis[39m[33m.[39mactiveSyncs[33m.[
39m[36mget[39m(syncId)[33m;[39m
     [90m 56 |[39m     [36mif[39m 
([33m![39mactiveSync) {
    [31m[1m>[22m[39m[90m 57 |[39m       
console[33m.[39mwarn([32m'[SyncMetrics] Sync not 
found:'[39m[33m,[39m syncId)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 58 |[39m       [36mreturn[39m[33m;[39m
     [90m 59 |[39m     }
     [90m 60 |[39m[0m

      at console.warn (node_modules/@jest/console/build/
BufferedConsole.js:191:10)
      at SyncMetricsTracker.warn [as trackSyncComplete] 
(src/lib/playbooks/analytics/sync-metrics.ts:57:15)
      at Timeout.trackSyncComplete [as _onTimeout] (src/
lib/playbooks/analytics/__tests__/sync-metrics.test.ts:1
01:21)

PASS src/lib/assessment/__tests__/confidence-calibration
.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/harvest/harvest-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [HarvestService] Scheduled initial notifications 
for HARVEST stage: { stage: 'harvest', targetScheduled: 
true, overdueScheduled: true }

      at log (src/lib/harvest/harvest-service.ts:85:15)

    console.error
      [HarvestService] Failed to create harvest: Error: 
Database error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\harvest\harvest-service.test.ts:159:25)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m  95 |[39m     [36mreturn[39m { 
success[33m:[39m [36mtrue[39m[33m,[39m harvest 
}[33m;[39m
     [90m  96 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m  97 |[39m     
console[33m.[39merror([32m'[HarvestService] Failed 
to create harvest:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m  98 |[39m     [36mreturn[39m {
     [90m  99 |[39m       success[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 100 |[39m       harvest[33m:[39m 
[36mnull[39m[33m,[39m[0m

      at error 
(src/lib/harvest/harvest-service.ts:97:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [HarvestService] Scheduled initial notifications 
for HARVEST stage: { stage: 'harvest', targetScheduled: 
true, overdueScheduled: true }

      at log (src/lib/harvest/harvest-service.ts:85:15)

PASS src/lib/auth/user-utils.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/background-sync.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.info
      SYNC: API_BASE is empty; sync is disabled 
(expected in dev)

      at Object.logMethod (src/lib/sync-engine.ts:170:3)

PASS src/components/calendar/drag-drop-provider.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

FAIL src/api/auth/use-request-account-deletion.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      [getCurrentPolicyVersion] Unexpected error: 
TypeError: 
_supabase.supabase.from(...).select(...).limit is not a 
function
          at limit (C:\Users\Peter\GrowBro\src\api\auth\
account-deletion-helpers.ts:19:8)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\api\auth\
account-deletion-helpers.ts:36:2)
          at apply (C:\Users\Peter\GrowBro\src\api\auth\
account-deletion-helpers.ts:14:46)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\api\auth\use-request-account-deletion.ts:181:56)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Object.apply [as mutationFn] (C:\Users\Pete
r\GrowBro\src\api\auth\use-request-account-deletion.ts:1
66:13)
          at Object.fn (C:\Users\Peter\GrowBro\node_modu
les\@tanstack\query-core\src\mutation.ts:190:29)
          at run (C:\Users\Peter\GrowBro\node_modules\@t
anstack\query-core\src\retryer.ts:155:49)
          at Object.start (C:\Users\Peter\GrowBro\node_m
odules\@tanstack\query-core\src\retryer.ts:221:9)
          at Mutation.execute (C:\Users\Peter\GrowBro\no
de_modules\@tanstack\query-core\src\mutation.ts:233:40)

    [0m [90m 31 |[39m     [36mreturn[39m 
data[33m.[39mpolicy_version [33m||[39m 
[32m'1.0.0'[39m[33m;[39m
     [90m 32 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 33 |[39m     
console[33m.[39merror([32m'[getCurrentPolicyVersion] 
Unexpected error:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 34 |[39m     [36mreturn[39m 
[32m'1.0.0'[39m[33m;[39m
     [90m 35 |[39m   }
     [90m 36 |[39m }[0m

      at error 
(src/api/auth/account-deletion-helpers.ts:33:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/api/auth/account-deletion-helpers.ts:36:2)
      at apply 
(src/api/auth/account-deletion-helpers.ts:14:46)
      at Object.<anonymous> 
(src/api/auth/use-request-account-deletion.ts:181:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as mutationFn] 
(src/api/auth/use-request-account-deletion.ts:166:13)
      at Object.fn (node_modules/@tanstack/query-core/sr
c/mutation.ts:190:29)
      at run (node_modules/@tanstack/query-core/src/retr
yer.ts:155:49)
      at Object.start 
(node_modules/@tanstack/query-core/src/retryer.ts:221:9)
      at Mutation.execute (node_modules/@tanstack/query-
core/src/mutation.ts:233:40)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at forceStoreRerender (node_modules/react-test-ren
derer/cjs/react-test-renderer.development.js:3430:24)
      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:3415:41
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:73:11
      at notifyFn (node_modules/@tanstack/query-core/src
/notifyManager.ts:21:5)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:44:13
          at Array.forEach (<anonymous>)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:43:25
      at batchNotifyFn (node_modules/@tanstack/query-cor
e/src/notifyManager.ts:24:5)
      at Timeout._onTimeout (node_modules/@tanstack/quer
y-core/src/notifyManager.ts:42:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at forceStoreRerender (node_modules/react-test-ren
derer/cjs/react-test-renderer.development.js:3430:24)
      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:3415:41
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:73:11
      at notifyFn (node_modules/@tanstack/query-core/src
/notifyManager.ts:21:5)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:44:13
          at Array.forEach (<anonymous>)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:43:25
      at batchNotifyFn (node_modules/@tanstack/query-cor
e/src/notifyManager.ts:24:5)
      at Timeout._onTimeout (node_modules/@tanstack/quer
y-core/src/notifyManager.ts:42:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at forceStoreRerender (node_modules/react-test-ren
derer/cjs/react-test-renderer.development.js:3430:24)
      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:3415:41
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:73:11
      at notifyFn (node_modules/@tanstack/query-core/src
/notifyManager.ts:21:5)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:44:13
          at Array.forEach (<anonymous>)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:43:25
      at batchNotifyFn (node_modules/@tanstack/query-cor
e/src/notifyManager.ts:24:5)
      at Timeout._onTimeout (node_modules/@tanstack/quer
y-core/src/notifyManager.ts:42:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at forceStoreRerender (node_modules/react-test-ren
derer/cjs/react-test-renderer.development.js:3430:24)
      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:3415:41
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:73:11
      at notifyFn (node_modules/@tanstack/query-core/src
/notifyManager.ts:21:5)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:44:13
          at Array.forEach (<anonymous>)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:43:25
      at batchNotifyFn (node_modules/@tanstack/query-cor
e/src/notifyManager.ts:24:5)
      at Timeout._onTimeout (node_modules/@tanstack/quer
y-core/src/notifyManager.ts:42:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at forceStoreRerender (node_modules/react-test-ren
derer/cjs/react-test-renderer.development.js:3430:24)
      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:3415:41
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:73:11
      at notifyFn (node_modules/@tanstack/query-core/src
/notifyManager.ts:21:5)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:44:13
          at Array.forEach (<anonymous>)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:43:25
      at batchNotifyFn (node_modules/@tanstack/query-cor
e/src/notifyManager.ts:24:5)
      at Timeout._onTimeout (node_modules/@tanstack/quer
y-core/src/notifyManager.ts:42:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at forceStoreRerender (node_modules/react-test-ren
derer/cjs/react-test-renderer.development.js:3430:24)
      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:3415:41
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:73:11
      at notifyFn (node_modules/@tanstack/query-core/src
/notifyManager.ts:21:5)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:44:13
          at Array.forEach (<anonymous>)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:43:25
      at batchNotifyFn (node_modules/@tanstack/query-cor
e/src/notifyManager.ts:24:5)
      at Timeout._onTimeout (node_modules/@tanstack/quer
y-core/src/notifyManager.ts:42:9)

  ÔùÅ useRequestAccountDeletion ÔÇ║ 
checkPendingDeletion ÔÇ║ uses snake_case column names 
in queries

    TypeError: _supabase.supabase.from(...).select(...).
eq(...).eq(...).limit is not a function

    [0m [90m 236 |[39m     
[33m.[39meq([32m'user_id'[39m[33m,[39m userId)
     [90m 237 |[39m     
[33m.[39meq([32m'status'[39m[33m,[39m 
[32m'pending'[39m)
    [31m[1m>[22m[39m[90m 238 |[39m     
[33m.[39mlimit([35m1[39m)[33m;[39m
     [90m     |[39m      [31m[1m^[22m[39m
     [90m 239 |[39m
     [90m 240 |[39m   [36mconst[39m row [33m=[39m 
data[33m?[39m[33m.[39m[[35m0[39m][33m;[39m
     [90m 241 |[39m   [36mif[39m (error 
[33m||[39m [33m![39mrow) {[0m

      at limit 
(src/api/auth/use-request-account-deletion.ts:238:6)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/api/auth/use-request-account-deletion.ts:254:2)
      at apply 
(src/api/auth/use-request-account-deletion.ts:230:43)
      at Object.<anonymous> (src/api/auth/use-request-ac
count-deletion.test.tsx:237:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

PASS src/lib/media/__tests__/photo-variants.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      Failed to generate resized variant: Error: Resize 
failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-variants.test.ts:158:32)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 90 |[39m     [36mreturn[39m 
result[33m.[39muri[33m;[39m
     [90m 91 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 92 |[39m     
console[33m.[39mwarn([32m'Failed to generate resized 
variant:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 93 |[39m     [36mreturn[39m 
uri[33m;[39m [90m// Fallback to original[39m
     [90m 94 |[39m   }
     [90m 95 |[39m }[0m

      at warn (src/lib/media/photo-variants.ts:92:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Failed to generate thumbnail variant: Error: 
Thumbnail failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-variants.test.ts:184:32)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 121 |[39m     [36mreturn[39m 
result[33m.[39muri[33m;[39m
     [90m 122 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 123 |[39m     
console[33m.[39mwarn([32m'Failed to generate 
thumbnail variant:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 124 |[39m     [36mreturn[39m 
uri[33m;[39m [90m// Fallback to original[39m
     [90m 125 |[39m   }
     [90m 126 |[39m }[0m

      at warn (src/lib/media/photo-variants.ts:123:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Failed to extract metadata: Error: Metadata failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-variants.test.ts:195:32)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 146 |[39m     }[33m;[39m
     [90m 147 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 148 |[39m     
console[33m.[39mwarn([32m'Failed to extract 
metadata:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 149 |[39m     [36mreturn[39m {
     [90m 150 |[39m       gpsStripped[33m,[39m
     [90m 151 |[39m       [33m...[39m(gpsStripped 
[33m&&[39m { mimeType[33m:[39m 
[32m'image/jpeg'[39m })[33m,[39m[0m

      at warn (src/lib/media/photo-variants.ts:148:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS src/lib/__tests__/path-utils.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/playbooks/template-saver.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/privacy-consent.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      Failed to hydrate privacy consent from secure 
storage: Error: boom
          at C:\Users\Peter\GrowBro\src\lib\__tests__\pr
ivacy-consent.test.ts:121:11
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:397:39
          at C:\Users\Peter\GrowBro\node_modules\jest-mo
ck\build\index.js:404:13
          at mockConstructor (C:\Users\Peter\GrowBro\nod
e_modules\jest-mock\build\index.js:103:19)
          at 
C:\Users\Peter\GrowBro\src\lib\privacy-consent.ts:41:43
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at 
C:\Users\Peter\GrowBro\src\lib\privacy-consent.ts:54:4
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:14:12
          at apply (C:\Users\Peter\GrowBro\src\lib\priva
cy-consent.ts:37:45)
          at Object.hydrateFromSecureStore [as 
initializePrivacyConsent] (C:\Users\Peter\GrowBro\src\li
b\privacy-consent.ts:147:8)
          at Object.initializePrivacyConsent (C:\Users\P
eter\GrowBro\src\lib\__tests__\privacy-consent.test.ts:1
25:24)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 44 |[39m       }
     [90m 45 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 46 |[39m       
console[33m.[39mwarn(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 47 |[39m         [32m'Failed to hydrate 
privacy consent from secure storage:'[39m[33m,[39m
     [90m 48 |[39m         error
     [90m 49 |[39m       )[33m;[39m[0m

      at warn (src/lib/privacy-consent.ts:46:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS src/lib/accessibility/__tests__/touch-target-valida
tion.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/harvest/performance.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/ics.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/nutrient-engine/utils/__tests__/community-n
avigation.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

FAIL 
src/lib/__tests__/watermelondb-plugin-config.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Package 
Dependencies ÔÇ║ WatermelonDB core dependencies are 
installed

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Package 
Dependencies ÔÇ║ Legacy WatermelonDB Expo plugin is not 
required

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Expo Config 
Plugin Setup ÔÇ║ expo-build-properties config declares 
simdjson pod

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Expo Config 
Plugin Setup ÔÇ║ expo-build-properties config declares 
libc++ pickFirst

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Development 
Build Requirements ÔÇ║ EAS build configuration exists

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Development 
Build Requirements ÔÇ║ development build profile is 
configured

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Development 
Build Requirements ÔÇ║ README documents development 
build requirement

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Database 
Schema Configuration ÔÇ║ WatermelonDB schema includes 
inventory tables

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Database 
Schema Configuration ÔÇ║ inventory_items table has 
required columns

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Database 
Schema Configuration ÔÇ║ inventory_batches table has 
required columns

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Database 
Schema Configuration ÔÇ║ inventory_movements table has 
required columns

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Database 
Adapter Configuration ÔÇ║ database adapter is 
configured for SQLite

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Database 
Adapter Configuration ÔÇ║ synchronize() includes 
inventory tables

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ CI/CD 
Guards ÔÇ║ CI should fail if build properties are 
missing

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ CI/CD 
Guards ÔÇ║ inventory schema version is up to date

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Migration 
Configuration ÔÇ║ migrations directory exists

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Migration 
Configuration ÔÇ║ schema includes migration support

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

PASS src/lib/hooks/__tests__/use-memory-monitor.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 65 |[39m     
intervalRef[33m.[39mcurrent [33m=[39m 
setInterval(() [33m=>[39m {
     [90m 66 |[39m       [36mconst[39m metrics 
[33m=[39m getMemoryMetrics()[33m;[39m
    [31m[1m>[22m[39m[90m 67 |[39m       
setCurrent(metrics)[33m;[39m
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 68 |[39m
     [90m 69 |[39m       [36mif[39m (logToConsole 
[33m&&[39m baselineRef[33m.[39mcurrent) {
     [90m 70 |[39m         [36mconst[39m deltaMB 
[33m=[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at setCurrent 
(src/lib/hooks/use-memory-monitor.ts:67:7)
      at callTimer (node_modules/@sinonjs/fake-timers/sr
c/fake-timers-src.js:744:24)
      at doTickInner (node_modules/@sinonjs/fake-timers/
src/fake-timers-src.js:1312:29)
      at doTick (node_modules/@sinonjs/fake-timers/src/f
ake-timers-src.js:1393:20)
      at Object.tick (node_modules/@sinonjs/fake-timers/
src/fake-timers-src.js:1401:20)
      at FakeTimers.advanceTimersByTime (node_modules/@j
est/fake-timers/build/modernFakeTimers.js:94:19)
      at Object.advanceTimersByTime (src/lib/hooks/__tes
ts__/use-memory-monitor.test.ts:63:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

    [0m [90m 65 |[39m     
intervalRef[33m.[39mcurrent [33m=[39m 
setInterval(() [33m=>[39m {
     [90m 66 |[39m       [36mconst[39m metrics 
[33m=[39m getMemoryMetrics()[33m;[39m
    [31m[1m>[22m[39m[90m 67 |[39m       
setCurrent(metrics)[33m;[39m
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 68 |[39m
     [90m 69 |[39m       [36mif[39m (logToConsole 
[33m&&[39m baselineRef[33m.[39mcurrent) {
     [90m 70 |[39m         [36mconst[39m deltaMB 
[33m=[39m[0m

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at dispatchSetStateInternal (node_modules/react-te
st-renderer/cjs/react-test-renderer.development.js:4148:
13)
      at dispatchSetState (node_modules/react-test-rende
rer/cjs/react-test-renderer.development.js:4107:7)
      at setCurrent 
(src/lib/hooks/use-memory-monitor.ts:67:7)
      at callTimer (node_modules/@sinonjs/fake-timers/sr
c/fake-timers-src.js:744:24)
      at doTickInner (node_modules/@sinonjs/fake-timers/
src/fake-timers-src.js:1312:29)
      at doTick (node_modules/@sinonjs/fake-timers/src/f
ake-timers-src.js:1393:20)
      at Object.tick (node_modules/@sinonjs/fake-timers/
src/fake-timers-src.js:1401:20)
      at FakeTimers.advanceTimersByTime (node_modules/@j
est/fake-timers/build/modernFakeTimers.js:94:19)
      at Object.advanceTimersByTime (src/lib/hooks/__tes
ts__/use-memory-monitor.test.ts:99:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

PASS 
src/lib/nutrient-engine/utils/alert-evaluation.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/assessment/__tests__/image-cache-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/accessibility/__tests__/labels.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/utils/date.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/watermelon-models/__tests__/nutrient-models
.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/inventory/__tests__/stock-monitoring-servic
e.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/utils/harvest-validation.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/security/secure-storage.test.ts (5.92 s)
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.info
      [SecureStorage] Initializing secure storage with 
encryption

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.log
      [SecureStorage] Creating MMKV instance for 
domain: auth

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Creating MMKV instance for 
domain: user-data

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Creating MMKV instance for 
domain: sync-metadata

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Creating MMKV instance for 
domain: security-cache

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Creating MMKV instance for 
domain: feature-flags

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.info
      [SecureStorage] Secure storage initialized 
successfully {
        domains: [
          'auth',
          'user-data',
          'sync-metadata',
          'security-cache',
          'feature-flags'
        ]
      }

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Initializing secure storage with 
encryption

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.log
      [SecureStorage] Creating MMKV instance for 
domain: auth

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Creating MMKV instance for 
domain: user-data

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Creating MMKV instance for 
domain: sync-metadata

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Creating MMKV instance for 
domain: security-cache

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Creating MMKV instance for 
domain: feature-flags

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.info
      [SecureStorage] Secure storage initialized 
successfully {
        domains: [
          'auth',
          'user-data',
          'sync-metadata',
          'security-cache',
          'feature-flags'
        ]
      }

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.info
      [SecureStorage] Initializing secure storage with 
encryption

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.error
      [SecureStorage] Failed to initialize secure 
storage Error: Key generation failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\security\secure-storage.test.ts:99:44)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 23 |[39m     
console[33m.[39mwarn([32m`[SecureStorage] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 24 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 25 |[39m     
console[33m.[39merror([32m`[SecureStorage] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                  
[31m[1m^[22m[39m
     [90m 26 |[39m }[33m;[39m
     [90m 27 |[39m
     [90m 28 |[39m [90m// ==================== MMKV 
Instance Management ====================[39m[0m

      at Object.apply 
(src/lib/security/secure-storage.ts:25:18)
      at error 
(src/lib/security/secure-storage.ts:116:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.info
      [SecureStorage] Starting recrypt for domain: auth

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Recrypt completed successfully 
for domain: auth

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.info
      [SecureStorage] Starting recrypt for domain: auth

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.info
      [SecureStorage] Starting recrypt for domain: auth

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Recrypt completed successfully 
for domain: auth

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.warn
      [SecureStorage] Rekeying all storage domains

    [0m [90m 21 |[39m     
console[33m.[39minfo([32m`[SecureStorage] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 22 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 23 |[39m     
console[33m.[39mwarn([32m`[SecureStorage] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 24 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 25 |[39m     
console[33m.[39merror([32m`[SecureStorage] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 26 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/secure-storage.ts:23:17)
      at warn (src/lib/security/secure-storage.ts:315:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/security/secure-storage.ts:331:2)
      at apply 
(src/lib/security/secure-storage.ts:310:40)
      at Object.<anonymous> 
(src/lib/security/secure-storage.test.ts:317:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.info
      [SecureStorage] Starting recrypt for domain: auth

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Recrypt completed successfully 
for domain: auth

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Starting recrypt for domain: 
user-data

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Recrypt completed successfully 
for domain: user-data

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Starting recrypt for domain: 
sync-metadata

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Recrypt completed successfully 
for domain: sync-metadata

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Starting recrypt for domain: 
security-cache

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Recrypt completed successfully 
for domain: security-cache

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Starting recrypt for domain: 
feature-flags

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Recrypt completed successfully 
for domain: feature-flags

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] All domains rekeyed successfully

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.warn
      [SecureStorage] Rekeying all storage domains

    [0m [90m 21 |[39m     
console[33m.[39minfo([32m`[SecureStorage] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 22 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 23 |[39m     
console[33m.[39mwarn([32m`[SecureStorage] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 24 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 25 |[39m     
console[33m.[39merror([32m`[SecureStorage] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 26 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/secure-storage.ts:23:17)
      at warn (src/lib/security/secure-storage.ts:315:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/security/secure-storage.ts:310:40)
      at Object.<anonymous> 
(src/lib/security/secure-storage.test.ts:333:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.info
      [SecureStorage] Starting recrypt for domain: auth

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.info
      [SecureStorage] Recrypt completed successfully 
for domain: auth

      at Object.apply [as info] 
(src/lib/security/secure-storage.ts:21:17)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

    console.log
      [SecureStorage] Secure storage already initialized

      at Object.apply 
(src/lib/security/secure-storage.ts:19:16)

PASS src/lib/notifications/community-notification-servic
e.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/assessment/__tests__/action-plan-generator.
test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/conflict-resolver.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/performance/__tests__/memory-monitor.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      [MemoryMonitor] GC not exposed. Run with 
--expose-gc flag for accurate post-GC measurements.

    [0m [90m 78 |[39m     
global[33m.[39mgc()[33m;[39m
     [90m 79 |[39m   } [36melse[39m {
    [31m[1m>[22m[39m[90m 80 |[39m     
console[33m.[39mwarn(
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 81 |[39m       [32m'[MemoryMonitor] GC not 
exposed. Run with --expose-gc flag for accurate post-GC 
measurements.'[39m
     [90m 82 |[39m     )[33m;[39m
     [90m 83 |[39m   }[0m

      at warn 
(src/lib/performance/memory-monitor.ts:80:13)
      at src/lib/performance/__tests__/memory-monitor.te
st.ts:54:42
      at Object.<anonymous> 
(node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] 
(node_modules/expect/build/index.js:320:21)
      at Object.toThrow (src/lib/performance/__tests__/m
emory-monitor.test.ts:54:50)

PASS src/lib/__tests__/sync-conflict.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

    console.info
      SYNC: API_BASE is empty; sync is disabled 
(expected in dev)

      at Object.logMethod (src/lib/sync-engine.ts:170:3)

PASS src/lib/media/__tests__/photo-hash.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/assessment/community-cta.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/assessment/__tests__/integration/plant-prof
ile-integration.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/harvest/chart-data-utils.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/moderation/__tests__/data-privacy-services.
test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

PASS src/lib/utils/path-utils.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/uploads/harvest-photo-urls.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Signed URL generation failed: Error: Failed to 
generate signed URL: File not found
          at C:\Users\Peter\GrowBro\src\lib\uploads\harv
est-photo-urls.ts:38:13
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 49 |[39m     }[33m;[39m
     [90m 50 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 51 |[39m     
console[33m.[39merror([32m'Signed URL generation 
failed:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 52 |[39m     [36mthrow[39m 
error[33m;[39m
     [90m 53 |[39m   }
     [90m 54 |[39m }[0m

      at error 
(src/lib/uploads/harvest-photo-urls.ts:51:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      Signed URL generation failed: Error: Signed URL 
is null
          at C:\Users\Peter\GrowBro\src\lib\uploads\harv
est-photo-urls.ts:42:13
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 49 |[39m     }[33m;[39m
     [90m 50 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 51 |[39m     
console[33m.[39merror([32m'Signed URL generation 
failed:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 52 |[39m     [36mthrow[39m 
error[33m;[39m
     [90m 53 |[39m   }
     [90m 54 |[39m }[0m

      at error 
(src/lib/uploads/harvest-photo-urls.ts:51:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

PASS src/lib/__tests__/telemetry-client.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/auth/__tests__/auth-telemetry.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/inventory/__tests__/cost-analysis-service.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/privacy/strip-pii.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/playbook-sync-integration.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/api/templates/use-templates.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      An update to TestComponent inside a test was not 
wrapped in act(...).
      
      When testing, code that causes React state 
updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the 
user would see in the browser. Learn more at 
https://react.dev/link/wrap-tests-with-act

      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:11801:19
      at runWithFiberInDEV (node_modules/react-test-rend
erer/cjs/react-test-renderer.development.js:1574:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules
/react-test-renderer/cjs/react-test-renderer.development
.js:11800:9)
      at scheduleUpdateOnFiber (node_modules/react-test-
renderer/cjs/react-test-renderer.development.js:10326:9)
      at forceStoreRerender (node_modules/react-test-ren
derer/cjs/react-test-renderer.development.js:3430:24)
      at node_modules/react-test-renderer/cjs/react-test
-renderer.development.js:3415:41
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:73:11
      at notifyFn (node_modules/@tanstack/query-core/src
/notifyManager.ts:21:5)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:44:13
          at Array.forEach (<anonymous>)
      at node_modules/@tanstack/query-core/src/notifyMan
ager.ts:43:25
      at batchNotifyFn (node_modules/@tanstack/query-cor
e/src/notifyManager.ts:24:5)
      at Timeout._onTimeout (node_modules/@tanstack/quer
y-core/src/notifyManager.ts:42:9)

PASS src/lib/assessment/retake-guidance.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/playbooks/errors/types.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/performance/__tests__/constants.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/community/__tests__/event-deduplicator-comp
rehensive.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/playbooks/strain-guidance.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/community/cache-updaters.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/nutrient-engine/utils/quality-flags.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/inventory/__tests__/harvest-cost-calculator
.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/performance/__tests__/memory-leak-detector.
test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/moderation/content-snapshot.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/notifications/notification-storage.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/compliance/app-access-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/accessibility/__tests__/touch-target.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/playbooks/analytics/__tests__/service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Analytics] Configured: {
        enabled: false,
        debug: true,
        batchSize: 10,
        flushIntervalMs: 30000,
        persistEvents: true,
        maxQueueSize: 1000
      }

      at AnalyticsService.log [as configure] 
(src/lib/playbooks/analytics/service.ts:46:15)

    console.log
      [Analytics] Configured: {
        enabled: false,
        debug: true,
        batchSize: 10,
        flushIntervalMs: 30000,
        persistEvents: true,
        maxQueueSize: 1000
      }

      at AnalyticsService.log [as configure] 
(src/lib/playbooks/analytics/service.ts:46:15)

    console.log
      [Analytics] Configured: {
        enabled: true,
        debug: true,
        batchSize: 10,
        flushIntervalMs: 30000,
        persistEvents: true,
        maxQueueSize: 1000
      }

      at AnalyticsService.log [as configure] 
(src/lib/playbooks/analytics/service.ts:46:15)

    console.log
      [Analytics] Session reset: 
1768559298840-gx6x8izco9v

      at AnalyticsService.log [as resetSession] 
(src/lib/playbooks/analytics/service.ts:136:15)

PASS 
src/lib/assessment/__tests__/task-integration.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/compliance/dpa-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/assessment/conflict-detection.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/sync/__tests__/conflict-resolver.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/growbro-task-engine/task-factory.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/performance/__tests__/ci-export.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/nutrient-engine/services/schedule-service.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/community/__tests__/metrics-tracker.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/notifications/pending-intent-audit.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/assessment/__tests__/result-aggregation.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/permissions-and-alarms.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/privacy/consent-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/notifications/notification-monitor-percenti
les.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/notifications/notification-monitor.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS scripts/lib/__tests__/prelaunch.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/compliance/ropa.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/security/key-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.error
      [KeyManager] Failed to generate encryption key 
Error: CSPRNG failure
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\security\key-manager.test.ts:56:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                  
[31m[1m^[22m[39m
     [90m 32 |[39m }[33m;[39m
     [90m 33 |[39m
     [90m 34 |[39m [90m// ==================== 
SecureStore Configuration ====================[39m[0m

      at Object.apply 
(src/lib/security/key-manager.ts:31:18)
      at Object.error 
(src/lib/security/key-manager.ts:74:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at Object.warn 
(src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
test-domain { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.error
      [KeyManager] Failed to store key for test Error: 
SecureStore error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\security\key-manager.test.ts:88:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                  
[31m[1m^[22m[39m
     [90m 32 |[39m }[33m;[39m
     [90m 33 |[39m
     [90m 34 |[39m [90m// ==================== 
SecureStore Configuration ====================[39m[0m

      at Object.apply 
(src/lib/security/key-manager.ts:31:18)
      at Object.error 
(src/lib/security/key-manager.ts:127:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [KeyManager] No key found for domain: nonexistent

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.error
      [KeyManager] Failed to retrieve key for test 
Error: SecureStore error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\security\key-manager.test.ts:123:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                  
[31m[1m^[22m[39m
     [90m 32 |[39m }[33m;[39m
     [90m 33 |[39m
     [90m 34 |[39m [90m// ==================== 
SecureStore Configuration ====================[39m[0m

      at Object.apply 
(src/lib/security/key-manager.ts:31:18)
      at Object.error 
(src/lib/security/key-manager.ts:149:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
test-domain { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Rotated encryption key for domain: 
test-domain { rotationCount: 1 }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
test-domain { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Rotated encryption key for domain: 
test-domain { rotationCount: 6 }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Deleted encryption key for domain: 
test-domain

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.error
      [KeyManager] Failed to delete key for test Error: 
SecureStore error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\security\key-manager.test.ts:202:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                  
[31m[1m^[22m[39m
     [90m 32 |[39m }[33m;[39m
     [90m 33 |[39m
     [90m 34 |[39m [90m// ==================== 
SecureStore Configuration ====================[39m[0m

      at Object.apply 
(src/lib/security/key-manager.ts:31:18)
      at Object.error 
(src/lib/security/key-manager.ts:169:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [KeyManager] No key found for domain: mmkv.auth

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] No existing key found for auth, 
generating new key

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at Object.warn 
(src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.auth { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] No key found for domain: mmkv.auth

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] No existing key found for auth, 
generating new key

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at Object.warn 
(src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.auth { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] No key found for domain: 
mmkv.user-data

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] No existing key found for user-data, 
generating new key

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at Object.warn 
(src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.user-data { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] No key found for domain: 
mmkv.sync-metadata

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] No existing key found for 
sync-metadata, generating new key

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at Object.warn 
(src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.sync-metadata { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] No key found for domain: 
mmkv.security-cache

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] No existing key found for 
security-cache, generating new key

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at Object.warn 
(src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.security-cache { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] No key found for domain: 
mmkv.feature-flags

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] No existing key found for 
feature-flags, generating new key

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at Object.warn 
(src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.feature-flags { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Initialized encryption keys for all 
domains {
        domains: [
          'auth',
          'user-data',
          'sync-metadata',
          'security-cache',
          'feature-flags'
        ]
      }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] Starting safe rekey operation for 
all storage domains

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:576:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/security/key-manager.ts:653:2)
      at apply (src/lib/security/key-manager.ts:569:38)
      at Object.<anonymous> 
(src/lib/security/key-manager.test.ts:283:44)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.info
      [KeyManager] Phase 1: Generating new keys and 
preserving backups

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Backed up old key for domain: auth

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.auth { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Rotated encryption key for domain: 
mmkv.auth { rotationCount: 1 }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated new key for domain: auth

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Backed up old key for domain: 
user-data

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.user-data { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Rotated encryption key for domain: 
mmkv.user-data { rotationCount: 1 }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated new key for domain: 
user-data

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Backed up old key for domain: 
sync-metadata

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.sync-metadata { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Rotated encryption key for domain: 
mmkv.sync-metadata { rotationCount: 1 }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated new key for domain: 
sync-metadata

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Backed up old key for domain: 
security-cache

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.security-cache { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Rotated encryption key for domain: 
mmkv.security-cache { rotationCount: 1 }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated new key for domain: 
security-cache

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Backed up old key for domain: 
feature-flags

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.feature-flags { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Rotated encryption key for domain: 
mmkv.feature-flags { rotationCount: 1 }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated new key for domain: 
feature-flags

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Phase 2: Performing safe 
re-encryption for each domain

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] All domains successfully rekeyed 
with data preservation

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] Starting safe rekey operation for 
all storage domains

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:576:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/security/key-manager.ts:569:38)
      at Object.<anonymous> 
(src/lib/security/key-manager.test.ts:321:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.info
      [KeyManager] Phase 1: Generating new keys and 
preserving backups

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Backed up old key for domain: auth

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.auth { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Rotated encryption key for domain: 
mmkv.auth { rotationCount: 1 }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated new key for domain: auth

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Backed up old key for domain: 
user-data

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.user-data { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Rotated encryption key for domain: 
mmkv.user-data { rotationCount: 1 }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated new key for domain: 
user-data

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Backed up old key for domain: 
sync-metadata

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.sync-metadata { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Rotated encryption key for domain: 
mmkv.sync-metadata { rotationCount: 1 }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated new key for domain: 
sync-metadata

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Backed up old key for domain: 
security-cache

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.security-cache { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Rotated encryption key for domain: 
mmkv.security-cache { rotationCount: 1 }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated new key for domain: 
security-cache

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Backed up old key for domain: 
feature-flags

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Generated 32-byte encryption key

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.feature-flags { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Rotated encryption key for domain: 
mmkv.feature-flags { rotationCount: 1 }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Generated new key for domain: 
feature-flags

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Phase 2: Performing safe 
re-encryption for each domain

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.error
      [KeyManager] Rekey operation failed, attempting 
rollback Error: Recrypt failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\security\key-manager.test.ts:319:47)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                  
[31m[1m^[22m[39m
     [90m 32 |[39m }[33m;[39m
     [90m 33 |[39m
     [90m 34 |[39m [90m// ==================== 
SecureStore Configuration ====================[39m[0m

      at Object.apply 
(src/lib/security/key-manager.ts:31:18)
      at error (src/lib/security/key-manager.ts:613:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      [KeyManager] Phase 3: Rolling back to previous 
keys

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:616:9)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at Object.warn 
(src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.auth { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Successfully rolled back key for 
domain: auth

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at Object.warn 
(src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.user-data { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Successfully rolled back key for 
domain: user-data

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at Object.warn 
(src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.sync-metadata { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Successfully rolled back key for 
domain: sync-metadata

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at Object.warn 
(src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.security-cache { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Successfully rolled back key for 
domain: security-cache

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.log
      [KeyManager] Checking hardware-backed storage 
capabilities

      at Object.apply 
(src/lib/security/key-manager.ts:25:16)

    console.info
      [KeyManager] Running on simulator/emulator - 
using software-only storage

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] iOS: Hardware-backed keychain not 
available, using software fallback

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at Object.warn 
(src/lib/security/key-manager.ts:98:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.info
      [KeyManager] Stored encryption key for domain: 
mmkv.feature-flags { hardwareBacking: 'software' }

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.info
      [KeyManager] Successfully rolled back key for 
domain: feature-flags

      at Object.apply [as info] 
(src/lib/security/key-manager.ts:27:17)

    console.warn
      [KeyManager] Rollback completed successfully

    [0m [90m 27 |[39m     
console[33m.[39minfo([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 28 |[39m   warn[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
    [31m[1m>[22m[39m[90m 29 |[39m     
console[33m.[39mwarn([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m    |[39m                 
[31m[1m^[22m[39m
     [90m 30 |[39m   error[33m:[39m (msg[33m:[39m 
string[33m,[39m [33m...[39margs[33m:[39m 
unknown[]) [33m=>[39m
     [90m 31 |[39m     
console[33m.[39merror([32m`[KeyManager] 
${msg}`[39m[33m,[39m [33m...[39margs)[33m,[39m
     [90m 32 |[39m }[33m;[39m[0m

      at Object.apply [as warn] 
(src/lib/security/key-manager.ts:29:17)
      at warn (src/lib/security/key-manager.ts:647:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

PASS src/lib/compliance/app-access-gate.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/plant-telemetry.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/playbooks/task-customization.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/settings/__tests__/sync-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

PASS src/lib/privacy/crash-store.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/rrule/generator.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/uploads/__tests__/path.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

PASS src/lib/__tests__/sync-errors.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/privacy/export-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/task-notifications-permission-gate.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/notifications/notification-monitor-user-act
ions.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/deep-link-validator.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/schemas/moderation-schemas.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/privacy/deletion-gate.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [Supabase] using url: http://localhost

      at Object.log (src/lib/supabase.ts:88:11)

PASS src/lib/quality/analyzers/__tests__/blur.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/compliance/__tests__/onboarding-telemetry.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/media/__tests__/photo-janitor.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      Skipping cleanup: low battery and not charging

      at log (src/lib/media/photo-janitor.ts:45:13)

    console.error
      LRU cleanup failed: Error: Storage error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-janitor.test.ts:267:39)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 169 |[39m     }[33m;[39m
     [90m 170 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 171 |[39m     
console[33m.[39merror([32m'LRU cleanup 
failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 172 |[39m     [36mreturn[39m {
     [90m 173 |[39m       filesDeleted[33m:[39m 
[35m0[39m[33m,[39m
     [90m 174 |[39m       bytesFreed[33m:[39m 
[35m0[39m[33m,[39m[0m

      at error (src/lib/media/photo-janitor.ts:171:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Failed to delete file file:///file2.jpg: Error: 
Delete failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-janitor.test.ts:304:32)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 104 |[39m       
filesDeleted[33m++[39m[33m;[39m
     [90m 105 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 106 |[39m       
console[33m.[39mwarn([32m`Failed to delete file 
${file.path}:`[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 107 |[39m     }
     [90m 108 |[39m   }
     [90m 109 |[39m[0m

      at warn (src/lib/media/photo-janitor.ts:106:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      Janitor cleanup completed: { filesDeleted: 0, 
bytesFreed: 0, durationMs: 0, orphansRemoved: 0 }

      at log (src/lib/media/photo-janitor.ts:194:15)

PASS src/lib/nutrient-engine/utils/conversions.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/nutrient-engine/services/calibration-remind
er.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      Cascading reminder reached target date

      at log (src/lib/nutrient-engine/services/calibrati
on-reminder.ts:496:15)

    console.warn
      Cascading reminder missing required data: { 
identifier: 'test-cascade-1', cascadeStep: 1 }

    [0m [90m 476 |[39m       [36mtypeof[39m 
identifier [33m!==[39m [32m'string'[39m
     [90m 477 |[39m     ) {
    [31m[1m>[22m[39m[90m 478 |[39m       
console[33m.[39mwarn(
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 479 |[39m         [32m'Cascading reminder 
missing required data:'[39m[33m,[39m
     [90m 480 |[39m         notificationData
     [90m 481 |[39m       )[33m;[39m[0m

      at warn (src/lib/nutrient-engine/services/calibrat
ion-reminder.ts:478:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/nutrient-engine/services/calibra
tion-reminder.ts:466:46)
      at Object.<anonymous> (src/lib/nutrient-engine/ser
vices/calibration-reminder.test.ts:222:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.warn
      Invalid cascade target date: invalid-date-string

    [0m [90m 488 |[39m     [90m// Check if the 
target date is valid[39m
     [90m 489 |[39m     [36mif[39m 
(isNaN(targetDate[33m.[39mgetTime())) {
    [31m[1m>[22m[39m[90m 490 |[39m       
console[33m.[39mwarn([32m'Invalid cascade target 
date:'[39m[33m,[39m cascadeTargetDate)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 491 |[39m       [36mreturn[39m 
[36mfalse[39m[33m;[39m
     [90m 492 |[39m     }
     [90m 493 |[39m[0m

      at warn (src/lib/nutrient-engine/services/calibrat
ion-reminder.ts:490:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/nutrient-engine/services/calibra
tion-reminder.ts:466:46)
      at Object.<anonymous> (src/lib/nutrient-engine/ser
vices/calibration-reminder.test.ts:235:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

    console.error
      Error scheduling notification: Error: Permission 
denied
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\nutrient-engine\services\calibration-reminder.te
st.ts:264:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 395 |[39m     [36mreturn[39m 
notificationId[33m;[39m
     [90m 396 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 397 |[39m     
console[33m.[39merror([32m'Error scheduling 
notification:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 398 |[39m     [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 399 |[39m   }
     [90m 400 |[39m }[0m

      at error (src/lib/nutrient-engine/services/calibra
tion-reminder.ts:397:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Error scheduling notification: Error: Permission 
denied
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\nutrient-engine\services\calibration-reminder.te
st.ts:264:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 395 |[39m     [36mreturn[39m 
notificationId[33m;[39m
     [90m 396 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 397 |[39m     
console[33m.[39merror([32m'Error scheduling 
notification:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 398 |[39m     [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 399 |[39m   }
     [90m 400 |[39m }[0m

      at error (src/lib/nutrient-engine/services/calibra
tion-reminder.ts:397:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Error scheduling notification: Error: Permission 
denied
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\nutrient-engine\services\calibration-reminder.te
st.ts:264:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 395 |[39m     [36mreturn[39m 
notificationId[33m;[39m
     [90m 396 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 397 |[39m     
console[33m.[39merror([32m'Error scheduling 
notification:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 398 |[39m     [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 399 |[39m   }
     [90m 400 |[39m }[0m

      at error (src/lib/nutrient-engine/services/calibra
tion-reminder.ts:397:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Error handling cascading reminder: Error: 
Scheduling failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\nutrient-engine\services\calibration-reminder.te
st.ts:274:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 531 |[39m     [36mreturn[39m 
[33m![39m[33m![39mresult[33m;[39m
     [90m 532 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 533 |[39m     
console[33m.[39merror([32m'Error handling cascading 
reminder:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 534 |[39m     [36mreturn[39m 
[36mfalse[39m[33m;[39m
     [90m 535 |[39m   }
     [90m 536 |[39m }[0m

      at error (src/lib/nutrient-engine/services/calibra
tion-reminder.ts:533:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS src/lib/moderation/validation.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/compliance/legal-acceptances-reacceptance.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/moderation/__tests__/audit-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/assessment/__tests__/assessment-classes.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/auth/deep-link-handler.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS scripts/lib/__tests__/cannabis-policy.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/playbooks/sanitize-playbook.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/uploads/harvest-photo-upload.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Harvest photo upload failed: Error: Upload 
failed: Storage quota exceeded
          at C:\Users\Peter\GrowBro\src\lib\uploads\harv
est-photo-upload.ts:121:13
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)

    [0m [90m 128 |[39m     }[33m;[39m
     [90m 129 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 130 |[39m     
console[33m.[39merror([32m'Harvest photo upload 
failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 131 |[39m     [36mthrow[39m 
error[33m;[39m
     [90m 132 |[39m   }
     [90m 133 |[39m }[0m

      at error 
(src/lib/uploads/harvest-photo-upload.ts:130:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      Harvest photo upload failed: Error: EXIF 
processing failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\uploads\harvest-photo-upload.test.ts:227:37)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 128 |[39m     }[33m;[39m
     [90m 129 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 130 |[39m     
console[33m.[39merror([32m'Harvest photo upload 
failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 131 |[39m     [36mthrow[39m 
error[33m;[39m
     [90m 132 |[39m   }
     [90m 133 |[39m }[0m

      at error 
(src/lib/uploads/harvest-photo-upload.ts:130:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS src/lib/__tests__/storage-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      Error computing SHA256 for file 
file:///tmp/input.jpg {
        error: 'ENOENT',
        stack: 'Error: ENOENT\n' +
          '    at Object.<anonymous> (C:\\Users\\Peter\\
GrowBro\\src\\lib\\__tests__\\storage-manager.test.ts:71
:19)\n' +
          '    at Generator.next (<anonymous>)\n' +
          '    at asyncGeneratorStep (C:\\Users\\Peter\\
GrowBro\\node_modules\\@babel\\runtime\\helpers\\asyncTo
Generator.js:3:17)\n' +
          '    at _next (C:\\Users\\Peter\\GrowBro\\node
_modules\\@babel\\runtime\\helpers\\asyncToGenerator.js:
17:9)\n' +
          '    at C:\\Users\\Peter\\GrowBro\\node_module
s\\@babel\\runtime\\helpers\\asyncToGenerator.js:22:7\n'
 +
          '    at new Promise (<anonymous>)\n' +
          '    at Object.<anonymous> (C:\\Users\\Peter\\
GrowBro\\node_modules\\@babel\\runtime\\helpers\\asyncTo
Generator.js:14:12)\n' +
          '    at Object.apply (C:\\Users\\Peter\\GrowBr
o\\src\\lib\\__tests__\\storage-manager.test.ts:73:4)\n'
 +
          '    at C:\\Users\\Peter\\GrowBro\\node_module
s\\jest-mock\\build\\index.js:397:39\n' +
          '    at Object.<anonymous> (C:\\Users\\Peter\\
GrowBro\\node_modules\\jest-mock\\build\\index.js:404:13
)\n' +
          '    at Object.mockConstructor [as 
readAsStringAsync] (C:\\Users\\Peter\\GrowBro\\node_modu
les\\jest-mock\\build\\index.js:103:19)\n' +
          '    at readAsStringAsync (C:\\Users\\Peter\\G
rowBro\\src\\lib\\sync\\storage-impl.ts:225:35)\n' +
          '    at Generator.next (<anonymous>)\n' +
          '    at asyncGeneratorStep (C:\\Users\\Peter\\
GrowBro\\node_modules\\@babel\\runtime\\helpers\\asyncTo
Generator.js:3:17)\n' +
          '    at _next (C:\\Users\\Peter\\GrowBro\\node
_modules\\@babel\\runtime\\helpers\\asyncToGenerator.js:
17:9)\n' +
          '    at C:\\Users\\Peter\\GrowBro\\node_module
s\\@babel\\runtime\\helpers\\asyncToGenerator.js:22:7\n'
 +
          '    at new Promise (<anonymous>)\n' +
          '    at C:\\Users\\Peter\\GrowBro\\node_module
s\\@babel\\runtime\\helpers\\asyncToGenerator.js:14:12\n
' +
          '    at apply (C:\\Users\\Peter\\GrowBro\\src\
\lib\\sync\\storage-impl.ts:233:2)\n' +
          '    at apply (C:\\Users\\Peter\\GrowBro\\src\
\lib\\sync\\storage-impl.ts:223:35)\n' +
          '    at computeSha256OfFile (C:\\Users\\Peter\
\GrowBro\\src\\lib\\sync\\storage-impl.ts:450:25)\n' +
          '    at Generator.next (<anonymous>)\n' +
          '    at asyncGeneratorStep (C:\\Users\\Peter\\
GrowBro\\node_modules\\@babel\\runtime\\helpers\\asyncTo
Generator.js:3:17)\n' +
          '    at _next (C:\\Users\\Peter\\GrowBro\\node
_modules\\@babel\\runtime\\helpers\\asyncToGenerator.js:
17:9)',
        uri: 'file:///tmp/input.jpg'
      }

    [0m [90m 450 |[39m     contentHash [33m=[39m 
[36mawait[39m computeSha256OfFile(uri)[33m;[39m
     [90m 451 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 452 |[39m     
console[33m.[39mwarn([32m`Error computing SHA256 for 
file ${uri}`[39m[33m,[39m {
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 453 |[39m       error[33m:[39m err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m 
[33mString[39m(err)[33m,[39m
     [90m 454 |[39m       stack[33m:[39m err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mstack [33m:[39m undefined[33m,[39m
     [90m 455 |[39m       uri[33m,[39m[0m

      at warn (src/lib/sync/storage-impl.ts:452:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.warn
      Error computing SHA256 for file 
file:///tmp/input.jpg {
        error: 'ENOENT',
        stack: 'Error: ENOENT\n' +
          '    at Object.<anonymous> (C:\\Users\\Peter\\
GrowBro\\src\\lib\\__tests__\\storage-manager.test.ts:71
:19)\n' +
          '    at Generator.next (<anonymous>)\n' +
          '    at asyncGeneratorStep (C:\\Users\\Peter\\
GrowBro\\node_modules\\@babel\\runtime\\helpers\\asyncTo
Generator.js:3:17)\n' +
          '    at _next (C:\\Users\\Peter\\GrowBro\\node
_modules\\@babel\\runtime\\helpers\\asyncToGenerator.js:
17:9)\n' +
          '    at C:\\Users\\Peter\\GrowBro\\node_module
s\\@babel\\runtime\\helpers\\asyncToGenerator.js:22:7\n'
 +
          '    at new Promise (<anonymous>)\n' +
          '    at Object.<anonymous> (C:\\Users\\Peter\\
GrowBro\\node_modules\\@babel\\runtime\\helpers\\asyncTo
Generator.js:14:12)\n' +
          '    at Object.apply (C:\\Users\\Peter\\GrowBr
o\\src\\lib\\__tests__\\storage-manager.test.ts:73:4)\n'
 +
          '    at C:\\Users\\Peter\\GrowBro\\node_module
s\\jest-mock\\build\\index.js:397:39\n' +
          '    at Object.<anonymous> (C:\\Users\\Peter\\
GrowBro\\node_modules\\jest-mock\\build\\index.js:404:13
)\n' +
          '    at Object.mockConstructor [as 
readAsStringAsync] (C:\\Users\\Peter\\GrowBro\\node_modu
les\\jest-mock\\build\\index.js:103:19)\n' +
          '    at readAsStringAsync (C:\\Users\\Peter\\G
rowBro\\src\\lib\\sync\\storage-impl.ts:225:35)\n' +
          '    at Generator.next (<anonymous>)\n' +
          '    at asyncGeneratorStep (C:\\Users\\Peter\\
GrowBro\\node_modules\\@babel\\runtime\\helpers\\asyncTo
Generator.js:3:17)\n' +
          '    at _next (C:\\Users\\Peter\\GrowBro\\node
_modules\\@babel\\runtime\\helpers\\asyncToGenerator.js:
17:9)\n' +
          '    at C:\\Users\\Peter\\GrowBro\\node_module
s\\@babel\\runtime\\helpers\\asyncToGenerator.js:22:7\n'
 +
          '    at new Promise (<anonymous>)\n' +
          '    at C:\\Users\\Peter\\GrowBro\\node_module
s\\@babel\\runtime\\helpers\\asyncToGenerator.js:14:12\n
' +
          '    at apply (C:\\Users\\Peter\\GrowBro\\src\
\lib\\sync\\storage-impl.ts:223:35)\n' +
          '    at computeSha256OfFile (C:\\Users\\Peter\
\GrowBro\\src\\lib\\sync\\storage-impl.ts:450:25)\n' +
          '    at Generator.next (<anonymous>)\n' +
          '    at asyncGeneratorStep (C:\\Users\\Peter\\
GrowBro\\node_modules\\@babel\\runtime\\helpers\\asyncTo
Generator.js:3:17)\n' +
          '    at _next (C:\\Users\\Peter\\GrowBro\\node
_modules\\@babel\\runtime\\helpers\\asyncToGenerator.js:
17:9)',
        uri: 'file:///tmp/input.jpg'
      }

    [0m [90m 450 |[39m     contentHash [33m=[39m 
[36mawait[39m computeSha256OfFile(uri)[33m;[39m
     [90m 451 |[39m   } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 452 |[39m     
console[33m.[39mwarn([32m`Error computing SHA256 for 
file ${uri}`[39m[33m,[39m {
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 453 |[39m       error[33m:[39m err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mmessage [33m:[39m 
[33mString[39m(err)[33m,[39m
     [90m 454 |[39m       stack[33m:[39m err 
[36minstanceof[39m [33mError[39m [33m?[39m 
err[33m.[39mstack [33m:[39m undefined[33m,[39m
     [90m 455 |[39m       uri[33m,[39m[0m

      at warn (src/lib/sync/storage-impl.ts:452:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS 
src/lib/nutrient-engine/utils/dosing-calculator.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/inventory/__tests__/inventory-item-service.
test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      [InventoryItemService] Get failed: Error: Not 
found
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\inventory\__tests__\inventory-item-service.test.
ts:350:43)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 346 |[39m     [36mreturn[39m 
modelToInventoryItem(item)[33m;[39m
     [90m 347 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 348 |[39m     
console[33m.[39merror([32m'[InventoryItemService] 
Get failed:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 349 |[39m     [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 350 |[39m   }
     [90m 351 |[39m }[0m

      at Object.error 
(src/lib/inventory/inventory-item-service.ts:348:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS 
src/lib/performance/__tests__/trend-analysis.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/auth/use-biometric-settings.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Failed to initialize biometric settings: Error: 
Permission denied
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\auth\use-biometric-settings.test.tsx:123:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 49 |[39m     })[33m;[39m
     [90m 50 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 51 |[39m     
console[33m.[39merror([32m'Failed to initialize 
biometric settings:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 52 |[39m     [36mset[39m({
     [90m 53 |[39m       isLoading[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 54 |[39m       error[33m:[39m 
[32m'Failed to initialize biometric 
settings'[39m[33m,[39m[0m

      at error 
(src/lib/auth/use-biometric-settings.ts:51:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to enable biometric login: Error: System 
error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\auth\use-biometric-settings.test.tsx:317:50)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 86 |[39m     [36mreturn[39m { 
success[33m:[39m [36mfalse[39m[33m,[39m 
error[33m:[39m errorMessage }[33m;[39m
     [90m 87 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 88 |[39m     
console[33m.[39merror([32m'Failed to enable 
biometric login:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 89 |[39m     [36mconst[39m errorMessage 
[33m=[39m [32m'auth.security.biometric_enable_error'
[39m[33m;[39m
     [90m 90 |[39m     [36mset[39m({
     [90m 91 |[39m       isLoading[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at error 
(src/lib/auth/use-biometric-settings.ts:88:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to disable biometric login: Error: Storage 
error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\auth\use-biometric-settings.test.tsx:403:51)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 110 |[39m     [36mreturn[39m { 
success[33m:[39m [36mtrue[39m[33m,[39m 
error[33m:[39m [36mnull[39m }[33m;[39m
     [90m 111 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 112 |[39m     
console[33m.[39merror([32m'Failed to disable 
biometric login:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 113 |[39m     [36mconst[39m errorMessage 
[33m=[39m [32m'auth.security.biometric_disable_error'
[39m[33m;[39m
     [90m 114 |[39m     [36mset[39m({
     [90m 115 |[39m       isLoading[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at error 
(src/lib/auth/use-biometric-settings.ts:112:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      You seem to have overlapping act() calls, this is 
not supported. Be sure to await previous act() calls 
before making a new one.

      at popActScope 
(node_modules/react/cjs/react.development.js:532:17)
      at 
node_modules/react/cjs/react.development.js:819:17

    console.error
      You seem to have overlapping act() calls, this is 
not supported. Be sure to await previous act() calls 
before making a new one.

      at popActScope 
(node_modules/react/cjs/react.development.js:532:17)
      at 
node_modules/react/cjs/react.development.js:819:17

PASS src/lib/auth/session-manager.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Session refresh error: { message: 'Refresh 
failed' }

    [0m [90m 138 |[39m           [90m// Don't log 
AuthSessionMissingError - it's expected when signed 
out[39m
     [90m 139 |[39m           [36mif[39m 
(error[33m.[39mname [33m!==[39m 
[32m'AuthSessionMissingError'[39m) {
    [31m[1m>[22m[39m[90m 140 |[39m             
console[33m.[39merror([32m'Session refresh 
error:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 141 |[39m           }
     [90m 142 |[39m           [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 143 |[39m         }[0m

      at Object.error 
(src/lib/auth/session-manager.ts:140:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      Session refresh exception: Error: Network error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\auth\session-manager.test.ts:215:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 187 |[39m         [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 188 |[39m       } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 189 |[39m         
console[33m.[39merror([32m'Session refresh 
exception:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 190 |[39m         [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 191 |[39m       }
     [90m 192 |[39m     }[33m,[39m[0m

      at Object.error 
(src/lib/auth/session-manager.ts:189:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.log
      [SessionManager] Session has been revoked, 
signing out

      at Object.log 
(src/lib/auth/session-manager.ts:273:19)

    console.error
      Session validation error: { message: 'Validation 
failed' }

    [0m [90m 241 |[39m           [90m// Don't log 
expected errors during sign-out[39m
     [90m 242 |[39m           [36mif[39m 
(error[33m.[39mname [33m!==[39m 
[32m'AuthSessionMissingError'[39m) {
    [31m[1m>[22m[39m[90m 243 |[39m             
console[33m.[39merror([32m'Session validation 
error:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 244 |[39m           }
     [90m 245 |[39m           [36mreturn[39m 
[36mfalse[39m[33m;[39m
     [90m 246 |[39m         }[0m

      at Object.error 
(src/lib/auth/session-manager.ts:243:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

    console.error
      Session validation exception: Error: Network error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\auth\session-manager.test.ts:426:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 284 |[39m         [36mreturn[39m 
[36mtrue[39m[33m;[39m
     [90m 285 |[39m       } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 286 |[39m         
console[33m.[39merror([32m'Session validation 
exception:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 287 |[39m         [36mreturn[39m 
[36mfalse[39m[33m;[39m
     [90m 288 |[39m       }
     [90m 289 |[39m     }[33m,[39m[0m

      at Object.error 
(src/lib/auth/session-manager.ts:286:17)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS src/lib/plants/derive-from-strain.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/notifications/playbook-notification-schedul
er.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/privacy/retention-worker.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/quality/engine.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

FAIL src/lib/assessment/assessment-analytics.test.ts
  ÔùÅ Test suite failed to run

    TypeError: (0 , _watermelondb.tableSchema) is not a 
function

    [0m [90m  6 |[39m     tableSchema({
     [90m  7 |[39m       name[33m:[39m 
[32m'series'[39m[33m,[39m
    [31m[1m>[22m[39m[90m  8 |[39m       
columns[33m:[39m [
     [90m    |[39m                           
[31m[1m^[22m[39m
     [90m  9 |[39m         { name[33m:[39m 
[32m'title'[39m[33m,[39m type[33m:[39m 
[32m'string'[39m }[33m,[39m
     [90m 10 |[39m         { name[33m:[39m 
[32m'description'[39m[33m,[39m type[33m:[39m 
[32m'string'[39m[33m,[39m isOptional[33m:[39m 
[36mtrue[39m }[33m,[39m
     [90m 11 |[39m         { name[33m:[39m 
[32m'dtstart_local'[39m[33m,[39m type[33m:[39m 
[32m'string'[39m }[33m,[39m[0m

      at Object.<anonymous> 
(src/lib/watermelon-schema.ts:8:42)
      at Object.require 
(src/lib/database/unsafe-sql-utils.ts:4:1)
      at Object.require 
(src/lib/assessment/assessment-analytics-summary.ts:1:1)
      at Object.<anonymous> 
(src/lib/assessment/assessment-analytics.ts:50:35)
      at Object.<anonymous> 
(src/lib/assessment/assessment-analytics.test.ts:74:28)

PASS 
src/lib/inventory/__tests__/telemetry-accuracy.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.warn
      [Inventory Telemetry] Failed to track low stock: 
Error: Analytics unavailable
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\inventory\__tests__\telemetry-accuracy.test.ts:3
58:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 69 |[39m     [90m// Analytics failures 
should not break inventory operations[39m
     [90m 70 |[39m     [36mif[39m (__DEV__) {
    [31m[1m>[22m[39m[90m 71 |[39m       
console[33m.[39mwarn([32m'[Inventory Telemetry] 
Failed to track low stock:'[39m[33m,[39m 
error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 72 |[39m     }
     [90m 73 |[39m   }
     [90m 74 |[39m }[0m

      at warn (src/lib/inventory/telemetry.ts:71:15)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS src/lib/inventory/__tests__/search-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 1ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 1 items 
and 6 tokens in 4ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 1ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 1ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

    console.log
      [InventorySearch] Built search index with 3 items 
and 16 tokens in 0ms

      at InventorySearchService.log 
(src/lib/inventory/search-service.ts:309:13)

PASS src/lib/rrule/rrule-monthly.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/harvest/__tests__/rls-security-audit.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/watermelon-models/__tests__/inventory-model
s.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/inventory/__tests__/accessibility-audit.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/assessment/__tests__/execution-providers.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/compliance/data-safety.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/assessment/__tests__/image-processing.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      Failed to strip EXIF data: Error: Manipulation 
failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-processing.test.ts:75
:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 43 |[39m     }[33m;[39m
     [90m 44 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 45 |[39m     
console[33m.[39merror([32m'Failed to strip EXIF 
data:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 46 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to process 
image'[39m)[33m;[39m
     [90m 47 |[39m   }
     [90m 48 |[39m }[0m

      at error 
(src/lib/assessment/image-processing.ts:45:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to generate thumbnail: Error: Generation 
failed
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-processing.test.ts:13
8:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 67 |[39m     [36mreturn[39m 
manipResult[33m.[39muri[33m;[39m
     [90m 68 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 69 |[39m     
console[33m.[39merror([32m'Failed to generate 
thumbnail:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 70 |[39m     [36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to generate 
thumbnail'[39m)[33m;[39m
     [90m 71 |[39m   }
     [90m 72 |[39m }[0m

      at error 
(src/lib/assessment/image-processing.ts:69:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      Failed to get image size: Error: File access error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\assessment\__tests__\image-processing.test.ts:18
3:9)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 80 |[39m     [36mreturn[39m 
info[33m.[39mexists [33m&&[39m [32m'size'[39m 
[36min[39m info [33m?[39m info[33m.[39msize 
[33m:[39m [35m0[39m[33m;[39m
     [90m 81 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 82 |[39m     
console[33m.[39merror([32m'Failed to get image 
size:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 83 |[39m     [36mreturn[39m 
[35m0[39m[33m;[39m
     [90m 84 |[39m   }
     [90m 85 |[39m }[0m

      at error 
(src/lib/assessment/image-processing.ts:82:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS src/lib/moderation/spam-detector.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/harvest/state-machine.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/strains/format-percentage.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/playbooks/task-generator.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/components/strains/growing-info.test.tsx
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/media/__tests__/photo-storage-helpers.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.error
      [PhotoStorageHelpers] Failed to get harvest photo 
URIs: Error: Database error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-storage-helpers.test.ts:20
1:42)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 34 |[39m     [36mreturn[39m 
photoUris[33m;[39m
     [90m 35 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 36 |[39m     
console[33m.[39merror(
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 37 |[39m       [32m'[PhotoStorageHelpers] 
Failed to get harvest photo URIs:'[39m[33m,[39m
     [90m 38 |[39m       error
     [90m 39 |[39m     )[33m;[39m[0m

      at error 
(src/lib/media/photo-storage-helpers.ts:36:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

    console.error
      [PhotoStorageHelpers] Failed to get plant photo 
URIs: Error: Database error
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
src\lib\media\__tests__\photo-storage-helpers.test.ts:21
0:40)
          at Generator.next (<anonymous>)
          at asyncGeneratorStep (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
3:17)
          at _next (C:\Users\Peter\GrowBro\node_modules\
@babel\runtime\helpers\asyncToGenerator.js:17:9)
          at C:\Users\Peter\GrowBro\node_modules\@babel\
runtime\helpers\asyncToGenerator.js:22:7
          at new Promise (<anonymous>)
          at Object.<anonymous> (C:\Users\Peter\GrowBro\
node_modules\@babel\runtime\helpers\asyncToGenerator.js:
14:12)
          at Promise.then.completed (C:\Users\Peter\Grow
Bro\node_modules\jest-circus\build\utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (C:\Users\Peter\GrowBro\n
ode_modules\jest-circus\build\utils.js:231:10)
          at _callCircusTest (C:\Users\Peter\GrowBro\nod
e_modules\jest-circus\build\run.js:316:40)
          at _runTest (C:\Users\Peter\GrowBro\node_modul
es\jest-circus\build\run.js:252:3)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:126:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at _runTestsForDescribeBlock (C:\Users\Peter\G
rowBro\node_modules\jest-circus\build\run.js:121:9)
          at run (C:\Users\Peter\GrowBro\node_modules\je
st-circus\build\run.js:71:3)
          at runAndTransformResultsToJestFormat (C:\User
s\Peter\GrowBro\node_modules\jest-circus\build\legacy-co
de-todo-rewrite\jestAdapterInit.js:122:21)
          at jestAdapter (C:\Users\Peter\GrowBro\node_mo
dules\jest-circus\build\legacy-code-todo-rewrite\jestAda
pter.js:79:19)
          at runTestInternal (C:\Users\Peter\GrowBro\nod
e_modules\jest-runner\build\runTest.js:367:16)
          at runTest (C:\Users\Peter\GrowBro\node_module
s\jest-runner\build\runTest.js:444:34)

    [0m [90m 64 |[39m     [36mreturn[39m 
photoUris[33m;[39m
     [90m 65 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m     
console[33m.[39merror(
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 67 |[39m       [32m'[PhotoStorageHelpers] 
Failed to get plant photo URIs:'[39m[33m,[39m
     [90m 68 |[39m       error
     [90m 69 |[39m     )[33m;[39m[0m

      at error 
(src/lib/media/photo-storage-helpers.ts:66:13)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

PASS 
src/lib/harvest/__tests__/accessibility-audit.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/uploads/harvest-photo-queue.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/notifications-permission-gate.e2e
.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/rrule/rrule.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/permissions/notification-handler.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/nutrient-engine/__tests__/indexes.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/inventory/__tests__/inventory-rls-security-
audit.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/assessment/__tests__/action-tracking.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      [ActionTracking] task_created {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: { taskCount: 3 }
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] task_created {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: { taskCount: 2 }
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] playbook_adjustment {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: { adjustmentCount: 2, accepted: true }
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] playbook_adjustment {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: { adjustmentCount: 1, accepted: false 
}
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] community_cta_tapped {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] retake_initiated {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] helpful_vote {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] not_helpful_vote {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] issue_resolved {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] issue_not_resolved {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] task_created {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: { taskCount: 1 }
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] task_created {
        assessmentId: 'assessment-2',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: { taskCount: 2 }
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] community_cta_tapped {
        assessmentId: 'assessment-3',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] task_created {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: { taskCount: 1 }
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] community_cta_tapped {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] retake_initiated {
        assessmentId: 'assessment-2',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] task_created {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: { taskCount: 1 }
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] community_cta_tapped {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] task_created {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: { taskCount: 1 }
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] playbook_adjustment {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: { adjustmentCount: 1, accepted: true }
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] community_cta_tapped {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] retake_initiated {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] helpful_vote {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

    console.log
      [ActionTracking] issue_resolved {
        assessmentId: 'assessment-1',
        classId: 'nitrogen_deficiency',
        confidence: '0.85',
        mode: 'device',
        metadata: undefined
      }

      at ActionTrackingService.log [as logEvent] 
(src/lib/assessment/action-tracking.ts:213:15)

PASS src/lib/privacy/deletion-adapter.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/community/__tests__/event-deduplicator.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

    console.log
      Dropping stale event: post1

      at log 
(src/lib/community/event-deduplicator.ts:221:13)

    console.log
      Dropping stale event (post_likes): post1:user1

      at log 
(src/lib/community/event-deduplicator.ts:272:13)

PASS src/lib/outbox.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/utils/__tests__/backoff.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/playbooks/errors/messages.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/compliance/age-gate.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/compliance/onboarding-state.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/template-registry.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/community/image-optimization.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/log-sanitizer.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/moderation/__tests__/audit-retention-manage
r.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/assessment/__tests__/error-classifier.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/compliance/dpia.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/strains/__tests__/accessibility.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/compliance-10-3.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/notifications/grouping-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/inventory/__tests__/inventory-valuation-ser
vice.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/error-handling.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/privacy/telemetry-aggregates.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/assessment/community-post-prefill.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/inventory/__tests__/forecasting-service.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/sentry-utils.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/strains/normalize-missing.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/navigation/deep-link-gate.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/sync-preferences.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/harvest/__tests__/harvest-workflow.unit.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/compliance/__tests__/onboarding-gating.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/monitor.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/privacy/consent-service.hasConsent.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS 
src/lib/inventory/__tests__/deduction-validators.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/domain-links.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/compliance/__tests__/age-gate.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/notifications/notification-monitor-metrics.
test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/privacy/consent-service.isConsentRequired.t
est.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/privacy/audit-log.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/moderation/rate-limit.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/__tests__/sync-engine.retry.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/auth/session-timeout.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/security/constants.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

PASS src/lib/strains/format-utils.test.ts
  ÔùÅ Console

    console.warn
      [open-handles-initial] [ 'Socket', 'Socket' ]

    [0m [90m 25 |[39m   )[33m;[39m
     [90m 26 |[39m
    [31m[1m>[22m[39m[90m 27 |[39m   console[33m.
[39mwarn([32m'[open-handles-initial]'[39m[33m,[39m 
names[33m.[39mslice([35m0[39m[33m,[39m 
[35m20[39m))[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 28 |[39m } [36mcatch[39m {}
     [90m 29 |[39m
     [90m 30 |[39m [90m// react-hook form setup for 
testing[39m[0m

      at Object.warn (jest-setup.ts:27:11)

FAIL src/lib/assessment/__tests__/integration/task-creat
ion-flow.test.ts
  ÔùÅ Test suite failed to run

    Cannot find module '../../../action-tracking' from '
src/lib/assessment/__tests__/integration/task-creation-f
low.test.ts'

    [0m [90m 20 |[39m }))[33m;[39m
     [90m 21 |[39m
    [31m[1m>[22m[39m[90m 22 |[39m jest[33m.[39mm
ock([32m'@/lib/action-tracking'[39m[33m,[39m () 
[33m=>[39m ({
     [90m    |[39m      [31m[1m^[22m[39m
     [90m 23 |[39m   trackTaskCreation[33m:[39m 
jest[33m.[39mfn()[33m,[39m
     [90m 24 |[39m }))[33m;[39m
     [90m 25 |[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.mock (src/lib/assessment/__tests__/integ
ration/task-creation-flow.test.ts:22:6)

FAIL src/app/post/[id]/comment/[comment-id].test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\app\post\
[id]\comment\[comment-id].test.tsx: The module factory 
of `jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: redirectSpy
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 10 |[39m 
jest[33m.[39mmock([32m'expo-router'[39m[33m,[39m 
() [33m=>[39m ({
     [90m 11 |[39m   [33mRedirect[39m[33m:[39m 
(props[33m:[39m { href[33m:[39m string }) 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 12 |[39m     
redirectSpy(props)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m[31m[1m^
[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[
1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[3
1m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39
m[31m[1m^[22m[39m
     [90m 13 |[39m     [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 14 |[39m   }[33m,[39m
     [90m 15 |[39m   useLocalSearchParams[33m:[39m 
() [33m=>[39m 
useLocalSearchParamsMock()[33m,[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/app/(app)/playbooks/__tests__/[id].test.tsx
  ÔùÅ Test suite failed to run

    Your test suite must contain at least one test.

      at onResult 
(node_modules/@jest/core/build/TestScheduler.js:133:18)
      at 
node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit 
(node_modules/emittery/index.js:361:23)

FAIL 
src/app/(app)/inventory/__tests__/navigation.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/inventory/offline-banner.tsx:13:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../inventory/__tests__/navigation.test.tsx:12
:1)

FAIL src/lib/strains/__tests__/performance.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/difficulty-badge.tsx:3:1)
      at Object.require 
(src/components/strains/strain-card.tsx:16:1)
      at Object.require (src/components/strains/strains-
list-with-cache.tsx:17:1)
      at Object.require 
(src/lib/strains/__tests__/performance.test.tsx:10:1)

FAIL src/lib/strains/__tests__/navigation.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/lib/strains/__tests__/navigation.test.tsx:9:1)

FAIL src/lib/nutrient-engine/services/diagnostic-service
.test.ts
  ÔùÅ Test suite failed to run

    TypeError: Super expression must either be null or 
a function

    [0m [90m 56 |[39m
     [90m 57 |[39m   [90m// Relations[39m
    [31m[1m>[22m[39m[90m 58 |[39m   [33m@[39mrel
ation([32m'source_water_profiles_v2'[39m[33m,[39m 
[32m'source_water_profile_id'[39m)
     [90m    |[39m                                    
                               [31m[1m^[22m[39m
     [90m 59 |[39m   
sourceWaterProfile[33m?[39m[33m:[39m [33mRelation[
39m[33m<[39m[33mSourceWaterProfileModel[39m[33m>[3
9m[33m;[39m
     [90m 60 |[39m }
     [90m 61 |[39m[0m

      at _inherits 
(node_modules/@babel/runtime/helpers/inherits.js:3:51)
      at src/lib/watermelon-models/reservoir.ts:58:67
      at Object.<anonymous> 
(src/lib/watermelon-models/reservoir.ts:58:67)
      at Object.require (src/lib/nutrient-engine/service
s/diagnostic-service.ts:6:1)
      at Object.require (src/lib/nutrient-engine/service
s/diagnostic-service.test.ts:9:1)

FAIL src/lib/inventory/__tests__/batch-picking-service.t
est.ts
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\lib\inven
tory\__tests__\batch-picking-service.test.ts: The 
module factory of `jest.mock()` is not allowed to 
reference any out-of-scope variables.
    Invalid variable access: LokiJSAdapter
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 26 |[39m
     [90m 27 |[39m jest[33m.[39mmock([32m'@nozbe/wa
termelondb/adapters/sqlite'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 28 |[39m   
[36mconst[39m [33mLokiJSAdapterMock[39m [33m=[39m 
[33mLokiJSAdapter[39m[33m;[39m
     [90m    |[39m                             [31m[
1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[3
1m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39
m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m
[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^
[22m[39m[31m[1m^[22m[39m
     [90m 29 |[39m
     [90m 30 |[39m   [90m// Return a class that 
wraps LokiJSAdapter[39m
     [90m 31 |[39m   [36mreturn[39m [36mclass[39m 
[33mMockSQLiteAdapter[39m [36mextends[39m 
[33mLokiJSAdapterMock[39m {[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/lib/assessment/__tests__/cloud-inference-flow.t
est.ts
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\lib\asses
sment\__tests__\cloud-inference-flow.test.ts: The 
module factory of `jest.mock()` is not allowed to 
reference any out-of-scope variables.
    Invalid variable access: storageFromMock
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 14 |[39m   supabase[33m:[39m {
     [90m 15 |[39m     storage[33m:[39m {
    [31m[1m>[22m[39m[90m 16 |[39m       
[36mfrom[39m[33m:[39m storageFromMock[33m,[39m
     [90m    |[39m             [31m[1m^[22m[39m[3
1m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39
m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m
[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^
[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[
1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
     [90m 17 |[39m     }[33m,[39m
     [90m 18 |[39m     functions[33m:[39m {
     [90m 19 |[39m       invoke[33m:[39m 
functionsInvokeMock[33m,[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/lib/auth/__tests__/performance.test.ts
  ÔùÅ Test suite failed to run

    Your test suite must contain at least one test.

      at onResult 
(node_modules/@jest/core/build/TestScheduler.js:133:18)
      at 
node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit 
(node_modules/emittery/index.js:361:23)

FAIL src/components/playbooks/__tests__/playbook-selecti
on-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/playbooks/playbo
ok-selection-card.tsx:15:1)
      at Object.require (src/components/playbooks/playbo
ok-selection-list.tsx:14:1)
      at Object.require (src/components/playbooks/__test
s__/playbook-selection-list.test.tsx:5:1)

FAIL src/components/playbooks/__tests__/playbook-selecti
on-card.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/playbooks/playbo
ok-selection-card.tsx:15:1)
      at Object.require (src/components/playbooks/__test
s__/playbook-selection-card.test.tsx:3:1)

FAIL src/components/playbooks/__tests__/adjustment-sugge
stion-card.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/playbooks/adjust
ment-suggestion-card.tsx:6:1)
      at Object.require (src/components/playbooks/__test
s__/adjustment-suggestion-card.test.tsx:6:1)

FAIL src/components/nutrient-engine/__tests__/diagnostic
-result-card.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/nutrient-engine/
diagnostic-result-card.tsx:4:1)
      at Object.require (src/components/nutrient-engine/
__tests__/diagnostic-result-card.test.tsx:3:1)

FAIL src/components/inventory/__tests__/inventory-valuat
ion-summary.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/inventory/invent
ory-valuation-summary.tsx:14:1)
      at Object.require (src/components/inventory/__test
s__/inventory-valuation-summary.test.tsx:10:1)

FAIL src/components/inventory/__tests__/cost-breakdown-c
ard.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/inventory/cost-breakdown-card.tsx:14:1)
      at Object.require (src/components/inventory/__test
s__/cost-breakdown-card.test.tsx:13:1)

FAIL src/components/inventory/__tests__/cost-trend-chart
.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/inventory/cost-trend-chart.tsx:18:1)
      at Object.require (src/components/inventory/__test
s__/cost-trend-chart.test.tsx:13:1)

FAIL src/components/inventory/__tests__/consumption-hist
ory-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/inventory/consum
ption-history-list.tsx:17:1)
      at Object.require (src/components/inventory/__test
s__/consumption-history-list.test.tsx:13:1)

FAIL src/components/assessment/__tests__/assessment-hist
ory-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/assessment/asses
sment-history-list.tsx:17:1)
      at Object.require (src/components/assessment/__tes
ts__/assessment-history-list.test.tsx:12:1)

FAIL src/app/settings/__tests__/profile.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/settings/validation-feedback.tsx:13:1)
      at Object.require 
(src/app/settings/profile.tsx:23:1)
      at Object.require 
(src/app/settings/__tests__/profile.test.tsx:14:1)

FAIL src/app/settings/__tests__/performance.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/cannabis-educational-banner.tsx:3:1)
      at Object.require (src/app/settings/index.tsx:6:1)
      at Object.require 
(src/app/settings/__tests__/performance.test.tsx:14:1)

FAIL 
src/app/settings/__tests__/privacy-and-data.test.tsx
  ÔùÅ Test suite failed to run

    TypeError: Cannot read properties of undefined 
(reading 'SCROLLVIEW')

    [0m [90m 39 |[39m   
[33mBottomSheetScrollViewMethods[39m[33m,[39m
     [90m 40 |[39m   
[33mBottomSheetKeyboardAwareProps[39m
    [31m[1m>[22m[39m[90m 41 |[39m [33m>[39m([33
mSCROLLABLE_TYPE[39m[33m.[39m[33mSCROLLVIEW[39m[33
m,[39m [33mAnimatedScrollView[39m)[33m;[39m
     [90m    |[39m                   
[31m[1m^[22m[39m
     [90m 42 |[39m [36mconst[39m 
[33mBottomSheetKeyboardAwareScrollView[39m 
[33m=[39m memo([33mBottomSheetScrollViewComponent[39
m)[33m;[39m
     [90m 43 |[39m
     [90m 44 |[39m [33mBottomSheetKeyboardAwareScroll
View[39m[33m.[39mdisplayName [33m=[39m[0m

      at Object.SCROLLVIEW (src/components/ui/modal-keyb
oard-aware-scroll-view.tsx:41:19)
      at Object.require 
(src/components/auth/re-auth-modal.tsx:20:1)
      at Object.require 
(src/app/settings/privacy-and-data.tsx:4:1)
      at Object.require (src/app/settings/__tests__/priv
acy-and-data.test.tsx:7:1)

FAIL 
src/app/settings/__tests__/accessibility-audit.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/settings/item.tsx:3:1)
      at Object.require (src/app/settings/about.tsx:8:1)
      at Object.require (src/app/settings/__tests__/acce
ssibility-audit.test.tsx:7:1)

FAIL src/app/settings/support/feedback.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/app/settings/support/feedback.tsx:14:1)
      at Object.require 
(src/app/settings/support/feedback.test.tsx:13:1)

FAIL src/app/notifications/__tests__/index.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/notifications/notification-row.tsx:3:1)
      at Object.require 
(src/app/notifications/index.tsx:6:1)
      at Object.require 
(src/app/notifications/__tests__/index.test.tsx:3:1)

FAIL src/app/(app)/__tests__/_layout.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\app\(app)
\__tests__\_layout.test.tsx: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: statusSelector
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 40 |[39m     
[33m...[39mactual[33m,[39m
     [90m 41 |[39m     translate[33m:[39m 
jest[33m.[39mfn((key[33m:[39m string) [33m=>[39m 
key)[33m,[39m
    [31m[1m>[22m[39m[90m 42 |[39m     
useAuth[33m:[39m { use[33m:[39m { status[33m:[39m 
statusSelector } }[33m,[39m
     [90m    |[39m                               [31m
[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[
39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[2
2m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m
^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
     [90m 43 |[39m     useIsFirstTime[33m:[39m () 
[33m=>[39m [[36mfalse[39m][33m,[39m
     [90m 44 |[39m     useAgeGate[33m:[39m { 
status[33m:[39m ageGateStatusMock }[33m,[39m
     [90m 45 |[39m   }[33m;[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/app/(app)/__tests__/strains.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/active-filters-row.tsx:5:1)
      at Object.require 
(src/components/strains/index.ts:1:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../strains/index.tsx:7:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../__tests__/strains.test.tsx:7:1)

FAIL src/app/(app)/__tests__/community.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\app\(app)
\__tests__\community.test.tsx: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: analyticsTrackMock
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 19 |[39m     
[33m...[39mactual[33m,[39m
     [90m 20 |[39m     translate[33m:[39m 
jest[33m.[39mfn((key[33m:[39m string) [33m=>[39m 
key)[33m,[39m
    [31m[1m>[22m[39m[90m 21 |[39m     
useAnalytics[33m:[39m () [33m=>[39m ({ 
track[33m:[39m analyticsTrackMock })[33m,[39m
     [90m    |[39m                                   
[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[
39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[2
2m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m
^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m
[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[
39m[31m[1m^[22m[39m
     [90m 22 |[39m   }[33m;[39m
     [90m 23 |[39m })[33m;[39m
     [90m 24 |[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/app/(app)/inventory/add.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../inventory/add.tsx:23:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../inventory/add.test.tsx:6:1)

FAIL 
supabase/functions/__tests__/auth-edge-functions.test.ts
  ÔùÅ Test suite failed to run

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when 
your code or its dependencies use non-standard 
JavaScript syntax, or when Jest is not configured to 
support such syntax.

    Out of the box Jest supports Babel, which will be 
used to transform your files into valid JS based on 
your Babel configuration.

    By default "node_modules" folder is ignored by 
transformers.

    Here's what you can do:
     ÔÇó If you are trying to use ECMAScript Modules, 
see https://jestjs.io/docs/ecmascript-modules for how 
to enable it.
     ÔÇó If you are trying to use TypeScript, see 
https://jestjs.io/docs/getting-started#using-typescript
     ÔÇó To have some of your "node_modules" files 
transformed, you can specify a custom 
"transformIgnorePatterns" in your config.
     ÔÇó If you need a custom transformation specify a 
"transform" option in your config.
     ÔÇó If you simply want to mock your non-JS modules 
(e.g. binary assets) you can stub them out with the 
"moduleNameMapper" config option.

    You'll find more details and examples of these 
config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    SyntaxError: C:\Users\Peter\GrowBro\supabase\functio
ns\__tests__\auth-edge-functions.test.ts: Identifier 
'supabase' has already been declared. (71:6)

    [0m [90m 69 |[39m }
     [90m 70 |[39m
    [31m[1m>[22m[39m[90m 71 |[39m [36mconst[39m 
supabase[33m:[39m [33mSupabaseClient[39m 
[33m=[39m createClient(
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 72 |[39m   [33mSUPABASE_URL[39m[33m,[39m
     [90m 73 |[39m   
[33mSUPABASE_SERVICE_ROLE_KEY[39m
     [90m 74 |[39m )[33m;[39m[0m

      at constructor (node_modules/@babel/core/node_modu
les/@babel/parser/src/parse-error.ts:95:45)
      at TypeScriptParserMixin.toParseError [as raise] (
node_modules/@babel/core/node_modules/@babel/parser/src/
tokenizer/index.ts:1503:19)
      at TypeScriptScopeHandler.raise [as 
checkRedeclarationInScope] (node_modules/@babel/core/nod
e_modules/@babel/parser/src/util/scope.ts:164:19)
      at 
TypeScriptScopeHandler.checkRedeclarationInScope (node_m
odules/@babel/core/node_modules/@babel/parser/src/util/s
cope.ts:118:12)
      at TypeScriptScopeHandler.declareName (node_module
s/@babel/core/node_modules/@babel/parser/src/plugins/typ
escript/scope.ts:89:11)
      at TypeScriptParserMixin.declareName [as 
declareNameFromIdentifier] (node_modules/@babel/core/nod
e_modules/@babel/parser/src/parser/lval.ts:818:16)
      at 
TypeScriptParserMixin.declareNameFromIdentifier [as 
checkIdentifier] (node_modules/@babel/core/node_modules/
@babel/parser/src/parser/lval.ts:813:12)
      at TypeScriptParserMixin.checkIdentifier [as 
checkLVal] (node_modules/@babel/core/node_modules/@babel
/parser/src/parser/lval.ts:713:12)
      at TypeScriptParserMixin.checkLVal (node_modules/@
babel/core/node_modules/@babel/parser/src/parser/stateme
nt.ts:1628:10)
      at TypeScriptParserMixin.parseVarId (node_modules/
@babel/core/node_modules/@babel/parser/src/plugins/types
cript/index.ts:3663:13)
      at TypeScriptParserMixin.parseVarId [as parseVar] 
(node_modules/@babel/core/node_modules/@babel/parser/src
/parser/statement.ts:1577:12)
      at TypeScriptParserMixin.parseVar (node_modules/@b
abel/core/node_modules/@babel/parser/src/parser/statemen
t.ts:1246:10)
      at TypeScriptParserMixin.parseVarStatement (node_m
odules/@babel/core/node_modules/@babel/parser/src/plugin
s/typescript/index.ts:3126:33)
      at TypeScriptParserMixin.parseVarStatement (node_m
odules/@babel/core/node_modules/@babel/parser/src/parser
/statement.ts:607:21)
      at TypeScriptParserMixin.parseStatementContent (no
de_modules/@babel/core/node_modules/@babel/parser/src/pl
ugins/typescript/index.ts:3185:20)
      at TypeScriptParserMixin.parseStatementContent 
[as parseStatementLike] (node_modules/@babel/core/node_m
odules/@babel/parser/src/parser/statement.ts:477:17)
      at TypeScriptParserMixin.parseStatementLike [as 
parseModuleItem] (node_modules/@babel/core/node_modules/
@babel/parser/src/parser/statement.ts:414:17)
      at TypeScriptParserMixin.parseModuleItem [as 
parseBlockOrModuleBlockBody] (node_modules/@babel/core/n
ode_modules/@babel/parser/src/parser/statement.ts:1438:1
6)
      at 
TypeScriptParserMixin.parseBlockOrModuleBlockBody [as 
parseBlockBody] (node_modules/@babel/core/node_modules/@
babel/parser/src/parser/statement.ts:1412:10)
      at TypeScriptParserMixin.parseBlockBody [as 
parseProgram] (node_modules/@babel/core/node_modules/@ba
bel/parser/src/parser/statement.ts:229:10)
      at TypeScriptParserMixin.parseProgram [as 
parseTopLevel] (node_modules/@babel/core/node_modules/@b
abel/parser/src/parser/statement.ts:203:25)
      at TypeScriptParserMixin.parseTopLevel (node_modul
es/@babel/core/node_modules/@babel/parser/src/parser/ind
ex.ts:93:10)
      at TypeScriptParserMixin.parse (node_modules/@babe
l/core/node_modules/@babel/parser/src/plugins/typescript
/index.ts:4309:20)
      at parse (node_modules/@babel/core/node_modules/@b
abel/parser/src/index.ts:92:38)
      at parser 
(node_modules/@babel/core/src/parser/index.ts:28:19)
          at parser.next (<anonymous>)
      at normalizeFile (node_modules/@babel/core/src/tra
nsformation/normalize-file.ts:49:24)
          at normalizeFile.next (<anonymous>)
      at run (node_modules/@babel/core/src/transformatio
n/index.ts:40:36)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL supabase/functions/send-push-notification/payload-v
alidator.test.ts
  ÔùÅ Test suite failed to run

    ReferenceError: Deno is not defined

    [0m [90m  9 |[39m } [36mfrom[39m 
[32m'./payload-validator'[39m[33m;[39m
     [90m 10 |[39m
    [31m[1m>[22m[39m[90m 11 |[39m 
[33mDeno[39m[33m.[39mtest([32m'validatePayloadSize 
- accepts small payload'[39m[33m,[39m () 
[33m=>[39m {
     [90m    |[39m [31m[1m^[22m[39m
     [90m 12 |[39m   [36mconst[39m payload 
[33m=[39m {
     [90m 13 |[39m     to[33m:[39m [32m'ExponentPus
hToken[xxxxxxxxxxxxxxxxxxxxxx]'[39m[33m,[39m
     [90m 14 |[39m     title[33m:[39m 
[32m'Test'[39m[33m,[39m[0m

      at Object.Deno (supabase/functions/send-push-notif
ication/payload-validator.test.ts:11:1)

FAIL src/lib/__tests__/sync-status.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/sync/sync-status.tsx:5:1)
      at Object.require 
(src/lib/__tests__/sync-status.test.tsx:4:1)

FAIL src/lib/__tests__/sync-offline-e2e.test.ts
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\lib\__tes
ts__\sync-offline-e2e.test.ts: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: isOnline
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 22 |[39m     auth[33m:[39m {
     [90m 23 |[39m       getSession[33m:[39m 
jest[33m.[39mfn()[33m.[39mmockImplementation(() 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 24 |[39m         
[36mif[39m ([33m![39misOnline) {
     [90m    |[39m              [31m[1m^[22m[39m[
31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[3
9m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22
m[39m[31m[1m^[22m[39m
     [90m 25 |[39m           [36mreturn[39m 
[33mPromise[39m[33m.[39mreject([36mnew[39m 
[33mError[39m([32m'Network 
unavailable'[39m))[33m;[39m
     [90m 26 |[39m         }
     [90m 27 |[39m         [36mreturn[39m 
[33mPromise[39m[33m.[39mresolve({[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/lib/moderation/use-geo-location.test.ts
  ÔùÅ Test suite failed to run

    Cannot find module '../geo-location-service' from 
'src/lib/moderation/use-geo-location.test.ts'

    [0m [90m 21 |[39m [90m// Mock dependencies[39m
     [90m 22 |[39m jest[33m.[39mmock([32m'expo-loca
tion'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 23 |[39m jest[33m.[39mm
ock([32m'../geo-location-service'[39m)[33m;[39m
     [90m    |[39m      [31m[1m^[22m[39m
     [90m 24 |[39m jest[33m.[39mmock([32m'@/lib/sup
abase'[39m)[33m;[39m
     [90m 25 |[39m
     [90m 26 |[39m afterEach(cleanup)[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.mock 
(src/lib/moderation/use-geo-location.test.ts:23:6)

FAIL src/lib/moderation/sor-export-queue.test.ts
  ÔùÅ Test suite failed to run

    PII_SCRUBBING_SALT environment variable is required 
in production

    [0m [90m 76 |[39m     [36mif[39m 
([33m![39msalt) {
     [90m 77 |[39m       [36mif[39m (environment 
[33m===[39m [32m'production'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mthrow[39m [36mnew[39m [33mError[39m(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 79 |[39m           [32m'PII_SCRUBBING_SALT 
environment variable is required in production'[39m
     [90m 80 |[39m         )[33m;[39m
     [90m 81 |[39m       }[0m

      at new PIIScrubber 
(src/lib/moderation/pii-scrubber.ts:78:15)
      at Object.<anonymous> 
(src/lib/moderation/pii-scrubber.ts:332:28)
      at Object.require 
(src/lib/moderation/sor-export-queue.ts:20:1)
      at Object.require 
(src/lib/moderation/sor-export-queue.test.ts:3:1)

FAIL src/lib/moderation/sla-monitor-service.test.ts
  ÔùÅ Test suite failed to run

    Cannot find module '../audit-service' from 
'src/lib/moderation/sla-monitor-service.test.ts'

    [0m [90m 20 |[39m
     [90m 21 |[39m [90m// Mock audit service[39m
    [31m[1m>[22m[39m[90m 22 |[39m jest[33m.[39mm
ock([32m'../audit-service'[39m[33m,[39m () 
[33m=>[39m ({
     [90m    |[39m      [31m[1m^[22m[39m
     [90m 23 |[39m   
[33mAuditService[39m[33m:[39m 
jest[33m.[39mfn()[33m.[39mmockImplementation(() 
[33m=>[39m ({
     [90m 24 |[39m     logEvent[33m:[39m jest[33m.
[39mfn()[33m.[39mmockResolvedValue(undefined)[33m,[3
9m
     [90m 25 |[39m   }))[33m,[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.mock 
(src/lib/moderation/sla-monitor-service.test.ts:22:6)

FAIL src/lib/moderation/pii-scrubber.test.ts
  ÔùÅ Test suite failed to run

    PII_SCRUBBING_SALT environment variable is required 
in production

    [0m [90m 76 |[39m     [36mif[39m 
([33m![39msalt) {
     [90m 77 |[39m       [36mif[39m (environment 
[33m===[39m [32m'production'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mthrow[39m [36mnew[39m [33mError[39m(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 79 |[39m           [32m'PII_SCRUBBING_SALT 
environment variable is required in production'[39m
     [90m 80 |[39m         )[33m;[39m
     [90m 81 |[39m       }[0m

      at new PIIScrubber 
(src/lib/moderation/pii-scrubber.ts:78:15)
      at Object.<anonymous> 
(src/lib/moderation/pii-scrubber.ts:332:28)
      at Object.require 
(src/lib/moderation/pii-scrubber.test.ts:3:1)

FAIL src/components/__tests__/cannabis-educational-banne
r.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/cannabis-educational-banner.tsx:3:1)
      at Object.require (src/components/__tests__/cannab
is-educational-banner.test.tsx:3:1)

FAIL 
src/components/strains/strains-list-with-cache.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\component
s\strains\strains-list-with-cache.test.tsx: The module 
factory of `jest.mock()` is not allowed to reference 
any out-of-scope variables.
    Invalid variable access: _ReactNativeCSSInterop
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.
     (This is an error on an internal node. Probably an 
internal error.)

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/components/strains/strains-empty-state.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/strains-empty-state.tsx:4:1)
      at Object.require (src/components/strains/strains-
empty-state.test.tsx:5:1)

FAIL src/components/strains/strain-card.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\component
s\strains\strain-card.test.tsx: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: React
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 13 |[39m 
jest[33m.[39mmock([32m'expo-router'[39m[33m,[39m 
() [33m=>[39m ({
     [90m 14 |[39m   [33mLink[39m[33m:[39m ({ 
children[33m,[39m href[33m,[39m [33m...[39mprops 
}[33m:[39m any) [33m=>[39m {
    [31m[1m>[22m[39m[90m 15 |[39m     
[36mconst[39m child [33m=[39m [33mReact[39m[33m.
[39m[33mChildren[39m[33m.[39monly(children)[33m;[3
9m
     [90m    |[39m                   [31m[1m^[22m[
39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[2
2m[39m[31m[1m^[22m[39m
     [90m 16 |[39m     [36mreturn[39m 
[33mReact[39m[33m.[39mcloneElement(child[33m,[39m 
{
     [90m 17 |[39m       [33m...[39mprops[33m,[39m
     [90m 18 |[39m       
[33m...[39mchild[33m.[39mprops[33m,[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/components/strains/race-badge.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/race-badge.tsx:3:1)
      at Object.require 
(src/components/strains/race-badge.test.tsx:3:1)

FAIL src/components/strains/filter-modal.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/filter-modal.tsx:5:1)
      at Object.require 
(src/components/strains/filter-modal.test.tsx:11:1)

FAIL src/components/strains/filter-chips.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/filter-chips.tsx:4:1)
      at Object.require 
(src/components/strains/filter-chips.test.tsx:6:1)

FAIL src/components/strains/favorite-button.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/strains/favorite-button.tsx:11:1)
      at Object.require 
(src/components/strains/favorite-button.test.tsx:3:1)

FAIL src/components/strains/did-you-mean.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/did-you-mean.tsx:3:1)
      at Object.require 
(src/components/strains/did-you-mean.test.tsx:7:1)

FAIL src/components/sync/sync-status.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/sync/sync-status.tsx:5:1)
      at Object.require 
(src/components/sync/sync-status.test.tsx:4:1)

FAIL src/components/sync/enhanced-conflict-resolution-mo
dal.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/sync/enhanced-co
nflict-resolution-modal.tsx:14:1)
      at Object.require (src/components/sync/enhanced-co
nflict-resolution-modal.test.tsx:5:1)

FAIL src/components/sync/connectivity-banner.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/sync/connectivity-banner.tsx:3:1)
      at Object.require 
(src/components/sync/connectivity-banner.test.tsx:4:1)

FAIL 
src/components/settings/legal-document-viewer.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/settings/offline-badge.tsx:10:1)
      at Object.require 
(src/components/settings/legal-document-viewer.tsx:12:1)
      at Object.require (src/components/settings/legal-d
ocument-viewer.test.tsx:5:1)

FAIL 
src/components/playbooks/share-template-modal.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/playbooks/share-template-modal.tsx:19:1)
      at Object.require (src/components/playbooks/share-
template-modal.test.tsx:5:1)

FAIL src/components/playbooks/phase-timeline.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/playbooks/phase-timeline.tsx:16:1)
      at Object.require 
(src/components/playbooks/phase-timeline.test.tsx:7:1)

FAIL src/components/playbooks/assumptions-chip.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/playbooks/assumptions-chip.tsx:11:1)
      at Object.require 
(src/components/playbooks/assumptions-chip.test.tsx:5:1)

FAIL src/components/plants/plants-card.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/plants/completion-progress.tsx:10:1)
      at Object.require 
(src/components/plants/index.ts:1:1)
      at Object.require 
(src/components/plants/plants-card.test.tsx:4:1)

FAIL src/components/plants/plant-form.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/plants/completion-progress.tsx:10:1)
      at Object.require 
(src/components/plants/plant-form.tsx:28:1)
      at Object.require 
(src/components/plants/plant-form.test.tsx:6:1)

FAIL src/components/onboarding/permission-primer-screen.
test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/onboarding/permi
ssion-primer-screen.tsx:12:1)
      at Object.require (src/components/onboarding/permi
ssion-primer-screen.test.tsx:5:1)

FAIL src/components/onboarding/pagination-dots.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/onboarding/pagination-dots.tsx:19:1)
      at Object.require (src/components/onboarding/pagin
ation-dots.test.tsx:10:1)

FAIL src/components/onboarding/onboarding-pager.test.tsx
  ÔùÅ Test suite failed to run

    TypeError: Cannot read properties of undefined 
(reading '950')

    [0m [90m 231 |[39m   backdrop[33m:[39m {
     [90m 232 |[39m     [90m// Use centralized 
design token for charcoal 950 and append alpha '66' for 
backdrop[39m
    [31m[1m>[22m[39m[90m 233 |[39m     
backgroundColor[33m:[39m 
[32m`${colors.charcoal[950]}66`[39m[33m,[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 234 |[39m   }[33m,[39m
     [90m 235 |[39m   detached[33m:[39m {
     [90m 236 |[39m     marginHorizontal[33m:[39m 
[35m16[39m[33m,[39m[0m

      at Object.<anonymous> 
(src/components/ui/modal.tsx:233:40)
      at Object.require 
(src/components/ui/date-picker.tsx:21:1)
      at Object.require 
(src/components/ui/index.tsx:7:1)
      at Object.require 
(src/components/onboarding/onboarding-pager.tsx:27:1)
      at Object.require (src/components/onboarding/onboa
rding-pager.test.tsx:19:1)

FAIL src/components/onboarding/notification-permission-p
rimer.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/onboarding/anima
ted-primer-icon.tsx:26:1)
      at Object.require (src/components/onboarding/notif
ication-permission-primer.tsx:11:1)
      at Object.require (src/components/onboarding/notif
ication-permission-primer.test.tsx:6:1)

FAIL 
src/components/nutrient-engine/quality-section.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/nutrient-engine/quality-section.tsx:9:1)
      at Object.require (src/components/nutrient-engine/
quality-section.test.tsx:6:1)

FAIL src/components/nutrient-engine/phase-adjustment-row
.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/nutrient-engine/
phase-adjustment-row.tsx:10:1)
      at Object.require (src/components/nutrient-engine/
phase-adjustment-row.test.tsx:7:1)

FAIL 
src/components/nutrient-engine/ph-ec-input-form.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/nutrient-engine/
ph-ec-input-form.tsx:14:1)
      at Object.require (src/components/nutrient-engine/
ph-ec-input-form.test.tsx:12:1)

FAIL src/components/nutrient-engine/feeding-adjustment-m
odal.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/nutrient-engine/
feeding-adjustment-modal.tsx:15:1)
      at Object.require (src/components/nutrient-engine/
feeding-adjustment-modal.test.tsx:15:1)

FAIL src/components/nutrient/template-list-item.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/nutrient/template-list-item.tsx:14:1)
      at Object.require (src/components/nutrient/templat
e-list-item.test.tsx:12:1)

FAIL src/components/nutrient/strain-profile-save-dialog.
test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/nutrient/strain-
profile-save-dialog.tsx:17:1)
      at Object.require (src/components/nutrient/strain-
profile-save-dialog.test.tsx:5:1)

FAIL src/components/nutrient/reservoir-form.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/nutrient/reservoir-form.tsx:12:1)
      at Object.require 
(src/components/nutrient/reservoir-form.test.tsx:5:1)

FAIL src/components/nutrient/ph-ec-reading-form.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/nutrient/ph-ec-reading-form.tsx:7:1)
      at Object.require (src/components/nutrient/ph-ec-r
eading-form.test.tsx:5:1)

FAIL src/components/nutrient/ph-ec-line-chart.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/nutrient/ph-ec-line-chart.tsx:22:1)
      at Object.require 
(src/components/nutrient/ph-ec-line-chart.test.tsx:11:1)

FAIL src/components/navigation/shared-header.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at requireActual 
(src/components/navigation/shared-header.test.tsx:17:36)
      at Object.require 
(src/components/navigation/shared-header.tsx:14:1)
      at Object.require 
(src/components/navigation/shared-header.test.tsx:6:1)

FAIL 
src/components/moderation/sor-preview-panels.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/moderation/sor-preview-panels.tsx:11:1)
      at Object.require (src/components/moderation/sor-p
review-panels.test.tsx:5:1)

FAIL src/components/moderation/original-decision-context
.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/moderation/origi
nal-decision-context.tsx:4:1)
      at Object.require (src/components/moderation/origi
nal-decision-context.test.tsx:6:1)

FAIL src/components/moderation/flagger-analytics-dashboa
rd.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/moderation/flagg
er-analytics-dashboard.tsx:11:1)
      at Object.require (src/components/moderation/flagg
er-analytics-dashboard.test.tsx:5:1)

FAIL src/components/moderation/counter-arguments-input.t
est.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/moderation/count
er-arguments-input.tsx:4:1)
      at Object.require (src/components/moderation/count
er-arguments-input.test.tsx:5:1)

FAIL src/components/inventory/inventory-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/inventory/inventory-list-item.tsx:14:1)
      at Object.require 
(src/components/inventory/inventory-list.tsx:23:1)
      at Object.require 
(src/components/inventory/inventory-list.test.tsx:11:1)

FAIL src/components/inventory/consumption-trend-chart.te
st.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/inventory/consum
ption-trend-chart.tsx:9:1)
      at Object.require (src/components/inventory/consum
ption-trend-chart.test.tsx:6:1)

FAIL src/components/inventory/batch-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/inventory/batch-list-item.tsx:13:1)
      at Object.require 
(src/components/inventory/batch-list.tsx:12:1)
      at Object.require 
(src/components/inventory/batch-list.test.tsx:12:1)

FAIL src/components/home/activation-checklist.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/home/activation-checklist.tsx:9:1)
      at Object.require 
(src/components/home/activation-checklist.test.tsx:12:1)

FAIL src/components/harvest/weight-chart.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\component
s\harvest\weight-chart.test.tsx: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: View
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 17 |[39m   
[33mLineChart[39m[33m:[39m ({ data[33m,[39m 
testID }[33m:[39m any) [33m=>[39m {
     [90m 18 |[39m     [36mreturn[39m (
    [31m[1m>[22m[39m[90m 19 |[39m       
[33m<[39m[33mView[39m testID[33m=[39m{testID 
[33m||[39m [32m'line-chart'[39m}[33m>[39m
     [90m    |[39m        [31m[1m^[22m[39m[31m[1
m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
     [90m 20 |[39m         [33m<[39m[33mText[39m t
estID[33m=[39m[32m"chart-data-count"[39m[33m>[39m{
data[33m.[39mlength}[33m<[39m[33m/[39m[33mText[3
9m[33m>[39m
     [90m 21 |[39m         
{data[33m.[39mmap((point[33m:[39m any[33m,[39m 
index[33m:[39m number) [33m=>[39m (
     [90m 22 |[39m           
[33m<[39m[33mText[39m key[33m=[39m{index} testID[
33m=[39m{[32m`chart-point-${index}`[39m}[33m>[39m[
0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/components/harvest/weight-chart-table.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/harvest/weight-chart-table.tsx:14:1)
      at Object.require (src/components/harvest/weight-c
hart-table.test.tsx:12:1)

FAIL src/components/harvest/weight-chart-empty.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/harvest/weight-chart-empty.tsx:12:1)
      at Object.require (src/components/harvest/weight-c
hart-empty.test.tsx:11:1)

FAIL 
src/components/harvest/harvest-history-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/harvest/harvest-history-list.tsx:4:1)
      at Object.require (src/components/harvest/harvest-
history-list.test.tsx:8:1)

FAIL 
src/components/harvest/harvest-error-banner.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/harvest/harvest-error-banner.tsx:11:1)
      at Object.require (src/components/harvest/harvest-
error-banner.test.tsx:11:1)

FAIL 
src/components/harvest/harvest-chart-container.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\component
s\harvest\harvest-chart-container.test.tsx: The module 
factory of `jest.mock()` is not allowed to reference 
any out-of-scope variables.
    Invalid variable access: View
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 17 |[39m jest[33m.[39mmock([32m'./wei
ght-chart'[39m[33m,[39m () [33m=>[39m ({
     [90m 18 |[39m   [33mWeightChart[39m[33m:[39m 
jest[33m.[39mfn((props[33m:[39m any) [33m=>[39m (
    [31m[1m>[22m[39m[90m 19 |[39m     
[33m<[39m[33mView[39m 
testID[33m=[39m{props[33m.[39mtestID [33m||[39m 
[32m'weight-chart'[39m}[33m>[39m
     [90m    |[39m      [31m[1m^[22m[39m[31m[1m^
[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
     [90m 20 |[39m       [33m<[39m[33mText[39m tes
tID[33m=[39m{[32m`${props.testID}-data-count`[39m}[
33m>[39m{props[33m.[39mdata[33m.[39mlength}[33m<[
39m[33m/[39m[33mText[39m[33m>[39m
     [90m 21 |[39m     
[33m<[39m[33m/[39m[33mView[39m[33m>[39m
     [90m 22 |[39m   ))[33m,[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL 
src/components/community/user-profile-header.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/community/user-profile-header.tsx:10:1)
      at Object.require (src/components/community/user-p
rofile-header.test.tsx:12:1)

FAIL 
src/components/community/community-empty-state.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/community/community-empty-state.tsx:4:1)
      at Object.require (src/components/community/commun
ity-empty-state.test.tsx:5:1)

FAIL 
src/components/calendar/draggable-agenda-item.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/calendar/drag-handle.tsx:4:1)
      at Object.require 
(src/components/calendar/agenda-item.tsx:4:1)
      at Object.require 
(src/components/calendar/draggable-agenda-item.tsx:14:1)
      at Object.require (src/components/calendar/draggab
le-agenda-item.test.tsx:4:1)

FAIL 
src/components/calendar/calendar-empty-state.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/calendar/calendar-empty-state.tsx:4:1)
      at Object.require (src/components/calendar/calenda
r-empty-state.test.tsx:5:1)

FAIL src/components/calendar/agenda-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/calendar/agenda-list.test.tsx:5:1)

FAIL src/components/calendar/agenda-item.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/calendar/drag-handle.tsx:4:1)
      at Object.require 
(src/components/calendar/agenda-item.tsx:4:1)
      at Object.require 
(src/components/calendar/agenda-item.test.tsx:6:1)

FAIL src/components/auth/offline-mode-banner.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/auth/offline-mode-banner.tsx:4:1)
      at Object.require 
(src/components/auth/offline-mode-banner.test.tsx:3:1)

FAIL 
src/components/assessment/queue-status-sheet.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/assessment/queue-status-sheet.tsx:4:1)
      at Object.require (src/components/assessment/queue
-status-sheet.test.tsx:5:1)

FAIL 
src/components/assessment/diagnostic-checklist.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/assessment/diagnostic-checklist.tsx:5:1)
      at Object.require (src/components/assessment/diagn
ostic-checklist.test.tsx:6:1)

FAIL 
src/components/assessment/community-cta-button.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/assessment/commu
nity-cta-button.tsx:13:1)
      at Object.require (src/components/assessment/commu
nity-cta-button.test.tsx:15:1)

FAIL src/components/assessment/assessment-feedback-sheet
.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/assessment/asses
sment-feedback-sheet.tsx:5:1)
      at Object.require (src/components/assessment/asses
sment-feedback-sheet.test.tsx:5:1)

FAIL 
src/app/__tests__/post-moderation-visibility.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/community/comment-input-footer.tsx:7:1)
      at Object.require 
(src/components/community/post-detail-content.tsx:10:1)
      at Object.require (src/app/feed/[id].tsx:22:1)
      at Object.require (src/app/__tests__/post-moderati
on-visibility.test.tsx:3:1)

FAIL src/app/__tests__/onboarding-flow.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/legal-confirmation-modal.tsx:5:1)
      at Object.require (src/app/age-gate.tsx:6:1)
      at Object.require 
(src/app/__tests__/onboarding-flow.test.tsx:13:1)

FAIL src/app/__tests__/calendar-works-without-notificati
ons.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/calendar/month-picker-modal.tsx:7:1)
      at Object.require 
(src/components/calendar/calendar-header.tsx:7:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../calendar.tsx:12:1)
      at Object.require (src/app/__tests__/calendar-work
s-without-notifications.test.tsx:4:1)

FAIL src/app/__tests__/add-post.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\app\__tes
ts__\add-post.test.tsx: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: mutateMock
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 18 |[39m
     [90m 19 |[39m 
jest[33m.[39mmock([32m'@/api'[39m[33m,[39m () 
[33m=>[39m ({
    [31m[1m>[22m[39m[90m 20 |[39m   
useAddPost[33m:[39m () [33m=>[39m ({ 
mutate[33m:[39m mutateMock[33m,[39m 
isPending[33m:[39m [36mfalse[39m })[33m,[39m
     [90m    |[39m                                [31
m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m
[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[
22m[39m[31m[1m^[22m[39m
     [90m 21 |[39m }))[33m;[39m
     [90m 22 |[39m
     [90m 23 |[39m jest[33m.[39mmock([32m'@/lib/ass
essment/community-post-prefill'[39m[33m,[39m () 
[33m=>[39m ({[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/app/settings/storage.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/app/settings/storage.tsx:14:1)
      at Object.require 
(src/app/settings/storage.test.tsx:5:1)

FAIL src/app/settings/security.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/auth/change-password-modal.tsx:16:1)
      at Object.require 
(src/app/settings/security.tsx:12:1)
      at Object.require 
(src/app/settings/security.test.tsx:4:1)

FAIL src/app/settings/delete-account.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/app/settings/delete-account.tsx:23:1)
      at Object.require 
(src/app/settings/delete-account.test.tsx:12:1)

FAIL src/app/settings/delete-account-flow.test.tsx
  ÔùÅ Test suite failed to run

    TypeError: Cannot read properties of undefined 
(reading 'SCROLLVIEW')

    [0m [90m 39 |[39m   
[33mBottomSheetScrollViewMethods[39m[33m,[39m
     [90m 40 |[39m   
[33mBottomSheetKeyboardAwareProps[39m
    [31m[1m>[22m[39m[90m 41 |[39m [33m>[39m([33
mSCROLLABLE_TYPE[39m[33m.[39m[33mSCROLLVIEW[39m[33
m,[39m [33mAnimatedScrollView[39m)[33m;[39m
     [90m    |[39m                   
[31m[1m^[22m[39m
     [90m 42 |[39m [36mconst[39m 
[33mBottomSheetKeyboardAwareScrollView[39m 
[33m=[39m memo([33mBottomSheetScrollViewComponent[39
m)[33m;[39m
     [90m 43 |[39m
     [90m 44 |[39m [33mBottomSheetKeyboardAwareScroll
View[39m[33m.[39mdisplayName [33m=[39m[0m

      at Object.SCROLLVIEW (src/components/ui/modal-keyb
oard-aware-scroll-view.tsx:41:19)
      at Object.require 
(src/components/auth/re-auth-modal.tsx:20:1)
      at Object.require 
(src/app/settings/delete-account.tsx:22:1)
      at Object.require 
(src/app/settings/delete-account-flow.test.tsx:21:1)

FAIL src/app/settings/active-sessions.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/auth/session-list-item.tsx:6:1)
      at Object.require 
(src/app/settings/active-sessions.tsx:5:1)
      at Object.require 
(src/app/settings/active-sessions.test.tsx:6:1)

FAIL src/app/settings/about.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/settings/item.tsx:3:1)
      at Object.require (src/app/settings/about.tsx:8:1)
      at Object.require 
(src/app/settings/about.test.tsx:10:1)

FAIL src/app/(app)/index.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/home/activation-checklist.tsx:9:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../index.tsx:10:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../index.test.tsx:7:1)

FAIL src/app/(modals)/trichome-helper.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/trichome/harvest
-suggestion-card.tsx:10:1)
      at Object.require 
(src/components/trichome/index.ts:7:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(modals)../../../trichome-helper.tsx:13:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(modals)../../../trichome-helper.test.tsx:6:1)

FAIL src/api/community/use-like-post.test.ts
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\api\commu
nity\use-like-post.test.ts: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: canonicalState
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 44 |[39m     constructor(
     [90m 45 |[39m       message[33m:[39m 
string[33m,[39m
    [31m[1m>[22m[39m[90m 46 |[39m       
[36mpublic[39m readonly canonicalState[33m:[39m {
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 47 |[39m         
post_id[33m?[39m[33m:[39m string[33m;[39m
     [90m 48 |[39m         
user_id[33m?[39m[33m:[39m string[33m;[39m
     [90m 49 |[39m         
exists[33m?[39m[33m:[39m boolean[33m;[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/components/privacy-settings.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/privacy-settings.tsx:5:1)
      at Object.require 
(src/components/privacy-settings.test.tsx:9:1)

FAIL src/components/photo-capture.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/photo-capture.tsx:6:1)
      at Object.require 
(src/components/photo-capture.test.tsx:5:1)

FAIL src/components/moderation-actions.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/community/modera
tor-tools-modal.tsx:20:1)
      at Object.require 
(src/components/moderation-actions.tsx:3:1)
      at Object.require 
(src/components/moderation-actions.test.tsx:14:1)

FAIL src/components/login-form.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\component
s\login-form.test.tsx: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: hasPlayServicesMock
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 13 |[39m   __esModule[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 14 |[39m   
[33mGoogleSignin[39m[33m:[39m {
    [31m[1m>[22m[39m[90m 15 |[39m     
hasPlayServices[33m:[39m 
hasPlayServicesMock[33m,[39m
     [90m    |[39m                      [31m[1m^[22
m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^
[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m
[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[
31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[3
9m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22
m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^
[22m[39m[31m[1m^[22m[39m
     [90m 16 |[39m     signIn[33m:[39m 
googleSignInMock[33m,[39m
     [90m 17 |[39m   }[33m,[39m
     [90m 18 |[39m   
[33mGoogleSigninButton[39m[33m:[39m ({ 
onPress[33m,[39m testID }[33m:[39m any) 
[33m=>[39m ([0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/components/legal-confirmation-modal.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/legal-confirmation-modal.tsx:5:1)
      at Object.require 
(src/components/legal-confirmation-modal.test.tsx:12:1)

FAIL src/components/inputs.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/inputs.tsx:4:1)
      at Object.require 
(src/components/inputs.test.tsx:5:1)

FAIL src/components/consent-modal.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/consent-modal.tsx:5:1)
      at Object.require 
(src/components/consent-modal.test.tsx:5:1)

FAIL src/app/camera-primer.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/onboarding/anima
ted-primer-icon.tsx:26:1)
      at Object.require (src/components/onboarding/camer
a-permission-primer.tsx:11:1)
      at Object.require 
(src/components/onboarding/index.ts:1:1)
      at Object.require (src/app/camera-primer.tsx:4:1)
      at Object.require 
(src/app/camera-primer.test.tsx:6:1)

Summary of all failing tests
FAIL src/lib/moderation/monitoring-service.test.ts 
(72.671 s)
  ÔùÅ MonitoringService ÔÇ║ getDashboard ÔÇ║ should 
return comprehensive monitoring dashboard

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 34 |[39m
     [90m 35 |[39m   
describe([32m'getDashboard'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 36 |[39m     
it([32m'should return comprehensive monitoring 
dashboard'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 37 |[39m       [90m// Mock all database 
queries[39m
     [90m 38 |[39m       mockSupabase[33m.[39m[36mf
rom[39m[33m.[39mmockReturnValue({
     [90m 39 |[39m         select[33m:[39m jest[33m
.[39mfn()[33m.[39mmockReturnThis()[33m,[39m[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:36:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:35:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

  ÔùÅ MonitoringService ÔÇ║ getDashboard ÔÇ║ should 
calculate health status based on alerts

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 57 |[39m     }[33m,[39m 
[35m10000[39m)[33m;[39m
     [90m 58 |[39m
    [31m[1m>[22m[39m[90m 59 |[39m     
it([32m'should calculate health status based on 
alerts'[39m[33m,[39m [36masync[39m () [33m=>[39m 
{
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 60 |[39m       mockSupabase[33m.[39m[36mf
rom[39m[33m.[39mmockReturnValue({
     [90m 61 |[39m         select[33m:[39m jest[33m
.[39mfn()[33m.[39mmockReturnThis()[33m,[39m
     [90m 62 |[39m         eq[33m:[39m jest[33m.[3
9mfn()[33m.[39mmockReturnThis()[33m,[39m[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:59:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:35:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

  ÔùÅ MonitoringService ÔÇ║ getAuditIntegrityMetrics 
ÔÇ║ should detect signature mismatches

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 1
    Received:    0

    [0m [90m 216 |[39m       [36mconst[39m metrics 
[33m=[39m [36mawait[39m 
service[33m.[39mgetAuditIntegrityMetrics()[33m;[39m
     [90m 217 |[39m
    [31m[1m>[22m[39m[90m 218 |[39m       expect(me
trics[33m.[39msignature_mismatches)[33m.[39mtoBeGrea
terThanOrEqual([35m1[39m)[33m;[39m
     [90m     |[39m                                   
         [31m[1m^[22m[39m
     [90m 219 |[39m       expect(metrics[33m.[39mint
egrity_violations)[33m.[39mtoBeGreaterThanOrEqual([35
m1[39m)[33m;[39m
     [90m 220 |[39m     })[33m;[39m
     [90m 221 |[39m   })[33m;[39m[0m

      at Object.toBeGreaterThanOrEqual 
(src/lib/moderation/monitoring-service.test.ts:218:44)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ MonitoringService ÔÇ║ getCapacityMetrics ÔÇ║ 
should calculate queue depths

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 222 |[39m
     [90m 223 |[39m   
describe([32m'getCapacityMetrics'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 224 |[39m     
it([32m'should calculate queue depths'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 225 |[39m       mockSupabase[33m.[39m[36m
from[39m[33m.[39mmockImplementation((table[33m:[39m
 string) [33m=>[39m {
     [90m 226 |[39m         [36mconst[39m 
counts[33m:[39m 
[33mRecord[39m[33m<[39m[33mstring[39m[33m,[39m 
number[33m>[39m [33m=[39m {
     [90m 227 |[39m           reports[33m:[39m 
[35m50[39m[33m,[39m[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:224:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:223:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

  ÔùÅ MonitoringService ÔÇ║ getCapacityMetrics ÔÇ║ 
should calculate moderator utilization

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 250 |[39m     }[33m,[39m 
[35m10000[39m)[33m;[39m
     [90m 251 |[39m
    [31m[1m>[22m[39m[90m 252 |[39m     
it([32m'should calculate moderator 
utilization'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 253 |[39m       mockSupabase[33m.[39m[36m
from[39m[33m.[39mmockImplementation((table[33m:[39m
 string) [33m=>[39m {
     [90m 254 |[39m         [36mif[39m (table 
[33m===[39m [32m'moderation_sessions'[39m) {
     [90m 255 |[39m           [36mreturn[39m {[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:252:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:223:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

  ÔùÅ MonitoringService ÔÇ║ getCapacityMetrics ÔÇ║ 
should estimate capacity hours

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 279 |[39m     }[33m,[39m 
[35m10000[39m)[33m;[39m
     [90m 280 |[39m
    [31m[1m>[22m[39m[90m 281 |[39m     
it([32m'should estimate capacity 
hours'[39m[33m,[39m [36masync[39m () [33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 282 |[39m       mockSupabase[33m.[39m[36m
from[39m[33m.[39mmockReturnValue({
     [90m 283 |[39m         select[33m:[39m jest[33
m.[39mfn()[33m.[39mmockReturnThis()[33m,[39m
     [90m 284 |[39m         [36min[39m[33m:[39m je
st[33m.[39mfn()[33m.[39mmockReturnThis()[33m,[39m
[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:281:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:223:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

  ÔùÅ MonitoringService ÔÇ║ Alert Generation ÔÇ║ should 
generate performance alerts for high latency

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 296 |[39m
     [90m 297 |[39m   describe([32m'Alert 
Generation'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 298 |[39m     
it([32m'should generate performance alerts for high 
latency'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 299 |[39m       mockSupabase[33m.[39m[36m
from[39m[33m.[39mmockReturnValue({
     [90m 300 |[39m         select[33m:[39m jest[33
m.[39mfn()[33m.[39mmockReturnThis()[33m,[39m
     [90m 301 |[39m         eq[33m:[39m jest[33m.[
39mfn()[33m.[39mmockReturnThis()[33m,[39m[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:298:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:297:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

  ÔùÅ MonitoringService ÔÇ║ Alert Generation ÔÇ║ should 
generate compliance alerts for DSA failures

    TypeError: _supabase.supabase.from(...).select(...).
eq(...).gte(...).order is not a function

    [0m [90m 188 |[39m       
[33m.[39meq([32m'event_type'[39m[33m,[39m 
[32m'report_submitted'[39m)
     [90m 189 |[39m       
[33m.[39mgte([32m'timestamp'[39m[33m,[39m 
oneHourAgo[33m.[39mtoISOString())
    [31m[1m>[22m[39m[90m 190 |[39m       
[33m.[39morder([32m'timestamp'[39m[33m,[39m { 
ascending[33m:[39m [36mfalse[39m })
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 191 |[39m       
[33m.[39mlimit([35m1000[39m)[33m;[39m
     [90m 192 |[39m
     [90m 193 |[39m     [36mconst[39m { 
data[33m:[39m decisionTimes } [33m=[39m 
[36mawait[39m supabase[0m

      at MonitoringService.order 
(src/lib/moderation/monitoring-service.ts:190:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at MonitoringService.<anonymous> (node_modules/@ba
bel/runtime/helpers/asyncToGenerator.js:14:12)
      at MonitoringService.apply [as 
getPerformanceMetrics] 
(src/lib/moderation/monitoring-service.ts:180:30)
      at MonitoringService.getPerformanceMetrics 
(src/lib/moderation/monitoring-service.ts:152:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at MonitoringService.<anonymous> (node_modules/@ba
bel/runtime/helpers/asyncToGenerator.js:14:12)
      at MonitoringService.apply [as getDashboard] 
(src/lib/moderation/monitoring-service.ts:150:21)
      at Object.getDashboard 
(src/lib/moderation/monitoring-service.test.ts:337:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ MonitoringService ÔÇ║ Alert Generation ÔÇ║ should 
generate capacity alerts for low capacity

    thrown: "Exceeded timeout of 10000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 343 |[39m     }[33m,[39m 
[35m10000[39m)[33m;[39m
     [90m 344 |[39m
    [31m[1m>[22m[39m[90m 345 |[39m     
it([32m'should generate capacity alerts for low 
capacity'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 346 |[39m       mockSupabase[33m.[39m[36m
from[39m[33m.[39mmockReturnValue({
     [90m 347 |[39m         select[33m:[39m jest[33
m.[39mfn()[33m.[39mmockReturnThis()[33m,[39m
     [90m 348 |[39m         eq[33m:[39m jest[33m.[
39mfn()[33m.[39mmockReturnThis()[33m,[39m[0m

      at it 
(src/lib/moderation/monitoring-service.test.ts:345:5)
      at describe 
(src/lib/moderation/monitoring-service.test.ts:297:3)
      at Object.describe 
(src/lib/moderation/monitoring-service.test.ts:23:1)

FAIL src/lib/inventory/__tests__/telemetry-performance.t
est.ts (30.084 s)
  ÔùÅ Inventory Telemetry Performance ÔÇ║ Low Stock 
Tracking Overhead ÔÇ║ should have <1% overhead on stock 
checks

    expect(received).toBeLessThan(expected)

    Expected: < 1
    Received:   84.43456162642948

    [0m [90m 64 |[39m       [36mconst[39m 
overheadPercent [33m=[39m (overhead [33m/[39m 
baselineDuration) [33m*[39m [35m100[39m[33m;[39m
     [90m 65 |[39m
    [31m[1m>[22m[39m[90m 66 |[39m       expect(ove
rheadPercent)[33m.[39mtoBeLessThan([35m1[39m)[33m;
[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 67 |[39m       expect([33mNoopAnalytics[39
m[33m.[39mtrack)[33m.[39mtoHaveBeenCalledTimes(itera
tions)[33m;[39m
     [90m 68 |[39m     })[33m;[39m
     [90m 69 |[39m   })[33m;[39m[0m

      at Object.toBeLessThan (src/lib/inventory/__tests_
_/telemetry-performance.test.ts:66:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Telemetry Performance ÔÇ║ Deduction 
Failure Tracking Overhead ÔÇ║ should have <1% overhead 
on deduction failures

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 70 |[39m
     [90m 71 |[39m   describe([32m'Deduction Failure 
Tracking Overhead'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 72 |[39m     
it([32m'should have <1% overhead on deduction 
failures'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 73 |[39m       [36mconst[39m 
operationTime [33m=[39m [35m50[39m[33m;[39m 
[90m// 50ms for deduction operation[39m
     [90m 74 |[39m       [36mconst[39m iterations 
[33m=[39m [35m50[39m[33m;[39m
     [90m 75 |[39m[0m

      at it (src/lib/inventory/__tests__/telemetry-perfo
rmance.test.ts:72:5)
      at describe (src/lib/inventory/__tests__/telemetry
-performance.test.ts:71:3)
      at Object.describe (src/lib/inventory/__tests__/te
lemetry-performance.test.ts:31:1)

  ÔùÅ Inventory Telemetry Performance ÔÇ║ Import Error 
Tracking Overhead ÔÇ║ should have <1% overhead on 
import operations

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 106 |[39m
     [90m 107 |[39m   describe([32m'Import Error 
Tracking Overhead'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 108 |[39m     
it([32m'should have <1% overhead on import 
operations'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 109 |[39m       [36mconst[39m 
operationTime [33m=[39m [35m200[39m[33m;[39m 
[90m// 200ms for import operation[39m
     [90m 110 |[39m       [36mconst[39m iterations 
[33m=[39m [35m20[39m[33m;[39m
     [90m 111 |[39m[0m

      at it (src/lib/inventory/__tests__/telemetry-perfo
rmance.test.ts:108:5)
      at describe (src/lib/inventory/__tests__/telemetry
-performance.test.ts:107:3)
      at Object.describe (src/lib/inventory/__tests__/te
lemetry-performance.test.ts:31:1)

  ÔùÅ Inventory Telemetry Performance ÔÇ║ CSV Operation 
Tracking Overhead ÔÇ║ should have <1% overhead on CSV 
export

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 137 |[39m
     [90m 138 |[39m   describe([32m'CSV Operation 
Tracking Overhead'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 139 |[39m     
it([32m'should have <1% overhead on CSV 
export'[39m[33m,[39m [36masync[39m () [33m=>[39m 
{
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 140 |[39m       [36mconst[39m 
operationTime [33m=[39m [35m1000[39m[33m;[39m 
[90m// 1000ms for large CSV export[39m
     [90m 141 |[39m       [36mconst[39m iterations 
[33m=[39m [35m10[39m[33m;[39m
     [90m 142 |[39m[0m

      at it (src/lib/inventory/__tests__/telemetry-perfo
rmance.test.ts:139:5)
      at describe (src/lib/inventory/__tests__/telemetry
-performance.test.ts:138:3)
      at Object.describe (src/lib/inventory/__tests__/te
lemetry-performance.test.ts:31:1)

  ÔùÅ Inventory Telemetry Performance ÔÇ║ Batch 
Operation Tracking Overhead ÔÇ║ should have <1% 
overhead on batch operations

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 170 |[39m
     [90m 171 |[39m   describe([32m'Batch Operation 
Tracking Overhead'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 172 |[39m     
it([32m'should have <1% overhead on batch 
operations'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 173 |[39m       [36mconst[39m 
operationTime [33m=[39m [35m30[39m[33m;[39m 
[90m// 30ms for batch operation[39m
     [90m 174 |[39m       [36mconst[39m iterations 
[33m=[39m [35m100[39m[33m;[39m
     [90m 175 |[39m[0m

      at it (src/lib/inventory/__tests__/telemetry-perfo
rmance.test.ts:172:5)
      at describe (src/lib/inventory/__tests__/telemetry
-performance.test.ts:171:3)
      at Object.describe (src/lib/inventory/__tests__/te
lemetry-performance.test.ts:31:1)

  ÔùÅ Inventory Telemetry Performance ÔÇ║ Memory Impact 
ÔÇ║ should not accumulate memory with repeated tracking

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 233 |[39m
     [90m 234 |[39m   describe([32m'Memory 
Impact'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 235 |[39m     
it([32m'should not accumulate memory with repeated 
tracking'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 236 |[39m       [36mconst[39m iterations 
[33m=[39m [35m1000[39m[33m;[39m
     [90m 237 |[39m
     [90m 238 |[39m       [90m// Track memory 
before[39m[0m

      at it (src/lib/inventory/__tests__/telemetry-perfo
rmance.test.ts:235:5)
      at describe (src/lib/inventory/__tests__/telemetry
-performance.test.ts:234:3)
      at Object.describe (src/lib/inventory/__tests__/te
lemetry-performance.test.ts:31:1)

FAIL src/lib/strains/__tests__/integration.test.tsx 
(9.581 s)
  ÔùÅ Strains Feature Integration ÔÇ║ Data Fetching 
Integration ÔÇ║ should fetch strains list successfully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 89 |[39m       })[33m;[39m
     [90m 90 |[39m
    [31m[1m>[22m[39m[90m 91 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m    |[39m                    
[31m[1m^[22m[39m
     [90m 92 |[39m         expect(result[33m.[39mcur
rent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m 93 |[39m       })[33m;[39m
     [90m 94 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:91:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Data Fetching 
Integration ÔÇ║ should fetch single strain detail 
successfully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 118 |[39m       })[33m;[39m
     [90m 119 |[39m
    [31m[1m>[22m[39m[90m 120 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 121 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m
)[33m;[39m
     [90m 122 |[39m       })[33m;[39m
     [90m 123 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:120:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Data Fetching 
Integration ÔÇ║ should handle API errors gracefully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 135 |[39m       })[33m;[39m
     [90m 136 |[39m
    [31m[1m>[22m[39m[90m 137 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 138 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misError)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m 139 |[39m       })[33m;[39m
     [90m 140 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:137:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Search and Filter 
Integration ÔÇ║ should apply search query correctly

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 158 |[39m       )[33m;[39m
     [90m 159 |[39m
    [31m[1m>[22m[39m[90m 160 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 161 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m
)[33m;[39m
     [90m 162 |[39m       })[33m;[39m
     [90m 163 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:160:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Search and Filter 
Integration ÔÇ║ should apply filters correctly

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 190 |[39m       )[33m;[39m
     [90m 191 |[39m
    [31m[1m>[22m[39m[90m 192 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 193 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m
)[33m;[39m
     [90m 194 |[39m       })[33m;[39m
     [90m 195 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:192:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Infinite Scroll 
Integration ÔÇ║ should load next page on fetchNextPage

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 230 |[39m       })[33m;[39m
     [90m 231 |[39m
    [31m[1m>[22m[39m[90m 232 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 233 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m
)[33m;[39m
     [90m 234 |[39m       })[33m;[39m
     [90m 235 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:232:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Performance 
Integration ÔÇ║ should cache responses appropriately

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 310 |[39m       })[33m;[39m
     [90m 311 |[39m
    [31m[1m>[22m[39m[90m 312 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 313 |[39m         expect(result1[33m.[39mc
urrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39
m)[33m;[39m
     [90m 314 |[39m       })[33m;[39m
     [90m 315 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:312:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Strains Feature Integration ÔÇ║ Error Recovery 
Integration ÔÇ║ should retry failed requests

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 342 |[39m       })[33m;[39m
     [90m 343 |[39m
    [31m[1m>[22m[39m[90m 344 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 345 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misError)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m 346 |[39m       })[33m;[39m
     [90m 347 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/__tests__/integration.test.tsx:344:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/nutrient-engine/services/alert-service-obse
rve.test.ts (11.388 s)
  ÔùÅ observeActiveAlerts ÔÇ║ observable behavior ÔÇ║ 
queries ph_ec_readings_v2 with reservoir_id filter

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
    -   "_condition": "where",
    -   "left": "reservoir_id",
    -   "right": "test-reservoir-id",
    +   "key": "reservoir_id",
    +   "value": "test-reservoir-id",
      },

    Number of calls: 1

    [0m [90m 53 |[39m
     [90m 54 |[39m       expect(mockDb[33m.[39m[36m
get[39m)[33m.[39mtoHaveBeenCalledWith([32m'ph_ec_rea
dings_v2'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 55 |[39m       expect(moc
kTable[33m.[39mquery)[33m.[39mtoHaveBeenCalledWith({
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 56 |[39m         _condition[33m:[39m 
[32m'where'[39m[33m,[39m
     [90m 57 |[39m         left[33m:[39m 
[32m'reservoir_id'[39m[33m,[39m
     [90m 58 |[39m         right[33m:[39m 
[32m'test-reservoir-id'[39m[33m,[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/nutrient-e
ngine/services/alert-service-observe.test.ts:55:31)

  ÔùÅ observeActiveAlerts ÔÇ║ observable behavior ÔÇ║ 
returns empty observable when no readings exist

    expect(jest.fn()).toHaveBeenNthCalledWith(n, 
...expected)

    n: 2
    Expected: "deviation_alerts_v2"
    Received
           1: "ph_ec_readings_v2"

    Number of calls: 1

    [0m [90m 116 |[39m           
expect(alerts)[33m.[39mtoEqual([])[33m;[39m
     [90m 117 |[39m           expect(mockDb[33m.[39m
[36mget[39m)[33m.[39mtoHaveBeenNthCalledWith([35m1
[39m[33m,[39m 
[32m'ph_ec_readings_v2'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 118 |[39m           expec
t(mockDb[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenNt
hCalledWith([35m2[39m[33m,[39m 
[32m'deviation_alerts_v2'[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 119 |[39m
     [90m 120 |[39m           [90m// Verify empty 
query condition (id = '')[39m
     [90m 121 |[39m           expect(mockAlertsQueryBu
ilder[33m.[39mobserve)[33m.[39mtoHaveBeenCalled()[3
3m;[39m[0m

      at Object.toHaveBeenNthCalledWith [as next] (src/l
ib/nutrient-engine/services/alert-service-observe.test.t
s:118:30)
      at Timeout.next [as _onTimeout] (src/lib/nutrient-
engine/services/alert-service-observe.test.ts:73:42)

  ÔùÅ observeActiveAlerts ÔÇ║ observable behavior ÔÇ║ 
returns empty observable when no readings exist

    thrown: "Exceeded timeout of 5000 ms for a test 
while waiting for `done()` to be called.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 62 |[39m     })[33m;[39m
     [90m 63 |[39m
    [31m[1m>[22m[39m[90m 64 |[39m     
test([32m'returns empty observable when no readings 
exist'[39m[33m,[39m (done) [33m=>[39m {
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 65 |[39m       [36mconst[39m 
mockReadings[33m:[39m [33mPhEcReadingModel[39m[] 
[33m=[39m [][33m;[39m
     [90m 66 |[39m
     [90m 67 |[39m       [90m// Mock readings 
observable that emits empty array[39m[0m

      at test (src/lib/nutrient-engine/services/alert-se
rvice-observe.test.ts:64:5)
      at describe (src/lib/nutrient-engine/services/aler
t-service-observe.test.ts:34:3)
      at Object.describe (src/lib/nutrient-engine/servic
es/alert-service-observe.test.ts:12:1)

  ÔùÅ observeActiveAlerts ÔÇ║ observable behavior ÔÇ║ 
queries deviation_alerts_v2 with correct filters when 
readings exist

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 4

      Array [
        Object {
    -     "id": "alert-1",
    -     "readingId": "reading-1",
    +     "id": "reading-1",
    +   },
    +   Object {
    +     "id": "reading-2",
        },
      ]

    [0m [90m 205 |[39m       
observable[33m.[39msubscribe({
     [90m 206 |[39m         next[33m:[39m (alerts) 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 207 |[39m           
expect(alerts)[33m.[39mtoEqual(mockAlerts)[33m;[39m
     [90m     |[39m                          
[31m[1m^[22m[39m
     [90m 208 |[39m
     [90m 209 |[39m           [90m// Verify queries 
were called[39m
     [90m 210 |[39m           expect(mockDb[33m.[39m
[36mget[39m)[33m.[39mtoHaveBeenNthCalledWith([35m1
[39m[33m,[39m 
[32m'ph_ec_readings_v2'[39m)[33m;[39m[0m

      at Object.toEqual [as next] (src/lib/nutrient-engi
ne/services/alert-service-observe.test.ts:207:26)
      at Timeout.next [as _onTimeout] (src/lib/nutrient-
engine/services/alert-service-observe.test.ts:149:42)

  ÔùÅ observeActiveAlerts ÔÇ║ observable behavior ÔÇ║ 
queries deviation_alerts_v2 with correct filters when 
readings exist

    thrown: "Exceeded timeout of 5000 ms for a test 
while waiting for `done()` to be called.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 125 |[39m     })[33m;[39m
     [90m 126 |[39m
    [31m[1m>[22m[39m[90m 127 |[39m     
test([32m'queries deviation_alerts_v2 with correct 
filters when readings exist'[39m[33m,[39m (done) 
[33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 128 |[39m       [36mconst[39m 
mockReadings[33m:[39m [33mPhEcReadingModel[39m[] 
[33m=[39m [
     [90m 129 |[39m         { id[33m:[39m 
[32m'reading-1'[39m } [36mas[39m 
[33mPhEcReadingModel[39m[33m,[39m
     [90m 130 |[39m         { id[33m:[39m 
[32m'reading-2'[39m } [36mas[39m 
[33mPhEcReadingModel[39m[33m,[39m[0m

      at test (src/lib/nutrient-engine/services/alert-se
rvice-observe.test.ts:127:5)
      at describe (src/lib/nutrient-engine/services/aler
t-service-observe.test.ts:34:3)
      at Object.describe (src/lib/nutrient-engine/servic
es/alert-service-observe.test.ts:12:1)

FAIL src/api/auth/use-auth-hooks.test.tsx (7.862 s)
  ÔùÅ Auth Hooks ÔÇ║ useSignIn ÔÇ║ should successfully 
sign in with valid credentials

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 170 |[39m
     [90m 171 |[39m       [90m// Assert[39m
    [31m[1m>[22m[39m[90m 172 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 173 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m
)[33m;[39m
     [90m 174 |[39m       })[33m;[39m
     [90m 175 |[39m[0m

      at Object.<anonymous> 
(src/api/auth/use-auth-hooks.test.tsx:172:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth Hooks ÔÇ║ useSignIn ÔÇ║ should handle 
invalid credentials error

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "auth.error_invalid_credentials"
    Received: "auth.error_generic"

    [0m [90m 211 |[39m       })[33m;[39m
     [90m 212 |[39m
    [31m[1m>[22m[39m[90m 213 |[39m       expect(re
sult[33m.[39mcurrent[33m.[39merror[33m?[39m[33m.
[39mmessage)[33m.[39mtoBe(
     [90m     |[39m                                   
          [31m[1m^[22m[39m
     [90m 214 |[39m         
[32m'auth.error_invalid_credentials'[39m
     [90m 215 |[39m       )[33m;[39m
     [90m 216 |[39m       expect(mockSignIn)[33m.[39
mnot[33m.[39mtoHaveBeenCalled()[33m;[39m[0m

      at Object.toBe 
(src/api/auth/use-auth-hooks.test.tsx:213:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Auth Hooks ÔÇ║ useSignIn ÔÇ║ should handle 
account lockout error

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "auth.error_account_locked"
    Received: "auth.error_generic"

    [0m [90m 248 |[39m       })[33m;[39m
     [90m 249 |[39m
    [31m[1m>[22m[39m[90m 250 |[39m       expect(re
sult[33m.[39mcurrent[33m.[39merror[33m?[39m[33m.
[39mmessage)[33m.[39mtoBe([32m'auth.error_account_loc
ked'[39m)[33m;[39m
     [90m     |[39m                                   
          [31m[1m^[22m[39m
     [90m 251 |[39m       expect(
     [90m 252 |[39m         
(result[33m.[39mcurrent[33m.[39merror [36mas[39m 
[33mError[39m [33m&[39m { 
metadata[33m?[39m[33m:[39m { 
lockout[33m?[39m[33m:[39m boolean } })
     [90m 253 |[39m           [33m?[39m[33m.[39mme
tadata[33m?[39m[33m.[39mlockout[0m

      at Object.toBe 
(src/api/auth/use-auth-hooks.test.tsx:250:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Auth Hooks ÔÇ║ useSignIn ÔÇ║ should track 
analytics when consent is granted

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 287 |[39m
     [90m 288 |[39m       [90m// Assert[39m
    [31m[1m>[22m[39m[90m 289 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 290 |[39m         expect(result[33m.[39mcu
rrent[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[39m
)[33m;[39m
     [90m 291 |[39m       })[33m;[39m
     [90m 292 |[39m[0m

      at Object.<anonymous> 
(src/api/auth/use-auth-hooks.test.tsx:289:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth Hooks ÔÇ║ useSignIn ÔÇ║ should handle 
offline login attempt

    expect(received).toContain(expected) // indexOf

    Expected substring: "Network"
    Received string:    "auth.error_generic"

    [0m [90m 319 |[39m       })[33m;[39m
     [90m 320 |[39m
    [31m[1m>[22m[39m[90m 321 |[39m       expect(re
sult[33m.[39mcurrent[33m.[39merror[33m?[39m[33m.
[39mmessage)[33m.[39mtoContain([32m'Network'[39m)[3
3m;[39m
     [90m     |[39m                                   
          [31m[1m^[22m[39m
     [90m 322 |[39m     })[33m;[39m
     [90m 323 |[39m   })[33m;[39m
     [90m 324 |[39m[0m

      at Object.toContain 
(src/api/auth/use-auth-hooks.test.tsx:321:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Auth Hooks ÔÇ║ OAuth Hooks ÔÇ║ useSignInWithOAuth 
ÔÇ║ should initiate Apple OAuth flow

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 508 |[39m
     [90m 509 |[39m         [90m// Assert[39m
    [31m[1m>[22m[39m[90m 510 |[39m         
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 511 |[39m           expect(result[33m.[39m
current[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[3
9m)[33m;[39m
     [90m 512 |[39m         })[33m;[39m
     [90m 513 |[39m[0m

      at Object.<anonymous> 
(src/api/auth/use-auth-hooks.test.tsx:510:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth Hooks ÔÇ║ OAuth Hooks ÔÇ║ useSignInWithOAuth 
ÔÇ║ should initiate Google OAuth flow

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 540 |[39m
     [90m 541 |[39m         [90m// Assert[39m
    [31m[1m>[22m[39m[90m 542 |[39m         
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 543 |[39m           expect(result[33m.[39m
current[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[3
9m)[33m;[39m
     [90m 544 |[39m         })[33m;[39m
     [90m 545 |[39m[0m

      at Object.<anonymous> 
(src/api/auth/use-auth-hooks.test.tsx:542:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth Hooks ÔÇ║ Password Reset Hooks ÔÇ║ 
useResetPassword ÔÇ║ should request password reset email

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 750 |[39m
     [90m 751 |[39m         [90m// Assert[39m
    [31m[1m>[22m[39m[90m 752 |[39m         
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 753 |[39m           expect(result[33m.[39m
current[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[3
9m)[33m;[39m
     [90m 754 |[39m         })[33m;[39m
     [90m 755 |[39m[0m

      at Object.<anonymous> 
(src/api/auth/use-auth-hooks.test.tsx:752:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth Hooks ÔÇ║ Password Reset Hooks ÔÇ║ 
useResetPassword ÔÇ║ should not reveal if email does 
not exist

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 777 |[39m
     [90m 778 |[39m         [90m// Assert[39m
    [31m[1m>[22m[39m[90m 779 |[39m         
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 780 |[39m           expect(result[33m.[39m
current[33m.[39misSuccess)[33m.[39mtoBe([36mtrue[3
9m)[33m;[39m
     [90m 781 |[39m         })[33m;[39m
     [90m 782 |[39m       })[33m;[39m[0m

      at Object.<anonymous> 
(src/api/auth/use-auth-hooks.test.tsx:779:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth Hooks ÔÇ║ Error Mapper ÔÇ║ should fallback 
to generic error

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "auth.error_generic"
    Received: "auth.error_offline_login"

    [0m [90m 1055 |[39m
     [90m 1056 |[39m       [36mconst[39m result 
[33m=[39m mapAuthError(error)[33m;[39m
    [31m[1m>[22m[39m[90m 1057 |[39m       expect(r
esult)[33m.[39mtoBe([32m'auth.error_generic'[39m)[3
3m;[39m
     [90m      |[39m                      
[31m[1m^[22m[39m
     [90m 1058 |[39m     })[33m;[39m
     [90m 1059 |[39m   })[33m;[39m
     [90m 1060 |[39m[0m

      at Object.toBe 
(src/api/auth/use-auth-hooks.test.tsx:1057:22)

FAIL 
src/lib/moderation/__tests__/retry-strategy.test.ts 
(5.891 s)
  ÔùÅ RetryStrategy ÔÇ║ exponential backoff ÔÇ║ caps 
delay at maxDelayMs

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 110 |[39m     })[33m;[39m
     [90m 111 |[39m
    [31m[1m>[22m[39m[90m 112 |[39m     
test([32m'caps delay at maxDelayMs'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 113 |[39m       [36mconst[39m strategy 
[33m=[39m [36mnew[39m [33mRetryStrategy[39m({
     [90m 114 |[39m         maxAttempts[33m:[39m 
[35m5[39m[33m,[39m
     [90m 115 |[39m         baseDelayMs[33m:[39m 
[35m1000[39m[33m,[39m[0m

      at test (src/lib/moderation/__tests__/retry-strate
gy.test.ts:112:5)
      at describe (src/lib/moderation/__tests__/retry-st
rategy.test.ts:85:3)
      at Object.describe (src/lib/moderation/__tests__/r
etry-strategy.test.ts:12:1)

FAIL src/lib/__tests__/network-manager.test.ts (6.995 s)
  ÔùÅ NetworkManager - Error Handling ÔÇ║ handles 
NetInfo.fetch errors gracefully with fallback state

    thrown: "Exceeded timeout of 5000 ms for a test.
    Add a timeout value to this test to increase the 
timeout, if this is a long-running test. See 
https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 177 |[39m   })[33m;[39m
     [90m 178 |[39m
    [31m[1m>[22m[39m[90m 179 |[39m   
it([32m'handles NetInfo.fetch errors gracefully with 
fallback state'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m     |[39m   [31m[1m^[22m[39m
     [90m 180 |[39m     [90m// Enable error throwing 
in NetInfo mock[39m
     [90m 181 |[39m     
setNetInfoThrow([36mtrue[39m)[33m;[39m
     [90m 182 |[39m[0m

      at it 
(src/lib/__tests__/network-manager.test.ts:179:3)
      at Object.describe 
(src/lib/__tests__/network-manager.test.ts:174:1)

FAIL src/lib/hooks/use-profile-statistics.test.ts
  ÔùÅ useProfileStatistics ÔÇ║ Data Fetching ÔÇ║ 
fetches statistics with user filtering

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 120 |[39m   describe([32m'Data 
Fetching'[39m[33m,[39m () [33m=>[39m {
     [90m 121 |[39m     test([32m'fetches statistics 
with user filtering'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
[36mconst[39m { useDatabase } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db/react'[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 123 |[39m       (useDatabase [36mas[39m je
st[33m.[39m[33mMock[39m)[33m.[39mmockReturnValue(m
ockDatabase)[33m;[39m
     [90m 124 |[39m
     [90m 125 |[39m       renderHook(() [33m=>[39m u
seProfileStatistics([32m'user-123'[39m))[33m;[39m[0
m

      at Object.<anonymous> 
(src/lib/hooks/use-profile-statistics.test.ts:122:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ useProfileStatistics ÔÇ║ Data Fetching ÔÇ║ 
updates statistics when data is fetched

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 139 |[39m
     [90m 140 |[39m     test([32m'updates statistics 
when data is fetched'[39m[33m,[39m [36masync[39m 
() [33m=>[39m {
    [31m[1m>[22m[39m[90m 141 |[39m       
[36mconst[39m { useDatabase } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db/react'[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 142 |[39m       (useDatabase [36mas[39m je
st[33m.[39m[33mMock[39m)[33m.[39mmockReturnValue(m
ockDatabase)[33m;[39m
     [90m 143 |[39m
     [90m 144 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m useProfileStatist
ics([32m'user-123'[39m))[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/hooks/use-profile-statistics.test.ts:141:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ useProfileStatistics ÔÇ║ Data Fetching ÔÇ║ 
handles missing collections gracefully

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 156 |[39m
     [90m 157 |[39m     test([32m'handles missing 
collections gracefully'[39m[33m,[39m [36masync[39m 
() [33m=>[39m {
    [31m[1m>[22m[39m[90m 158 |[39m       
[36mconst[39m { useDatabase } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db/react'[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 159 |[39m       (useDatabase [36mas[39m je
st[33m.[39m[33mMock[39m)[33m.[39mmockReturnValue(m
ockDatabase)[33m;[39m
     [90m 160 |[39m
     [90m 161 |[39m       mockDatabase[33m.[39mcolle
ctions[33m.[39m[36mget[39m[33m.[39mmockImplementat
ion(() [33m=>[39m {[0m

      at Object.<anonymous> 
(src/lib/hooks/use-profile-statistics.test.ts:158:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ useProfileStatistics ÔÇ║ Throttling ÔÇ║ throttles 
rapid updates

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 179 |[39m   
describe([32m'Throttling'[39m[33m,[39m () 
[33m=>[39m {
     [90m 180 |[39m     test([32m'throttles rapid 
updates'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 181 |[39m       
[36mconst[39m { useDatabase } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db/react'[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 182 |[39m       (useDatabase [36mas[39m je
st[33m.[39m[33mMock[39m)[33m.[39mmockReturnValue(m
ockDatabase)[33m;[39m
     [90m 183 |[39m
     [90m 184 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m useProfileStatist
ics([32m'user-123'[39m))[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/hooks/use-profile-statistics.test.ts:181:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ useProfileStatistics ÔÇ║ Refresh Functionality 
ÔÇ║ refresh updates statistics

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 199 |[39m   describe([32m'Refresh 
Functionality'[39m[33m,[39m () [33m=>[39m {
     [90m 200 |[39m     test([32m'refresh updates 
statistics'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 201 |[39m       
[36mconst[39m { useDatabase } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db/react'[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 202 |[39m       (useDatabase [36mas[39m je
st[33m.[39m[33mMock[39m)[33m.[39mmockReturnValue(m
ockDatabase)[33m;[39m
     [90m 203 |[39m
     [90m 204 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m useProfileStatist
ics([32m'user-123'[39m))[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/hooks/use-profile-statistics.test.ts:201:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ useProfileStatistics ÔÇ║ Real-time Updates ÔÇ║ 
sets up collection observers

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 223 |[39m   describe([32m'Real-time 
Updates'[39m[33m,[39m () [33m=>[39m {
     [90m 224 |[39m     test([32m'sets up collection 
observers'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 225 |[39m       
[36mconst[39m { useDatabase } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db/react'[39m)[33m;[39m
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 226 |[39m       (useDatabase [36mas[39m je
st[33m.[39m[33mMock[39m)[33m.[39mmockReturnValue(m
ockDatabase)[33m;[39m
     [90m 227 |[39m
     [90m 228 |[39m       renderHook(() [33m=>[39m u
seProfileStatistics([32m'user-123'[39m))[33m;[39m[0
m

      at Object.<anonymous> 
(src/lib/hooks/use-profile-statistics.test.ts:225:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/moderation/age-verification-service.test.ts
  ÔùÅ AgeVerificationService ÔÇ║ verifyAgeAttribute ÔÇ║ 
should successfully verify age attribute and issue token

    TypeError: 
this.supabase.from(...).insert(...).select is not a 
function

    [0m [90m 81 |[39m         
age_attribute_verified[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 82 |[39m       })
    [31m[1m>[22m[39m[90m 83 |[39m       
[33m.[39mselect()
     [90m    |[39m        [31m[1m^[22m[39m
     [90m 84 |[39m       
[33m.[39msingle()[33m;[39m
     [90m 85 |[39m
     [90m 86 |[39m     [36mif[39m (error 
[33m||[39m [33m![39mtoken) {[0m

      at AgeTokenService.select 
(src/lib/moderation/age-token-service.ts:83:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AgeVerificationService ÔÇ║ verifyAgeAttribute ÔÇ║ 
should not store raw ID data during verification

    TypeError: 
this.supabase.from(...).insert(...).select is not a 
function

    [0m [90m 81 |[39m         
age_attribute_verified[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 82 |[39m       })
    [31m[1m>[22m[39m[90m 83 |[39m       
[33m.[39mselect()
     [90m    |[39m        [31m[1m^[22m[39m
     [90m 84 |[39m       
[33m.[39msingle()[33m;[39m
     [90m 85 |[39m
     [90m 86 |[39m     [36mif[39m (error 
[33m||[39m [33m![39mtoken) {[0m

      at AgeTokenService.select 
(src/lib/moderation/age-token-service.ts:83:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AgeVerificationService ÔÇ║ checkAgeGating ÔÇ║ 
should grant access to verified users

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "age_verified"
    Received: "content_not_restricted"

    [0m [90m 417 |[39m       mockSupabase[33m.[39mi
nsert[33m.[39mmockResolvedValue({ error[33m:[39m 
[36mnull[39m })[33m;[39m
     [90m 418 |[39m
    [31m[1m>[22m[39m[90m 419 |[39m       
[36mawait[39m service[33m.[39mdetectSuspiciousActivi
ty(input)[33m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 420 |[39m
     [90m 421 |[39m       [90m// Verify device 
signals included[39m
     [90m 422 |[39m       expect(mockSupabase[33m.[3
9minsert)[33m.[39mtoHaveBeenCalledWith([0m

      at Object.<anonymous> (src/lib/moderation/age-veri
fication-service.test.ts:419:29)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AgeVerificationService ÔÇ║ checkAgeGating ÔÇ║ 
should deny access to unverified users

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 448 |[39m
     [90m 449 |[39m       [90m// Mock user status 
upsert[39m
    [31m[1m>[22m[39m[90m 450 |[39m       mockSupab
ase[33m.[39mupsert[33m.[39mmockResolvedValue({ 
error[33m:[39m [36mnull[39m })[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 451 |[39m
     [90m 452 |[39m       [36mawait[39m service[33m
.[39mdetectSuspiciousActivity(input)[33m;[39m
     [90m 453 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/age-veri
fication-service.test.ts:450:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/strains/use-favorites.test.ts
  ÔùÅ useFavorites ÔÇ║ addFavorite ÔÇ║ stores snapshot 
with essential fields

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 1

      Object {
        "id": "test-strain-1",
        "imageUrl": "https://example.com/image.jpg",
        "name": "Test Strain",
        "race": "hybrid",
    +   "slug": "test-strain",
        "thc_display": "18-24%",
      }

    [0m [90m 142 |[39m       })[33m;[39m
     [90m 143 |[39m
    [31m[1m>[22m[39m[90m 144 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 145 |[39m         [36mconst[39m favorites 
[33m=[39m result[33m.[39mcurrent[33m.[39mgetFavori
tes()[33m;[39m
     [90m 146 |[39m         [36mconst[39m snapshot 
[33m=[39m 
favorites[[35m0[39m][33m.[39msnapshot[33m;[39m
     [90m 147 |[39m         
expect(snapshot)[33m.[39mtoEqual({[0m

      at Object.<anonymous> 
(src/lib/strains/use-favorites.test.ts:144:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ useFavorites ÔÇ║ multiple favorites ÔÇ║ sorts 
favorites by addedAt descending

    expect(received).toHaveLength(expected)

    Expected length: 2
    Received length: 3
    Received array:  [{"addedAt": 1768559000702, "id": 
"test-strain-2", "snapshot": {"id": "test-strain-2", 
"imageUrl": "https://example.com/image.jpg", "name": 
"Strain 2", "race": "hybrid", "slug": "test-strain", 
"thc_display": "18-24%"}}, {"addedAt": 1768559000680, 
"id": "test-strain-1", "snapshot": {"id": 
"test-strain-1", "imageUrl": 
"https://example.com/image.jpg", "name": "Test Strain", 
"race": "hybrid", "slug": "test-strain", "thc_display": 
"18-24%"}}, {"addedAt": 1768559000677, "id": 
"test-strain-3", "snapshot": {"id": "test-strain-3", 
"imageUrl": "https://example.com/image.jpg", "name": 
"Strain 3", "race": "hybrid", "slug": "test-strain", 
"thc_display": "18-24%"}}]

    [0m [90m 248 |[39m       })[33m;[39m
     [90m 249 |[39m
    [31m[1m>[22m[39m[90m 250 |[39m       
[36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 251 |[39m         expect(result[33m.[39mcu
rrent[33m.[39mgetFavorites())[33m.[39mtoHaveLength(
[35m2[39m)[33m;[39m
     [90m 252 |[39m       })[33m;[39m
     [90m 253 |[39m[0m

      at Object.<anonymous> 
(src/lib/strains/use-favorites.test.ts:250:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ useFavorites ÔÇ║ sync state ÔÇ║ tracks sync errors

    expect(received).toBeNull()

    Received: "repo.getAllFavoritesNeedingSync is not a 
function"

    [0m [90m 266 |[39m     test([32m'tracks sync 
errors'[39m[33m,[39m () [33m=>[39m {
     [90m 267 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m 
useFavorites())[33m;[39m
    [31m[1m>[22m[39m[90m 268 |[39m       expect(re
sult[33m.[39mcurrent[33m.[39msyncError)[33m.[39mto
BeNull()[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 269 |[39m     })[33m;[39m
     [90m 270 |[39m
     [90m 271 |[39m     test([32m'tracks last sync 
timestamp'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBeNull 
(src/lib/strains/use-favorites.test.ts:268:40)

FAIL src/lib/moderation/content-age-gating.test.ts
  ÔùÅ ContentAgeGatingEngine ÔÇ║ checkAgeGating ÔÇ║ 
should grant access to non-restricted content

    TypeError: this.supabase.from(...).select(...).eq(..
.).eq(...).limit is not a function

    [0m [90m 445 |[39m       
[33m.[39meq([32m'content_id'[39m[33m,[39m 
contentId)
     [90m 446 |[39m       
[33m.[39meq([32m'content_type'[39m[33m,[39m 
contentType)
    [31m[1m>[22m[39m[90m 447 |[39m       
[33m.[39mlimit([35m1[39m)[33m;[39m [90m// Safe 
due to unique constraint on (content_id, 
content_type)[39m
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 448 |[39m
     [90m 449 |[39m     [36mconst[39m restriction 
[33m=[39m (data [36mas[39m 
[33mDbContentRestriction[39m[] [33m|[39m [36mnull[
39m)[33m?[39m[33m.[39m[[35m0[39m][33m;[39m
     [90m 450 |[39m[0m

      at ContentAgeGatingEngine.limit 
(src/lib/moderation/content-age-gating.ts:447:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getContentRestriction] 
(src/lib/moderation/content-age-gating.ts:438:38)
      at ContentAgeGatingEngine.getContentRestriction 
(src/lib/moderation/content-age-gating.ts:114:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
checkAgeGating] 
(src/lib/moderation/content-age-gating.ts:108:23)
      at Object.checkAgeGating 
(src/lib/moderation/content-age-gating.test.ts:54:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ checkAgeGating ÔÇ║ 
should grant access to verified users for restricted 
content

    TypeError: this.supabase.from(...).select(...).eq(..
.).eq(...).limit is not a function

    [0m [90m 445 |[39m       
[33m.[39meq([32m'content_id'[39m[33m,[39m 
contentId)
     [90m 446 |[39m       
[33m.[39meq([32m'content_type'[39m[33m,[39m 
contentType)
    [31m[1m>[22m[39m[90m 447 |[39m       
[33m.[39mlimit([35m1[39m)[33m;[39m [90m// Safe 
due to unique constraint on (content_id, 
content_type)[39m
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 448 |[39m
     [90m 449 |[39m     [36mconst[39m restriction 
[33m=[39m (data [36mas[39m 
[33mDbContentRestriction[39m[] [33m|[39m [36mnull[
39m)[33m?[39m[33m.[39m[[35m0[39m][33m;[39m
     [90m 450 |[39m[0m

      at ContentAgeGatingEngine.limit 
(src/lib/moderation/content-age-gating.ts:447:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getContentRestriction] 
(src/lib/moderation/content-age-gating.ts:438:38)
      at ContentAgeGatingEngine.getContentRestriction 
(src/lib/moderation/content-age-gating.ts:114:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
checkAgeGating] 
(src/lib/moderation/content-age-gating.ts:108:23)
      at Object.checkAgeGating 
(src/lib/moderation/content-age-gating.test.ts:90:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ checkAgeGating ÔÇ║ 
should deny access to unverified users for restricted 
content

    TypeError: this.supabase.from(...).select(...).eq(..
.).eq(...).limit is not a function

    [0m [90m 445 |[39m       
[33m.[39meq([32m'content_id'[39m[33m,[39m 
contentId)
     [90m 446 |[39m       
[33m.[39meq([32m'content_type'[39m[33m,[39m 
contentType)
    [31m[1m>[22m[39m[90m 447 |[39m       
[33m.[39mlimit([35m1[39m)[33m;[39m [90m// Safe 
due to unique constraint on (content_id, 
content_type)[39m
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 448 |[39m
     [90m 449 |[39m     [36mconst[39m restriction 
[33m=[39m (data [36mas[39m 
[33mDbContentRestriction[39m[] [33m|[39m [36mnull[
39m)[33m?[39m[33m.[39m[[35m0[39m][33m;[39m
     [90m 450 |[39m[0m

      at ContentAgeGatingEngine.limit 
(src/lib/moderation/content-age-gating.ts:447:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getContentRestriction] 
(src/lib/moderation/content-age-gating.ts:438:38)
      at ContentAgeGatingEngine.getContentRestriction 
(src/lib/moderation/content-age-gating.ts:114:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
checkAgeGating] 
(src/lib/moderation/content-age-gating.ts:108:23)
      at Object.checkAgeGating 
(src/lib/moderation/content-age-gating.test.ts:124:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ autoFlagContent ÔÇ║ 
should not flag content without restricted keywords

    TypeError: Cannot read properties of undefined 
(reading 'data')

    [0m [90m 177 |[39m
     [90m 178 |[39m     [90m// Upsert age 
restriction[39m
    [31m[1m>[22m[39m[90m 179 |[39m     
[36mconst[39m { data[33m:[39m 
restriction[33m,[39m error } [33m=[39m 
[36mawait[39m [36mthis[39m[33m.[39msupabase
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 180 |[39m       [33m.[39m[36mfrom[39m([
32m'content_age_restrictions'[39m)
     [90m 181 |[39m       [33m.[39mupsert(
     [90m 182 |[39m         {[0m

      at ContentAgeGatingEngine.data 
(src/lib/moderation/content-age-gating.ts:179:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ filterContentByAge ÔÇ║ 
should not filter content for verified users

    TypeError: 
this.supabase.from(...).select(...).eq(...).limit is 
not a function

    [0m [90m 478 |[39m       
[33m.[39mselect([32m'*'[39m)
     [90m 479 |[39m       
[33m.[39meq([32m'user_id'[39m[33m,[39m userId)
    [31m[1m>[22m[39m[90m 480 |[39m       
[33m.[39mlimit([35m1[39m)[33m;[39m
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 481 |[39m
     [90m 482 |[39m     [36mif[39m (error) {
     [90m 483 |[39m       [90m// Cache transient DB 
errors briefly to avoid hot-looping[39m[0m

      at ContentAgeGatingEngine.limit 
(src/lib/moderation/content-age-gating.ts:480:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getUserAgeStatus] 
(src/lib/moderation/content-age-gating.ts:462:33)
      at ContentAgeGatingEngine.getUserAgeStatus 
(src/lib/moderation/content-age-gating.ts:302:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
filterContentByAge] 
(src/lib/moderation/content-age-gating.ts:296:27)
      at Object.filterContentByAge 
(src/lib/moderation/content-age-gating.test.ts:327:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ filterContentByAge ÔÇ║ 
should filter restricted content for unverified users

    TypeError: this.supabase.from(...).select(...).eq 
is not a function

    [0m [90m 477 |[39m       
[33m.[39m[36mfrom[39m([32m'user_age_status'[39m)
     [90m 478 |[39m       
[33m.[39mselect([32m'*'[39m)
    [31m[1m>[22m[39m[90m 479 |[39m       
[33m.[39meq([32m'user_id'[39m[33m,[39m userId)
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 480 |[39m       
[33m.[39mlimit([35m1[39m)[33m;[39m
     [90m 481 |[39m
     [90m 482 |[39m     [36mif[39m (error) {[0m

      at ContentAgeGatingEngine.eq 
(src/lib/moderation/content-age-gating.ts:479:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getUserAgeStatus] 
(src/lib/moderation/content-age-gating.ts:462:33)
      at ContentAgeGatingEngine.getUserAgeStatus 
(src/lib/moderation/content-age-gating.ts:302:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
filterContentByAge] 
(src/lib/moderation/content-age-gating.ts:296:27)
      at Object.filterContentByAge 
(src/lib/moderation/content-age-gating.test.ts:357:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ filterContentByAge ÔÇ║ 
should apply safer defaults for minors

    TypeError: this.supabase.from(...).select(...).eq 
is not a function

    [0m [90m 477 |[39m       
[33m.[39m[36mfrom[39m([32m'user_age_status'[39m)
     [90m 478 |[39m       
[33m.[39mselect([32m'*'[39m)
    [31m[1m>[22m[39m[90m 479 |[39m       
[33m.[39meq([32m'user_id'[39m[33m,[39m userId)
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 480 |[39m       
[33m.[39mlimit([35m1[39m)[33m;[39m
     [90m 481 |[39m
     [90m 482 |[39m     [36mif[39m (error) {[0m

      at ContentAgeGatingEngine.eq 
(src/lib/moderation/content-age-gating.ts:479:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getUserAgeStatus] 
(src/lib/moderation/content-age-gating.ts:462:33)
      at ContentAgeGatingEngine.getUserAgeStatus 
(src/lib/moderation/content-age-gating.ts:302:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
filterContentByAge] 
(src/lib/moderation/content-age-gating.ts:296:27)
      at Object.filterContentByAge 
(src/lib/moderation/content-age-gating.test.ts:390:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ removeAgeRestriction 
ÔÇ║ should remove age restriction from content

    TypeError: this.supabase.from(...).update(...).eq 
is not a function

    [0m [90m 263 |[39m         
is_age_restricted[33m:[39m [36mfalse[39m[33m,[39m
     [90m 264 |[39m       })
    [31m[1m>[22m[39m[90m 265 |[39m       
[33m.[39meq([32m'content_id'[39m[33m,[39m 
contentId)
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 266 |[39m       
[33m.[39meq([32m'content_type'[39m[33m,[39m 
contentType)[33m;[39m
     [90m 267 |[39m
     [90m 268 |[39m     [36mif[39m (error) {[0m

      at ContentAgeGatingEngine.eq 
(src/lib/moderation/content-age-gating.ts:265:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
removeAgeRestriction] 
(src/lib/moderation/content-age-gating.ts:256:29)
      at Object.removeAgeRestriction 
(src/lib/moderation/content-age-gating.test.ts:409:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ContentAgeGatingEngine ÔÇ║ getAgeRestrictionStats 
ÔÇ║ should return statistics for age-restricted content

    TypeError: this.supabase.from(...).select(...).eq 
is not a function

    [0m [90m 339 |[39m       [33m.[39m[36mfrom[39
m([32m'content_age_restrictions'[39m)
     [90m 340 |[39m       
[33m.[39mselect([32m'flagged_by_system, 
flagged_by_author, flagged_by_moderator'[39m)
    [31m[1m>[22m[39m[90m 341 |[39m       
[33m.[39meq([32m'is_age_restricted'[39m[33m,[39m 
[36mtrue[39m)[33m;[39m
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 342 |[39m
     [90m 343 |[39m     [36mconst[39m statsList 
[33m=[39m (stats [33m||[39m []) [36mas[39m 
[33mPick[39m[33m<[39m
     [90m 344 |[39m       
[33mDbContentRestriction[39m[33m,[39m[0m

      at ContentAgeGatingEngine.eq 
(src/lib/moderation/content-age-gating.ts:341:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at ContentAgeGatingEngine.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at ContentAgeGatingEngine.apply [as 
getAgeRestrictionStats] 
(src/lib/moderation/content-age-gating.ts:332:31)
      at Object.getAgeRestrictionStats 
(src/lib/moderation/content-age-gating.test.ts:445:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/api/community/client.test.ts
  ÔùÅ CommunityApiClient ÔÇ║ getPost ÔÇ║ should fetch a 
single post successfully

    TypeError: this.client.from(...).select(...).eq is 
not a function

    [0m [90m 331 |[39m       
[33m.[39m[36mfrom[39m([32m'posts'[39m)
     [90m 332 |[39m       
[33m.[39mselect([32m'*'[39m)
    [31m[1m>[22m[39m[90m 333 |[39m       
[33m.[39meq([32m'id'[39m[33m,[39m postId)
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 334 |[39m       
[33m.[39mis([32m'deleted_at'[39m[33m,[39m 
[36mnull[39m)
     [90m 335 |[39m       
[33m.[39mis([32m'hidden_at'[39m[33m,[39m 
[36mnull[39m)[33m;[39m
     [90m 336 |[39m[0m

      at CommunityApiClient.eq 
(src/api/community/client.ts:333:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CommunityApiClient.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at CommunityApiClient.apply [as getPost] 
(src/api/community/client.ts:329:16)
      at Object.getPost 
(src/api/community/client.test.ts:138:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ CommunityApiClient ÔÇ║ getPost ÔÇ║ should throw 
error when post fetch fails

    expect(received).rejects.toThrow(expected)

    Expected substring: "Failed to fetch posts with 
counts"
    Received message:   
"this.client.from(...).select(...).eq is not a function"

        [0m [90m 331 |[39m       
[33m.[39m[36mfrom[39m([32m'posts'[39m)
         [90m 332 |[39m       
[33m.[39mselect([32m'*'[39m)
        [31m[1m>[22m[39m[90m 333 |[39m       
[33m.[39meq([32m'id'[39m[33m,[39m postId)
         [90m     |[39m        [31m[1m^[22m[39m
         [90m 334 |[39m       
[33m.[39mis([32m'deleted_at'[39m[33m,[39m 
[36mnull[39m)
         [90m 335 |[39m       
[33m.[39mis([32m'hidden_at'[39m[33m,[39m 
[36mnull[39m)[33m;[39m
         [90m 336 |[39m[0m

      at CommunityApiClient.eq 
(src/api/community/client.ts:333:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CommunityApiClient.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at CommunityApiClient.apply [as getPost] 
(src/api/community/client.ts:329:16)
      at Object.getPost 
(src/api/community/client.test.ts:171:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow 
(src/api/community/client.test.ts:171:58)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ CommunityApiClient ÔÇ║ deletePost and 
undoDeletePost ÔÇ║ should restore a post within undo 
window

    TypeError: Cannot read properties of undefined 
(reading 'select')

    [0m [90m 585 |[39m   }[33m>[39m {
     [90m 586 |[39m     [36mconst[39m { 
data[33m:[39m diagnosticPost[33m,[39m 
error[33m:[39m diagnosticError } [33m=[39m 
[36mawait[39m [36mthis[39m[33m.[39mclient
    [31m[1m>[22m[39m[90m 587 |[39m       
[33m.[39m[36mfrom[39m([32m'posts'[39m)
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 588 |[39m       [33m.[39mselect([32m'id, 
deleted_at, created_at, updated_at'[39m)
     [90m 589 |[39m       
[33m.[39meq([32m'id'[39m[33m,[39m postId)
     [90m 590 |[39m       
[33m.[39msingle()[33m;[39m[0m

      at CommunityApiClient.<anonymous> 
(src/api/community/client.ts:587:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CommunityApiClient.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at CommunityApiClient.apply [as 
runPostDiagnostic] (src/api/community/client.ts:582:34)
      at Object.runPostDiagnostic 
(src/api/community/client.ts:673:24)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ CommunityApiClient ÔÇ║ Pagination ÔÇ║ should 
handle pagination with cursor correctly

    TypeError: this.client.from(...).select(...).is is 
not a function

    [0m [90m 358 |[39m       
[33m.[39m[36mfrom[39m([32m'posts'[39m)
     [90m 359 |[39m       
[33m.[39mselect([32m'*'[39m)
    [31m[1m>[22m[39m[90m 360 |[39m       
[33m.[39mis([32m'deleted_at'[39m[33m,[39m 
[36mnull[39m)
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 361 |[39m       
[33m.[39mis([32m'hidden_at'[39m[33m,[39m 
[36mnull[39m)
     [90m 362 |[39m       
[33m.[39morder([32m'created_at'[39m[33m,[39m { 
ascending[33m:[39m [36mfalse[39m })
     [90m 363 |[39m       
[33m.[39mlimit(limit)[33m;[39m[0m

      at CommunityApiClient.is 
(src/api/community/client.ts:360:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CommunityApiClient ÔÇ║ getPostsDiscover ÔÇ║ 
applies top_7d sorting and filters

    TypeError: b.not is not a function

    [0m [90m 226 |[39m   [36mif[39m 
(ctx[33m.[39mphotosOnly) {
     [90m 227 |[39m     b [33m=[39m b
    [31m[1m>[22m[39m[90m 228 |[39m       
[33m.[39mnot([32m'media_uri'[39m[33m,[39m 
[32m'is'[39m[33m,[39m [36mnull[39m)
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 229 |[39m       
[33m.[39mnot([32m'media_resized_uri'[39m[33m,[39m 
[32m'is'[39m[33m,[39m [36mnull[39m)
     [90m 230 |[39m       [33m.[39mnot([32m'media_t
humbnail_uri'[39m[33m,[39m [32m'is'[39m[33m,[39m 
[36mnull[39m)[33m;[39m
     [90m 231 |[39m   }[0m

      at not (src/api/community/client.ts:228:8)
      at CommunityApiClient.applyDiscoverFilters 
(src/api/community/client.ts:413:29)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/hooks/use-notification-preferences.test.ts
  ÔùÅ Notification Preferences Integration ÔÇ║ Loading 
Preferences ÔÇ║ loads preferences for authenticated user

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 94 |[39m       [36mconst[39m { result 
} [33m=[39m renderHook(() [33m=>[39m 
useNotificationPreferences())[33m;[39m
     [90m 95 |[39m
    [31m[1m>[22m[39m[90m 96 |[39m       expect(res
ult[33m.[39mcurrent[33m.[39mloading)[33m.[39mtoBe(
[36mtrue[39m)[33m;[39m
     [90m    |[39m                                    
  [31m[1m^[22m[39m
     [90m 97 |[39m
     [90m 98 |[39m       [36mawait[39m waitFor(() 
[33m=>[39m expect(result[33m.[39mcurrent[33m.[39ml
oading)[33m.[39mtoBe([36mfalse[39m))[33m;[39m
     [90m 99 |[39m[0m

      at Object.toBe (src/lib/hooks/use-notification-pre
ferences.test.ts:96:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Notification Preferences Integration ÔÇ║ Loading 
Preferences ÔÇ║ handles loading errors gracefully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Database connection failed"
    Received: null

    [0m [90m 112 |[39m       [36mawait[39m 
waitFor(() [33m=>[39m expect(result[33m.[39mcurrent
[33m.[39mloading)[33m.[39mtoBe([36mfalse[39m))[33m
;[39m
     [90m 113 |[39m
    [31m[1m>[22m[39m[90m 114 |[39m       expect(re
sult[33m.[39mcurrent[33m.[39merror)[33m.[39mtoBe(
[32m'Database connection failed'[39m)[33m;[39m
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 115 |[39m       expect(result[33m.[39mcurr
ent[33m.[39mpreferences)[33m.[39mtoBeNull()[33m;[3
9m
     [90m 116 |[39m     })[33m;[39m
     [90m 117 |[39m[0m

      at Object.toBe (src/lib/hooks/use-notification-pre
ferences.test.ts:114:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Notification Preferences Integration ÔÇ║ Toggle 
Categories ÔÇ║ reverts on toggle failure

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Network error"
    Received: null

    [0m [90m 250 |[39m       )[33m;[39m
     [90m 251 |[39m
    [31m[1m>[22m[39m[90m 252 |[39m       expect(re
sult[33m.[39mcurrent[33m.[39merror)[33m.[39mtoBe(
[32m'Network error'[39m)[33m;[39m
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 253 |[39m     })[33m;[39m
     [90m 254 |[39m   })[33m;[39m
     [90m 255 |[39m[0m

      at Object.toBe (src/lib/hooks/use-notification-pre
ferences.test.ts:252:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/nutrient-engine/services/reservoir-service.
test.ts
  ÔùÅ reservoir-service ÔÇ║ updateReservoir ÔÇ║ should 
reject invalid pH range when updating one bound

    expect(received).rejects.toThrow(expected)

    Expected substring: "Target pH min must be less 
than pH max"
    Received message:   "reservoir.update is not a 
function"

        [0m [90m 140 |[39m
         [90m 141 |[39m   [36mreturn[39m 
[36mawait[39m 
database[33m.[39mwrite([36masync[39m () 
[33m=>[39m {
        [31m[1m>[22m[39m[90m 142 |[39m     
[36mreturn[39m [36mawait[39m 
reservoir[33m.[39mupdate((record[33m:[39m 
[33mReservoirModel[39m) [33m=>[39m {
         [90m     |[39m                            
[31m[1m^[22m[39m
         [90m 143 |[39m       [36mif[39m 
(updates[33m.[39mname [33m!==[39m undefined) {
         [90m 144 |[39m         record[33m.[39mname 
[33m=[39m 
updates[33m.[39mname[33m.[39mtrim()[33m;[39m
         [90m 145 |[39m       }[0m

      at update (src/lib/nutrient-engine/services/reserv
oir-service.ts:142:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.callback (src/lib/nutrient-engine/servic
es/reservoir-service.test.ts:159:43)
      at write (src/lib/nutrient-engine/services/reservo
ir-service.ts:141:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/nutrient-engine/service
s/reservoir-service.test.ts:191:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ reservoir-service ÔÇ║ updateReservoir ÔÇ║ should 
reject invalid EC range when updating one bound

    expect(received).rejects.toThrow(expected)

    Expected substring: "Target EC min must be less 
than EC max"
    Received message:   "reservoir.update is not a 
function"

        [0m [90m 140 |[39m
         [90m 141 |[39m   [36mreturn[39m 
[36mawait[39m 
database[33m.[39mwrite([36masync[39m () 
[33m=>[39m {
        [31m[1m>[22m[39m[90m 142 |[39m     
[36mreturn[39m [36mawait[39m 
reservoir[33m.[39mupdate((record[33m:[39m 
[33mReservoirModel[39m) [33m=>[39m {
         [90m     |[39m                            
[31m[1m^[22m[39m
         [90m 143 |[39m       [36mif[39m 
(updates[33m.[39mname [33m!==[39m undefined) {
         [90m 144 |[39m         record[33m.[39mname 
[33m=[39m 
updates[33m.[39mname[33m.[39mtrim()[33m;[39m
         [90m 145 |[39m       }[0m

      at update (src/lib/nutrient-engine/services/reserv
oir-service.ts:142:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.callback (src/lib/nutrient-engine/servic
es/reservoir-service.test.ts:159:43)
      at write (src/lib/nutrient-engine/services/reservo
ir-service.ts:141:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/nutrient-engine/service
s/reservoir-service.test.ts:217:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/community/__tests__/realtime-manager.test.ts
  ÔùÅ RealtimeConnectionManager ÔÇ║ Polling Fallback 
ÔÇ║ should call onPollRefresh during polling

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

    [0m [90m  98 |[39m       [36mawait[39m 
[36mnew[39m [33mPromise[39m((resolve) [33m=>[39m 
setTimeout(resolve[33m,[39m [35m200[39m))[33m;[39m
     [90m  99 |[39m
    [31m[1m>[22m[39m[90m 100 |[39m       expect(mo
ckCallbacks[33m.[39monPollRefresh)[33m.[39mtoHaveBee
nCalled()[33m;[39m
     [90m     |[39m                                   
        [31m[1m^[22m[39m
     [90m 101 |[39m     })[33m;[39m
     [90m 102 |[39m
     [90m 103 |[39m     it([32m'should stop polling 
when onPollRefresh is not implemented'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toHaveBeenCalled (src/lib/community/__te
sts__/realtime-manager.test.ts:100:43)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ RealtimeConnectionManager ÔÇ║ Polling Fallback 
ÔÇ║ should stop polling when onPollRefresh is not 
implemented

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "[Realtime] CRITICAL: Polling active but 
onPollRefresh not implemented. Data will NOT update. 
This is a bug in consumer implementation. Stopping 
polling."
    Received: "Realtime subscription error:", 
{"channelName": undefined, "errorMessage": undefined, 
"errorStack": undefined, "reconnectAttempts": 0, 
"status": "CHANNEL_ERROR"}

    Number of calls: 1

    [0m [90m 120 |[39m             [90m// After max 
retries, should start polling and trigger error[39m
     [90m 121 |[39m             setTimeout(() 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 122 |[39m               
expect(consoleErrorSpy)[33m.[39mtoHaveBeenCalledWith(
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 123 |[39m                 [32m'[Realtime] 
CRITICAL: Polling active but onPollRefresh not 
implemented. '[39m [33m+[39m
     [90m 124 |[39m                   [32m'Data will 
NOT update. This is a bug in consumer implementation. 
Stopping polling.'[39m
     [90m 125 |[39m               )[33m;[39m[0m

      at Timeout.toHaveBeenCalledWith [as _onTimeout] (s
rc/lib/community/__tests__/realtime-manager.test.ts:122:
39)

FAIL src/components/ui/checkbox.test.tsx
  ÔùÅ Checkbox, Radio & Switch components  ÔÇ║ <Radio 
/> should render the correct label

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: undefined

    [0m [90m 122 |[39m     )[33m;[39m
     [90m 123 |[39m
    [31m[1m>[22m[39m[90m 124 |[39m     expect(scre
en[33m.[39mgetByTestId([32m'radio'[39m)[33m.[39mpr
ops[33m.[39maccessibilityState[33m.[39mchecked)[33m
.[39mtoBe(
     [90m     |[39m                                   
                                       
[31m[1m^[22m[39m
     [90m 125 |[39m       [36mfalse[39m
     [90m 126 |[39m     )[33m;[39m
     [90m 127 |[39m     expect(screen[33m.[39mgetByT
estId([32m'radio'[39m)[33m.[39mprops[33m.[39macces
sibilityRole)[33m.[39mtoBe([32m'radio'[39m)[33m;[3
9m[0m

      at Object.toBe 
(src/components/ui/checkbox.test.tsx:124:74)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/components/inventory/csv/csv.test.tsx
  ÔùÅ CSV Export ÔÇ║ exports RFC 4180 compliant CSV 
files

    expect(received).toContain(expected) // indexOf

    Expected substring: "external_key,name,category"
    Received string:    ""

    [0m [90m 22 |[39m     expect(result[33m.[39mite
ms)[33m.[39mtoBeDefined()[33m;[39m
     [90m 23 |[39m     expect(result[33m.[39mitems[
33m.[39mfilename)[33m.[39mtoBe([32m'items.csv'[39m)
[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     expect(resul
t[33m.[39mitems[33m.[39mcontent)[33m.[39mtoContain
([32m'external_key,name,category'[39m)[33m;[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 25 |[39m
     [90m 26 |[39m     expect(result[33m.[39mbatches
)[33m.[39mtoBeDefined()[33m;[39m
     [90m 27 |[39m     expect(result[33m.[39mbatches
[33m.[39mfilename)[33m.[39mtoBe([32m'batches.csv'[
39m)[33m;[39m[0m

      at Object.toContain 
(src/components/inventory/csv/csv.test.tsx:24:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CSV Export ÔÇ║ uses UTF-8 encoding with CRLF line 
endings

    expect(received).toContain(expected) // indexOf

    Expected substring: "┬À
    "
    Received string:    ""

    [0m [90m 35 |[39m
     [90m 36 |[39m     [90m// Check for CRLF line 
endings[39m
    [31m[1m>[22m[39m[90m 37 |[39m     expect(resul
t[33m.[39mitems[33m.[39mcontent)[33m.[39mtoContain
([32m'\r\n'[39m)[33m;[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 38 |[39m   })[33m;[39m
     [90m 39 |[39m
     [90m 40 |[39m   test([32m'uses ISO-8601 dates 
and dot decimals'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {[0m

      at Object.toContain 
(src/components/inventory/csv/csv.test.tsx:37:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CSV Export ÔÇ║ uses ISO-8601 dates and dot 
decimals

    expect(received).toMatch(expected)

    Expected pattern: /\d{4}-\d{2}-\d{2}/
    Received string:  ""

    [0m [90m 43 |[39m     [90m// Check date format 
(YYYY-MM-DD)[39m
     [90m 44 |[39m     [36mconst[39m dateRegex 
[33m=[39m [35m/\d{4}-\d{2}-\d{2}/[39m[33m;[39m
    [31m[1m>[22m[39m[90m 45 |[39m     expect(resul
t[33m.[39mbatches[33m.[39mcontent)[33m.[39mtoMatch
(dateRegex)[33m;[39m
     [90m    |[39m                                    
[31m[1m^[22m[39m
     [90m 46 |[39m
     [90m 47 |[39m     [90m// Check decimal format 
(dot separator)[39m
     [90m 48 |[39m     [36mconst[39m decimalRegex 
[33m=[39m [35m/\d+\.\d+/[39m[33m;[39m[0m

      at Object.toMatch 
(src/components/inventory/csv/csv.test.tsx:45:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CSV Import Preview ÔÇ║ generates dry-run preview 
with row-level diffs

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 1
    Received:    0

    [0m [90m 60 |[39m     [36mconst[39m preview 
[33m=[39m [36mawait[39m previewCSVImport({ 
items[33m:[39m csvContent })[33m;[39m
     [90m 61 |[39m
    [31m[1m>[22m[39m[90m 62 |[39m     expect(previ
ew[33m.[39mtotalRows)[33m.[39mtoBeGreaterThanOrEqual
([35m1[39m)[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 63 |[39m     expect(preview[33m.[39mdiffs)
[33m.[39mtoBeDefined()[33m;[39m
     [90m 64 |[39m     expect(preview[33m.[39msummar
y)[33m.[39mtoBeDefined()[33m;[39m
     [90m 65 |[39m     expect(preview[33m.[39msummar
y[33m.[39mitemsToAdd)[33m.[39mtoBeGreaterThanOrEqual
([35m0[39m)[33m;[39m[0m

      at Object.toBeGreaterThanOrEqual 
(src/components/inventory/csv/csv.test.tsx:62:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CSV Import Preview ÔÇ║ validates CSV format and 
reports errors

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

    [0m [90m 72 |[39m     [36mconst[39m preview 
[33m=[39m [36mawait[39m previewCSVImport({ 
items[33m:[39m invalidCSV })[33m;[39m
     [90m 73 |[39m
    [31m[1m>[22m[39m[90m 74 |[39m     expect(previ
ew[33m.[39minvalidRows)[33m.[39mtoBeGreaterThan([35
m0[39m)[33m;[39m
     [90m    |[39m                                 
[31m[1m^[22m[39m
     [90m 75 |[39m     expect(preview[33m.[39mcanPro
ceed)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 76 |[39m   })[33m;[39m
     [90m 77 |[39m })[33m;[39m[0m

      at Object.toBeGreaterThan 
(src/components/inventory/csv/csv.test.tsx:74:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CSV Size Limits ÔÇ║ enforces 50k row limit

    expect(received).rejects.toThrow()

    Received promise resolved instead of rejected
    Resolved to value: {"canProceed": true, "diffs": 
[], "errors": [], "invalidRows": 0, "parseErrors": [], 
"summary": {"batchesToAdd": 0, "batchesToSkip": 0, 
"batchesToUpdate": 0, "itemsToAdd": 0, "itemsToSkip": 
0, "itemsToUpdate": 0, "movementsToAdd": 0}, 
"totalRows": 0, "validRows": 0}

    [0m [90m 118 |[39m     [36mconst[39m largeCSV 
[33m=[39m header [33m+[39m rows[33m;[39m
     [90m 119 |[39m
    [31m[1m>[22m[39m[90m 120 |[39m     
[36mawait[39m expect(previewCSVImport({ 
items[33m:[39m largeCSV 
}))[33m.[39mrejects[33m.[39mtoThrow()[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 121 |[39m   })[33m;[39m
     [90m 122 |[39m
     [90m 123 |[39m   test([32m'enforces 10MB file 
size limit'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect 
(src/components/inventory/csv/csv.test.tsx:120:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ CSV Size Limits ÔÇ║ enforces 10MB file size limit

    expect(received).rejects.toThrow()

    Received promise resolved instead of rejected
    Resolved to value: {"canProceed": false, "diffs": 
[], "errors": [], "invalidRows": 1, "parseErrors": 
[{"message": "File size (10.90 MB) exceeds maximum 
allowed size (10 MB)", "type": "size_limit"}], 
"summary": {"batchesToAdd": 0, "batchesToSkip": 0, 
"batchesToUpdate": 0, "itemsToAdd": 0, "itemsToSkip": 
0, "itemsToUpdate": 0, "movementsToAdd": 0}, 
"totalRows": 0, "validRows": 0}

    [0m [90m 132 |[39m     [36mconst[39m largeCSV 
[33m=[39m header [33m+[39m rows[33m;[39m
     [90m 133 |[39m
    [31m[1m>[22m[39m[90m 134 |[39m     
[36mawait[39m expect(previewCSVImport({ 
items[33m:[39m largeCSV 
}))[33m.[39mrejects[33m.[39mtoThrow()[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 135 |[39m   })[33m;[39m
     [90m 136 |[39m })[33m;[39m
     [90m 137 |[39m[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect 
(src/components/inventory/csv/csv.test.tsx:134:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/api/ph-ec-readings/index.test.ts
  ÔùÅ pH/EC Readings API ÔÇ║ createReadingLocal ÔÇ║ 
should create a reading in local database

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "ph_ec_readings"
    Received: "ph_ec_readings_v2"

    Number of calls: 1

    [0m [90m 60 |[39m       expect(result[33m.[39mp
h)[33m.[39mtoBe([35m6.5[39m)[33m;[39m
     [90m 61 |[39m       expect(result[33m.[39mec25c
)[33m.[39mtoBe([35m2.1[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 62 |[39m       expect(dat
abase[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalle
dWith([32m'ph_ec_readings'[39m)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 63 |[39m       expect(database[33m.[39mwri
te)[33m.[39mtoHaveBeenCalled()[33m;[39m
     [90m 64 |[39m     })[33m;[39m
     [90m 65 |[39m[0m

      at Object.toHaveBeenCalledWith 
(src/api/ph-ec-readings/index.test.ts:62:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ pH/EC Readings API ÔÇ║ fetchReadingsLocal ÔÇ║ 
should fetch readings from local database

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "ph_ec_readings"
    Received: "ph_ec_readings_v2"

    Number of calls: 1

    [0m [90m 176 |[39m       expect(result[33m.[39m
data)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 177 |[39m       expect(result[33m.[39mtota
l)[33m.[39mtoBe([35m1[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m       expect(da
tabase[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCall
edWith([32m'ph_ec_readings'[39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 179 |[39m     })[33m;[39m
     [90m 180 |[39m
     [90m 181 |[39m     it([32m'should filter 
readings by reservoir'[39m[33m,[39m [36masync[39m 
() [33m=>[39m {[0m

      at Object.toHaveBeenCalledWith 
(src/api/ph-ec-readings/index.test.ts:178:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/inventory/__tests__/use-consumption-analyti
cs.test.ts
  ÔùÅ useConsumptionAnalytics ÔÇ║ should handle errors 
gracefully

    expect(received).toBeTruthy()

    Received: null

    [0m [90m 143 |[39m     })[33m;[39m
     [90m 144 |[39m
    [31m[1m>[22m[39m[90m 145 |[39m     expect(resu
lt[33m.[39mcurrent[33m.[39merror)[33m.[39mtoBeTrut
hy()[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 146 |[39m     expect(result[33m.[39mcurren
t[33m.[39merror[33m?[39m[33m.[39mmessage)[33m.[3
9mtoContain([32m'error'[39m)[33m;[39m
     [90m 147 |[39m   })[33m;[39m
     [90m 148 |[39m })[33m;[39m[0m

      at Object.toBeTruthy (src/lib/inventory/__tests__/
use-consumption-analytics.test.ts:145:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/components/consent-manager.test.tsx
  ÔùÅ ConsentManager ÔÇ║ toggling runtime consent 
updates ConsentService

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "telemetry", false

    Number of calls: 0

    [0m [90m 151 |[39m       [36mfalse[39m
     [90m 152 |[39m     )[33m;[39m
    [31m[1m>[22m[39m[90m 153 |[39m     expect([33
mConsentService[39m[33m.[39msetConsent)[33m.[39mtoH
aveBeenCalledWith([32m'telemetry'[39m[33m,[39m 
[36mfalse[39m)[33m;[39m
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 154 |[39m   })[33m;[39m
     [90m 155 |[39m
     [90m 156 |[39m   test([32m'quick opt-out clears 
telemetry queue and revokes consents'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toHaveBeenCalledWith 
(src/components/consent-manager.test.tsx:153:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ConsentManager ÔÇ║ quick opt-out clears telemetry 
queue and revokes consents

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "telemetry", false

    Number of calls: 0

    [0m [90m 160 |[39m     fireEvent[33m.[39mpress(
screen[33m.[39mgetByTestId([32m'opt-out-all-btn'[39m
))[33m;[39m
     [90m 161 |[39m     expect(telemetryClient[33m.[
39mclearQueue)[33m.[39mtoHaveBeenCalled()[33m;[39m
    [31m[1m>[22m[39m[90m 162 |[39m     expect([33
mConsentService[39m[33m.[39msetConsent)[33m.[39mtoH
aveBeenCalledWith([32m'telemetry'[39m[33m,[39m 
[36mfalse[39m)[33m;[39m
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 163 |[39m     expect(setPrivacyConsent)[33m
.[39mtoHaveBeenCalledWith({
     [90m 164 |[39m       analytics[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 165 |[39m       crashReporting[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.toHaveBeenCalledWith 
(src/components/consent-manager.test.tsx:162:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/quality/analyzers/__tests__/white-balance.t
est.ts
  ÔùÅ analyzeWhiteBalance ÔÇ║ color cast detection ÔÇ║ 
should detect warm color cast

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m  99 |[39m
     [90m 100 |[39m       expect(result[33m.[39mscor
e)[33m.[39mtoBeLessThan([35m100[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 101 |[39m       expect(re
sult[33m.[39missue)[33m.[39mtoBeDefined()[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 102 |[39m       expect(result[33m.[39missu
e[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'white_
balance'[39m)[33m;[39m
     [90m 103 |[39m     })[33m;[39m
     [90m 104 |[39m[0m

      at Object.toBeDefined (src/lib/quality/analyzers/_
_tests__/white-balance.test.ts:101:28)

  ÔùÅ analyzeWhiteBalance ÔÇ║ color cast detection ÔÇ║ 
should detect cool color cast

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 108 |[39m
     [90m 109 |[39m       expect(result[33m.[39mscor
e)[33m.[39mtoBeLessThan([35m100[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 110 |[39m       expect(re
sult[33m.[39missue)[33m.[39mtoBeDefined()[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 111 |[39m       expect(result[33m.[39missu
e[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'white_
balance'[39m)[33m;[39m
     [90m 112 |[39m     })[33m;[39m
     [90m 113 |[39m[0m

      at Object.toBeDefined (src/lib/quality/analyzers/_
_tests__/white-balance.test.ts:110:28)

FAIL src/components/ui/button.test.tsx
  ÔùÅ Button component  ÔÇ║ should apply correct styles 
based on size prop

    expect(received).toContain(expected) // indexOf

    Expected substring: "font-inter font-semibold 
text-white dark:text-black text-xl"
    Received string:    "font-inter font-semibold 
text-white text-xl"

    [0m [90m 86 |[39m     [36mconst[39m 
receivedStyle [33m=[39m
     [90m 87 |[39m       button[33m.[39mprops[33m.
[39mchildren[[35m0[39m][33m.[39mprops[33m.[39mchil
dren[33m.[39mprops[33m.[39mclassName[33m;[39m
    [31m[1m>[22m[39m[90m 88 |[39m     expect(recei
vedStyle)[33m.[39mtoContain(expectedStyle)[33m;[39m
     [90m    |[39m                           
[31m[1m^[22m[39m
     [90m 89 |[39m   })[33m;[39m
     [90m 90 |[39m   it([32m'should apply correct 
styles for label when variant is 
secondary'[39m[33m,[39m () [33m=>[39m {
     [90m 91 |[39m     
render([33m<[39m[33mButton[39m 
testID[33m=[39m[32m"button"[39m 
variant[33m=[39m[32m"secondary"[39m 
label[33m=[39m[32m"Submit"[39m 
[33m/[39m[33m>[39m)[33m;[39m[0m

      at Object.toContain 
(src/components/ui/button.test.tsx:88:27)

  ÔùÅ Button component  ÔÇ║ should apply correct styles 
for label when variant is secondary

    expect(received).toContain(expected) // indexOf

    Expected substring: "font-inter font-semibold 
text-secondary-600 text-base"
    Received string:    "font-inter font-semibold 
text-white text-base"

    [0m [90m  96 |[39m     [36mconst[39m 
receivedStyle [33m=[39m
     [90m  97 |[39m       button[33m.[39mprops[33m.
[39mchildren[[35m0[39m][33m.[39mprops[33m.[39mchi
ldren[33m.[39mprops[33m.[39mclassName[33m;[39m
    [31m[1m>[22m[39m[90m  98 |[39m     expect(rece
ivedStyle)[33m.[39mtoContain(expectedStyle)[33m;[39m
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m  99 |[39m   })[33m;[39m
     [90m 100 |[39m   it([32m'should apply correct 
styles for label when is disabled'[39m[33m,[39m () 
[33m=>[39m {
     [90m 101 |[39m     
render([33m<[39m[33mButton[39m 
testID[33m=[39m[32m"button"[39m 
label[33m=[39m[32m"Submit"[39m disabled 
[33m/[39m[33m>[39m)[33m;[39m[0m

      at Object.toContain 
(src/components/ui/button.test.tsx:98:27)

FAIL src/lib/moderation/__tests__/community-integration.
test.ts
  ÔùÅ Community Integration ÔÇ║ Content Visibility ÔÇ║ 
should return not visible for removed content

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 73 |[39m       )[33m;[39m
     [90m 74 |[39m
    [31m[1m>[22m[39m[90m 75 |[39m       expect(res
ult[33m.[39mvisible)[33m.[39mtoBe([36mfalse[39m)[
33m;[39m
     [90m    |[39m                              
[31m[1m^[22m[39m
     [90m 76 |[39m       expect(result[33m.[39mreaso
n)[33m.[39mtoBe([32m'removed'[39m)[33m;[39m
     [90m 77 |[39m     })[33m;[39m
     [90m 78 |[39m   })[33m;[39m[0m

      at Object.toBe (src/lib/moderation/__tests__/commu
nity-integration.test.ts:75:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/nutrient-engine/schemas/ph-ec-reading-schem
a.test.ts
  ÔùÅ PhEcReadingSchema ÔÇ║ Validation Messages ÔÇ║ 
returns localized error message for pH too high

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "pH must be at most 14"
    Received: "pH must be 14 or less"

    [0m [90m 66 |[39m           
err[33m.[39mpath[33m.[39mincludes([32m'ph'[39m)
     [90m 67 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m 68 |[39m         expect(p
hError[33m?[39m[33m.[39mmessage)[33m.[39mtoBe([32
m'pH must be at most 14'[39m)[33m;[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 69 |[39m       }
     [90m 70 |[39m     })[33m;[39m
     [90m 71 |[39m[0m

      at Object.toBe (src/lib/nutrient-engine/schemas/ph
-ec-reading-schema.test.ts:68:34)

  ÔùÅ PhEcReadingSchema ÔÇ║ Validation Messages ÔÇ║ 
returns localized error message for EC out of range

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "EC must be at most 10 mS/cm"
    Received: "EC must be 10 or less"

    [0m [90m  99 |[39m           
err[33m.[39mpath[33m.[39mincludes([32m'ecRaw'[39m)
     [90m 100 |[39m         )[33m;[39m
    [31m[1m>[22m[39m[90m 101 |[39m         expect(
ecError[33m?[39m[33m.[39mmessage)[33m.[39mtoBe([3
2m'EC must be at most 10 mS/cm'[39m)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 102 |[39m       }
     [90m 103 |[39m     })[33m;[39m
     [90m 104 |[39m[0m

      at Object.toBe (src/lib/nutrient-engine/schemas/ph
-ec-reading-schema.test.ts:101:34)

FAIL 
src/lib/moderation/__tests__/misuse-detection.test.ts
  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Violation Tracking ÔÇ║ should track multiple violations 
by user

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 43 |[39m
     [90m 44 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 45 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m    |[39m                                    
 [31m[1m^[22m[39m
     [90m 46 |[39m
     [90m 47 |[39m       expect(record[33m.[39mviola
tionCount)[33m.[39mtoBe([35m3[39m)[33m;[39m
     [90m 48 |[39m       expect(record[33m.[39mviola
tionsByType)[33m.[39mtoMatchObject({[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:45:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Violation Tracking ÔÇ║ should distinguish between 
different violation types

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 60 |[39m
     [90m 61 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 62 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m    |[39m                                    
 [31m[1m^[22m[39m
     [90m 63 |[39m
     [90m 64 |[39m       expect(record[33m.[39mviola
tionsByType[33m.[39mspam)[33m.[39mtoBe([35m2[39m)
[33m;[39m
     [90m 65 |[39m       expect(record[33m.[39mviola
tionsByType[33m.[39mmisinformation)[33m.[39mtoBe([3
5m1[39m)[33m;[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:62:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Violation Tracking ÔÇ║ should track violation 
timestamps for pattern analysis

    TypeError: Cannot read properties of undefined 
(reading 'getTime')

    [0m [90m 79 |[39m       )[33m;[39m
     [90m 80 |[39m
    [31m[1m>[22m[39m[90m 81 |[39m       expect(vio
lation2[33m.[39mtimestamp[33m.[39mgetTime())[33m.[
39mtoBeGreaterThan(
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 82 |[39m         
violation1[33m.[39mtimestamp[33m.[39mgetTime()
     [90m 83 |[39m       )[33m;[39m
     [90m 84 |[39m     })[33m;[39m[0m

      at Object.getTime (src/lib/moderation/__tests__/mi
suse-detection.test.ts:81:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Graduated Enforcement (Requirement 12.2) ÔÇ║ should 
escalate from warning to temporary suspension

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 91 |[39m       [90m// First violation: 
warning[39m
     [90m 92 |[39m       [36mawait[39m repeatOffende
rService[33m.[39mrecordViolation(userId[33m,[39m 
[32m'spam'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 93 |[39m       
[36mlet[39m record [33m=[39m [36mawait[39m repeatO
ffenderService[33m.[39mgetRepeatOffenderRecord(userId)
[33m;[39m
     [90m    |[39m                                    
            [31m[1m^[22m[39m
     [90m 94 |[39m       expect(record[33m.[39mescal
ationLevel)[33m.[39mtoBe([32m'warning'[39m)[33m;[3
9m
     [90m 95 |[39m
     [90m 96 |[39m       [90m// Second violation: 
still warning[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:93:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Graduated Enforcement (Requirement 12.2) ÔÇ║ should 
escalate to permanent ban after multiple suspensions

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 115 |[39m
     [90m 116 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 117 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 118 |[39m
     [90m 119 |[39m       expect(record[33m.[39mesca
lationLevel)[33m.[39mtoBe([32m'permanent_ban'[39m)[
33m;[39m
     [90m 120 |[39m       expect(record[33m.[39mstat
us)[33m.[39mtoBe([32m'banned'[39m)[33m;[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:117:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Graduated Enforcement (Requirement 12.2) ÔÇ║ should 
apply different thresholds for severe violations

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 128 |[39m
     [90m 129 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 130 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 131 |[39m
     [90m 132 |[39m       [90m// Should immediately 
suspend for severe violations[39m
     [90m 133 |[39m       expect(record[33m.[39mesca
lationLevel)[33m.[39mtoBe([32m'temporary_suspension'
[39m)[33m;[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:130:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Graduated Enforcement (Requirement 12.2) ÔÇ║ should 
include suspension duration in enforcement action

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 143 |[39m
     [90m 144 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 145 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 146 |[39m       [36mconst[39m 
latestSuspension [33m=[39m
     [90m 147 |[39m         record[33m.[39msuspensio
nHistory[record[33m.[39msuspensionHistory[33m.[39mle
ngth [33m-[39m [35m1[39m][33m;[39m
     [90m 148 |[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:145:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Manifestly Unfounded Reporter Tracking ÔÇ║ should track 
false reports by reporter

    TypeError: moderationService.submitReport is not a 
function

    [0m [90m 159 |[39m       [90m// Submit 5 false 
reports[39m
     [90m 160 |[39m       [36mfor[39m 
([36mlet[39m i [33m=[39m [35m0[39m[33m;[39m i 
[33m<[39m [35m5[39m[33m;[39m i[33m++[39m) {
    [31m[1m>[22m[39m[90m 161 |[39m         
[36mconst[39m report [33m=[39m [36mawait[39m 
moderationService[33m.[39msubmitReport({
     [90m     |[39m                                   
             [31m[1m^[22m[39m
     [90m 162 |[39m           contentId[33m:[39m 
[32m`content-${i}`[39m[33m,[39m
     [90m 163 |[39m           reporterId[33m,[39m
     [90m 164 |[39m           reportType[33m:[39m 
[32m'policy_violation'[39m[33m,[39m[0m

      at Object.submitReport (src/lib/moderation/__tests
__/misuse-detection.test.ts:161:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Manifestly Unfounded Reporter Tracking ÔÇ║ should 
suspend reporter after threshold of false reports

    TypeError: moderationService.submitReport is not a 
function

    [0m [90m 192 |[39m       [90m// Submit 10 false 
reports (threshold)[39m
     [90m 193 |[39m       [36mfor[39m 
([36mlet[39m i [33m=[39m [35m0[39m[33m;[39m i 
[33m<[39m [35m10[39m[33m;[39m i[33m++[39m) {
    [31m[1m>[22m[39m[90m 194 |[39m         
[36mconst[39m report [33m=[39m [36mawait[39m 
moderationService[33m.[39msubmitReport({
     [90m     |[39m                                   
             [31m[1m^[22m[39m
     [90m 195 |[39m           contentId[33m:[39m 
[32m`content-${i}`[39m[33m,[39m
     [90m 196 |[39m           reporterId[33m,[39m
     [90m 197 |[39m           reportType[33m:[39m 
[32m'policy_violation'[39m[33m,[39m[0m

      at Object.submitReport (src/lib/moderation/__tests
__/misuse-detection.test.ts:194:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Manifestly Unfounded Reporter Tracking ÔÇ║ should 
calculate false report rate

    TypeError: moderationService.submitReport is not a 
function

    [0m [90m 225 |[39m       [90m// Submit 10 
reports: 3 valid, 7 false[39m
     [90m 226 |[39m       [36mfor[39m 
([36mlet[39m i [33m=[39m [35m0[39m[33m;[39m i 
[33m<[39m [35m10[39m[33m;[39m i[33m++[39m) {
    [31m[1m>[22m[39m[90m 227 |[39m         
[36mconst[39m report [33m=[39m [36mawait[39m 
moderationService[33m.[39msubmitReport({
     [90m     |[39m                                   
             [31m[1m^[22m[39m
     [90m 228 |[39m           contentId[33m:[39m 
[32m`content-${i}`[39m[33m,[39m
     [90m 229 |[39m           reporterId[33m,[39m
     [90m 230 |[39m           reportType[33m:[39m 
[32m'policy_violation'[39m[33m,[39m[0m

      at Object.submitReport (src/lib/moderation/__tests
__/misuse-detection.test.ts:227:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Audit 
Trail (Requirement 12.3) ÔÇ║ should log all enforcement 
actions with immutable audit trail

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: ObjectContaining {"actorId": Any<String>, 
"eventType": "repeat_offender_violation_recorded", 
"metadata": ObjectContaining {"violationCount": 
Any<Number>, "violationType": "hate_speech"}, 
"targetId": "user-audit-123"}

    Number of calls: 0

    [0m [90m 262 |[39m       [36mawait[39m repeatOf
fenderService[33m.[39mrecordViolation(userId[33m,[39
m [32m'hate_speech'[39m)[33m;[39m
     [90m 263 |[39m
    [31m[1m>[22m[39m[90m 264 |[39m       
expect(auditLogSpy)[33m.[39mtoHaveBeenCalledWith(
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 265 |[39m         
expect[33m.[39mobjectContaining({
     [90m 266 |[39m           eventType[33m:[39m [3
2m'repeat_offender_violation_recorded'[39m[33m,[39m
     [90m 267 |[39m           actorId[33m:[39m 
expect[33m.[39many([33mString[39m)[33m,[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/__tests__/misuse-detection.test.ts:264:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Audit 
Trail (Requirement 12.3) ÔÇ║ should log escalation 
actions with reason codes

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: ObjectContaining {"eventType": 
"repeat_offender_escalation", "metadata": 
ObjectContaining {"escalationLevel": 
"temporary_suspension", "reasonCode": Any<String>}}

    Number of calls: 0

    [0m [90m 284 |[39m       }
     [90m 285 |[39m
    [31m[1m>[22m[39m[90m 286 |[39m       
expect(auditLogSpy)[33m.[39mtoHaveBeenCalledWith(
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 287 |[39m         
expect[33m.[39mobjectContaining({
     [90m 288 |[39m           eventType[33m:[39m 
[32m'repeat_offender_escalation'[39m[33m,[39m
     [90m 289 |[39m           metadata[33m:[39m 
expect[33m.[39mobjectContaining({[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/__tests__/misuse-detection.test.ts:286:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Audit 
Trail (Requirement 12.3) ÔÇ║ should include evidence 
links in audit trail

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: ObjectContaining {"metadata": 
ObjectContaining {"decisionId": "decision-123", 
"evidenceUrls": ArrayContaining 
["https://example.com/evidence/1"]}}

    Number of calls: 0

    [0m [90m 304 |[39m       })[33m;[39m
     [90m 305 |[39m
    [31m[1m>[22m[39m[90m 306 |[39m       
expect(auditLogSpy)[33m.[39mtoHaveBeenCalledWith(
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 307 |[39m         
expect[33m.[39mobjectContaining({
     [90m 308 |[39m           metadata[33m:[39m 
expect[33m.[39mobjectContaining({
     [90m 309 |[39m             
evidenceUrls[33m:[39m 
expect[33m.[39marrayContaining([[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/__tests__/misuse-detection.test.ts:306:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Appeal 
Paths (Requirement 12.4) ÔÇ║ should allow users to 
appeal repeat offender status

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 327 |[39m
     [90m 328 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 329 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 330 |[39m       expect(record[33m.[39mstat
us)[33m.[39mtoBe([32m'suspended'[39m)[33m;[39m
     [90m 331 |[39m
     [90m 332 |[39m       [90m// Submit 
appeal[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:329:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Appeal 
Paths (Requirement 12.4) ÔÇ║ should restore account 
status when appeal is upheld

    TypeError: repeatOffenderService.submitStatusAppeal 
is not a function

    [0m [90m 350 |[39m
     [90m 351 |[39m       [90m// Submit and uphold 
appeal[39m
    [31m[1m>[22m[39m[90m 352 |[39m       
[36mconst[39m appeal [33m=[39m [36mawait[39m repea
tOffenderService[33m.[39msubmitStatusAppeal(userId[33
m,[39m {
     [90m     |[39m                                   
               [31m[1m^[22m[39m
     [90m 353 |[39m         reason[33m:[39m 
[32m'False positives'[39m[33m,[39m
     [90m 354 |[39m         evidence[33m:[39m 
[][33m,[39m
     [90m 355 |[39m       })[33m;[39m[0m

      at Object.submitStatusAppeal (src/lib/moderation/_
_tests__/misuse-detection.test.ts:352:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Appeal 
Paths (Requirement 12.4) ÔÇ║ should maintain suspension 
when appeal is rejected

    TypeError: repeatOffenderService.submitStatusAppeal 
is not a function

    [0m [90m 376 |[39m
     [90m 377 |[39m       [90m// Submit and reject 
appeal[39m
    [31m[1m>[22m[39m[90m 378 |[39m       
[36mconst[39m appeal [33m=[39m [36mawait[39m repea
tOffenderService[33m.[39msubmitStatusAppeal(userId[33
m,[39m {
     [90m     |[39m                                   
               [31m[1m^[22m[39m
     [90m 379 |[39m         reason[33m:[39m [32m'I 
disagree with the violations'[39m[33m,[39m
     [90m 380 |[39m         evidence[33m:[39m 
[][33m,[39m
     [90m 381 |[39m       })[33m;[39m[0m

      at Object.submitStatusAppeal (src/lib/moderation/_
_tests__/misuse-detection.test.ts:378:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Pattern 
Detection ÔÇ║ should detect rapid violation patterns

    TypeError: 
repeatOffenderService.detectViolationPattern is not a 
function

    [0m [90m 406 |[39m
     [90m 407 |[39m       [36mconst[39m pattern 
[33m=[39m
    [31m[1m>[22m[39m[90m 408 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mdetectVi
olationPattern(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 409 |[39m
     [90m 410 |[39m       expect(pattern[33m.[39misR
apid)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 411 |[39m       expect(pattern[33m.[39mvio
lationsPerHour)[33m.[39mtoBeGreaterThan([35m4[39m)[
33m;[39m[0m

      at Object.detectViolationPattern (src/lib/moderati
on/__tests__/misuse-detection.test.ts:408:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ Pattern 
Detection ÔÇ║ should detect cross-category violation 
patterns

    TypeError: 
repeatOffenderService.detectViolationPattern is not a 
function

    [0m [90m 421 |[39m
     [90m 422 |[39m       [36mconst[39m pattern 
[33m=[39m
    [31m[1m>[22m[39m[90m 423 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mdetectVi
olationPattern(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 424 |[39m
     [90m 425 |[39m       expect(pattern[33m.[39misC
rossCategory)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 426 |[39m       expect(pattern[33m.[39muni
queViolationTypes)[33m.[39mtoBe([35m3[39m)[33m;[39
m[0m

      at Object.detectViolationPattern (src/lib/moderati
on/__tests__/misuse-detection.test.ts:423:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Severity-Based Thresholds ÔÇ║ should apply stricter 
thresholds for severe violations

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 437 |[39m
     [90m 438 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 439 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 440 |[39m
     [90m 441 |[39m       expect(record[33m.[39mesca
lationLevel)[33m.[39mtoBe([32m'permanent_ban'[39m)[
33m;[39m
     [90m 442 |[39m       expect(record[33m.[39mstat
us)[33m.[39mtoBe([32m'banned'[39m)[33m;[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:439:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Repeat Infringer Detection (Art. 23) ÔÇ║ 
Severity-Based Thresholds ÔÇ║ should apply lenient 
thresholds for minor violations

    TypeError: 
repeatOffenderService.getRepeatOffenderRecord is not a 
function

    [0m [90m 452 |[39m
     [90m 453 |[39m       [36mconst[39m record 
[33m=[39m
    [31m[1m>[22m[39m[90m 454 |[39m         
[36mawait[39m repeatOffenderService[33m.[39mgetRepea
tOffenderRecord(userId)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 455 |[39m
     [90m 456 |[39m       expect(record[33m.[39mesca
lationLevel)[33m.[39mtoBe([32m'warning'[39m)[33m;[
39m
     [90m 457 |[39m       expect(record[33m.[39mstat
us)[33m.[39mtoBe([32m'active'[39m)[33m;[39m[0m

      at Object.getRepeatOffenderRecord (src/lib/moderat
ion/__tests__/misuse-detection.test.ts:454:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/task-manager.test.ts
  ÔùÅ TaskManager basic flows ÔÇ║ create/update/delete 
one-off task

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 256 |[39m     completedAt[33m:[39m mod
el[33m.[39mcompletedAt[33m?[39m[33m.[39mtoISOStrin
g()[33m,[39m
     [90m 257 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
{}[33m,[39m
    [31m[1m>[22m[39m[90m 258 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 259 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 260 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 261 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:258:32)
      at toTaskFromModel 
(src/lib/task-manager.ts:423:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager basic flows ÔÇ║ series create and 
visible window materialization (lazy)

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 276 |[39m     origin[33m:[39m 
model[33m.[39morigin [33m?[39m[33m?[39m 
undefined[33m,[39m
     [90m 277 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
undefined[33m,[39m
    [31m[1m>[22m[39m[90m 278 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 279 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 280 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 281 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:278:32)
      at toSeriesFromModel 
(src/lib/task-manager.ts:1628:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager basic flows ÔÇ║ complete task and 
materialize next for recurring

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 276 |[39m     origin[33m:[39m 
model[33m.[39morigin [33m?[39m[33m?[39m 
undefined[33m,[39m
     [90m 277 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
undefined[33m,[39m
    [31m[1m>[22m[39m[90m 278 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 279 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 280 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 281 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:278:32)
      at toSeriesFromModel 
(src/lib/task-manager.ts:1628:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager basic flows ÔÇ║ skip recurring 
instance via override

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 276 |[39m     origin[33m:[39m 
model[33m.[39morigin [33m?[39m[33m?[39m 
undefined[33m,[39m
     [90m 277 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
undefined[33m,[39m
    [31m[1m>[22m[39m[90m 278 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 279 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 280 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 281 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:278:32)
      at toSeriesFromModel 
(src/lib/task-manager.ts:1628:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager basic flows ÔÇ║ complete recurring 
instance via override and materialize next

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 276 |[39m     origin[33m:[39m 
model[33m.[39morigin [33m?[39m[33m?[39m 
undefined[33m,[39m
     [90m 277 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
undefined[33m,[39m
    [31m[1m>[22m[39m[90m 278 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 279 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 280 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 281 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:278:32)
      at toSeriesFromModel 
(src/lib/task-manager.ts:1628:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager basic flows ÔÇ║ reschedule recurring 
instance override persists and affects visibility

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 276 |[39m     origin[33m:[39m 
model[33m.[39morigin [33m?[39m[33m?[39m 
undefined[33m,[39m
     [90m 277 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
undefined[33m,[39m
    [31m[1m>[22m[39m[90m 278 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 279 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 280 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 281 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:278:32)
      at toSeriesFromModel 
(src/lib/task-manager.ts:1628:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager notification scheduling ÔÇ║ 
createTask respects scheduleNotifications=false

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 256 |[39m     completedAt[33m:[39m mod
el[33m.[39mcompletedAt[33m?[39m[33m.[39mtoISOStrin
g()[33m,[39m
     [90m 257 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
{}[33m,[39m
    [31m[1m>[22m[39m[90m 258 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 259 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 260 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 261 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:258:32)
      at toTaskFromModel 
(src/lib/task-manager.ts:423:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TaskManager notification scheduling ÔÇ║ 
createTask schedules reminders by default

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 256 |[39m     completedAt[33m:[39m mod
el[33m.[39mcompletedAt[33m?[39m[33m.[39mtoISOStrin
g()[33m,[39m
     [90m 257 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
{}[33m,[39m
    [31m[1m>[22m[39m[90m 258 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 259 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 260 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 261 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:258:32)
      at toTaskFromModel 
(src/lib/task-manager.ts:423:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/auth/__tests__/key-rotation.test.ts
  ÔùÅ Key Rotation ÔÇ║ rotateEncryptionKey ÔÇ║ should 
successfully rotate encryption key

    TypeError: _reactNativeMmkv.MMKV.mockImplementation 
is not a function

    [0m [90m 129 |[39m       }[33m;[39m
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m       
([33mMMKV[39m [36mas[39m jest[33m.[39m[33mMockedC
lass[39m[33m<[39m[36mtypeof[39m 
[33mMMKV[39m[33m>[39m)[33m.[39mmockImplementation(
     [90m     |[39m                                   
            [31m[1m^[22m[39m
     [90m 132 |[39m         (config[33m:[39m any) 
[33m=>[39m {
     [90m 133 |[39m           [36mif[39m 
(config[33m.[39mid [33m===[39m 
[32m'auth-storage'[39m) {
     [90m 134 |[39m             [36mreturn[39m 
mockOldStorage [36mas[39m any[33m;[39m[0m

      at Object.mockImplementation 
(src/lib/auth/__tests__/key-rotation.test.ts:131:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Key Rotation ÔÇ║ initializeEncryptionKey ÔÇ║ 
should return existing key if available

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "existing-key-hex"
    Received: "1"

    [0m [90m 188 |[39m       [36mconst[39m key 
[33m=[39m [36mawait[39m 
initializeEncryptionKey()[33m;[39m
     [90m 189 |[39m
    [31m[1m>[22m[39m[90m 190 |[39m       
expect(key)[33m.[39mtoBe(existingKey)[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 191 |[39m       expect(mockCrypto[33m.[39m
getRandomBytesAsync)[33m.[39mnot[33m.[39mtoHaveBeenC
alled()[33m;[39m
     [90m 192 |[39m     })[33m;[39m
     [90m 193 |[39m[0m

      at Object.toBe 
(src/lib/auth/__tests__/key-rotation.test.ts:190:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Key Rotation ÔÇ║ initializeEncryptionKey ÔÇ║ 
should generate new key if none exists

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 32

    Number of calls: 0

    [0m [90m 213 |[39m
     [90m 214 |[39m       
expect(key)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 215 |[39m       expect(mo
ckCrypto[33m.[39mgetRandomBytesAsync)[33m.[39mtoHave
BeenCalledWith([35m32[39m)[33m;[39m
     [90m     |[39m                                   
           [31m[1m^[22m[39m
     [90m 216 |[39m       expect(mockSecureStore[33m.
[39msetItemAsync)[33m.[39mtoHaveBeenCalled()[33m;[3
9m
     [90m 217 |[39m       expect(mockSupabase[33m.[3
9mrpc)[33m.[39mtoHaveBeenCalledWith([32m'rotate_encry
ption_key'[39m[33m,[39m {
     [90m 218 |[39m         p_old_version[33m:[39m 
[35m0[39m[33m,[39m[0m

      at Object.toHaveBeenCalledWith 
(src/lib/auth/__tests__/key-rotation.test.ts:215:46)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Key Rotation ÔÇ║ cleanupOldKeys ÔÇ║ should remove 
keys older than 2 versions

    expect(jest.fn()).toHaveBeenCalledTimes(expected)

    Expected number of calls: 3
    Received number of calls: 0

    [0m [90m 272 |[39m
     [90m 273 |[39m       [90m// Should delete 
versions 1, 2, 3 (keep 4 and 5)[39m
    [31m[1m>[22m[39m[90m 274 |[39m       expect(mo
ckSecureStore[33m.[39mdeleteItemAsync)[33m.[39mtoHav
eBeenCalledTimes([35m3[39m)[33m;[39m
     [90m     |[39m                                   
            [31m[1m^[22m[39m
     [90m 275 |[39m       expect(mockSecureStore[33m.
[39mdeleteItemAsync)[33m.[39mtoHaveBeenCalledWith(
     [90m 276 |[39m         
[32m'auth_encryption_key_v1'[39m
     [90m 277 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledTimes 
(src/lib/auth/__tests__/key-rotation.test.ts:274:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/auth/index.test.tsx
  ÔùÅ Auth ÔÇ║ state transitions ÔÇ║ should transition 
from idle to signIn with session and user

    TypeError: _supabase.supabase.auth.getSession is 
not a function

    [0m [90m 54 |[39m   [90m// Check if Supabase 
client already has this session active[39m
     [90m 55 |[39m   [90m// (e.g., from 
signInWithPassword, signInWithIdToken, or OAuth)[39m
    [31m[1m>[22m[39m[90m 56 |[39m   
[36mconst[39m { data[33m:[39m currentData } 
[33m=[39m [36mawait[39m supabase[33m.[39mauth[33m
.[39mgetSession()[33m;[39m
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 57 |[39m   [36mconst[39m 
supabaseHasSession [33m=[39m
     [90m 58 |[39m     currentData[33m?[39m[33m.[3
9msession[33m?[39m[33m.[39maccess_token 
[33m===[39m session[33m.[39maccess_token[33m;[39m
     [90m 59 |[39m[0m

      at getSession (src/lib/auth/index.tsx:56:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:92:2)
      at apply (src/lib/auth/index.tsx:49:39)
      at handleSignInWithSession 
(src/lib/auth/index.tsx:268:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:265:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:257:29)
      at Object.performSignIn 
(src/lib/auth/index.tsx:428:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as signIn] 
(src/lib/auth/index.tsx:428:9)
      at Object.signIn 
(src/lib/auth/index.test.tsx:139:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth ÔÇ║ session management ÔÇ║ should update 
session with updateSession action

    TypeError: _supabase.supabase.auth.getSession is 
not a function

    [0m [90m 54 |[39m   [90m// Check if Supabase 
client already has this session active[39m
     [90m 55 |[39m   [90m// (e.g., from 
signInWithPassword, signInWithIdToken, or OAuth)[39m
    [31m[1m>[22m[39m[90m 56 |[39m   
[36mconst[39m { data[33m:[39m currentData } 
[33m=[39m [36mawait[39m supabase[33m.[39mauth[33m
.[39mgetSession()[33m;[39m
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 57 |[39m   [36mconst[39m 
supabaseHasSession [33m=[39m
     [90m 58 |[39m     currentData[33m?[39m[33m.[3
9msession[33m?[39m[33m.[39maccess_token 
[33m===[39m session[33m.[39maccess_token[33m;[39m
     [90m 59 |[39m[0m

      at getSession (src/lib/auth/index.tsx:56:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:49:39)
      at handleSignInWithSession 
(src/lib/auth/index.tsx:268:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:265:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:257:29)
      at Object.performSignIn 
(src/lib/auth/index.tsx:428:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as signIn] 
(src/lib/auth/index.tsx:428:9)
      at Object.signIn 
(src/lib/auth/index.test.tsx:174:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth ÔÇ║ session management ÔÇ║ should update 
user with updateUser action

    TypeError: _supabase.supabase.auth.getSession is 
not a function

    [0m [90m 54 |[39m   [90m// Check if Supabase 
client already has this session active[39m
     [90m 55 |[39m   [90m// (e.g., from 
signInWithPassword, signInWithIdToken, or OAuth)[39m
    [31m[1m>[22m[39m[90m 56 |[39m   
[36mconst[39m { data[33m:[39m currentData } 
[33m=[39m [36mawait[39m supabase[33m.[39mauth[33m
.[39mgetSession()[33m;[39m
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 57 |[39m   [36mconst[39m 
supabaseHasSession [33m=[39m
     [90m 58 |[39m     currentData[33m?[39m[33m.[3
9msession[33m?[39m[33m.[39maccess_token 
[33m===[39m session[33m.[39maccess_token[33m;[39m
     [90m 59 |[39m[0m

      at getSession (src/lib/auth/index.tsx:56:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:49:39)
      at handleSignInWithSession 
(src/lib/auth/index.tsx:268:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:265:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:257:29)
      at Object.performSignIn 
(src/lib/auth/index.tsx:428:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as signIn] 
(src/lib/auth/index.tsx:428:9)
      at Object.signIn 
(src/lib/auth/index.test.tsx:196:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth ÔÇ║ session persistence ÔÇ║ should persist 
session to storage on signIn

    TypeError: _supabase.supabase.auth.getSession is 
not a function

    [0m [90m 54 |[39m   [90m// Check if Supabase 
client already has this session active[39m
     [90m 55 |[39m   [90m// (e.g., from 
signInWithPassword, signInWithIdToken, or OAuth)[39m
    [31m[1m>[22m[39m[90m 56 |[39m   
[36mconst[39m { data[33m:[39m currentData } 
[33m=[39m [36mawait[39m supabase[33m.[39mauth[33m
.[39mgetSession()[33m;[39m
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 57 |[39m   [36mconst[39m 
supabaseHasSession [33m=[39m
     [90m 58 |[39m     currentData[33m?[39m[33m.[3
9msession[33m?[39m[33m.[39maccess_token 
[33m===[39m session[33m.[39maccess_token[33m;[39m
     [90m 59 |[39m[0m

      at getSession (src/lib/auth/index.tsx:56:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:49:39)
      at handleSignInWithSession 
(src/lib/auth/index.tsx:268:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:265:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:257:29)
      at Object.performSignIn 
(src/lib/auth/index.tsx:428:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as signIn] 
(src/lib/auth/index.tsx:428:9)
      at Object.signIn 
(src/lib/auth/index.test.tsx:226:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Auth ÔÇ║ session persistence ÔÇ║ should hydrate 
session from storage

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "signIn"
    Received: "signOut"

    [0m [90m 250 |[39m
     [90m 251 |[39m       [36mconst[39m state 
[33m=[39m useAuth[33m.[39mgetState()[33m;[39m
    [31m[1m>[22m[39m[90m 252 |[39m       expect(st
ate[33m.[39mstatus)[33m.[39mtoBe([32m'signIn'[39m)
[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 253 |[39m       expect(state[33m.[39mtoken
)[33m.[39mtoEqual(token)[33m;[39m
     [90m 254 |[39m     })[33m;[39m
     [90m 255 |[39m[0m

      at Object.toBe 
(src/lib/auth/index.test.tsx:252:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Auth ÔÇ║ session persistence ÔÇ║ should clear 
storage on signOut

    expect(received).toBeTruthy()

    Received: undefined

    [0m [90m 270 |[39m         [33m.[39mgetState()
     [90m 271 |[39m         [33m.[39msignIn({ 
access[33m:[39m [32m'test-token'[39m[33m,[39m 
refresh[33m:[39m [32m'test-refresh'[39m 
})[33m;[39m
    [31m[1m>[22m[39m[90m 272 |[39m       expect(mo
ckStorage[33m.[39m[36mget[39m([32m'token'[39m))[3
3m.[39mtoBeTruthy()[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 273 |[39m
     [90m 274 |[39m       [36mawait[39m 
signOut()[33m;[39m
     [90m 275 |[39m[0m

      at Object.toBeTruthy 
(src/lib/auth/index.test.tsx:272:40)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Auth ÔÇ║ onAuthStateChange event handling ÔÇ║ 
should update state on SIGNED_IN event with different 
session token

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "different-access-token"
    Received: "test-access-token"

    [0m [90m 317 |[39m       [36mconst[39m 
updatedState [33m=[39m 
useAuth[33m.[39mgetState()[33m;[39m
     [90m 318 |[39m       expect(updatedState[33m.[3
9mstatus)[33m.[39mtoBe([32m'signIn'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 319 |[39m       expect(up
datedState[33m.[39msession[33m?[39m[33m.[39maccess
_token)[33m.[39mtoBe([32m'different-access-token'[39
m)[33m;[39m
     [90m     |[39m                                   
               [31m[1m^[22m[39m
     [90m 320 |[39m       expect(updatedState[33m.[3
9msession[33m?[39m[33m.[39mrefresh_token)[33m.[39m
toBe(
     [90m 321 |[39m         
[32m'different-refresh-token'[39m
     [90m 322 |[39m       )[33m;[39m[0m

      at Object.toBe 
(src/lib/auth/index.test.tsx:319:50)

  ÔùÅ Auth ÔÇ║ onAuthStateChange event handling ÔÇ║ 
should update state on SIGNED_IN event with different 
session token

    TypeError: _supabase.supabase.auth.getSession is 
not a function

    [0m [90m 54 |[39m   [90m// Check if Supabase 
client already has this session active[39m
     [90m 55 |[39m   [90m// (e.g., from 
signInWithPassword, signInWithIdToken, or OAuth)[39m
    [31m[1m>[22m[39m[90m 56 |[39m   
[36mconst[39m { data[33m:[39m currentData } 
[33m=[39m [36mawait[39m supabase[33m.[39mauth[33m
.[39mgetSession()[33m;[39m
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 57 |[39m   [36mconst[39m 
supabaseHasSession [33m=[39m
     [90m 58 |[39m     currentData[33m?[39m[33m.[3
9msession[33m?[39m[33m.[39maccess_token 
[33m===[39m session[33m.[39maccess_token[33m;[39m
     [90m 59 |[39m[0m

      at getSession (src/lib/auth/index.tsx:56:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:49:39)
      at handleSignInWithSession 
(src/lib/auth/index.tsx:268:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:265:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:257:29)
      at Object.performSignIn 
(src/lib/auth/index.tsx:428:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as signIn] 
(src/lib/auth/index.tsx:428:9)
      at Object.signIn 
(src/lib/auth/index.test.tsx:283:26)

  ÔùÅ Auth ÔÇ║ onAuthStateChange event handling ÔÇ║ 
should not update state on SIGNED_IN event with same 
session token

    TypeError: _supabase.supabase.auth.getSession is 
not a function

    [0m [90m 54 |[39m   [90m// Check if Supabase 
client already has this session active[39m
     [90m 55 |[39m   [90m// (e.g., from 
signInWithPassword, signInWithIdToken, or OAuth)[39m
    [31m[1m>[22m[39m[90m 56 |[39m   
[36mconst[39m { data[33m:[39m currentData } 
[33m=[39m [36mawait[39m supabase[33m.[39mauth[33m
.[39mgetSession()[33m;[39m
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 57 |[39m   [36mconst[39m 
supabaseHasSession [33m=[39m
     [90m 58 |[39m     currentData[33m?[39m[33m.[3
9msession[33m?[39m[33m.[39maccess_token 
[33m===[39m session[33m.[39maccess_token[33m;[39m
     [90m 59 |[39m[0m

      at getSession (src/lib/auth/index.tsx:56:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:49:39)
      at handleSignInWithSession 
(src/lib/auth/index.tsx:268:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation (src/lib/auth/index.tsx:218:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:174:29)
      at withAuthMutex (src/lib/auth/index.tsx:265:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/auth/index.tsx:257:29)
      at Object.performSignIn 
(src/lib/auth/index.tsx:428:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply [as signIn] 
(src/lib/auth/index.tsx:428:9)
      at Object.signIn 
(src/lib/auth/index.test.tsx:331:26)

  ÔùÅ Auth ÔÇ║ signOut ÔÇ║ should clear auth token from 
storage on signOut

    expect(received).toBeTruthy()

    Received: undefined

    [0m [90m 382 |[39m
     [90m 383 |[39m       [90m// Verify token is 
stored[39m
    [31m[1m>[22m[39m[90m 384 |[39m       expect(mo
ckStorage[33m.[39m[36mget[39m([32m'token'[39m))[3
3m.[39mtoBeTruthy()[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 385 |[39m
     [90m 386 |[39m       [90m// Sign out[39m
     [90m 387 |[39m       [36mawait[39m 
signOut()[33m;[39m[0m

      at Object.toBeTruthy 
(src/lib/auth/index.test.tsx:384:40)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/moderation/__tests__/security-tests.test.ts
  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should prevent unauthorized access to moderation 
queues

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should allow moderators to access moderation queues

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should allow admins to access all moderation 
functions

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should enforce role-based access control via JWT 
claims

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should prevent privilege escalation

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should validate moderator credentials on every 
request

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Authentication & Authorization 
ÔÇ║ should log all authentication attempts

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should create immutable audit events with cryptographic 
signatures

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should detect tampering with audit events

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should maintain chain of custody for audit trail access

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should prevent deletion of audit events

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should prevent modification of audit events

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should verify partition checksums for integrity

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Audit Trail Integrity ÔÇ║ 
should detect partition tampering

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Data Access Controls ÔÇ║ 
should enforce row-level security on sensitive data

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Data Access Controls ÔÇ║ 
should allow moderators to access only their assigned 
reports

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Data Access Controls ÔÇ║ 
should prevent cross-moderator data access

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Data Access Controls ÔÇ║ 
should log all data access attempts

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Input Validation & Injection 
Prevention ÔÇ║ should prevent SQL injection in report 
queries

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Input Validation & Injection 
Prevention ÔÇ║ should sanitize user input in reports

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Input Validation & Injection 
Prevention ÔÇ║ should validate content locator URLs

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Input Validation & Injection 
Prevention ÔÇ║ should enforce maximum input lengths

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Rate Limiting & Abuse 
Prevention ÔÇ║ should rate limit report submissions

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Rate Limiting & Abuse 
Prevention ÔÇ║ should detect and prevent duplicate 
report spam

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Rate Limiting & Abuse 
Prevention ÔÇ║ should implement CAPTCHA for suspicious 
activity

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Encryption & Data Protection 
ÔÇ║ should encrypt sensitive data at rest

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Encryption & Data Protection 
ÔÇ║ should use secure hashing for content snapshots

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Encryption & Data Protection 
ÔÇ║ should protect API keys and secrets

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Session Management ÔÇ║ should 
invalidate sessions after timeout

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

  ÔùÅ Security Tests ÔÇ║ Session Management ÔÇ║ should 
release claimed reports on session expiry

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 24 |[39m     auditService [33m=[39m 
[36mnew[39m 
[33mAuditService[39m(supabase)[33m;[39m
     [90m 25 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 26 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 27 |[39m     
jest[33m.[39mclearAllMocks()[33m;[39m
     [90m 28 |[39m   })[33m;[39m
     [90m 29 |[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/security-tests.test.ts:26:22)

FAIL src/lib/assessment/offline-queue-manager.test.ts
  ÔùÅ OfflineQueueManager ÔÇ║ enqueue ÔÇ║ should create 
a new assessment request

    TypeError: _watermelondb.Q.lt is not a function

    [0m [90m 473 |[39m     [36mconst[39m 
conditions [33m=[39m [
     [90m 474 |[39m       [33mQ[39m[33m.[39mwhere(
[32m'status'[39m[33m,[39m status)[33m,[39m
    [31m[1m>[22m[39m[90m 475 |[39m       [33mQ[3
9m[33m.[39mwhere([32m'updated_at'[39m[33m,[39m 
[33mQ[39m[33m.[39mlt(cutoff))[33m,[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 476 |[39m     ][33m;[39m
     [90m 477 |[39m
     [90m 478 |[39m     [36mreturn[39m collection[3
3m.[39mquery([33m...[39mconditions)[33m.[39mfetch()
[33m;[39m[0m

      at OfflineQueueManager.lt 
(src/lib/assessment/offline-queue-manager.ts:475:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
fetchRecordsBefore] 
(src/lib/assessment/offline-queue-manager.ts:468:35)
      at OfflineQueueManager.fetchRecordsBefore 
(src/lib/assessment/offline-queue-manager.ts:407:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
getRetentionRemovals] 
(src/lib/assessment/offline-queue-manager.ts:399:37)
      at OfflineQueueManager.getRetentionRemovals 
(src/lib/assessment/offline-queue-manager.ts:366:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
cleanupStoragePolicy] 
(src/lib/assessment/offline-queue-manager.ts:358:37)
      at OfflineQueueManager.cleanupStoragePolicy 
(src/lib/assessment/offline-queue-manager.ts:64:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as enqueue] 
(src/lib/assessment/offline-queue-manager.ts:56:16)
      at Object.enqueue 
(src/lib/assessment/offline-queue-manager.test.ts:34:44)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ OfflineQueueManager ÔÇ║ getQueueStatus ÔÇ║ should 
return correct queue counts

    TypeError: _watermelondb.Q.lt is not a function

    [0m [90m 473 |[39m     [36mconst[39m 
conditions [33m=[39m [
     [90m 474 |[39m       [33mQ[39m[33m.[39mwhere(
[32m'status'[39m[33m,[39m status)[33m,[39m
    [31m[1m>[22m[39m[90m 475 |[39m       [33mQ[3
9m[33m.[39mwhere([32m'updated_at'[39m[33m,[39m 
[33mQ[39m[33m.[39mlt(cutoff))[33m,[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 476 |[39m     ][33m;[39m
     [90m 477 |[39m
     [90m 478 |[39m     [36mreturn[39m collection[3
3m.[39mquery([33m...[39mconditions)[33m.[39mfetch()
[33m;[39m[0m

      at OfflineQueueManager.lt 
(src/lib/assessment/offline-queue-manager.ts:475:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
fetchRecordsBefore] 
(src/lib/assessment/offline-queue-manager.ts:468:35)
      at OfflineQueueManager.fetchRecordsBefore 
(src/lib/assessment/offline-queue-manager.ts:407:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
getRetentionRemovals] 
(src/lib/assessment/offline-queue-manager.ts:399:37)
      at OfflineQueueManager.getRetentionRemovals 
(src/lib/assessment/offline-queue-manager.ts:366:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
cleanupStoragePolicy] 
(src/lib/assessment/offline-queue-manager.ts:358:37)
      at OfflineQueueManager.cleanupStoragePolicy 
(src/lib/assessment/offline-queue-manager.ts:64:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as enqueue] 
(src/lib/assessment/offline-queue-manager.ts:56:16)
      at Object.enqueue 
(src/lib/assessment/offline-queue-manager.test.ts:63:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ OfflineQueueManager ÔÇ║ getQueueStatus ÔÇ║ should 
count processing requests

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 1
    Received: 0

    [0m [90m 104 |[39m       [36mconst[39m status 
[33m=[39m [36mawait[39m 
queueManager[33m.[39mgetQueueStatus()[33m;[39m
     [90m 105 |[39m
    [31m[1m>[22m[39m[90m 106 |[39m       expect(st
atus[33m.[39mprocessing)[33m.[39mtoBe([35m1[39m)[
33m;[39m
     [90m     |[39m                                 
[31m[1m^[22m[39m
     [90m 107 |[39m     })[33m;[39m
     [90m 108 |[39m   })[33m;[39m
     [90m 109 |[39m[0m

      at Object.toBe (src/lib/assessment/offline-queue-m
anager.test.ts:106:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OfflineQueueManager ÔÇ║ processQueue ÔÇ║ should 
not process when offline

    TypeError: _watermelondb.Q.lt is not a function

    [0m [90m 473 |[39m     [36mconst[39m 
conditions [33m=[39m [
     [90m 474 |[39m       [33mQ[39m[33m.[39mwhere(
[32m'status'[39m[33m,[39m status)[33m,[39m
    [31m[1m>[22m[39m[90m 475 |[39m       [33mQ[3
9m[33m.[39mwhere([32m'updated_at'[39m[33m,[39m 
[33mQ[39m[33m.[39mlt(cutoff))[33m,[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 476 |[39m     ][33m;[39m
     [90m 477 |[39m
     [90m 478 |[39m     [36mreturn[39m collection[3
3m.[39mquery([33m...[39mconditions)[33m.[39mfetch()
[33m;[39m[0m

      at OfflineQueueManager.lt 
(src/lib/assessment/offline-queue-manager.ts:475:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
fetchRecordsBefore] 
(src/lib/assessment/offline-queue-manager.ts:468:35)
      at OfflineQueueManager.fetchRecordsBefore 
(src/lib/assessment/offline-queue-manager.ts:407:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
getRetentionRemovals] 
(src/lib/assessment/offline-queue-manager.ts:399:37)
      at OfflineQueueManager.getRetentionRemovals 
(src/lib/assessment/offline-queue-manager.ts:366:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
cleanupStoragePolicy] 
(src/lib/assessment/offline-queue-manager.ts:358:37)
      at OfflineQueueManager.cleanupStoragePolicy 
(src/lib/assessment/offline-queue-manager.ts:64:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as enqueue] 
(src/lib/assessment/offline-queue-manager.ts:56:16)
      at Object.enqueue (src/lib/assessment/offline-queu
e-manager.test.ts:114:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ OfflineQueueManager ÔÇ║ processQueue ÔÇ║ should 
process pending requests when online

    TypeError: _watermelondb.Q.lt is not a function

    [0m [90m 473 |[39m     [36mconst[39m 
conditions [33m=[39m [
     [90m 474 |[39m       [33mQ[39m[33m.[39mwhere(
[32m'status'[39m[33m,[39m status)[33m,[39m
    [31m[1m>[22m[39m[90m 475 |[39m       [33mQ[3
9m[33m.[39mwhere([32m'updated_at'[39m[33m,[39m 
[33mQ[39m[33m.[39mlt(cutoff))[33m,[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 476 |[39m     ][33m;[39m
     [90m 477 |[39m
     [90m 478 |[39m     [36mreturn[39m collection[3
3m.[39mquery([33m...[39mconditions)[33m.[39mfetch()
[33m;[39m[0m

      at OfflineQueueManager.lt 
(src/lib/assessment/offline-queue-manager.ts:475:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
fetchRecordsBefore] 
(src/lib/assessment/offline-queue-manager.ts:468:35)
      at OfflineQueueManager.fetchRecordsBefore 
(src/lib/assessment/offline-queue-manager.ts:407:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
getRetentionRemovals] 
(src/lib/assessment/offline-queue-manager.ts:399:37)
      at OfflineQueueManager.getRetentionRemovals 
(src/lib/assessment/offline-queue-manager.ts:366:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
cleanupStoragePolicy] 
(src/lib/assessment/offline-queue-manager.ts:358:37)
      at OfflineQueueManager.cleanupStoragePolicy 
(src/lib/assessment/offline-queue-manager.ts:64:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as enqueue] 
(src/lib/assessment/offline-queue-manager.ts:56:16)
      at Object.enqueue (src/lib/assessment/offline-queu
e-manager.test.ts:129:44)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ OfflineQueueManager ÔÇ║ processQueue ÔÇ║ should 
skip requests that exceeded max retries

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 163 |[39m       [36mconst[39m results 
[33m=[39m [36mawait[39m 
queueManager[33m.[39mprocessQueue()[33m;[39m
     [90m 164 |[39m
    [31m[1m>[22m[39m[90m 165 |[39m       expect(re
sults)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 166 |[39m       expect(results[[35m0[39m]
[33m?[39m[33m.[39msuccess)[33m.[39mtoBe([36mfalse
[39m)[33m;[39m
     [90m 167 |[39m       expect(results[[35m0[39m]
[33m?[39m[33m.[39merror)[33m.[39mtoBe([32m'Max 
retries exceeded'[39m)[33m;[39m
     [90m 168 |[39m     })[33m;[39m[0m

      at Object.toHaveLength (src/lib/assessment/offline
-queue-manager.test.ts:165:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OfflineQueueManager ÔÇ║ retryFailed ÔÇ║ should 
reset failed requests to pending

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 196 |[39m         
[33m.[39mfetch()[33m;[39m
     [90m 197 |[39m
    [31m[1m>[22m[39m[90m 198 |[39m       expect(re
quests)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 199 |[39m       expect(requests[[35m0[39m]
[33m?[39m[33m.[39mnextAttemptAt)[33m.[39mtoBeUndef
ined()[33m;[39m
     [90m 200 |[39m     })[33m;[39m
     [90m 201 |[39m[0m

      at Object.toHaveLength (src/lib/assessment/offline
-queue-manager.test.ts:198:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OfflineQueueManager ÔÇ║ retryFailed ÔÇ║ should 
not retry requests that exceeded max retries

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 224 |[39m         
[33m.[39mfetch()[33m;[39m
     [90m 225 |[39m
    [31m[1m>[22m[39m[90m 226 |[39m       expect(fa
iledRequests)[33m.[39mtoHaveLength([35m1[39m)[33m;
[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 227 |[39m     })[33m;[39m
     [90m 228 |[39m   })[33m;[39m
     [90m 229 |[39m[0m

      at Object.toHaveLength (src/lib/assessment/offline
-queue-manager.test.ts:226:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OfflineQueueManager ÔÇ║ clearCompleted ÔÇ║ should 
have clearCompleted method

    TypeError: _watermelondb.Q.lt is not a function

    [0m [90m 290 |[39m       [33m.[39mquery(
     [90m 291 |[39m         [33mQ[39m[33m.[39mwher
e([32m'status'[39m[33m,[39m 
[32m'completed'[39m)[33m,[39m
    [31m[1m>[22m[39m[90m 292 |[39m         [33mQ
[39m[33m.[39mwhere([32m'updated_at'[39m[33m,[39m 
[33mQ[39m[33m.[39mlt(cutoffTime))
     [90m     |[39m                                 
[31m[1m^[22m[39m
     [90m 293 |[39m       )
     [90m 294 |[39m       
[33m.[39mfetch()[33m;[39m
     [90m 295 |[39m[0m

      at OfflineQueueManager.lt 
(src/lib/assessment/offline-queue-manager.ts:292:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as clearCompleted] 
(src/lib/assessment/offline-queue-manager.ts:282:23)
      at Object.clearCompleted (src/lib/assessment/offli
ne-queue-manager.test.ts:234:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ OfflineQueueManager ÔÇ║ cancelRequest ÔÇ║ should 
cancel a pending request

    TypeError: _watermelondb.Q.lt is not a function

    [0m [90m 473 |[39m     [36mconst[39m 
conditions [33m=[39m [
     [90m 474 |[39m       [33mQ[39m[33m.[39mwhere(
[32m'status'[39m[33m,[39m status)[33m,[39m
    [31m[1m>[22m[39m[90m 475 |[39m       [33mQ[3
9m[33m.[39mwhere([32m'updated_at'[39m[33m,[39m 
[33mQ[39m[33m.[39mlt(cutoff))[33m,[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 476 |[39m     ][33m;[39m
     [90m 477 |[39m
     [90m 478 |[39m     [36mreturn[39m collection[3
3m.[39mquery([33m...[39mconditions)[33m.[39mfetch()
[33m;[39m[0m

      at OfflineQueueManager.lt 
(src/lib/assessment/offline-queue-manager.ts:475:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
fetchRecordsBefore] 
(src/lib/assessment/offline-queue-manager.ts:468:35)
      at OfflineQueueManager.fetchRecordsBefore 
(src/lib/assessment/offline-queue-manager.ts:407:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
getRetentionRemovals] 
(src/lib/assessment/offline-queue-manager.ts:399:37)
      at OfflineQueueManager.getRetentionRemovals 
(src/lib/assessment/offline-queue-manager.ts:366:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as 
cleanupStoragePolicy] 
(src/lib/assessment/offline-queue-manager.ts:358:37)
      at OfflineQueueManager.cleanupStoragePolicy 
(src/lib/assessment/offline-queue-manager.ts:64:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at OfflineQueueManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at OfflineQueueManager.apply [as enqueue] 
(src/lib/assessment/offline-queue-manager.ts:56:16)
      at Object.enqueue (src/lib/assessment/offline-queu
e-manager.test.ts:243:44)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/moderation/__tests__/age-verification-secur
ity.test.ts
  ÔùÅ Age Verification Security Tests ÔÇ║ No Raw ID 
Persistence (Blueprint Compliance) ÔÇ║ should not store 
raw ID data after verification

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:35:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ No Raw ID 
Persistence (Blueprint Compliance) ÔÇ║ should only 
store age verification status and token hash

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:64:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ No Raw ID 
Persistence (Blueprint Compliance) ÔÇ║ should reject 
verification attempts with raw ID data

    expect(received).rejects.toThrow(expected)

    Expected pattern: /raw ID data not allowed/i
    Received message: "Cannot read properties of 
undefined (reading 'over18')"

        [0m [90m 67 |[39m
         [90m 68 |[39m     [90m// Validate age 
attribute[39m
        [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
         [90m    |[39m                       
[31m[1m^[22m[39m
         [90m 70 |[39m       [36mawait[39m [36mthis
[39m[33m.[39mauditService[33m.[39mlogTokenEvent({
         [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
         [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:95:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/moderation/__tests__/ag
e-verification-security.test.ts:96:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Token 
Security (HMAC-SHA256) ÔÇ║ should hash tokens with 
HMAC-SHA256

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:109:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Token 
Security (HMAC-SHA256) ÔÇ║ should use 
environment-specific salt for token hashing

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:135:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Token 
Security (HMAC-SHA256) ÔÇ║ should generate 
cryptographically secure random tokens

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:160:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Replay Attack 
Prevention ÔÇ║ should prevent token reuse after first 
validation

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:187:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Replay Attack 
Prevention ÔÇ║ should track token use count

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:214:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Replay Attack 
Prevention ÔÇ║ should log suspicious replay attempts

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:238:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Replay Attack 
Prevention ÔÇ║ should expire tokens after configured 
duration

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:271:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Suspicious 
Activity Detection (ePrivacy 5(3) Compliance) ÔÇ║ 
should detect suspicious activity only with consent

    TypeError: Cannot read properties of undefined 
(reading 'rapidAccountCreation')

    [0m [90m 120 |[39m     [90m// Filter signals 
based on consent (ePrivacy 5(3) compliance)[39m
     [90m 121 |[39m     [36mconst[39m 
allowedSignals [33m=[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
rapidAccountCreation[33m:[39m 
signals[33m.[39mrapidAccountCreation[33m,[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 123 |[39m       
multipleFailedVerifications[33m:[39m 
signals[33m.[39mmultipleFailedVerifications[33m,[39m
     [90m 124 |[39m       
unusualAccessPattern[33m:[39m 
signals[33m.[39munusualAccessPattern[33m,[39m
     [90m 125 |[39m       vpnDetected[33m:[39m 
signals[33m.[39mvpnDetected[33m,[39m[0m

      at AgeVerificationService.rapidAccountCreation 
(src/lib/moderation/age-verification-service.ts:122:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
detectSuspiciousActivity] 
(src/lib/moderation/age-verification-service.ts:115:33)
      at Object.detectSuspiciousActivity (src/lib/modera
tion/__tests__/age-verification-security.test.ts:298:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Suspicious 
Activity Detection (ePrivacy 5(3) Compliance) ÔÇ║ 
should not store device fingerprints without consent

    TypeError: Cannot read properties of undefined 
(reading 'rapidAccountCreation')

    [0m [90m 120 |[39m     [90m// Filter signals 
based on consent (ePrivacy 5(3) compliance)[39m
     [90m 121 |[39m     [36mconst[39m 
allowedSignals [33m=[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
rapidAccountCreation[33m:[39m 
signals[33m.[39mrapidAccountCreation[33m,[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 123 |[39m       
multipleFailedVerifications[33m:[39m 
signals[33m.[39mmultipleFailedVerifications[33m,[39m
     [90m 124 |[39m       
unusualAccessPattern[33m:[39m 
signals[33m.[39munusualAccessPattern[33m,[39m
     [90m 125 |[39m       vpnDetected[33m:[39m 
signals[33m.[39mvpnDetected[33m,[39m[0m

      at AgeVerificationService.rapidAccountCreation 
(src/lib/moderation/age-verification-service.ts:122:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
detectSuspiciousActivity] 
(src/lib/moderation/age-verification-service.ts:115:33)
      at Object.detectSuspiciousActivity (src/lib/modera
tion/__tests__/age-verification-security.test.ts:329:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Suspicious 
Activity Detection (ePrivacy 5(3) Compliance) ÔÇ║ 
should detect rapid verification attempts without 
fingerprinting

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:354:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Suspicious 
Activity Detection (ePrivacy 5(3) Compliance) ÔÇ║ 
should require explicit consent for GPS-based location 
checks

    TypeError: 
ageVerificationService.verifyLocationBasedAge is not a 
function

    [0m [90m 375 |[39m       [90m// Without 
consent: should not use GPS[39m
     [90m 376 |[39m       [36mawait[39m expect(
    [31m[1m>[22m[39m[90m 377 |[39m         ageVeri
ficationService[33m.[39mverifyLocationBasedAge(userId
[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 378 |[39m           useGPS[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 379 |[39m           hasConsent[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 380 |[39m         })[0m

      at Object.verifyLocationBasedAge (src/lib/moderati
on/__tests__/age-verification-security.test.ts:377:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ EUDI Wallet 
Integration (Blueprint Compliance) ÔÇ║ should accept 
EUDI wallet age attributes

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:408:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ EUDI Wallet 
Integration (Blueprint Compliance) ÔÇ║ should validate 
EUDI wallet signatures

    expect(received).rejects.toThrow(expected)

    Expected pattern: /invalid EUDI wallet signature/i
    Received message: "Cannot read properties of 
undefined (reading 'over18')"

        [0m [90m 67 |[39m
         [90m 68 |[39m     [90m// Validate age 
attribute[39m
        [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
         [90m    |[39m                       
[31m[1m^[22m[39m
         [90m 70 |[39m       [36mawait[39m [36mthis
[39m[33m.[39mauditService[33m.[39mlogTokenEvent({
         [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
         [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:427:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/moderation/__tests__/ag
e-verification-security.test.ts:428:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ EUDI Wallet 
Integration (Blueprint Compliance) ÔÇ║ should support 
multiple verification methods

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:442:52)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Appeal Window 
Configuration ÔÇ║ should allow users to appeal age 
verification decisions

    TypeError: 
ageVerificationService.recordVerificationFailure is not 
a function

    [0m [90m 463 |[39m
     [90m 464 |[39m       [90m// Simulate failed 
verification[39m
    [31m[1m>[22m[39m[90m 465 |[39m       
[36mawait[39m ageVerificationService[33m.[39mrecordV
erificationFailure(userId[33m,[39m {
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 466 |[39m         reason[33m:[39m 
[32m'Attribute verification failed'[39m[33m,[39m
     [90m 467 |[39m         canAppeal[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 468 |[39m       })[33m;[39m[0m

      at Object.recordVerificationFailure (src/lib/moder
ation/__tests__/age-verification-security.test.ts:465:36
)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ 
Privacy-by-Design Principles ÔÇ║ should implement data 
minimization for age verification

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:499:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ 
Privacy-by-Design Principles ÔÇ║ should auto-delete 
expired verification tokens

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:534:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ 
Privacy-by-Design Principles ÔÇ║ should retain audit 
logs per retention policy

    TypeError: Cannot read properties of undefined 
(reading 'over18')

    [0m [90m 67 |[39m
     [90m 68 |[39m     [90m// Validate age 
attribute[39m
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mif[39m ([33m![39mageAttribute[33m.[39mover18) 
{
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 70 |[39m       [36mawait[39m [36mthis[39
m[33m.[39mauditService[33m.[39mlogTokenEvent({
     [90m 71 |[39m         eventType[33m:[39m 
[32m'verification_failure'[39m[33m,[39m
     [90m 72 |[39m         userId[33m,[39m[0m

      at AgeVerificationService.over18 
(src/lib/moderation/age-verification-service.ts:69:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
verifyAgeAttribute] 
(src/lib/moderation/age-verification-service.ts:63:27)
      at Object.verifyAgeAttribute (src/lib/moderation/_
_tests__/age-verification-security.test.ts:565:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Age Verification Security Tests ÔÇ║ Safer 
Defaults for Minors ÔÇ║ should assume minor status 
until verified

    TypeError: Cannot read properties of null (reading 
'isVerified')

    [0m [90m 590 |[39m       [36mconst[39m 
ageStatus [33m=[39m [36mawait[39m ageVerificationSer
vice[33m.[39mgetUserAgeStatus(userId)[33m;[39m
     [90m 591 |[39m
    [31m[1m>[22m[39m[90m 592 |[39m       expect(ag
eStatus[33m.[39misVerified)[33m.[39mtoBe([36mfalse
[39m)[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 593 |[39m       expect(ageStatus[33m.[39ma
ssumedMinor)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 594 |[39m       expect(ageStatus[33m.[39mc
anAccessAgeRestrictedContent)[33m.[39mtoBe([36mfalse
[39m)[33m;[39m
     [90m 595 |[39m     })[33m;[39m[0m

      at Object.isVerified (src/lib/moderation/__tests__
/age-verification-security.test.ts:592:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Age Verification Security Tests ÔÇ║ Safer 
Defaults for Minors ÔÇ║ should apply stricter content 
filtering for unverified users

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: undefined

    [0m [90m 604 |[39m       )[33m;[39m
     [90m 605 |[39m
    [31m[1m>[22m[39m[90m 606 |[39m       expect(ac
cessResult[33m.[39mallowed)[33m.[39mtoBe([36mfalse
[39m)[33m;[39m
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 607 |[39m       expect(accessResult[33m.[3
9mreason)[33m.[39mtoContain([32m'age_verification_req
uired'[39m)[33m;[39m
     [90m 608 |[39m       expect(accessResult[33m.[3
9msaferDefaultsApplied)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m 609 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/moderation/__tests__/age-v
erification-security.test.ts:606:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/api/posts/use-add-post.test.ts
  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ handles 
prefill attachments without metadata

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:76:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ handles 
attachments with complete metadata

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:106:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ handles 
Supabase attachments with incomplete metadata by 
falling back to download

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:130:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ handles 
non-Supabase URLs with incomplete metadata

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:160:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ extracts 
storage path from signed URL

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:190:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ extracts 
storage path from public URL

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:220:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ensureRemoteAttachmentMetadata ÔÇ║ uses original 
path as fallback when variant paths are missing

    TypeError: Cannot read properties of undefined 
(reading 'endsWith')

    [0m [90m 67 |[39m   [90m// Security: strict 
check to ensure URL belongs to our Supabase project[39m
     [90m 68 |[39m   [90m// We append a slash to 
prevent prefix attacks (e.g. project-id-evil.com)[39m
    [31m[1m>[22m[39m[90m 69 |[39m   
[36mconst[39m baseUrl [33m=[39m 
supabaseUrl[33m.[39mendsWith([32m'/'[39m) 
[33m?[39m supabaseUrl [33m:[39m 
[32m`${supabaseUrl}/`[39m[33m;[39m
     [90m    |[39m                               
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m   [36mreturn[39m (
     [90m 72 |[39m     
uri[33m.[39mstartsWith(baseUrl) [33m&&[39m[0m

      at endsWith (src/api/posts/use-add-post.ts:69:31)
      at isSupabaseStorageUri 
(src/api/posts/use-add-post.ts:274:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/api/posts/use-add-post.ts:266:44)
      at Object.<anonymous> 
(src/api/posts/use-add-post.test.ts:275:56)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/nutrient-engine/services/alert-service.test.ts
  ÔùÅ evaluateAndTriggerAlert ÔÇ║ triggers alert for pH 
out of range with persistence

    TypeError: Cannot read properties of undefined 
(reading 'getTime')

    [0m [90m 353 |[39m     note[33m:[39m 
model[33m.[39mnote[33m,[39m
     [90m 354 |[39m     qualityFlags[33m:[39m 
model[33m.[39mqualityFlags[33m,[39m
    [31m[1m>[22m[39m[90m 355 |[39m     
createdAt[33m:[39m 
model[33m.[39mcreatedAt[33m.[39mgetTime()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 356 |[39m     updatedAt[33m:[39m 
model[33m.[39mupdatedAt[33m.[39mgetTime()[33m,[39m
     [90m 357 |[39m   }[33m;[39m
     [90m 358 |[39m }[0m

      at getTime (src/lib/nutrient-engine/services/alert
-service.ts:355:32)
      at modelToReading (src/lib/nutrient-engine/service
s/alert-service.ts:60:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ evaluateAndTriggerAlert ÔÇ║ triggers alert for pH 
out of range with persistence

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ evaluateAndTriggerAlert ÔÇ║ does not trigger 
alert for reading within range

    TypeError: Cannot read properties of undefined 
(reading 'getTime')

    [0m [90m 353 |[39m     note[33m:[39m 
model[33m.[39mnote[33m,[39m
     [90m 354 |[39m     qualityFlags[33m:[39m 
model[33m.[39mqualityFlags[33m,[39m
    [31m[1m>[22m[39m[90m 355 |[39m     
createdAt[33m:[39m 
model[33m.[39mcreatedAt[33m.[39mgetTime()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 356 |[39m     updatedAt[33m:[39m 
model[33m.[39mupdatedAt[33m.[39mgetTime()[33m,[39m
     [90m 357 |[39m   }[33m;[39m
     [90m 358 |[39m }[0m

      at getTime (src/lib/nutrient-engine/services/alert
-service.ts:355:32)
      at modelToReading (src/lib/nutrient-engine/service
s/alert-service.ts:60:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ evaluateAndTriggerAlert ÔÇ║ does not trigger 
alert for reading within range

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ evaluateAndTriggerAlert ÔÇ║ does not trigger 
alert without persistence

    TypeError: Cannot read properties of undefined 
(reading 'getTime')

    [0m [90m 353 |[39m     note[33m:[39m 
model[33m.[39mnote[33m,[39m
     [90m 354 |[39m     qualityFlags[33m:[39m 
model[33m.[39mqualityFlags[33m,[39m
    [31m[1m>[22m[39m[90m 355 |[39m     
createdAt[33m:[39m 
model[33m.[39mcreatedAt[33m.[39mgetTime()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 356 |[39m     updatedAt[33m:[39m 
model[33m.[39mupdatedAt[33m.[39mgetTime()[33m,[39m
     [90m 357 |[39m   }[33m;[39m
     [90m 358 |[39m }[0m

      at getTime (src/lib/nutrient-engine/services/alert
-service.ts:355:32)
      at modelToReading (src/lib/nutrient-engine/service
s/alert-service.ts:60:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ evaluateAndTriggerAlert ÔÇ║ does not trigger 
alert without persistence

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ createAlert ÔÇ║ creates alert with all required 
fields

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "mock-id"
    Received: undefined

    [0m [90m 203 |[39m     [36mconst[39m alert 
[33m=[39m [36mawait[39m 
createAlert(alertData[33m,[39m 
[32m'user123'[39m)[33m;[39m
     [90m 204 |[39m
    [31m[1m>[22m[39m[90m 205 |[39m     expect(aler
t[33m.[39mreadingId)[33m.[39mtoBe(reading[33m.[39m
id)[33m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 206 |[39m     expect(alert[33m.[39mtype)[
33m.[39mtoBe([32m'ph_high'[39m)[33m;[39m
     [90m 207 |[39m     expect(alert[33m.[39muserId)
[33m.[39mtoBe([32m'user123'[39m)[33m;[39m
     [90m 208 |[39m[0m

      at Object.toBe (src/lib/nutrient-engine/services/a
lert-service.test.ts:205:29)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ createAlert ÔÇ║ creates alert with all required 
fields

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ acknowledgeAlert ÔÇ║ sets acknowledgedAt timestamp

    TypeError: alert.acknowledge is not a function

    [0m [90m 148 |[39m     
[33m.[39mfind(alertId)[33m;[39m
     [90m 149 |[39m
    [31m[1m>[22m[39m[90m 150 |[39m   
[36mawait[39m alert[33m.[39macknowledge()[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 151 |[39m   [36mreturn[39m 
alert[33m;[39m
     [90m 152 |[39m }
     [90m 153 |[39m[0m

      at acknowledge (src/lib/nutrient-engine/services/a
lert-service.ts:150:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ acknowledgeAlert ÔÇ║ sets acknowledgedAt timestamp

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ resolveAlert ÔÇ║ sets resolvedAt timestamp

    TypeError: alert.resolve is not a function

    [0m [90m 164 |[39m     
[33m.[39mfind(alertId)[33m;[39m
     [90m 165 |[39m
    [31m[1m>[22m[39m[90m 166 |[39m   
[36mawait[39m alert[33m.[39mresolve()[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 167 |[39m   [36mreturn[39m 
alert[33m;[39m
     [90m 168 |[39m }
     [90m 169 |[39m[0m

      at resolve (src/lib/nutrient-engine/services/alert
-service.ts:166:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ resolveAlert ÔÇ║ sets resolvedAt timestamp

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ markAlertDeliveredLocally ÔÇ║ sets 
deliveredAtLocal timestamp

    TypeError: alert.markDeliveredLocally is not a 
function

    [0m [90m 179 |[39m     
[33m.[39mfind(alertId)[33m;[39m
     [90m 180 |[39m
    [31m[1m>[22m[39m[90m 181 |[39m   
[36mawait[39m 
alert[33m.[39mmarkDeliveredLocally()[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 182 |[39m   [36mreturn[39m 
alert[33m;[39m
     [90m 183 |[39m }
     [90m 184 |[39m[0m

      at markDeliveredLocally (src/lib/nutrient-engine/s
ervices/alert-service.ts:181:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ markAlertDeliveredLocally ÔÇ║ sets 
deliveredAtLocal timestamp

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ getActiveAlerts ÔÇ║ returns unresolved alerts for 
reservoir

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 1
    Received: 0

    [0m [90m 331 |[39m     [36mconst[39m active 
[33m=[39m [36mawait[39m 
getActiveAlerts(reservoir[33m.[39mid)[33m;[39m
     [90m 332 |[39m
    [31m[1m>[22m[39m[90m 333 |[39m     expect(acti
ve[33m.[39mlength)[33m.[39mtoBe([35m1[39m)[33m;[
39m
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 334 |[39m     expect(active[[35m0[39m][33
m.[39mid)[33m.[39mtoBe(activeAlert[33m.[39mid)[33m
;[39m
     [90m 335 |[39m     expect(active[[35m0[39m][33
m.[39mtype)[33m.[39mtoBe([32m'ph_high'[39m)[33m;[
39m
     [90m 336 |[39m[0m

      at Object.toBe (src/lib/nutrient-engine/services/a
lert-service.test.ts:333:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ getActiveAlerts ÔÇ║ returns unresolved alerts for 
reservoir

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ getActiveAlerts ÔÇ║ returns empty array for 
reservoir with no alerts

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ getAlertHistory ÔÇ║ returns alerts within time 
period

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

    [0m [90m 366 |[39m     [36mconst[39m history 
[33m=[39m [36mawait[39m 
getAlertHistory(reservoir[33m.[39mid[33m,[39m 
[35m7[39m)[33m;[39m
     [90m 367 |[39m
    [31m[1m>[22m[39m[90m 368 |[39m     expect(hist
ory[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[
39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 369 |[39m     
expect(history[33m.[39mfind((a) [33m=>[39m 
a[33m.[39mid [33m===[39m recentAlert[33m.[39mid))
[33m.[39mtoBeTruthy()[33m;[39m
     [90m 370 |[39m
     [90m 371 |[39m     [90m// Cleanup[39m[0m

      at Object.toBeGreaterThan (src/lib/nutrient-engine
/services/alert-service.test.ts:368:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ getAlertHistory ÔÇ║ returns alerts within time 
period

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ getUnacknowledgedAlerts ÔÇ║ returns all 
unacknowledged alerts

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

    [0m [90m 402 |[39m     [36mconst[39m results 
[33m=[39m [36mawait[39m 
getUnacknowledgedAlerts()[33m;[39m
     [90m 403 |[39m
    [31m[1m>[22m[39m[90m 404 |[39m     expect(resu
lts[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[
39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 405 |[39m     
expect(results[33m.[39mfind((a) [33m=>[39m 
a[33m.[39mid [33m===[39m unacknowledged[33m.[39mid
))[33m.[39mtoBeTruthy()[33m;[39m
     [90m 406 |[39m     
expect(results[33m.[39mfind((a) [33m=>[39m 
a[33m.[39mid [33m===[39m acknowledged[33m.[39mid))
[33m.[39mtoBeUndefined()[33m;[39m
     [90m 407 |[39m[0m

      at Object.toBeGreaterThan (src/lib/nutrient-engine
/services/alert-service.test.ts:404:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ getUnacknowledgedAlerts ÔÇ║ returns all 
unacknowledged alerts

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ getOfflineAlerts ÔÇ║ returns alerts delivered 
offline

    expect(received).toBeTruthy()

    Received: undefined

    [0m [90m 440 |[39m     [36mconst[39m offline 
[33m=[39m [36mawait[39m 
getOfflineAlerts()[33m;[39m
     [90m 441 |[39m
    [31m[1m>[22m[39m[90m 442 |[39m     
expect(offline[33m.[39mfind((a) [33m=>[39m 
a[33m.[39mid [33m===[39m offlineAlert[33m.[39mid))
[33m.[39mtoBeTruthy()[33m;[39m
     [90m     |[39m                                   
                        [31m[1m^[22m[39m
     [90m 443 |[39m     
expect(offline[33m.[39mfind((a) [33m=>[39m 
a[33m.[39mid [33m===[39m onlineAlert[33m.[39mid))
[33m.[39mtoBeUndefined()[33m;[39m
     [90m 444 |[39m
     [90m 445 |[39m     [90m// Cleanup[39m[0m

      at Object.toBeTruthy (src/lib/nutrient-engine/serv
ices/alert-service.test.ts:442:59)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ getOfflineAlerts ÔÇ║ returns alerts delivered 
offline

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ observeActiveAlerts ÔÇ║ returns observable that 
filters by reservoir ID

    TypeError: reservoir.destroyPermanently is not a 
function

    [0m [90m 67 |[39m   [36mconst[39m db 
[33m=[39m database[33m;[39m
     [90m 68 |[39m   [36mawait[39m 
db[33m.[39mwrite([36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 69 |[39m     
[36mawait[39m 
reservoir[33m.[39mdestroyPermanently()[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 70 |[39m     [36mawait[39m 
reading[33m.[39mdestroyPermanently()[33m;[39m
     [90m 71 |[39m
     [90m 72 |[39m     [90m// Clean up any 
alerts[39m[0m

      at destroyPermanently (src/lib/nutrient-engine/ser
vices/alert-service.test.ts:69:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/nutrient-engine/services/
alert-service.test.ts:68:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/uploads/__tests__/harvest-photo-cleanup.test.ts
  ÔùÅ cleanupDeletedHarvestPhotos ÔÇ║ should cleanup 
photos from soft-deleted harvests

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 3
    Received: 0

    [0m [90m 94 |[39m     [90m// Verify results[39m
     [90m 95 |[39m     expect(result[33m.[39mharvest
sProcessed)[33m.[39mtoBe([35m2[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 96 |[39m     expect(resul
t[33m.[39mphotosDeleted)[33m.[39mtoBe([35m3[39m)[
33m;[39m [90m// 2 + 1 photos[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 97 |[39m     expect(result[33m.[39merrors)
[33m.[39mtoBe([35m0[39m)[33m;[39m
     [90m 98 |[39m
     [90m 99 |[39m     [90m// Verify storage 
calls[39m[0m

      at Object.toBe (src/lib/uploads/__tests__/harvest-
photo-cleanup.test.ts:96:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ cleanupHarvestPhotos ÔÇ║ should cleanup photos 
for specific harvest

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 2
    Received: 0

    [0m [90m 249 |[39m     [36mconst[39m 
deletedCount [33m=[39m [36mawait[39m 
cleanupHarvestPhotos([32m'harvest-1'[39m)[33m;[39m
     [90m 250 |[39m
    [31m[1m>[22m[39m[90m 251 |[39m     expect(dele
tedCount)[33m.[39mtoBe([35m2[39m)[33m;[39m
     [90m     |[39m                          
[31m[1m^[22m[39m
     [90m 252 |[39m     expect(supabase[33m.[39mstor
age[33m.[39m[36mfrom[39m)[33m.[39mtoHaveBeenCalled
With([32m'harvest-photos'[39m)[33m;[39m
     [90m 253 |[39m     
expect(mockRemove)[33m.[39mtoHaveBeenCalledWith([
     [90m 254 |[39m       [32m'user123/harvest-1/phot
o1_original.jpg'[39m[33m,[39m[0m

      at Object.toBe (src/lib/uploads/__tests__/harvest-
photo-cleanup.test.ts:251:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ cleanupHarvestPhotos ÔÇ║ should strip bucket 
prefix from remote paths

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: ["user123/harvest-1/photo1.jpg"]

    Number of calls: 0

    [0m [90m 308 |[39m
     [90m 309 |[39m     [90m// Should strip 
'harvest-photos/' prefix[39m
    [31m[1m>[22m[39m[90m 310 |[39m     expect(mock
Remove)[33m.[39mtoHaveBeenCalledWith([[32m'user123/ha
rvest-1/photo1.jpg'[39m])[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 311 |[39m   })[33m;[39m
     [90m 312 |[39m })[33m;[39m
     [90m 313 |[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/uploads/__
tests__/harvest-photo-cleanup.test.ts:310:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/moderation/__tests__/eprivacy-compliance.test.ts
  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should use IP 
geolocation by default without consent

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 32 |[39m       [36mconst[39m userId 
[33m=[39m [32m'user-ip-default'[39m[33m;[39m
     [90m 33 |[39m
    [31m[1m>[22m[39m[90m 34 |[39m       
[36mconst[39m location [33m=[39m [36mawait[39m geo
LocationService[33m.[39mdetectUserLocation(userId[33m
,[39m {
     [90m    |[39m                                    
             [31m[1m^[22m[39m
     [90m 35 |[39m         method[33m:[39m 
[32m'ip'[39m[33m,[39m
     [90m 36 |[39m         requireConsent[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 37 |[39m       })[33m;[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:34:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should require 
explicit consent for GPS location

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 46 |[39m
     [90m 47 |[39m       [36mawait[39m expect(
    [31m[1m>[22m[39m[90m 48 |[39m         geoLocat
ionService[33m.[39mdetectUserLocation(userId[33m,[39
m {
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 49 |[39m           method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 50 |[39m           
requireConsent[33m:[39m [36mtrue[39m[33m,[39m
     [90m 51 |[39m           hasConsent[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:48:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should allow GPS 
location with explicit consent

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 69 |[39m         
[33m.[39mmockResolvedValue(mockGPSLocation 
[36mas[39m any)[33m;[39m
     [90m 70 |[39m
    [31m[1m>[22m[39m[90m 71 |[39m       
[36mconst[39m location [33m=[39m [36mawait[39m geo
LocationService[33m.[39mdetectUserLocation(userId[33m
,[39m {
     [90m    |[39m                                    
             [31m[1m^[22m[39m
     [90m 72 |[39m         method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 73 |[39m         requireConsent[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 74 |[39m         hasConsent[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:71:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should record consent 
for GPS location access

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 92 |[39m       } [36mas[39m 
any)[33m;[39m
     [90m 93 |[39m
    [31m[1m>[22m[39m[90m 94 |[39m       
[36mawait[39m geoLocationService[33m.[39mdetectUserL
ocation(userId[33m,[39m {
     [90m    |[39m                                
[31m[1m^[22m[39m
     [90m 95 |[39m         method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 96 |[39m         requireConsent[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 97 |[39m         hasConsent[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:94:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should provide clear 
user benefit explanation for GPS request

    TypeError: geoLocationService.requestGPSConsent is 
not a function

    [0m [90m 118 |[39m       [36mconst[39m userId 
[33m=[39m [32m'user-gps-benefit'[39m[33m;[39m
     [90m 119 |[39m
    [31m[1m>[22m[39m[90m 120 |[39m       
[36mconst[39m consentRequest [33m=[39m 
[36mawait[39m 
geoLocationService[33m.[39mrequestGPSConsent(
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 121 |[39m         userId[33m,[39m
     [90m 122 |[39m         {
     [90m 123 |[39m           purpose[33m:[39m 
[32m'Accurate geo-restriction for legal 
compliance'[39m[33m,[39m[0m

      at Object.requestGPSConsent (src/lib/moderation/__
tests__/eprivacy-compliance.test.ts:120:55)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should fall back to IP 
geolocation when GPS consent denied

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 135 |[39m       [36mconst[39m userId 
[33m=[39m 
[32m'user-gps-denied-fallback'[39m[33m;[39m
     [90m 136 |[39m
    [31m[1m>[22m[39m[90m 137 |[39m       
[36mconst[39m location [33m=[39m [36mawait[39m geo
LocationService[33m.[39mdetectUserLocation(userId[33m
,[39m {
     [90m     |[39m                                   
              [31m[1m^[22m[39m
     [90m 138 |[39m         method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 139 |[39m         requireConsent[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 140 |[39m         hasConsent[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:137:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should allow users to 
revoke GPS consent

    TypeError: geoLocationService.grantGPSConsent is 
not a function

    [0m [90m 151 |[39m
     [90m 152 |[39m       [90m// Grant consent[39m
    [31m[1m>[22m[39m[90m 153 |[39m       
[36mawait[39m geoLocationService[33m.[39mgrantGPSCon
sent(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 154 |[39m         purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m
     [90m 155 |[39m       })[33m;[39m
     [90m 156 |[39m[0m

      at Object.grantGPSConsent (src/lib/moderation/__te
sts__/eprivacy-compliance.test.ts:153:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ GPS Location 
Consent (ePrivacy Art. 5(3)) ÔÇ║ should not cache GPS 
location without consent

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 176 |[39m       [90m// Attempt GPS 
without consent[39m
     [90m 177 |[39m       [36mawait[39m expect(
    [31m[1m>[22m[39m[90m 178 |[39m         geoLoca
tionService[33m.[39mdetectUserLocation(userId[33m,[3
9m {
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 179 |[39m           method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 180 |[39m           
requireConsent[33m:[39m [36mtrue[39m[33m,[39m
     [90m 181 |[39m           hasConsent[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:178:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should not perform device fingerprinting without consent

    TypeError: Cannot read properties of undefined 
(reading 'rapidAccountCreation')

    [0m [90m 120 |[39m     [90m// Filter signals 
based on consent (ePrivacy 5(3) compliance)[39m
     [90m 121 |[39m     [36mconst[39m 
allowedSignals [33m=[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
rapidAccountCreation[33m:[39m 
signals[33m.[39mrapidAccountCreation[33m,[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 123 |[39m       
multipleFailedVerifications[33m:[39m 
signals[33m.[39mmultipleFailedVerifications[33m,[39m
     [90m 124 |[39m       
unusualAccessPattern[33m:[39m 
signals[33m.[39munusualAccessPattern[33m,[39m
     [90m 125 |[39m       vpnDetected[33m:[39m 
signals[33m.[39mvpnDetected[33m,[39m[0m

      at AgeVerificationService.rapidAccountCreation 
(src/lib/moderation/age-verification-service.ts:122:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
detectSuspiciousActivity] 
(src/lib/moderation/age-verification-service.ts:115:33)
      at Object.detectSuspiciousActivity (src/lib/modera
tion/__tests__/eprivacy-compliance.test.ts:201:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should allow device fingerprinting with explicit consent

    TypeError: Cannot read properties of undefined 
(reading 'rapidAccountCreation')

    [0m [90m 120 |[39m     [90m// Filter signals 
based on consent (ePrivacy 5(3) compliance)[39m
     [90m 121 |[39m     [36mconst[39m 
allowedSignals [33m=[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
rapidAccountCreation[33m:[39m 
signals[33m.[39mrapidAccountCreation[33m,[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 123 |[39m       
multipleFailedVerifications[33m:[39m 
signals[33m.[39mmultipleFailedVerifications[33m,[39m
     [90m 124 |[39m       
unusualAccessPattern[33m:[39m 
signals[33m.[39munusualAccessPattern[33m,[39m
     [90m 125 |[39m       vpnDetected[33m:[39m 
signals[33m.[39mvpnDetected[33m,[39m[0m

      at AgeVerificationService.rapidAccountCreation 
(src/lib/moderation/age-verification-service.ts:122:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
detectSuspiciousActivity] 
(src/lib/moderation/age-verification-service.ts:115:33)
      at Object.detectSuspiciousActivity (src/lib/modera
tion/__tests__/eprivacy-compliance.test.ts:217:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should not store device fingerprints without consent

    TypeError: Cannot read properties of undefined 
(reading 'rapidAccountCreation')

    [0m [90m 120 |[39m     [90m// Filter signals 
based on consent (ePrivacy 5(3) compliance)[39m
     [90m 121 |[39m     [36mconst[39m 
allowedSignals [33m=[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
rapidAccountCreation[33m:[39m 
signals[33m.[39mrapidAccountCreation[33m,[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 123 |[39m       
multipleFailedVerifications[33m:[39m 
signals[33m.[39mmultipleFailedVerifications[33m,[39m
     [90m 124 |[39m       
unusualAccessPattern[33m:[39m 
signals[33m.[39munusualAccessPattern[33m,[39m
     [90m 125 |[39m       vpnDetected[33m:[39m 
signals[33m.[39mvpnDetected[33m,[39m[0m

      at AgeVerificationService.rapidAccountCreation 
(src/lib/moderation/age-verification-service.ts:122:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
detectSuspiciousActivity] 
(src/lib/moderation/age-verification-service.ts:115:33)
      at Object.detectSuspiciousActivity (src/lib/modera
tion/__tests__/eprivacy-compliance.test.ts:234:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should request consent before collecting device 
identifiers

    TypeError: 
ageVerificationService.requestDeviceFingerprintConsent 
is not a function

    [0m [90m 257 |[39m
     [90m 258 |[39m       [36mconst[39m 
consentRequest [33m=[39m
    [31m[1m>[22m[39m[90m 259 |[39m         
[36mawait[39m ageVerificationService[33m.[39mrequest
DeviceFingerprintConsent(userId[33m,[39m {
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 260 |[39m           purpose[33m:[39m 
[32m'Fraud prevention and age verification 
enforcement'[39m[33m,[39m
     [90m 261 |[39m           
dataCollected[33m:[39m [
     [90m 262 |[39m             [32m'Device 
model'[39m[33m,[39m[0m

      at Object.requestDeviceFingerprintConsent (src/lib
/moderation/__tests__/eprivacy-compliance.test.ts:259:38
)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should use alternative fraud detection without 
fingerprinting

    TypeError: Cannot read properties of undefined 
(reading 'rapidAccountCreation')

    [0m [90m 120 |[39m     [90m// Filter signals 
based on consent (ePrivacy 5(3) compliance)[39m
     [90m 121 |[39m     [36mconst[39m 
allowedSignals [33m=[39m {
    [31m[1m>[22m[39m[90m 122 |[39m       
rapidAccountCreation[33m:[39m 
signals[33m.[39mrapidAccountCreation[33m,[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 123 |[39m       
multipleFailedVerifications[33m:[39m 
signals[33m.[39mmultipleFailedVerifications[33m,[39m
     [90m 124 |[39m       
unusualAccessPattern[33m:[39m 
signals[33m.[39munusualAccessPattern[33m,[39m
     [90m 125 |[39m       vpnDetected[33m:[39m 
signals[33m.[39mvpnDetected[33m,[39m[0m

      at AgeVerificationService.rapidAccountCreation 
(src/lib/moderation/age-verification-service.ts:122:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at AgeVerificationService.<anonymous> (node_module
s/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at AgeVerificationService.apply [as 
detectSuspiciousActivity] 
(src/lib/moderation/age-verification-service.ts:115:33)
      at Object.detectSuspiciousActivity (src/lib/modera
tion/__tests__/eprivacy-compliance.test.ts:278:51)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should not use VPN/proxy detection without consent

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 293 |[39m       [36mconst[39m userId 
[33m=[39m [32m'user-no-vpn-detection'[39m[33m;[39m
     [90m 294 |[39m
    [31m[1m>[22m[39m[90m 295 |[39m       
[36mconst[39m location [33m=[39m [36mawait[39m geo
LocationService[33m.[39mdetectUserLocation(userId[33m
,[39m {
     [90m     |[39m                                   
              [31m[1m^[22m[39m
     [90m 296 |[39m         method[33m:[39m 
[32m'ip'[39m[33m,[39m
     [90m 297 |[39m         detectVPN[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 298 |[39m         
hasVPNDetectionConsent[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:295:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Device 
Fingerprinting Restrictions (ePrivacy Art. 5(3)) ÔÇ║ 
should allow VPN/proxy detection with consent

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 306 |[39m       [36mconst[39m userId 
[33m=[39m 
[32m'user-vpn-detection-consent'[39m[33m;[39m
     [90m 307 |[39m
    [31m[1m>[22m[39m[90m 308 |[39m       
[36mconst[39m location [33m=[39m [36mawait[39m geo
LocationService[33m.[39mdetectUserLocation(userId[33m
,[39m {
     [90m     |[39m                                   
              [31m[1m^[22m[39m
     [90m 309 |[39m         method[33m:[39m 
[32m'ip'[39m[33m,[39m
     [90m 310 |[39m         detectVPN[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 311 |[39m         
hasVPNDetectionConsent[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:308:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent Management 
ÔÇ║ should provide granular consent options

    TypeError: geoLocationService.getConsentOptions is 
not a function

    [0m [90m 321 |[39m       [36mconst[39m userId 
[33m=[39m [32m'user-granular-consent'[39m[33m;[39m
     [90m 322 |[39m
    [31m[1m>[22m[39m[90m 323 |[39m       
[36mconst[39m consentOptions [33m=[39m 
[36mawait[39m geoLocationService[33m.[39mgetConsentO
ptions(userId)[33m;[39m
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 324 |[39m
     [90m 325 |[39m       
expect(consentOptions)[33m.[39mtoContainEqual(
     [90m 326 |[39m         
expect[33m.[39mobjectContaining({[0m

      at Object.getConsentOptions (src/lib/moderation/__
tests__/eprivacy-compliance.test.ts:323:55)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent Management 
ÔÇ║ should allow users to grant consent selectively

    TypeError: geoLocationService.updateConsent is not 
a function

    [0m [90m 352 |[39m
     [90m 353 |[39m       [90m// Grant GPS consent 
but deny fingerprinting[39m
    [31m[1m>[22m[39m[90m 354 |[39m       
[36mawait[39m geoLocationService[33m.[39mupdateConse
nt(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 355 |[39m         gps_location[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 356 |[39m         
device_fingerprinting[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 357 |[39m         vpn_detection[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.updateConsent (src/lib/moderation/__test
s__/eprivacy-compliance.test.ts:354:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent Management 
ÔÇ║ should record consent timestamp and version

    TypeError: geoLocationService.grantGPSConsent is 
not a function

    [0m [90m 368 |[39m       [36mconst[39m userId 
[33m=[39m 
[32m'user-consent-timestamp'[39m[33m;[39m
     [90m 369 |[39m
    [31m[1m>[22m[39m[90m 370 |[39m       
[36mawait[39m geoLocationService[33m.[39mgrantGPSCon
sent(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 371 |[39m         purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m
     [90m 372 |[39m       })[33m;[39m
     [90m 373 |[39m[0m

      at Object.grantGPSConsent (src/lib/moderation/__te
sts__/eprivacy-compliance.test.ts:370:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent Management 
ÔÇ║ should allow users to withdraw consent at any time

    TypeError: geoLocationService.grantGPSConsent is 
not a function

    [0m [90m 390 |[39m
     [90m 391 |[39m       [90m// Grant consent[39m
    [31m[1m>[22m[39m[90m 392 |[39m       
[36mawait[39m geoLocationService[33m.[39mgrantGPSCon
sent(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 393 |[39m         purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m
     [90m 394 |[39m       })[33m;[39m
     [90m 395 |[39m[0m

      at Object.grantGPSConsent (src/lib/moderation/__te
sts__/eprivacy-compliance.test.ts:392:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent Management 
ÔÇ║ should stop data collection immediately after 
consent withdrawal

    TypeError: geoLocationService.grantGPSConsent is 
not a function

    [0m [90m 414 |[39m
     [90m 415 |[39m       [90m// Grant consent[39m
    [31m[1m>[22m[39m[90m 416 |[39m       
[36mawait[39m geoLocationService[33m.[39mgrantGPSCon
sent(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 417 |[39m         purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m
     [90m 418 |[39m       })[33m;[39m
     [90m 419 |[39m[0m

      at Object.grantGPSConsent (src/lib/moderation/__te
sts__/eprivacy-compliance.test.ts:416:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent UI 
Requirements ÔÇ║ should provide clear consent request 
text

    TypeError: geoLocationService.requestGPSConsent is 
not a function

    [0m [90m 447 |[39m       [36mconst[39m userId 
[33m=[39m 
[32m'user-clear-consent-text'[39m[33m;[39m
     [90m 448 |[39m
    [31m[1m>[22m[39m[90m 449 |[39m       
[36mconst[39m consentRequest [33m=[39m 
[36mawait[39m 
geoLocationService[33m.[39mrequestGPSConsent(
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 450 |[39m         userId[33m,[39m
     [90m 451 |[39m         {
     [90m 452 |[39m           purpose[33m:[39m 
[32m'Geo-restriction enforcement'[39m[33m,[39m[0m

      at Object.requestGPSConsent (src/lib/moderation/__
tests__/eprivacy-compliance.test.ts:449:55)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent UI 
Requirements ÔÇ║ should provide accept and decline 
options

    TypeError: geoLocationService.requestGPSConsent is 
not a function

    [0m [90m 463 |[39m       [36mconst[39m userId 
[33m=[39m [32m'user-accept-decline'[39m[33m;[39m
     [90m 464 |[39m
    [31m[1m>[22m[39m[90m 465 |[39m       
[36mconst[39m consentRequest [33m=[39m 
[36mawait[39m 
geoLocationService[33m.[39mrequestGPSConsent(
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 466 |[39m         userId[33m,[39m
     [90m 467 |[39m         {
     [90m 468 |[39m           purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m[0m

      at Object.requestGPSConsent (src/lib/moderation/__
tests__/eprivacy-compliance.test.ts:465:55)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent UI 
Requirements ÔÇ║ should link to privacy policy in 
consent request

    TypeError: geoLocationService.requestGPSConsent is 
not a function

    [0m [90m 478 |[39m       [36mconst[39m userId 
[33m=[39m 
[32m'user-privacy-policy-link'[39m[33m;[39m
     [90m 479 |[39m
    [31m[1m>[22m[39m[90m 480 |[39m       
[36mconst[39m consentRequest [33m=[39m 
[36mawait[39m 
geoLocationService[33m.[39mrequestGPSConsent(
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 481 |[39m         userId[33m,[39m
     [90m 482 |[39m         {
     [90m 483 |[39m           purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m[0m

      at Object.requestGPSConsent (src/lib/moderation/__
tests__/eprivacy-compliance.test.ts:480:55)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Consent UI 
Requirements ÔÇ║ should not use pre-ticked consent boxes

    TypeError: geoLocationService.requestGPSConsent is 
not a function

    [0m [90m 492 |[39m       [36mconst[39m userId 
[33m=[39m [32m'user-no-preticked'[39m[33m;[39m
     [90m 493 |[39m
    [31m[1m>[22m[39m[90m 494 |[39m       
[36mconst[39m consentRequest [33m=[39m 
[36mawait[39m 
geoLocationService[33m.[39mrequestGPSConsent(
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 495 |[39m         userId[33m,[39m
     [90m 496 |[39m         {
     [90m 497 |[39m           purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m[0m

      at Object.requestGPSConsent (src/lib/moderation/__
tests__/eprivacy-compliance.test.ts:494:55)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Data Minimization 
with Consent ÔÇ║ should collect minimal data even with 
consent

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 520 |[39m       } [36mas[39m 
any)[33m;[39m
     [90m 521 |[39m
    [31m[1m>[22m[39m[90m 522 |[39m       
[36mconst[39m location [33m=[39m [36mawait[39m geo
LocationService[33m.[39mdetectUserLocation(userId[33m
,[39m {
     [90m     |[39m                                   
              [31m[1m^[22m[39m
     [90m 523 |[39m         method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 524 |[39m         requireConsent[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 525 |[39m         hasConsent[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:522:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Data Minimization 
with Consent ÔÇ║ should not retain location data longer 
than necessary

    TypeError: geoLocationService.detectUserLocation is 
not a function

    [0m [90m 546 |[39m       } [36mas[39m 
any)[33m;[39m
     [90m 547 |[39m
    [31m[1m>[22m[39m[90m 548 |[39m       
[36mawait[39m geoLocationService[33m.[39mdetectUserL
ocation(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 549 |[39m         method[33m:[39m 
[32m'gps'[39m[33m,[39m
     [90m 550 |[39m         requireConsent[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 551 |[39m         hasConsent[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.detectUserLocation (src/lib/moderation/_
_tests__/eprivacy-compliance.test.ts:548:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Audit Logging for 
Consent ÔÇ║ should log all consent grants and 
withdrawals

    TypeError: geoLocationService.grantGPSConsent is 
not a function

    [0m [90m 577 |[39m
     [90m 578 |[39m       [90m// Grant consent[39m
    [31m[1m>[22m[39m[90m 579 |[39m       
[36mawait[39m geoLocationService[33m.[39mgrantGPSCon
sent(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 580 |[39m         purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m
     [90m 581 |[39m       })[33m;[39m
     [90m 582 |[39m[0m

      at Object.grantGPSConsent (src/lib/moderation/__te
sts__/eprivacy-compliance.test.ts:579:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ ePrivacy Compliance Tests ÔÇ║ Audit Logging for 
Consent ÔÇ║ should log consent version and policy 
version

    TypeError: geoLocationService.grantGPSConsent is 
not a function

    [0m [90m 598 |[39m       [36mconst[39m userId 
[33m=[39m 
[32m'user-consent-version-audit'[39m[33m;[39m
     [90m 599 |[39m
    [31m[1m>[22m[39m[90m 600 |[39m       
[36mawait[39m geoLocationService[33m.[39mgrantGPSCon
sent(userId[33m,[39m {
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 601 |[39m         purpose[33m:[39m 
[32m'Geo-restriction'[39m[33m,[39m
     [90m 602 |[39m       })[33m;[39m
     [90m 603 |[39m[0m

      at Object.grantGPSConsent (src/lib/moderation/__te
sts__/eprivacy-compliance.test.ts:600:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/quality/remote-config.test.ts
  ÔùÅ refreshQualityThresholds - cache behavior ÔÇ║ 
should handle 304 Not Modified with cached ETag

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "cache"
    Received: "stale-cache"

    [0m [90m 232 |[39m
     [90m 233 |[39m     [36mconst[39m state 
[33m=[39m getQualityConfigState()[33m;[39m
    [31m[1m>[22m[39m[90m 234 |[39m     expect(stat
e[33m.[39mmetadata[33m.[39msource)[33m.[39mtoBe([
32m'cache'[39m)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 235 |[39m     expect(state[33m.[39mthresho
lds[33m.[39macceptableScore)[33m.[39mtoBe([35m80[3
9m)[33m;[39m
     [90m 236 |[39m   })[33m;[39m
     [90m 237 |[39m })[33m;[39m[0m

      at Object.toBe 
(src/lib/quality/remote-config.test.ts:234:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/playbooks/__tests__/schema-validation.test.ts
  ÔùÅ Playbook Schema Validation ÔÇ║ Valid Playbook 
Schemas ÔÇ║ should validate minimal valid playbook

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 68 |[39m   describe([32m'Valid 
Playbook Schemas'[39m[33m,[39m () [33m=>[39m {
     [90m 69 |[39m     it([32m'should validate 
minimal valid playbook'[39m[33m,[39m () [33m=>[39m 
{
    [31m[1m>[22m[39m[90m 70 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 71 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 72 |[39m         id[33m:[39m [32m'550e840
0-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 73 |[39m         name[33m:[39m [32m'Auto 
Indoor Basic'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:70:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Valid Playbook 
Schemas ÔÇ║ should validate complete playbook with all 
fields

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 91 |[39m
     [90m 92 |[39m     it([32m'should validate 
complete playbook with all fields'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 93 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 94 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 95 |[39m         id[33m:[39m [32m'550e840
0-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 96 |[39m         name[33m:[39m 
[32m'Photo Indoor Advanced'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:93:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Valid Playbook 
Schemas ÔÇ║ should validate playbook with all task types

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 132 |[39m
     [90m 133 |[39m     it([32m'should validate 
playbook with all task types'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 134 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 135 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 136 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 137 |[39m         name[33m:[39m 
[32m'Complete Task Types'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:134:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject playbook missing required 
fields

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 199 |[39m   describe([32m'Invalid 
Playbook Schemas'[39m[33m,[39m () [33m=>[39m {
     [90m 200 |[39m     it([32m'should reject 
playbook missing required fields'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 201 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 202 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 203 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 204 |[39m         name[33m:[39m 
[32m'Incomplete'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:201:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject invalid UUID format

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 213 |[39m
     [90m 214 |[39m     it([32m'should reject 
invalid UUID format'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 215 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 216 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 217 |[39m         id[33m:[39m 
[32m'not-a-uuid'[39m[33m,[39m
     [90m 218 |[39m         name[33m:[39m 
[32m'Invalid ID'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:215:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject invalid setup value

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 228 |[39m
     [90m 229 |[39m     it([32m'should reject 
invalid setup value'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 230 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 231 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 232 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 233 |[39m         name[33m:[39m 
[32m'Invalid Setup'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:230:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject invalid locale format

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 243 |[39m
     [90m 244 |[39m     it([32m'should reject 
invalid locale format'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 245 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 246 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 247 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 248 |[39m         name[33m:[39m 
[32m'Invalid Locale'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:245:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject invalid reminder time format

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 258 |[39m
     [90m 259 |[39m     it([32m'should reject 
invalid reminder time format'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 260 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 261 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 262 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 263 |[39m         name[33m:[39m 
[32m'Invalid Reminder'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:260:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject step missing required fields

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 282 |[39m
     [90m 283 |[39m     it([32m'should reject step 
missing required fields'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 284 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 285 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 286 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 287 |[39m         name[33m:[39m 
[32m'Incomplete Step'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:284:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject invalid phase value

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 303 |[39m
     [90m 304 |[39m     it([32m'should reject 
invalid phase value'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 305 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 306 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 307 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 308 |[39m         name[33m:[39m 
[32m'Invalid Phase'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:305:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject invalid task type

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 326 |[39m
     [90m 327 |[39m     it([32m'should reject 
invalid task type'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 328 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 329 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 330 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 331 |[39m         name[33m:[39m 
[32m'Invalid Task Type'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:328:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Invalid Playbook 
Schemas ÔÇ║ should reject negative relativeDay

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 349 |[39m
     [90m 350 |[39m     it([32m'should reject 
negative relativeDay'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 351 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 352 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 353 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 354 |[39m         name[33m:[39m 
[32m'Negative Day'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:351:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Edge Cases ÔÇ║ 
should validate empty steps array

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 374 |[39m   describe([32m'Edge 
Cases'[39m[33m,[39m () [33m=>[39m {
     [90m 375 |[39m     it([32m'should validate 
empty steps array'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 376 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 377 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 378 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 379 |[39m         name[33m:[39m 
[32m'Empty Steps'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:376:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Edge Cases ÔÇ║ 
should validate playbook with many steps

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 388 |[39m
     [90m 389 |[39m     it([32m'should validate 
playbook with many steps'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 390 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 391 |[39m       [36mconst[39m steps 
[33m=[39m [33mArray[39m[33m.[39m[36mfrom[39m({ 
length[33m:[39m [35m100[39m }[33m,[39m 
(_[33m,[39m i) [33m=>[39m ({
     [90m 392 |[39m         id[33m:[39m 
[32m`step-${i}`[39m[33m,[39m
     [90m 393 |[39m         phase[33m:[39m 
[32m'veg'[39m [36mas[39m 
[36mconst[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:390:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Edge Cases ÔÇ║ 
should validate locale with region code

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 410 |[39m
     [90m 411 |[39m     it([32m'should validate 
locale with region code'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 412 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 413 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 414 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 415 |[39m         name[33m:[39m 
[32m'Regional Locale'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:412:28)

  ÔùÅ Playbook Schema Validation ÔÇ║ Edge Cases ÔÇ║ 
should validate complex RRULE patterns

    no schema with key or ref 
"https://json-schema.org/draft/2020-12/schema"

    [0m [90m 424 |[39m
     [90m 425 |[39m     it([32m'should validate 
complex RRULE patterns'[39m[33m,[39m () [33m=>[39m 
{
    [31m[1m>[22m[39m[90m 426 |[39m       
[36mconst[39m validate [33m=[39m 
ajv[33m.[39mcompile(playbookSchema)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 427 |[39m       [36mconst[39m playbook 
[33m=[39m {
     [90m 428 |[39m         id[33m:[39m [32m'550e84
00-e29b-41d4-a716-446655440000'[39m[33m,[39m
     [90m 429 |[39m         name[33m:[39m 
[32m'Complex RRULE'[39m[33m,[39m[0m

      at Ajv.validate 
(node_modules/ajv/lib/core.ts:362:21)
      at Ajv.validateSchema 
(node_modules/ajv/lib/core.ts:519:24)
      at Ajv._addSchema 
(node_modules/ajv/lib/core.ts:725:30)
      at Ajv.compile 
(node_modules/ajv/lib/core.ts:388:22)
      at Object.compile (src/lib/playbooks/__tests__/sch
ema-validation.test.ts:426:28)

FAIL 
src/lib/community/__tests__/offline-workflow.test.ts
  ÔùÅ Offline Workflow Integration ÔÇ║ Comment Offline 
Workflow ÔÇ║ should queue comment ÔåÆ fail ÔåÆ retry 
with backoff ÔåÆ succeed

    expect(jest.fn()).toHaveBeenCalledTimes(expected)

    Expected number of calls: 2
    Received number of calls: 0

    [0m [90m 203 |[39m       [36mawait[39m 
outboxProcessor[33m.[39mprocessQueue()[33m;[39m
     [90m 204 |[39m
    [31m[1m>[22m[39m[90m 205 |[39m       expect(mo
ckApiClient[33m.[39mcreateComment)[33m.[39mtoHaveBee
nCalledTimes([35m2[39m)[33m;[39m
     [90m     |[39m                                   
        [31m[1m^[22m[39m
     [90m 206 |[39m     })[33m;[39m
     [90m 207 |[39m
     [90m 208 |[39m     it([32m'should mark as 
failed after max retries'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toHaveBeenCalledTimes (src/lib/community
/__tests__/offline-workflow.test.ts:205:43)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/moderation/trusted-flagger-analytics.test.ts
  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
getTrustedFlaggerAnalytics ÔÇ║ fetches analytics and 
converts date strings to Date objects

    Failed to fetch trusted flaggers: TypeError: fetch 
failed

    [0m [90m 202 |[39m
     [90m 203 |[39m   [36mif[39m (error) {
    [31m[1m>[22m[39m[90m 204 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Failed to fetch trusted flaggers: 
${error.message}`[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 205 |[39m   }
     [90m 206 |[39m
     [90m 207 |[39m   [36mif[39m 
([33m![39mflaggers [33m||[39m 
flaggers[33m.[39mlength [33m===[39m [35m0[39m) 
{[0m

      at 
src/lib/moderation/trusted-flagger-analytics.ts:204:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
getTrustedFlaggerAnalytics ÔÇ║ handles empty flaggers 
array

    Failed to fetch trusted flaggers: TypeError: fetch 
failed

    [0m [90m 202 |[39m
     [90m 203 |[39m   [36mif[39m (error) {
    [31m[1m>[22m[39m[90m 204 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Failed to fetch trusted flaggers: 
${error.message}`[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 205 |[39m   }
     [90m 206 |[39m
     [90m 207 |[39m   [36mif[39m 
([33m![39mflaggers [33m||[39m 
flaggers[33m.[39mlength [33m===[39m [35m0[39m) 
{[0m

      at 
src/lib/moderation/trusted-flagger-analytics.ts:204:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
getTrustedFlaggerAnalytics ÔÇ║ throws error on failed 
response

    expect(received).rejects.toThrow(expected)

    Expected substring: "Failed to fetch trusted 
flagger analytics: Internal Server Error"
    Received message:   "Failed to fetch trusted 
flaggers: TypeError: fetch failed"

        [0m [90m 202 |[39m
         [90m 203 |[39m   [36mif[39m (error) {
        [31m[1m>[22m[39m[90m 204 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Failed to fetch trusted flaggers: 
${error.message}`[39m)[33m;[39m
         [90m     |[39m           [31m[1m^[22m[39m
         [90m 205 |[39m   }
         [90m 206 |[39m
         [90m 207 |[39m   [36mif[39m 
([33m![39mflaggers [33m||[39m 
flaggers[33m.[39mlength [33m===[39m [35m0[39m) 
{[0m

      at 
src/lib/moderation/trusted-flagger-analytics.ts:204:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/moderation/trusted-flag
ger-analytics.test.ts:115:58)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
getTrustedFlaggerMetrics ÔÇ║ fetches metrics and 
converts date string to Date object

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Date

    Received value has no prototype
    Received value: undefined

    [0m [90m 143 |[39m         
[32m'/api/moderation/trusted-flaggers/1/metrics'[39m
     [90m 144 |[39m       )[33m;[39m
    [31m[1m>[22m[39m[90m 145 |[39m       expect(re
sult[33m.[39mlast_reviewed_at)[33m.[39mtoBeInstanceO
f([33mDate[39m)[33m;[39m
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 146 |[39m       expect(result[33m.[39mlast
_reviewed_at[33m?[39m[33m.[39mtoISOString())[33m.[
39mtoBe(
     [90m 147 |[39m         
[32m'2024-01-15T10:00:00.000Z'[39m
     [90m 148 |[39m       )[33m;[39m[0m

      at Object.toBeInstanceOf (src/lib/moderation/trust
ed-flagger-analytics.test.ts:145:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ getTrustedFlaggers 
ÔÇ║ fetches flaggers and converts date strings to Date 
objects

    Failed to fetch trusted flaggers: Internal Server 
Error

    [0m [90m 291 |[39m
     [90m 292 |[39m   [36mif[39m 
([33m![39mresponse[33m.[39mok) {
    [31m[1m>[22m[39m[90m 293 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Failed to fetch trusted flaggers: 
${response.statusText}`[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 294 |[39m   }
     [90m 295 |[39m
     [90m 296 |[39m   [36mconst[39m rawData 
[33m=[39m [36mawait[39m 
response[33m.[39mjson()[33m;[39m[0m

      at 
src/lib/moderation/trusted-flagger-analytics.ts:293:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ getTrustedFlaggers 
ÔÇ║ handles status filter

    TypeError: rawData.map is not a function

    [0m [90m 297 |[39m
     [90m 298 |[39m   [90m// Convert date strings to 
Date objects for each flagger[39m
    [31m[1m>[22m[39m[90m 299 |[39m   
[36mreturn[39m rawData[33m.[39mmap(
     [90m     |[39m                  
[31m[1m^[22m[39m
     [90m 300 |[39m     (
     [90m 301 |[39m       flagger[33m:[39m 
[33mRawFlaggerData[39m [33m&[39m
     [90m 302 |[39m         
[33mOmit[39m[33m<[39m[0m

      at map 
(src/lib/moderation/trusted-flagger-analytics.ts:299:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ getTrustedFlaggers 
ÔÇ║ handles empty response array

    TypeError: rawData.map is not a function

    [0m [90m 297 |[39m
     [90m 298 |[39m   [90m// Convert date strings to 
Date objects for each flagger[39m
    [31m[1m>[22m[39m[90m 299 |[39m   
[36mreturn[39m rawData[33m.[39mmap(
     [90m     |[39m                  
[31m[1m^[22m[39m
     [90m 300 |[39m     (
     [90m 301 |[39m       flagger[33m:[39m 
[33mRawFlaggerData[39m [33m&[39m
     [90m 302 |[39m         
[33mOmit[39m[33m<[39m[0m

      at map 
(src/lib/moderation/trusted-flagger-analytics.ts:299:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ shouldWarnFlagger 
ÔÇ║ warns when accuracy drops below 70%

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 315 |[39m           }
     [90m 316 |[39m         )
    [31m[1m>[22m[39m[90m 317 |[39m       
)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 318 |[39m     })[33m;[39m
     [90m 319 |[39m
     [90m 320 |[39m     test([32m'warns when false 
positive rate exceeds 30%'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:317:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ shouldWarnFlagger 
ÔÇ║ warns when false positive rate exceeds 30%

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 327 |[39m           }
     [90m 328 |[39m         )
    [31m[1m>[22m[39m[90m 329 |[39m       
)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 330 |[39m     })[33m;[39m
     [90m 331 |[39m
     [90m 332 |[39m     test([32m'warns when quality 
is degrading'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:329:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ shouldWarnFlagger 
ÔÇ║ warns when quality is degrading

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 339 |[39m           }
     [90m 340 |[39m         )
    [31m[1m>[22m[39m[90m 341 |[39m       
)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 342 |[39m     })[33m;[39m
     [90m 343 |[39m
     [90m 344 |[39m     test([32m'does not warn when 
all metrics are good'[39m[33m,[39m () [33m=>[39m 
{[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:341:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
shouldSuspendFlagger ÔÇ║ suspends when accuracy drops 
below 50%

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 366 |[39m           }
     [90m 367 |[39m         )
    [31m[1m>[22m[39m[90m 368 |[39m       
)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 369 |[39m     })[33m;[39m
     [90m 370 |[39m
     [90m 371 |[39m     test([32m'suspends when 
false positive rate exceeds 50%'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:368:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
shouldSuspendFlagger ÔÇ║ suspends when false positive 
rate exceeds 50%

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 379 |[39m           }
     [90m 380 |[39m         )
    [31m[1m>[22m[39m[90m 381 |[39m       
)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 382 |[39m     })[33m;[39m
     [90m 383 |[39m
     [90m 384 |[39m     test([32m'suspends when 
already on warning and still degrading'[39m[33m,[39m 
() [33m=>[39m {[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:381:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
shouldSuspendFlagger ÔÇ║ suspends when already on 
warning and still degrading

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 392 |[39m           }
     [90m 393 |[39m         )
    [31m[1m>[22m[39m[90m 394 |[39m       
)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 395 |[39m     })[33m;[39m
     [90m 396 |[39m
     [90m 397 |[39m     test([32m'does not suspend 
when metrics are acceptable'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:394:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ formatResponseTime 
ÔÇ║ formats milliseconds to hours and minutes

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "2h 0m"
    Received: "2h"

    [0m [90m 495 |[39m     test([32m'formats 
milliseconds to hours and minutes'[39m[33m,[39m () 
[33m=>[39m {
     [90m 496 |[39m       expect(formatResponseTime([
35m3661000[39m))[33m.[39mtoBe([32m'1h 
1m'[39m)[33m;[39m [90m// 1h 1m 1s[39m
    [31m[1m>[22m[39m[90m 497 |[39m       expect(fo
rmatResponseTime([35m7200000[39m))[33m.[39mtoBe([32
m'2h 0m'[39m)[33m;[39m [90m// 2h[39m
     [90m     |[39m                                   
        [31m[1m^[22m[39m
     [90m 498 |[39m     })[33m;[39m
     [90m 499 |[39m
     [90m 500 |[39m     test([32m'formats days for 
very long response times'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/moderation/trusted-flagger
-analytics.test.ts:497:43)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
exportFlaggerMetrics ÔÇ║ exports metrics with date range

    TypeError: response.blob is not a function

    [0m [90m 469 |[39m   }
     [90m 470 |[39m
    [31m[1m>[22m[39m[90m 471 |[39m   
[36mreturn[39m response[33m.[39mblob()[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 472 |[39m }
     [90m 473 |[39m[0m

      at blob 
(src/lib/moderation/trusted-flagger-analytics.ts:471:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Trusted Flagger Analytics ÔÇ║ 
exportFlaggerMetrics ÔÇ║ throws error on failed response

    expect(received).rejects.toThrow(expected)

    Expected substring: "Failed to export flagger 
metrics: Internal Server Error"
    Received message:   "response.blob is not a 
function"

        [0m [90m 469 |[39m   }
         [90m 470 |[39m
        [31m[1m>[22m[39m[90m 471 |[39m   
[36mreturn[39m response[33m.[39mblob()[33m;[39m
         [90m     |[39m                   
[31m[1m^[22m[39m
         [90m 472 |[39m }
         [90m 473 |[39m[0m

      at blob 
(src/lib/moderation/trusted-flagger-analytics.ts:471:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/moderation/trusted-flag
ger-analytics.test.ts:556:70)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/playbooks/outbox-worker.test.ts
  ÔùÅ OutboxWorker ÔÇ║ processPendingActions ÔÇ║ should 
process pending schedule actions

    TypeError: action.destroyPermanently is not a 
function

    [0m [90m 271 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mdatabase[33m.[39mwrite([36masync[39
m () [33m=>[39m {
     [90m 272 |[39m         [36mfor[39m 
([36mconst[39m action [36mof[39m oldActions) {
    [31m[1m>[22m[39m[90m 273 |[39m           
[36mawait[39m 
action[33m.[39mdestroyPermanently()[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 274 |[39m         }
     [90m 275 |[39m       })[33m;[39m
     [90m 276 |[39m     }[0m

      at destroyPermanently 
(src/lib/playbooks/outbox-worker.ts:273:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn 
(src/lib/playbooks/outbox-worker.test.ts:97:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/playbooks/outbox-worker.test.ts:98:8)
      at OutboxWorker.write 
(src/lib/playbooks/outbox-worker.ts:271:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OutboxWorker ÔÇ║ processPendingActions ÔÇ║ should 
process pending cancel actions

    TypeError: action.destroyPermanently is not a 
function

    [0m [90m 271 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mdatabase[33m.[39mwrite([36masync[39
m () [33m=>[39m {
     [90m 272 |[39m         [36mfor[39m 
([36mconst[39m action [36mof[39m oldActions) {
    [31m[1m>[22m[39m[90m 273 |[39m           
[36mawait[39m 
action[33m.[39mdestroyPermanently()[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 274 |[39m         }
     [90m 275 |[39m       })[33m;[39m
     [90m 276 |[39m     }[0m

      at destroyPermanently 
(src/lib/playbooks/outbox-worker.ts:273:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn 
(src/lib/playbooks/outbox-worker.test.ts:132:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/playbooks/outbox-worker.test.ts:133:8)
      at OutboxWorker.write 
(src/lib/playbooks/outbox-worker.ts:271:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OutboxWorker ÔÇ║ processPendingActions ÔÇ║ should 
handle processing errors with retry

    TypeError: action.destroyPermanently is not a 
function

    [0m [90m 271 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mdatabase[33m.[39mwrite([36masync[39
m () [33m=>[39m {
     [90m 272 |[39m         [36mfor[39m 
([36mconst[39m action [36mof[39m oldActions) {
    [31m[1m>[22m[39m[90m 273 |[39m           
[36mawait[39m 
action[33m.[39mdestroyPermanently()[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 274 |[39m         }
     [90m 275 |[39m       })[33m;[39m
     [90m 276 |[39m     }[0m

      at destroyPermanently 
(src/lib/playbooks/outbox-worker.ts:273:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn 
(src/lib/playbooks/outbox-worker.test.ts:164:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/playbooks/outbox-worker.test.ts:165:8)
      at OutboxWorker.write 
(src/lib/playbooks/outbox-worker.ts:271:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OutboxWorker ÔÇ║ processPendingActions ÔÇ║ should 
mark as failed after max retries

    TypeError: action.destroyPermanently is not a 
function

    [0m [90m 271 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mdatabase[33m.[39mwrite([36masync[39
m () [33m=>[39m {
     [90m 272 |[39m         [36mfor[39m 
([36mconst[39m action [36mof[39m oldActions) {
    [31m[1m>[22m[39m[90m 273 |[39m           
[36mawait[39m 
action[33m.[39mdestroyPermanently()[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 274 |[39m         }
     [90m 275 |[39m       })[33m;[39m
     [90m 276 |[39m     }[0m

      at destroyPermanently 
(src/lib/playbooks/outbox-worker.ts:273:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn 
(src/lib/playbooks/outbox-worker.test.ts:200:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/playbooks/outbox-worker.test.ts:201:8)
      at OutboxWorker.write 
(src/lib/playbooks/outbox-worker.ts:271:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OutboxWorker ÔÇ║ cleanup ÔÇ║ should mark expired 
actions as expired

    TypeError: action.destroyPermanently is not a 
function

    [0m [90m 271 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mdatabase[33m.[39mwrite([36masync[39
m () [33m=>[39m {
     [90m 272 |[39m         [36mfor[39m 
([36mconst[39m action [36mof[39m oldActions) {
    [31m[1m>[22m[39m[90m 273 |[39m           
[36mawait[39m 
action[33m.[39mdestroyPermanently()[33m;[39m
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 274 |[39m         }
     [90m 275 |[39m       })[33m;[39m
     [90m 276 |[39m     }[0m

      at destroyPermanently 
(src/lib/playbooks/outbox-worker.ts:273:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn 
(src/lib/playbooks/outbox-worker.test.ts:229:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/playbooks/outbox-worker.test.ts:230:8)
      at OutboxWorker.write 
(src/lib/playbooks/outbox-worker.ts:271:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ OutboxWorker ÔÇ║ cleanup ÔÇ║ should delete old 
completed actions

    TypeError: action.update is not a function

    [0m [90m 249 |[39m       [36mawait[39m [36mthi
s[39m[33m.[39mdatabase[33m.[39mwrite([36masync[39
m () [33m=>[39m {
     [90m 250 |[39m         [36mfor[39m 
([36mconst[39m action [36mof[39m expiredActions) {
    [31m[1m>[22m[39m[90m 251 |[39m           
[36mawait[39m action[33m.[39mupdate((record) 
[33m=>[39m {
     [90m     |[39m                        
[31m[1m^[22m[39m
     [90m 252 |[39m             [36mif[39m 
(record[33m.[39mstatus [33m===[39m 
[32m'pending'[39m) {
     [90m 253 |[39m               
record[33m.[39mstatus [33m=[39m 
[32m'expired'[39m[33m;[39m
     [90m 254 |[39m             }[0m

      at update 
(src/lib/playbooks/outbox-worker.ts:251:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn 
(src/lib/playbooks/outbox-worker.test.ts:252:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply 
(src/lib/playbooks/outbox-worker.test.ts:253:8)
      at OutboxWorker.write 
(src/lib/playbooks/outbox-worker.ts:249:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/__tests__/template-manager.test.ts
  ÔùÅ TemplateManager ÔÇ║ applyTemplate creates tasks 
and is idempotent with same key

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 256 |[39m     completedAt[33m:[39m mod
el[33m.[39mcompletedAt[33m?[39m[33m.[39mtoISOStrin
g()[33m,[39m
     [90m 257 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
{}[33m,[39m
    [31m[1m>[22m[39m[90m 258 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 259 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 260 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 261 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:258:32)
      at toTaskFromModel 
(src/lib/task-manager.ts:423:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ TemplateManager ÔÇ║ bulkShiftTasks shifts due and 
reminder timestamps

    TypeError: Cannot read properties of undefined 
(reading 'toISOString')

    [0m [90m 256 |[39m     completedAt[33m:[39m mod
el[33m.[39mcompletedAt[33m?[39m[33m.[39mtoISOStrin
g()[33m,[39m
     [90m 257 |[39m     metadata[33m:[39m 
model[33m.[39mmetadata [33m?[39m[33m?[39m 
{}[33m,[39m
    [31m[1m>[22m[39m[90m 258 |[39m     
createdAt[33m:[39m model[33m.[39mcreatedAt[33m.[39
mtoISOString()[33m,[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 259 |[39m     updatedAt[33m:[39m model[33
m.[39mupdatedAt[33m.[39mtoISOString()[33m,[39m
     [90m 260 |[39m     deletedAt[33m:[39m model[33
m.[39mdeletedAt[33m?[39m[33m.[39mtoISOString()[33m
,[39m
     [90m 261 |[39m   }[33m;[39m[0m

      at toISOString (src/lib/task-manager.ts:258:32)
      at toTaskFromModel 
(src/lib/task-manager.ts:423:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/playbooks/playbook-service.test.ts
  ÔùÅ PlaybookService ÔÇ║ 
validateOneActivePlaybookPerPlant ÔÇ║ returns false 
when different playbook is already applied

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 342 |[39m       )[33m;[39m
     [90m 343 |[39m
    [31m[1m>[22m[39m[90m 344 |[39m       expect(is
Valid)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 345 |[39m     })[33m;[39m
     [90m 346 |[39m
     [90m 347 |[39m     test([32m'returns true when 
completed playbook exists for plant'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toBe 
(src/lib/playbooks/playbook-service.test.ts:344:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ PlaybookService ÔÇ║ 
validateOneActivePlaybookPerPlant ÔÇ║ returns false 
when pending playbook exists for plant

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 376 |[39m       )[33m;[39m
     [90m 377 |[39m
    [31m[1m>[22m[39m[90m 378 |[39m       expect(is
Valid)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 379 |[39m     })[33m;[39m
     [90m 380 |[39m   })[33m;[39m
     [90m 381 |[39m[0m

      at Object.toBe 
(src/lib/playbooks/playbook-service.test.ts:378:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ PlaybookService ÔÇ║ applyPlaybookToPlant ÔÇ║ 
applies playbook with idempotency key

    TypeError: this.database.get(...).query is not a 
function

    [0m [90m 443 |[39m     [36mconst[39m tasks 
[33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39mdatabase
     [90m 444 |[39m       [33m.[39m[36mget[39m[33
m<[39m[33mTaskModel[39m[33m>[39m([32m'tasks'[39m)
    [31m[1m>[22m[39m[90m 445 |[39m       [33m.[3
9mquery([33mQ[39m[33m.[39mwhere([32m'id'[39m[33m,
[39m [33mQ[39m[33m.[39moneOf(taskIds)))
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 446 |[39m       
[33m.[39mfetch()[33m;[39m
     [90m 447 |[39m
     [90m 448 |[39m     [90m// Process in batches to 
avoid blocking UI thread[39m[0m

      at PlaybookService.query 
(src/lib/playbooks/playbook-service.ts:445:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at PlaybookService.<anonymous> (node_modules/@babe
l/runtime/helpers/asyncToGenerator.js:14:12)
      at PlaybookService.apply [as 
scheduleTaskNotifications] 
(src/lib/playbooks/playbook-service.ts:441:42)
      at PlaybookService.scheduleTaskNotifications 
(src/lib/playbooks/playbook-service.ts:366:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ PlaybookService ÔÇ║ applyPlaybookToPlant ÔÇ║ 
returns existing result for duplicate idempotency key

    TypeError: this.database.get(...).query is not a 
function

    [0m [90m 443 |[39m     [36mconst[39m tasks 
[33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39mdatabase
     [90m 444 |[39m       [33m.[39m[36mget[39m[33
m<[39m[33mTaskModel[39m[33m>[39m([32m'tasks'[39m)
    [31m[1m>[22m[39m[90m 445 |[39m       [33m.[3
9mquery([33mQ[39m[33m.[39mwhere([32m'id'[39m[33m,
[39m [33mQ[39m[33m.[39moneOf(taskIds)))
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 446 |[39m       
[33m.[39mfetch()[33m;[39m
     [90m 447 |[39m
     [90m 448 |[39m     [90m// Process in batches to 
avoid blocking UI thread[39m[0m

      at PlaybookService.query 
(src/lib/playbooks/playbook-service.ts:445:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at PlaybookService.<anonymous> (node_modules/@babe
l/runtime/helpers/asyncToGenerator.js:14:12)
      at PlaybookService.apply [as 
scheduleTaskNotifications] 
(src/lib/playbooks/playbook-service.ts:441:42)
      at PlaybookService.scheduleTaskNotifications 
(src/lib/playbooks/playbook-service.ts:366:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ PlaybookService ÔÇ║ applyPlaybookToPlant ÔÇ║ 
throws error when plant has active playbook

    expect(received).rejects.toThrow(expected)

    Expected substring: "Plant already has an active 
playbook"
    Received message:   "this.database.get(...).query 
is not a function"

        [0m [90m 443 |[39m     [36mconst[39m tasks 
[33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39mdatabase
         [90m 444 |[39m       [33m.[39m[36mget[39m
[33m<[39m[33mTaskModel[39m[33m>[39m([32m'tasks'[
39m)
        [31m[1m>[22m[39m[90m 445 |[39m       [33m
.[39mquery([33mQ[39m[33m.[39mwhere([32m'id'[39m[
33m,[39m [33mQ[39m[33m.[39moneOf(taskIds)))
         [90m     |[39m        [31m[1m^[22m[39m
         [90m 446 |[39m       
[33m.[39mfetch()[33m;[39m
         [90m 447 |[39m
         [90m 448 |[39m     [90m// Process in 
batches to avoid blocking UI thread[39m[0m

      at PlaybookService.query 
(src/lib/playbooks/playbook-service.ts:445:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at PlaybookService.<anonymous> (node_modules/@babe
l/runtime/helpers/asyncToGenerator.js:14:12)
      at PlaybookService.apply [as 
scheduleTaskNotifications] 
(src/lib/playbooks/playbook-service.ts:441:42)
      at PlaybookService.scheduleTaskNotifications 
(src/lib/playbooks/playbook-service.ts:366:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow 
(src/lib/playbooks/playbook-service.test.ts:504:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ PlaybookService ÔÇ║ applyPlaybookToPlant ÔÇ║ 
allows multiple playbooks when allowMultiple is true

    TypeError: this.database.get(...).query is not a 
function

    [0m [90m 443 |[39m     [36mconst[39m tasks 
[33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39mdatabase
     [90m 444 |[39m       [33m.[39m[36mget[39m[33
m<[39m[33mTaskModel[39m[33m>[39m([32m'tasks'[39m)
    [31m[1m>[22m[39m[90m 445 |[39m       [33m.[3
9mquery([33mQ[39m[33m.[39mwhere([32m'id'[39m[33m,
[39m [33mQ[39m[33m.[39moneOf(taskIds)))
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 446 |[39m       
[33m.[39mfetch()[33m;[39m
     [90m 447 |[39m
     [90m 448 |[39m     [90m// Process in batches to 
avoid blocking UI thread[39m[0m

      at PlaybookService.query 
(src/lib/playbooks/playbook-service.ts:445:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at PlaybookService.<anonymous> (node_modules/@babe
l/runtime/helpers/asyncToGenerator.js:14:12)
      at PlaybookService.apply [as 
scheduleTaskNotifications] 
(src/lib/playbooks/playbook-service.ts:441:42)
      at PlaybookService.scheduleTaskNotifications 
(src/lib/playbooks/playbook-service.ts:366:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ PlaybookService ÔÇ║ applyPlaybookToPlant ÔÇ║ 
tracks performance metrics

    TypeError: this.database.get(...).query is not a 
function

    [0m [90m 443 |[39m     [36mconst[39m tasks 
[33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39mdatabase
     [90m 444 |[39m       [33m.[39m[36mget[39m[33
m<[39m[33mTaskModel[39m[33m>[39m([32m'tasks'[39m)
    [31m[1m>[22m[39m[90m 445 |[39m       [33m.[3
9mquery([33mQ[39m[33m.[39mwhere([32m'id'[39m[33m,
[39m [33mQ[39m[33m.[39moneOf(taskIds)))
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 446 |[39m       
[33m.[39mfetch()[33m;[39m
     [90m 447 |[39m
     [90m 448 |[39m     [90m// Process in batches to 
avoid blocking UI thread[39m[0m

      at PlaybookService.query 
(src/lib/playbooks/playbook-service.ts:445:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at PlaybookService.<anonymous> (node_modules/@babe
l/runtime/helpers/asyncToGenerator.js:14:12)
      at PlaybookService.apply [as 
scheduleTaskNotifications] 
(src/lib/playbooks/playbook-service.ts:441:42)
      at PlaybookService.scheduleTaskNotifications 
(src/lib/playbooks/playbook-service.ts:366:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/api/strains/utils.test.ts
  ÔùÅ Strains Utilities ÔÇ║ 
normalizeGrowCharacteristics ÔÇ║ normalizes complete 
grow data

    expect(received).toEqual(expected) // deep equality

    - Expected  - 4
    + Received  + 8

      Object {
        "difficulty": "beginner",
        "flowering_time": Object {
    -     "label": undefined,
    +     "label": "Varies",
          "max_weeks": 10,
          "min_weeks": 8,
        },
        "height": Object {
          "indoor_cm": 100,
    -     "label": undefined,
    +     "label": "Not reported",
          "outdoor_cm": 200,
        },
        "indoor_suitable": true,
        "outdoor_suitable": false,
        "yield": Object {
          "indoor": Object {
    -       "label": undefined,
    +       "label": "Not reported",
            "max_grams": 500,
    +       "max_oz": undefined,
            "min_grams": 400,
    +       "min_oz": undefined,
          },
          "outdoor": Object {
    -       "label": undefined,
    +       "label": "Not reported",
            "max_grams": 800,
    +       "max_oz": undefined,
            "min_grams": 600,
    +       "min_oz": undefined,
          },
        },
      }

    [0m [90m 349 |[39m       }[33m;[39m
     [90m 350 |[39m       [36mconst[39m result 
[33m=[39m 
normalizeGrowCharacteristics(input)[33m;[39m
    [31m[1m>[22m[39m[90m 351 |[39m       
expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 352 |[39m         difficulty[33m:[39m 
[32m'beginner'[39m[33m,[39m
     [90m 353 |[39m         
indoor_suitable[33m:[39m [36mtrue[39m[33m,[39m
     [90m 354 |[39m         
outdoor_suitable[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.toEqual 
(src/api/strains/utils.test.ts:351:22)

  ÔùÅ Strains Utilities ÔÇ║ 
normalizeGrowCharacteristics ÔÇ║ provides defaults for 
missing data

    expect(received).toEqual(expected) // deep equality

    - Expected  -  3
    + Received  + 18

      Object {
        "difficulty": "intermediate",
    -   "flowering_time": Object {},
    -   "height": Object {},
    +   "flowering_time": Object {
    +     "label": "Varies",
    +     "max_weeks": undefined,
    +     "min_weeks": undefined,
    +   },
    +   "height": Object {
    +     "indoor_cm": undefined,
    +     "label": "Not reported",
    +     "outdoor_cm": undefined,
    +   },
        "indoor_suitable": true,
        "outdoor_suitable": true,
    -   "yield": Object {},
    +   "yield": Object {
    +     "indoor": Object {
    +       "label": "Not reported",
    +     },
    +     "outdoor": Object {
    +       "label": "Not reported",
    +     },
    +   },
      }

    [0m [90m 364 |[39m     test([32m'provides 
defaults for missing data'[39m[33m,[39m () 
[33m=>[39m {
     [90m 365 |[39m       [36mconst[39m result 
[33m=[39m 
normalizeGrowCharacteristics([36mnull[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 366 |[39m       
expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 367 |[39m         difficulty[33m:[39m 
[32m'intermediate'[39m[33m,[39m
     [90m 368 |[39m         
indoor_suitable[33m:[39m [36mtrue[39m[33m,[39m
     [90m 369 |[39m         
outdoor_suitable[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.toEqual 
(src/api/strains/utils.test.ts:366:22)

FAIL src/api/strains/client.test.ts
  ÔùÅ StrainsApiClient ÔÇ║ getStrains ÔÇ║ fetches 
strains with default params

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrains ÔÇ║ applies 
search query with proper encoding

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrains ÔÇ║ applies 
filters correctly

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrains ÔÇ║ uses cursor 
for pagination when provided

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrains ÔÇ║ normalizes 
legacy response format

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrains ÔÇ║ handles 
direct array response

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrain ÔÇ║ fetches single 
strain by ID

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ getStrain ÔÇ║ encodes strain 
ID properly

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

  ÔùÅ StrainsApiClient ÔÇ║ caching ÔÇ║ sends 
If-None-Match header on subsequent requests

    TypeError: Cannot read properties of undefined 
(reading 'use')

    [0m [90m 142 |[39m     ) [33m=>[39m [33mT[39m
     [90m 143 |[39m   )[33m:[39m [36mvoid[39m {
    [31m[1m>[22m[39m[90m 144 |[39m     [36mthis[
39m[33m.[39mclient[33m.[39minterceptors[33m.[39mre
quest[33m.[39muse(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 145 |[39m       (config) [33m=>[39m 
config[33m,[39m
     [90m 146 |[39m       (error[33m:[39m 
[33mAxiosError[39m) [33m=>[39m {
     [90m 147 |[39m         [36mif[39m 
(error[33m.[39mconfig) {[0m

      at StrainsApiClient.use [as 
setupRequestInterceptor] 
(src/api/strains/client.ts:144:38)
      at StrainsApiClient.setupRequestInterceptor [as 
setupSecurityInterceptors] 
(src/api/strains/client.ts:99:10)
      at new setupSecurityInterceptors 
(src/api/strains/client.ts:88:10)
      at getStrainsApiClient 
(src/api/strains/client.ts:726:22)
      at Object.<anonymous> 
(src/api/strains/client.test.ts:46:33)

FAIL src/lib/uploads/__tests__/ai-images.test.ts
  ÔùÅ AI image uploads with consent gating ÔÇ║ 
inference upload succeeds with cloudProcessing and 
without aiTraining consent

    TypeError: FileSystem.readAsStringAsync is not a 
function

    [0m [90m 80 |[39m   [90m// Use expo-file-system 
+ base64-arraybuffer for React Native compatibility[39m
     [90m 81 |[39m   [90m// (Response.arrayBuffer() 
is not available in bare RN)[39m
    [31m[1m>[22m[39m[90m 82 |[39m   
[36mconst[39m base64 [33m=[39m [36mawait[39m [33m
FileSystem[39m[33m.[39mreadAsStringAsync(localUri[33
m,[39m {
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 83 |[39m     encoding[33m:[39m [33mFileSy
stem[39m[33m.[39m[33mEncodingType[39m[33m.[39m[3
3mBase64[39m[33m,[39m
     [90m 84 |[39m   })[33m;[39m
     [90m 85 |[39m   [36mconst[39m arrayBuffer 
[33m=[39m decode(base64)[33m;[39m[0m

      at readAsStringAsync 
(src/lib/uploads/ai-images.ts:82:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/uploads/ai-images.ts:95:2)
      at apply (src/lib/uploads/ai-images.ts:74:24)
      at doUpload (src/lib/uploads/ai-images.ts:132:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AI image upload implementation details ÔÇ║ 
training upload succeeds with both consents and records 
retention

    TypeError: FileSystem.readAsStringAsync is not a 
function

    [0m [90m 80 |[39m   [90m// Use expo-file-system 
+ base64-arraybuffer for React Native compatibility[39m
     [90m 81 |[39m   [90m// (Response.arrayBuffer() 
is not available in bare RN)[39m
    [31m[1m>[22m[39m[90m 82 |[39m   
[36mconst[39m base64 [33m=[39m [36mawait[39m [33m
FileSystem[39m[33m.[39mreadAsStringAsync(localUri[33
m,[39m {
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 83 |[39m     encoding[33m:[39m [33mFileSy
stem[39m[33m.[39m[33mEncodingType[39m[33m.[39m[3
3mBase64[39m[33m,[39m
     [90m 84 |[39m   })[33m;[39m
     [90m 85 |[39m   [36mconst[39m arrayBuffer 
[33m=[39m decode(base64)[33m;[39m[0m

      at readAsStringAsync 
(src/lib/uploads/ai-images.ts:82:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/uploads/ai-images.ts:74:24)
      at doUpload (src/lib/uploads/ai-images.ts:172:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AI image upload implementation details ÔÇ║ calls 
stripExifAndGeolocation before upload

    TypeError: FileSystem.readAsStringAsync is not a 
function

    [0m [90m 80 |[39m   [90m// Use expo-file-system 
+ base64-arraybuffer for React Native compatibility[39m
     [90m 81 |[39m   [90m// (Response.arrayBuffer() 
is not available in bare RN)[39m
    [31m[1m>[22m[39m[90m 82 |[39m   
[36mconst[39m base64 [33m=[39m [36mawait[39m [33m
FileSystem[39m[33m.[39mreadAsStringAsync(localUri[33
m,[39m {
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 83 |[39m     encoding[33m:[39m [33mFileSy
stem[39m[33m.[39m[33mEncodingType[39m[33m.[39m[3
3mBase64[39m[33m,[39m
     [90m 84 |[39m   })[33m;[39m
     [90m 85 |[39m   [36mconst[39m arrayBuffer 
[33m=[39m decode(base64)[33m;[39m[0m

      at readAsStringAsync 
(src/lib/uploads/ai-images.ts:82:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/uploads/ai-images.ts:74:24)
      at doUpload (src/lib/uploads/ai-images.ts:132:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AI image upload implementation details ÔÇ║ 
handles different MIME types and creates ArrayBuffer 
correctly

    TypeError: FileSystem.readAsStringAsync is not a 
function

    [0m [90m 80 |[39m   [90m// Use expo-file-system 
+ base64-arraybuffer for React Native compatibility[39m
     [90m 81 |[39m   [90m// (Response.arrayBuffer() 
is not available in bare RN)[39m
    [31m[1m>[22m[39m[90m 82 |[39m   
[36mconst[39m base64 [33m=[39m [36mawait[39m [33m
FileSystem[39m[33m.[39mreadAsStringAsync(localUri[33
m,[39m {
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 83 |[39m     encoding[33m:[39m [33mFileSy
stem[39m[33m.[39m[33mEncodingType[39m[33m.[39m[3
3mBase64[39m[33m,[39m
     [90m 84 |[39m   })[33m;[39m
     [90m 85 |[39m   [36mconst[39m arrayBuffer 
[33m=[39m decode(base64)[33m;[39m[0m

      at readAsStringAsync 
(src/lib/uploads/ai-images.ts:82:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/uploads/ai-images.ts:74:24)
      at doUpload (src/lib/uploads/ai-images.ts:132:24)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/inventory/__tests__/batch-service.test.ts
  ÔùÅ BatchService ÔÇ║ addBatch ÔÇ║ creates batch with 
valid data

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "LOT-001"
    Received: undefined

    [0m [90m 56 |[39m       expect(result[33m.[39ms
uccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 57 |[39m       expect(result[33m.[39mdata)
[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 58 |[39m       expect(res
ult[33m.[39mdata[33m?[39m[33m.[39mlotNumber)[33m.
[39mtoBe([32m'LOT-001'[39m)[33m;[39m
     [90m    |[39m                                    
  [31m[1m^[22m[39m
     [90m 59 |[39m       expect(result[33m.[39mdata
[33m?[39m[33m.[39mquantity)[33m.[39mtoBe([35m100[
39m)[33m;[39m
     [90m 60 |[39m       expect(result[33m.[39mdata
[33m?[39m[33m.[39mcostPerUnitMinor)[33m.[39mtoBe([
35m1500[39m)[33m;[39m
     [90m 61 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:58:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ addBatch ÔÇ║ fails with 
duplicate lot number for same item

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 116 |[39m       })[33m;[39m
     [90m 117 |[39m
    [31m[1m>[22m[39m[90m 118 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mfalse[39m)
[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 119 |[39m       expect(result[33m.[39mvali
dationErrors[33m?[39m[33m.[39m[[35m0[39m][33m?[3
9m[33m.[39mmessage)[33m.[39mtoBe(
     [90m 120 |[39m         [33mBATCH_VALIDATION_ERRO
RS[39m[33m.[39m[33mDUPLICATE_LOT[39m
     [90m 121 |[39m       )[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:118:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ addBatch ÔÇ║ sets receivedAt to 
current time if not provided

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 133 |[39m
     [90m 134 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 135 |[39m       expect(re
sult[33m.[39mdata[33m?[39m[33m.[39mreceivedAt)[33
m.[39mtoBeDefined()[33m;[39m
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 136 |[39m       expect(result[33m.[39mdata
[33m![39m[33m.[39mreceivedAt[33m.[39mgetTime())[3
3m.[39mtoBeGreaterThanOrEqual(
     [90m 137 |[39m         before[33m.[39mgetTime()
     [90m 138 |[39m       )[33m;[39m[0m

      at Object.toBeDefined (src/lib/inventory/__tests__
/batch-service.test.ts:135:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatchesForItem - FEFO 
Ordering ÔÇ║ returns batches sorted by expiration date 
(FEFO)

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 0
    Received array:  []

    [0m [90m 172 |[39m       [36mconst[39m batches 
[33m=[39m [36mawait[39m 
getBatchesForItem(testItemId)[33m;[39m
     [90m 173 |[39m
    [31m[1m>[22m[39m[90m 174 |[39m       expect(ba
tches)[33m.[39mtoHaveLength([35m3[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 175 |[39m       expect(batches[[35m0[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-EARLY'[39
m)[33m;[39m [90m// Expires first[39m
     [90m 176 |[39m       expect(batches[[35m1[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-MID'[39m)
[33m;[39m
     [90m 177 |[39m       expect(batches[[35m2[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-LATE'[39m
)[33m;[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/batch-service.test.ts:174:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatchesForItem - FEFO 
Ordering ÔÇ║ places batches without expiry at the end

    expect(received).toHaveLength(expected)

    Expected length: 2
    Received length: 0
    Received array:  []

    [0m [90m 197 |[39m       [36mconst[39m batches 
[33m=[39m [36mawait[39m 
getBatchesForItem(testItemId)[33m;[39m
     [90m 198 |[39m
    [31m[1m>[22m[39m[90m 199 |[39m       expect(ba
tches)[33m.[39mtoHaveLength([35m2[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 200 |[39m       expect(batches[[35m0[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-EXPIRES'[
39m)[33m;[39m
     [90m 201 |[39m       expect(batches[[35m1[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-NO-EXPIRY'
[39m)[33m;[39m
     [90m 202 |[39m     })[33m;[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/batch-service.test.ts:199:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatchesForItem - FEFO 
Ordering ÔÇ║ excludes expired batches by default

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 224 |[39m       [36mconst[39m batches 
[33m=[39m [36mawait[39m 
getBatchesForItem(testItemId[33m,[39m 
[36mfalse[39m)[33m;[39m
     [90m 225 |[39m
    [31m[1m>[22m[39m[90m 226 |[39m       expect(ba
tches)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 227 |[39m       expect(batches[[35m0[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-VALID'[39
m)[33m;[39m
     [90m 228 |[39m     })[33m;[39m
     [90m 229 |[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/batch-service.test.ts:226:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatchesForItem - FEFO 
Ordering ÔÇ║ includes expired batches when requested

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 242 |[39m       [36mconst[39m batches 
[33m=[39m [36mawait[39m 
getBatchesForItem(testItemId[33m,[39m 
[36mtrue[39m)[33m;[39m
     [90m 243 |[39m
    [31m[1m>[22m[39m[90m 244 |[39m       expect(ba
tches)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 245 |[39m       expect(batches[[35m0[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-EXPIRED'[
39m)[33m;[39m
     [90m 246 |[39m     })[33m;[39m
     [90m 247 |[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/batch-service.test.ts:244:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatchesForItem - FEFO 
Ordering ÔÇ║ excludes batches with zero quantity

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 269 |[39m       [36mconst[39m batches 
[33m=[39m [36mawait[39m 
getBatchesForItem(testItemId)[33m;[39m
     [90m 270 |[39m
    [31m[1m>[22m[39m[90m 271 |[39m       expect(ba
tches)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 272 |[39m       expect(batches[[35m0[39m]
[33m.[39mlotNumber)[33m.[39mtoBe([32m'LOT-FULL'[39m
)[33m;[39m
     [90m 273 |[39m     })[33m;[39m
     [90m 274 |[39m   })[33m;[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/batch-service.test.ts:271:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatch ÔÇ║ retrieves batch by 
ID

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "LOT-GET"
    Received: undefined

    [0m [90m 286 |[39m
     [90m 287 |[39m       expect(batch)[33m.[39mnot
[33m.[39mtoBeNull()[33m;[39m
    [31m[1m>[22m[39m[90m 288 |[39m       expect(ba
tch[33m?[39m[33m.[39mlotNumber)[33m.[39mtoBe([32m
'LOT-GET'[39m)[33m;[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 289 |[39m     })[33m;[39m
     [90m 290 |[39m
     [90m 291 |[39m     test([32m'returns null for 
deleted batch'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:288:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getBatch ÔÇ║ returns null for 
deleted batch

    expect(received).toBeNull()

    Received: {"costPerUnitMinor": undefined, 
"createdAt": undefined, "deletedAt": undefined, 
"expiresOn": undefined, "id": "mock-id", "itemId": 
undefined, "lotNumber": undefined, "quantity": 
undefined, "receivedAt": undefined, "updatedAt": 
undefined, "userId": undefined}

    [0m [90m 300 |[39m       [36mconst[39m batch 
[33m=[39m [36mawait[39m getBatch(created[33m.[39md
ata[33m![39m[33m.[39mid)[33m;[39m
     [90m 301 |[39m
    [31m[1m>[22m[39m[90m 302 |[39m       
expect(batch)[33m.[39mtoBeNull()[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 303 |[39m     })[33m;[39m
     [90m 304 |[39m   })[33m;[39m
     [90m 305 |[39m[0m

      at Object.toBeNull (src/lib/inventory/__tests__/ba
tch-service.test.ts:302:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ updateBatchQuantity ÔÇ║ updates 
quantity with reason

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 318 |[39m       })[33m;[39m
     [90m 319 |[39m
    [31m[1m>[22m[39m[90m 320 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 321 |[39m       expect(result[33m.[39mdata
[33m?[39m[33m.[39mquantity)[33m.[39mtoBe([35m75[
39m)[33m;[39m
     [90m 322 |[39m     })[33m;[39m
     [90m 323 |[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:320:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ updateBatchQuantity ÔÇ║ creates 
movement record for quantity adjustment

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 370 |[39m       })[33m;[39m
     [90m 371 |[39m
    [31m[1m>[22m[39m[90m 372 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 373 |[39m       expect(result[33m.[39mdata
[33m?[39m[33m.[39mquantity)[33m.[39mtoBe([35m75[
39m)[33m;[39m
     [90m 374 |[39m
     [90m 375 |[39m       [90m// Verify movement 
record was created[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:372:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getTotalAvailableQuantity ÔÇ║ 
sums quantities across all batches

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 100
    Received: 0

    [0m [90m 415 |[39m       [36mconst[39m total 
[33m=[39m [36mawait[39m 
getTotalAvailableQuantity(testItemId)[33m;[39m
     [90m 416 |[39m
    [31m[1m>[22m[39m[90m 417 |[39m       
expect(total)[33m.[39mtoBe([35m100[39m)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 418 |[39m     })[33m;[39m
     [90m 419 |[39m
     [90m 420 |[39m     test([32m'excludes expired 
batches by default'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:417:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ getTotalAvailableQuantity ÔÇ║ 
excludes expired batches by default

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 50
    Received: 0

    [0m [90m 439 |[39m       [36mconst[39m total 
[33m=[39m [36mawait[39m 
getTotalAvailableQuantity(testItemId[33m,[39m 
[36mfalse[39m)[33m;[39m
     [90m 440 |[39m
    [31m[1m>[22m[39m[90m 441 |[39m       
expect(total)[33m.[39mtoBe([35m50[39m)[33m;[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 442 |[39m     })[33m;[39m
     [90m 443 |[39m   })[33m;[39m
     [90m 444 |[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:441:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BatchService ÔÇ║ deleteBatch ÔÇ║ soft deletes 
batch

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 454 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m deleteBatch(created[33m.[3
9mdata[33m![39m[33m.[39mid)[33m;[39m
     [90m 455 |[39m
    [31m[1m>[22m[39m[90m 456 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 457 |[39m
     [90m 458 |[39m       [36mconst[39m batch 
[33m=[39m [36mawait[39m getBatch(created[33m.[39md
ata[33m![39m[33m.[39mid)[33m;[39m
     [90m 459 |[39m       
expect(batch)[33m.[39mtoBeNull()[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/batch-
service.test.ts:456:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/harvest/__tests__/edge-cases.test.ts
  ÔùÅ Edge Case Guidance ÔÇ║ 
getOverlappingHarvestsGuidance ÔÇ║ should provide 
guidance for overlapping harvests

    expect(received).toContain(expected) // indexOf

    Expected substring: "overlappingHarvests"
    Received string:    
"harvest.edge_case.overlapping_harvests.title"

    [0m [90m 409 |[39m       [36mconst[39m 
guidance [33m=[39m 
getOverlappingHarvestsGuidance([32m'Test 
Plant'[39m[33m,[39m [35m2[39m)[33m;[39m
     [90m 410 |[39m
    [31m[1m>[22m[39m[90m 411 |[39m       expect(gu
idance[33m.[39mtitle)[33m.[39mtoContain([32m'overla
ppingHarvests'[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 412 |[39m       expect(guidance[33m.[39mse
verity)[33m.[39mtoBe([32m'warning'[39m)[33m;[39m
     [90m 413 |[39m       expect(guidance[33m.[39mac
tions)[33m.[39mtoHaveLength([35m3[39m)[33m;[39m
     [90m 414 |[39m       expect(guidance[33m.[39mac
tions[[35m0[39m][33m.[39mactionType)[33m.[39mtoBe(
[32m'navigate'[39m)[33m;[39m[0m

      at Object.toContain 
(src/lib/harvest/__tests__/edge-cases.test.ts:411:30)

  ÔùÅ Edge Case Guidance ÔÇ║ 
getMissingDryWeightGuidance ÔÇ║ should provide guidance 
for missing dry weight

    expect(received).toContain(expected) // indexOf

    Expected substring: "missingDryWeight"
    Received string:    
"harvest.edge_case.missing_dry_weight.title"

    [0m [90m 420 |[39m       [36mconst[39m 
guidance [33m=[39m 
getMissingDryWeightGuidance()[33m;[39m
     [90m 421 |[39m
    [31m[1m>[22m[39m[90m 422 |[39m       expect(gu
idance[33m.[39mtitle)[33m.[39mtoContain([32m'missin
gDryWeight'[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 423 |[39m       expect(guidance[33m.[39mse
verity)[33m.[39mtoBe([32m'error'[39m)[33m;[39m
     [90m 424 |[39m       
expect(guidance[33m.[39mactions[33m.[39msome((a) 
[33m=>[39m a[33m.[39mactionType [33m===[39m [32m'
fix'[39m))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 425 |[39m     })[33m;[39m[0m

      at Object.toContain 
(src/lib/harvest/__tests__/edge-cases.test.ts:422:30)

  ÔùÅ Edge Case Guidance ÔÇ║ getUnusualDurationGuidance 
ÔÇ║ should provide guidance for too short duration

    expect(received).toContain(expected) // indexOf

    Expected substring: "durationTooShort"
    Received string:    
"harvest.edge_case.duration_too_short.title"

    [0m [90m 435 |[39m       })[33m;[39m
     [90m 436 |[39m
    [31m[1m>[22m[39m[90m 437 |[39m       expect(gu
idance[33m.[39mtitle)[33m.[39mtoContain([32m'durati
onTooShort'[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 438 |[39m       expect(guidance[33m.[39mse
verity)[33m.[39mtoBe([32m'warning'[39m)[33m;[39m
     [90m 439 |[39m       expect(guidance[33m.[39mac
tions)[33m.[39mtoHaveLength([35m3[39m)[33m;[39m
     [90m 440 |[39m     })[33m;[39m[0m

      at Object.toContain 
(src/lib/harvest/__tests__/edge-cases.test.ts:437:30)

  ÔùÅ Edge Case Guidance ÔÇ║ getUnusualDurationGuidance 
ÔÇ║ should provide guidance for too long duration

    expect(received).toContain(expected) // indexOf

    Expected substring: "durationTooLong"
    Received string:    
"harvest.edge_case.duration_too_long.title"

    [0m [90m 448 |[39m       })[33m;[39m
     [90m 449 |[39m
    [31m[1m>[22m[39m[90m 450 |[39m       expect(gu
idance[33m.[39mtitle)[33m.[39mtoContain([32m'durati
onTooLong'[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 451 |[39m       expect(guidance[33m.[39mse
verity)[33m.[39mtoBe([32m'info'[39m)[33m;[39m
     [90m 452 |[39m     })[33m;[39m
     [90m 453 |[39m   })[33m;[39m[0m

      at Object.toContain 
(src/lib/harvest/__tests__/edge-cases.test.ts:450:30)

  ÔùÅ Edge Case Guidance ÔÇ║ 
getHarvestValidationGuidance ÔÇ║ should return multiple 
guidance messages for multiple issues

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 469 |[39m       expect(guidance)[33m.[
39mtoHaveLength([35m3[39m)[33m;[39m
     [90m 470 |[39m       
expect(guidance[33m.[39msome((g) [33m=>[39m g[33m.
[39mtitle[33m.[39mincludes([32m'overlapping'[39m)))
[33m.[39mtoBe([36mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 471 |[39m       
expect(guidance[33m.[39msome((g) [33m=>[39m g[33m.
[39mtitle[33m.[39mincludes([32m'missingDryWeight'[39
m)))[33m.[39mtoBe(
     [90m     |[39m                                   
                                       
[31m[1m^[22m[39m
     [90m 472 |[39m         [36mtrue[39m
     [90m 473 |[39m       )[33m;[39m
     [90m 474 |[39m       
expect(guidance[33m.[39msome((g) [33m=>[39m g[33m.
[39mtitle[33m.[39mincludes([32m'syncConflict'[39m)))
[33m.[39mtoBe([36mtrue[39m)[33m;[39m[0m

      at Object.toBe 
(src/lib/harvest/__tests__/edge-cases.test.ts:471:74)

  ÔùÅ Edge Case Guidance ÔÇ║ 
getHarvestValidationGuidance ÔÇ║ should include clock 
skew guidance

    expect(received).toContain(expected) // indexOf

    Expected substring: "clockSkew"
    Received string:    
"harvest.edge_case.clock_skew.title"

    [0m [90m 495 |[39m
     [90m 496 |[39m       expect(guidance)[33m.[39mt
oHaveLength([35m1[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 497 |[39m       expect(gu
idance[[35m0[39m][33m.[39mtitle)[33m.[39mtoContain
([32m'clockSkew'[39m)[33m;[39m
     [90m     |[39m                                 
[31m[1m^[22m[39m
     [90m 498 |[39m     })[33m;[39m
     [90m 499 |[39m   })[33m;[39m
     [90m 500 |[39m[0m

      at Object.toContain 
(src/lib/harvest/__tests__/edge-cases.test.ts:497:33)

FAIL src/lib/moderation/__tests__/integration-workflows.
test.ts
  ÔùÅ End-to-End Integration Tests ÔÇ║ Complete 
Notice-and-Action Workflow ÔÇ║ should process report 
from submission to decision with SoR

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Appeals Workflow 
with Human Review ÔÇ║ should process appeal from 
submission to reversal

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Appeals Workflow 
with Human Review ÔÇ║ should escalate to ODS when 
internal appeal exhausted

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Trusted Flagger 
Priority Processing ÔÇ║ should prioritize trusted 
flagger reports

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Age-Gating 
Enforcement Workflow ÔÇ║ should enforce age-gating for 
cannabis content

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Age-Gating 
Enforcement Workflow ÔÇ║ should apply safer defaults 
for minors

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ Geo-Restriction 
Workflow ÔÇ║ should apply geo-restrictions with SoR 
notification

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

  ÔùÅ End-to-End Integration Tests ÔÇ║ SLA Compliance 
Workflow ÔÇ║ should escalate reports approaching SLA 
deadline

    TypeError: _appealsService.AppealsService is not a 
constructor

    [0m [90m 35 |[39m     [90m// reportingService = 
new ReportingService(supabase, auditService);[39m
     [90m 36 |[39m     moderationService [33m=[39m 
[36mnew[39m 
[33mModerationService[39m(supabase[33m,[39m 
auditService)[33m;[39m
    [31m[1m>[22m[39m[90m 37 |[39m     
appealsService [33m=[39m [36mnew[39m 
[33mAppealsService[39m(supabase[33m,[39m 
auditService)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 38 |[39m     dsaClient [33m=[39m 
[36mnew[39m [33mDSATransparencyClient[39m({
     [90m 39 |[39m       apiUrl[33m:[39m [32m'https
://transparency-api.ec.europa.eu'[39m[33m,[39m
     [90m 40 |[39m       apiKey[33m:[39m 
[32m'test-key'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/moderation/__tests_
_/integration-workflows.test.ts:37:22)

FAIL src/api/strains/use-prefetch-strain.test.ts
  ÔùÅ usePrefetchStrain ÔÇ║ usePrefetchStrainsPage ÔÇ║ 
prefetches strains page with default params

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
        "gcTime": 600000,
        "initialPageParam": undefined,
    -   "queryFn": Any<Function>,
    +   "queryFn": [Function queryFn],
        "queryKey": Array [
    -     "strains",
    +     "strains-infinite",
    +     undefined,
    +     undefined,
    +     20,
        ],
        "staleTime": 300000,
      },

    Number of calls: 1

    [0m [90m 71 |[39m       })[33m;[39m
     [90m 72 |[39m
    [31m[1m>[22m[39m[90m 73 |[39m       expect(moc
kQueryClient[33m.[39mprefetchInfiniteQuery)[33m.[39m
toHaveBeenCalledWith({
     [90m    |[39m                                    
                 [31m[1m^[22m[39m
     [90m 74 |[39m         queryKey[33m:[39m 
[[32m'strains'[39m][33m,[39m
     [90m 75 |[39m         queryFn[33m:[39m 
expect[33m.[39many([33mFunction[39m)[33m,[39m
     [90m 76 |[39m         
initialPageParam[33m:[39m undefined[33m,[39m[0m

      at Object.toHaveBeenCalledWith 
(src/api/strains/use-prefetch-strain.test.ts:73:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ usePrefetchStrain ÔÇ║ usePrefetchStrainsPage ÔÇ║ 
prefetches strains page with filters

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      Object {
        "gcTime": 600000,
        "initialPageParam": undefined,
    -   "queryFn": Any<Function>,
    +   "queryFn": [Function queryFn],
        "queryKey": Array [
    -     "strains",
    +     "strains-infinite",
    +     "OG Kush",
    +     Object {
    +       "effects": Array [
    +         "Relaxed",
    +         "Happy",
    +       ],
    +       "race": "indica",
    +       "thcMax": 25,
    +       "thcMin": 15,
    +     },
    +     10,
        ],
        "staleTime": 300000,
      },

    Number of calls: 1

    [0m [90m 110 |[39m       })[33m;[39m
     [90m 111 |[39m
    [31m[1m>[22m[39m[90m 112 |[39m       expect(mo
ckQueryClient[33m.[39mprefetchInfiniteQuery)[33m.[39
mtoHaveBeenCalledWith({
     [90m     |[39m                                   
                  [31m[1m^[22m[39m
     [90m 113 |[39m         queryKey[33m:[39m 
[[32m'strains'[39m][33m,[39m
     [90m 114 |[39m         queryFn[33m:[39m 
expect[33m.[39many([33mFunction[39m)[33m,[39m
     [90m 115 |[39m         
initialPageParam[33m:[39m undefined[33m,[39m[0m

      at Object.toHaveBeenCalledWith 
(src/api/strains/use-prefetch-strain.test.ts:112:53)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/playbooks/i18n/__tests__/translations.test.ts
  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ English translations ÔÇ║ should have 
valid ICU format for pluralization

    TypeError: Cannot read properties of undefined 
(reading 'total_weeks_one')

    [0m [90m  9 |[39m
     [90m 10 |[39m         [90m// Check 
pluralization patterns[39m
    [31m[1m>[22m[39m[90m 11 |[39m         expect(p
laybooks[33m.[39mselection[33m.[39mpreview[33m.[39
mtotal_weeks_one)[33m.[39mtoContain(
     [90m    |[39m                                    
        [31m[1m^[22m[39m
     [90m 12 |[39m           [32m'{{count}}'[39m
     [90m 13 |[39m         )[33m;[39m
     [90m 14 |[39m         expect(playbooks[33m.[39m
selection[33m.[39mpreview[33m.[39mtotal_weeks_other)
[33m.[39mtoContain([0m

      at Object.total_weeks_one (src/lib/playbooks/i18n/
__tests__/translations.test.ts:11:44)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ English translations ÔÇ║ should have 
valid ICU format for interpolation

    TypeError: Cannot read properties of undefined 
(reading 'confidence')

    [0m [90m 51 |[39m
     [90m 52 |[39m         [90m// Check 
interpolation patterns[39m
    [31m[1m>[22m[39m[90m 53 |[39m         expect(p
laybooks[33m.[39madjustments[33m.[39mconfidence)[33
m.[39mtoContain([32m'{{percent}}'[39m)[33m;[39m
     [90m    |[39m                                    
  [31m[1m^[22m[39m
     [90m 54 |[39m         expect(playbooks[33m.[39m
save_as_template_description)[33m.[39mtoContain(
     [90m 55 |[39m           
[32m'{{percentage}}'[39m
     [90m 56 |[39m         )[33m;[39m[0m

      at Object.confidence (src/lib/playbooks/i18n/__tes
ts__/translations.test.ts:53:38)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ English translations ÔÇ║ should have 
valid accessibility labels with interpolation

    expect(received).toContain(expected) // indexOf

    Matcher error: received value must not be null nor 
undefined

    Received has value: undefined

    [0m [90m 76 |[39m         [36mconst[39m { 
playbooks } [33m=[39m (enTranslations [36mas[39m 
any)[33m.[39mcommunity[33m;[39m
     [90m 77 |[39m
    [31m[1m>[22m[39m[90m 78 |[39m         expect(p
laybooks[33m.[39maccessibility[33m.[39mplaybook_card
)[33m.[39mtoContain([32m'{{name}}'[39m)[33m;[39m
     [90m    |[39m                                    
                   [31m[1m^[22m[39m
     [90m 79 |[39m         expect(playbooks[33m.[39m
accessibility[33m.[39mplaybook_card)[33m.[39mtoConta
in([32m'{{setup}}'[39m)[33m;[39m
     [90m 80 |[39m         expect(playbooks[33m.[39m
accessibility[33m.[39mplaybook_card)[33m.[39mtoConta
in([32m'{{weeks}}'[39m)[33m;[39m
     [90m 81 |[39m         expect(playbooks[33m.[39m
accessibility[33m.[39mplaybook_card)[33m.[39mtoConta
in([32m'{{tasks}}'[39m)[33m;[39m[0m

      at Object.toContain (src/lib/playbooks/i18n/__test
s__/translations.test.ts:78:55)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ German translations ÔÇ║ should have 
valid ICU format for pluralization

    TypeError: Cannot read properties of undefined 
(reading 'total_weeks_one')

    [0m [90m 122 |[39m
     [90m 123 |[39m         [90m// Check 
pluralization patterns[39m
    [31m[1m>[22m[39m[90m 124 |[39m         expect(
playbooks[33m.[39mselection[33m.[39mpreview[33m.[3
9mtotal_weeks_one)[33m.[39mtoContain(
     [90m     |[39m                                   
         [31m[1m^[22m[39m
     [90m 125 |[39m           [32m'{{count}}'[39m
     [90m 126 |[39m         )[33m;[39m
     [90m 127 |[39m         expect(playbooks[33m.[39
mselection[33m.[39mpreview[33m.[39mtotal_weeks_other
)[33m.[39mtoContain([0m

      at Object.total_weeks_one (src/lib/playbooks/i18n/
__tests__/translations.test.ts:124:44)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ German translations ÔÇ║ should have 
valid ICU format for interpolation

    TypeError: Cannot read properties of undefined 
(reading 'confidence')

    [0m [90m 164 |[39m
     [90m 165 |[39m         [90m// Check 
interpolation patterns[39m
    [31m[1m>[22m[39m[90m 166 |[39m         expect(
playbooks[33m.[39madjustments[33m.[39mconfidence)[3
3m.[39mtoContain([32m'{{percent}}'[39m)[33m;[39m
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 167 |[39m         expect(playbooks[33m.[39
msave_as_template_description)[33m.[39mtoContain(
     [90m 168 |[39m           
[32m'{{percentage}}'[39m
     [90m 169 |[39m         )[33m;[39m[0m

      at Object.confidence (src/lib/playbooks/i18n/__tes
ts__/translations.test.ts:166:38)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ German translations ÔÇ║ should have 
valid accessibility labels with interpolation

    expect(received).toContain(expected) // indexOf

    Matcher error: received value must not be null nor 
undefined

    Received has value: undefined

    [0m [90m 189 |[39m         [36mconst[39m { 
playbooks } [33m=[39m (deTranslations [36mas[39m 
any)[33m.[39mcommunity[33m;[39m
     [90m 190 |[39m
    [31m[1m>[22m[39m[90m 191 |[39m         expect(
playbooks[33m.[39maccessibility[33m.[39mplaybook_car
d)[33m.[39mtoContain([32m'{{name}}'[39m)[33m;[39m
     [90m     |[39m                                   
                    [31m[1m^[22m[39m
     [90m 192 |[39m         expect(playbooks[33m.[39
maccessibility[33m.[39mplaybook_card)[33m.[39mtoCont
ain([32m'{{setup}}'[39m)[33m;[39m
     [90m 193 |[39m         expect(playbooks[33m.[39
maccessibility[33m.[39mplaybook_card)[33m.[39mtoCont
ain([32m'{{weeks}}'[39m)[33m;[39m
     [90m 194 |[39m         expect(playbooks[33m.[39
maccessibility[33m.[39mplaybook_card)[33m.[39mtoCont
ain([32m'{{tasks}}'[39m)[33m;[39m[0m

      at Object.toContain (src/lib/playbooks/i18n/__test
s__/translations.test.ts:191:55)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Translation key parity ÔÇ║ should have 
matching nested keys for selection

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 3

    @@ -4,10 +4,13 @@
        "10",
        "11",
        "12",
        "13",
        "14",
    +   "15",
    +   "16",
    +   "17",
        "2",
        "3",
        "4",
        "5",
        "6",

    [0m [90m 246 |[39m         )[33m;[39m
     [90m 247 |[39m
    [31m[1m>[22m[39m[90m 248 |[39m         expect(
enKeys[33m.[39msort())[33m.[39mtoEqual(deKeys[33m.
[39msort())[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 249 |[39m       })[33m;[39m
     [90m 250 |[39m
     [90m 251 |[39m       test([32m'should have 
matching nested keys for 
schedule.shift'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toEqual (src/lib/playbooks/i18n/__tests_
_/translations.test.ts:248:31)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Translation key parity ÔÇ║ should have 
matching nested keys for schedule.shift

    expect(received).toEqual(expected) // deep equality

    - Expected  - 3
    + Received  + 0

    @@ -3,13 +3,10 @@
        "1",
        "10",
        "11",
        "12",
        "13",
    -   "14",
    -   "15",
    -   "16",
        "2",
        "3",
        "4",
        "5",
        "6",

    [0m [90m 257 |[39m         )[33m;[39m
     [90m 258 |[39m
    [31m[1m>[22m[39m[90m 259 |[39m         expect(
enKeys[33m.[39msort())[33m.[39mtoEqual(deKeys[33m.
[39msort())[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 260 |[39m       })[33m;[39m
     [90m 261 |[39m
     [90m 262 |[39m       test([32m'should have 
matching nested keys for trichome'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toEqual (src/lib/playbooks/i18n/__tests_
_/translations.test.ts:259:31)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Translation key parity ÔÇ║ should have 
matching nested keys for trichome

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 1

    @@ -3,10 +3,11 @@
        "1",
        "10",
        "11",
        "12",
        "13",
    +   "14",
        "2",
        "3",
        "4",
        "5",
        "6",

    [0m [90m 268 |[39m         )[33m;[39m
     [90m 269 |[39m
    [31m[1m>[22m[39m[90m 270 |[39m         expect(
enKeys[33m.[39msort())[33m.[39mtoEqual(deKeys[33m.
[39msort())[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 271 |[39m       })[33m;[39m
     [90m 272 |[39m
     [90m 273 |[39m       test([32m'should have 
matching nested keys for community'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toEqual (src/lib/playbooks/i18n/__tests_
_/translations.test.ts:270:31)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Translation key parity ÔÇ║ should have 
matching nested keys for community

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 1

    @@ -7,10 +7,11 @@
        "13",
        "14",
        "15",
        "16",
        "17",
    +   "18",
        "2",
        "3",
        "4",
        "5",
        "6",

    [0m [90m 279 |[39m         )[33m;[39m
     [90m 280 |[39m
    [31m[1m>[22m[39m[90m 281 |[39m         expect(
enKeys[33m.[39msort())[33m.[39mtoEqual(deKeys[33m.
[39msort())[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 282 |[39m       })[33m;[39m
     [90m 283 |[39m
     [90m 284 |[39m       test([32m'should have 
matching nested keys for accessibility'[39m[33m,[39m 
() [33m=>[39m {[0m

      at Object.toEqual (src/lib/playbooks/i18n/__tests_
_/translations.test.ts:281:31)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Translation key parity ÔÇ║ should have 
matching nested keys for accessibility

    expect(received).toEqual(expected) // deep equality

    - Expected  - 4
    + Received  + 0

    @@ -26,14 +26,10 @@
        "30",
        "31",
        "32",
        "33",
        "34",
    -   "35",
    -   "36",
    -   "37",
    -   "38",
        "4",
        "5",
        "6",
        "7",
        "8",

    [0m [90m 290 |[39m         )[33m;[39m
     [90m 291 |[39m
    [31m[1m>[22m[39m[90m 292 |[39m         expect(
enKeys[33m.[39msort())[33m.[39mtoEqual(deKeys[33m.
[39msort())[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 293 |[39m       })[33m;[39m
     [90m 294 |[39m     })[33m;[39m
     [90m 295 |[39m[0m

      at Object.toEqual (src/lib/playbooks/i18n/__tests_
_/translations.test.ts:292:31)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Phases translations ÔÇ║ should have all 
phase translations in English

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 298 |[39m         [36mconst[39m { 
phases } [33m=[39m (enTranslations [36mas[39m 
any)[33m.[39mcommunity[33m;[39m
     [90m 299 |[39m
    [31m[1m>[22m[39m[90m 300 |[39m         expect(
phases[33m.[39mseedling)[33m.[39mtoBeDefined()[33m;
[39m
     [90m     |[39m                                 
[31m[1m^[22m[39m
     [90m 301 |[39m         expect(phases[33m.[39mve
g)[33m.[39mtoBeDefined()[33m;[39m
     [90m 302 |[39m         expect(phases[33m.[39mfl
ower)[33m.[39mtoBeDefined()[33m;[39m
     [90m 303 |[39m         expect(phases[33m.[39mha
rvest)[33m.[39mtoBeDefined()[33m;[39m[0m

      at Object.toBeDefined (src/lib/playbooks/i18n/__te
sts__/translations.test.ts:300:33)

  ÔùÅ Playbook Translations ÔÇ║ ICU MessageFormat 
Validation ÔÇ║ Phases translations ÔÇ║ should have all 
phase translations in German

    expect(received).toBeDefined()

    Received: undefined

    [0m [90m 307 |[39m         [36mconst[39m { 
phases } [33m=[39m (deTranslations [36mas[39m 
any)[33m.[39mcommunity[33m;[39m
     [90m 308 |[39m
    [31m[1m>[22m[39m[90m 309 |[39m         expect(
phases[33m.[39mseedling)[33m.[39mtoBeDefined()[33m;
[39m
     [90m     |[39m                                 
[31m[1m^[22m[39m
     [90m 310 |[39m         expect(phases[33m.[39mve
g)[33m.[39mtoBeDefined()[33m;[39m
     [90m 311 |[39m         expect(phases[33m.[39mfl
ower)[33m.[39mtoBeDefined()[33m;[39m
     [90m 312 |[39m         expect(phases[33m.[39mha
rvest)[33m.[39mtoBeDefined()[33m;[39m[0m

      at Object.toBeDefined (src/lib/playbooks/i18n/__te
sts__/translations.test.ts:309:33)

FAIL src/lib/moderation/__tests__/dsa-transparency-clien
t.test.ts
  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ Schema 
Validation ÔÇ║ should submit SoR with all required DSA 
fields

    TypeError: client.submitSoR is not a function

    [0m [90m 67 |[39m       })[33m;[39m
     [90m 68 |[39m
    [31m[1m>[22m[39m[90m 69 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 70 |[39m
     [90m 71 |[39m       expect(result[33m.[39msucce
ss)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 72 |[39m       expect(result[33m.[39mtrans
parencyDbId)[33m.[39mtoBe([32m'ec-db-id-456'[39m)[3
3m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:69:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ Schema 
Validation ÔÇ║ should reject SoR missing required fields

    TypeError: client.submitSoR is not a function

    [0m [90m 90 |[39m       } [36mas[39m 
any[33m;[39m
     [90m 91 |[39m
    [31m[1m>[22m[39m[90m 92 |[39m       
[36mawait[39m expect(client[33m.[39msubmitSoR(invali
dSoR))[33m.[39mrejects[33m.[39mtoThrow(
     [90m    |[39m                           
[31m[1m^[22m[39m
     [90m 93 |[39m         [35m/missing required 
field/i[39m
     [90m 94 |[39m       )[33m;[39m
     [90m 95 |[39m     })[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:92:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ Schema 
Validation ÔÇ║ should validate decisionGround enum 
values

    TypeError: client.submitSoR is not a function

    [0m [90m 117 |[39m       }[33m;[39m
     [90m 118 |[39m
    [31m[1m>[22m[39m[90m 119 |[39m       
[36mawait[39m expect(client[33m.[39msubmitSoR(invali
dSoR))[33m.[39mrejects[33m.[39mtoThrow(
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 120 |[39m         [35m/invalid 
decisionGround/i[39m
     [90m 121 |[39m       )[33m;[39m
     [90m 122 |[39m     })[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:119:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 4xx 
Error Handling ÔÇ║ should handle 400 Bad Request as 
permanent error

    TypeError: client.submitSoR is not a function

    [0m [90m 136 |[39m       })[33m;[39m
     [90m 137 |[39m
    [31m[1m>[22m[39m[90m 138 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 139 |[39m
     [90m 140 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 141 |[39m       expect(result[33m.[39merro
r)[33m.[39mtoMatchObject({[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:138:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 4xx 
Error Handling ÔÇ║ should handle 401 Unauthorized as 
permanent error

    TypeError: client.submitSoR is not a function

    [0m [90m 159 |[39m       })[33m;[39m
     [90m 160 |[39m
    [31m[1m>[22m[39m[90m 161 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 162 |[39m
     [90m 163 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 164 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'perman
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:161:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 4xx 
Error Handling ÔÇ║ should handle 403 Forbidden as 
permanent error

    TypeError: client.submitSoR is not a function

    [0m [90m 179 |[39m       })[33m;[39m
     [90m 180 |[39m
    [31m[1m>[22m[39m[90m 181 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 182 |[39m
     [90m 183 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 184 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'perman
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:181:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 4xx 
Error Handling ÔÇ║ should handle 422 Unprocessable 
Entity as permanent error

    TypeError: client.submitSoR is not a function

    [0m [90m 202 |[39m       })[33m;[39m
     [90m 203 |[39m
    [31m[1m>[22m[39m[90m 204 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 205 |[39m
     [90m 206 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 207 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'perman
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:204:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 4xx 
Error Handling ÔÇ║ should handle 429 Rate Limit as 
transient error

    TypeError: client.submitSoR is not a function

    [0m [90m 223 |[39m       })[33m;[39m
     [90m 224 |[39m
    [31m[1m>[22m[39m[90m 225 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 226 |[39m
     [90m 227 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 228 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'transi
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:225:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 5xx 
Error Handling ÔÇ║ should handle 500 Internal Server 
Error as transient

    TypeError: client.submitSoR is not a function

    [0m [90m 245 |[39m       })[33m;[39m
     [90m 246 |[39m
    [31m[1m>[22m[39m[90m 247 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 248 |[39m
     [90m 249 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 250 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'transi
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:247:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 5xx 
Error Handling ÔÇ║ should handle 502 Bad Gateway as 
transient

    TypeError: client.submitSoR is not a function

    [0m [90m 264 |[39m       })[33m;[39m
     [90m 265 |[39m
    [31m[1m>[22m[39m[90m 266 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 267 |[39m
     [90m 268 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 269 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'transi
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:266:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 5xx 
Error Handling ÔÇ║ should handle 503 Service 
Unavailable as transient

    TypeError: client.submitSoR is not a function

    [0m [90m 283 |[39m       })[33m;[39m
     [90m 284 |[39m
    [31m[1m>[22m[39m[90m 285 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 286 |[39m
     [90m 287 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 288 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'transi
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:285:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 5xx 
Error Handling ÔÇ║ should handle 504 Gateway Timeout as 
transient

    TypeError: client.submitSoR is not a function

    [0m [90m 302 |[39m       })[33m;[39m
     [90m 303 |[39m
    [31m[1m>[22m[39m[90m 304 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 305 |[39m
     [90m 306 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 307 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'transi
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:304:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 
Network Error Handling ÔÇ║ should handle network 
timeout as transient

    TypeError: client.submitSoR is not a function

    [0m [90m 316 |[39m       
mockFetch[33m.[39mmockRejectedValueOnce([36mnew[39m 
[33mError[39m([32m'Network timeout'[39m))[33m;[39m
     [90m 317 |[39m
    [31m[1m>[22m[39m[90m 318 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 319 |[39m
     [90m 320 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 321 |[39m       expect(result[33m.[39merro
r[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'transi
ent'[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:318:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 
Network Error Handling ÔÇ║ should handle connection 
refused as transient

    TypeError: client.submitSoR is not a function

    [0m [90m 328 |[39m       
mockFetch[33m.[39mmockRejectedValueOnce([36mnew[39m 
[33mError[39m([32m'ECONNREFUSED'[39m))[33m;[39m
     [90m 329 |[39m
    [31m[1m>[22m[39m[90m 330 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 331 |[39m
     [90m 332 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 333 |[39m       expect(result[33m.[39mretr
yable)[33m.[39mtoBe([36mtrue[39m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:330:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 
Idempotency ÔÇ║ should include idempotency key in 
request headers

    TypeError: client.submitSoR is not a function

    [0m [90m 346 |[39m       })[33m;[39m
     [90m 347 |[39m
    [31m[1m>[22m[39m[90m 348 |[39m       
[36mawait[39m 
client[33m.[39msubmitSoR(validSoR[33m,[39m 
idempotencyKey)[33m;[39m
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 349 |[39m
     [90m 350 |[39m       
expect(mockFetch)[33m.[39mtoHaveBeenCalledWith(
     [90m 351 |[39m         
expect[33m.[39many([33mString[39m)[33m,[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:348:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ 
Idempotency ÔÇ║ should handle 409 Conflict for 
duplicate submission

    TypeError: client.submitSoR is not a function

    [0m [90m 372 |[39m       })[33m;[39m
     [90m 373 |[39m
    [31m[1m>[22m[39m[90m 374 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR[33m,[39m 
idempotencyKey)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 375 |[39m
     [90m 376 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m [90m// 
Treat as success[39m
     [90m 377 |[39m       expect(result[33m.[39mtran
sparencyDbId)[33m.[39mtoBe([32m'ec-db-id-existing'[3
9m)[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:374:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ Batch 
Submission ÔÇ║ should submit batch of SoRs (1-100)

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 402 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
client[33m.[39msubmitBatch(sorBatch)[33m;[39m
     [90m 403 |[39m
    [31m[1m>[22m[39m[90m 404 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 405 |[39m       expect(result[33m.[39macce
pted)[33m.[39mtoBe([35m50[39m)[33m;[39m
     [90m 406 |[39m       expect(result[33m.[39mreje
cted)[33m.[39mtoBe([35m0[39m)[33m;[39m
     [90m 407 |[39m       expect(result[33m.[39mresu
lts)[33m.[39mtoHaveLength([35m50[39m)[33m;[39m[0m

      at Object.toBe (src/lib/moderation/__tests__/dsa-t
ransparency-client.test.ts:404:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ Batch 
Submission ÔÇ║ should reject batch exceeding 100 SoRs

    expect(received).rejects.toThrow(expected)

    Expected pattern: /batch size exceeds maximum/i
    Received message: "Batch size must be at most 100, 
got 101"

        [0m [90m 162 |[39m
         [90m 163 |[39m     [36mif[39m 
(statements[33m.[39mlength [33m>[39m 
[33mBATCH_SIZE_MAX[39m) {
        [31m[1m>[22m[39m[90m 164 |[39m       
[36mthrow[39m [36mnew[39m [33mError[39m(
         [90m     |[39m             
[31m[1m^[22m[39m
         [90m 165 |[39m         [32m`Batch size must 
be at most ${BATCH_SIZE_MAX}, got 
${statements.length}`[39m
         [90m 166 |[39m       )[33m;[39m
         [90m 167 |[39m     }[0m

      at DSATransparencyClient.<anonymous> 
(src/lib/moderation/dsa-transparency-client.ts:164:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at DSATransparencyClient.<anonymous> (node_modules
/@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at DSATransparencyClient.apply [as submitBatch] 
(src/lib/moderation/dsa-transparency-client.ts:143:20)
      at Object.submitBatch (src/lib/moderation/__tests_
_/dsa-transparency-client.test.ts:415:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/moderation/__tests__/ds
a-transparency-client.test.ts:415:58)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ Batch 
Submission ÔÇ║ should handle partial batch failures

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 440 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
client[33m.[39msubmitBatch(sorBatch)[33m;[39m
     [90m 441 |[39m
    [31m[1m>[22m[39m[90m 442 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 443 |[39m       expect(result[33m.[39macce
pted)[33m.[39mtoBe([35m8[39m)[33m;[39m
     [90m 444 |[39m       expect(result[33m.[39mreje
cted)[33m.[39mtoBe([35m2[39m)[33m;[39m
     [90m 445 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/moderation/__tests__/dsa-t
ransparency-client.test.ts:442:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ PII 
Verification ÔÇ║ should reject SoR containing PII fields

    TypeError: client.submitSoR is not a function

    [0m [90m 454 |[39m       }[33m;[39m
     [90m 455 |[39m
    [31m[1m>[22m[39m[90m 456 |[39m       
[36mawait[39m expect(client[33m.[39msubmitSoR(sorWit
hPII))[33m.[39mrejects[33m.[39mtoThrow(
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 457 |[39m         [35m/contains PII 
fields/i[39m
     [90m 458 |[39m       )[33m;[39m
     [90m 459 |[39m     })[33m;[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:456:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DSATransparencyClient - Contract Tests ÔÇ║ PII 
Verification ÔÇ║ should accept SoR with only 
pseudonymized identifiers

    TypeError: client.submitSoR is not a function

    [0m [90m 468 |[39m       })[33m;[39m
     [90m 469 |[39m
    [31m[1m>[22m[39m[90m 470 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m 
client[33m.[39msubmitSoR(validSoR)[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 471 |[39m
     [90m 472 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 473 |[39m       [90m// Verify no PII in 
request body[39m[0m

      at Object.submitSoR (src/lib/moderation/__tests__/
dsa-transparency-client.test.ts:470:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/notifications/push-receiver-service.test.ts
  ÔùÅ PushReceiverService ÔÇ║ setupNotificationHandlers 
ÔÇ║ should set up notification handler with correct 
settings

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 19 |[39m
     [90m 20 |[39m [36masync[39m [36mfunction[39m 
setupMockNotifications() {
    [31m[1m>[22m[39m[90m 21 |[39m   
[36mconst[39m { [36mdefault[39m[33m:[39m 
[33mNotifications[39m } [33m=[39m [36mawait[39m [
36mimport[39m([32m'expo-notifications'[39m)[33m;[39
m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 22 |[39m   [36mconst[39m 
anyNotifications[33m:[39m any [33m=[39m 
[33mNotifications[39m [36mas[39m any[33m;[39m
     [90m 23 |[39m   [36mreturn[39m 
anyNotifications[33m;[39m
     [90m 24 |[39m }[0m

      at 
src/lib/notifications/push-receiver-service.test.ts:21:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/notifications/push-receiver-serv
ice.test.ts:24:2)
      at apply (src/lib/notifications/push-receiver-serv
ice.test.ts:20:38)
      at Object.setupMockNotifications (src/lib/notifica
tions/push-receiver-service.test.ts:28:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ PushReceiverService ÔÇ║ setupNotificationHandlers 
ÔÇ║ should register foreground and response listeners

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 19 |[39m
     [90m 20 |[39m [36masync[39m [36mfunction[39m 
setupMockNotifications() {
    [31m[1m>[22m[39m[90m 21 |[39m   
[36mconst[39m { [36mdefault[39m[33m:[39m 
[33mNotifications[39m } [33m=[39m [36mawait[39m [
36mimport[39m([32m'expo-notifications'[39m)[33m;[39
m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 22 |[39m   [36mconst[39m 
anyNotifications[33m:[39m any [33m=[39m 
[33mNotifications[39m [36mas[39m any[33m;[39m
     [90m 23 |[39m   [36mreturn[39m 
anyNotifications[33m;[39m
     [90m 24 |[39m }[0m

      at 
src/lib/notifications/push-receiver-service.test.ts:21:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/notifications/push-receiver-serv
ice.test.ts:20:38)
      at Object.setupMockNotifications (src/lib/notifica
tions/push-receiver-service.test.ts:48:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ PushReceiverService ÔÇ║ setupNotificationHandlers 
ÔÇ║ should remove existing subscriptions before 
creating new ones

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 19 |[39m
     [90m 20 |[39m [36masync[39m [36mfunction[39m 
setupMockNotifications() {
    [31m[1m>[22m[39m[90m 21 |[39m   
[36mconst[39m { [36mdefault[39m[33m:[39m 
[33mNotifications[39m } [33m=[39m [36mawait[39m [
36mimport[39m([32m'expo-notifications'[39m)[33m;[39
m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 22 |[39m   [36mconst[39m 
anyNotifications[33m:[39m any [33m=[39m 
[33mNotifications[39m [36mas[39m any[33m;[39m
     [90m 23 |[39m   [36mreturn[39m 
anyNotifications[33m;[39m
     [90m 24 |[39m }[0m

      at 
src/lib/notifications/push-receiver-service.test.ts:21:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/notifications/push-receiver-serv
ice.test.ts:20:38)
      at Object.setupMockNotifications (src/lib/notifica
tions/push-receiver-service.test.ts:63:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ PushReceiverService ÔÇ║ 
removeNotificationHandlers ÔÇ║ should remove all 
notification subscriptions

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 19 |[39m
     [90m 20 |[39m [36masync[39m [36mfunction[39m 
setupMockNotifications() {
    [31m[1m>[22m[39m[90m 21 |[39m   
[36mconst[39m { [36mdefault[39m[33m:[39m 
[33mNotifications[39m } [33m=[39m [36mawait[39m [
36mimport[39m([32m'expo-notifications'[39m)[33m;[39
m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 22 |[39m   [36mconst[39m 
anyNotifications[33m:[39m any [33m=[39m 
[33mNotifications[39m [36mas[39m any[33m;[39m
     [90m 23 |[39m   [36mreturn[39m 
anyNotifications[33m;[39m
     [90m 24 |[39m }[0m

      at 
src/lib/notifications/push-receiver-service.test.ts:21:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/notifications/push-receiver-serv
ice.test.ts:20:38)
      at Object.setupMockNotifications (src/lib/notifica
tions/push-receiver-service.test.ts:84:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ PushReceiverService ÔÇ║ 
handleNotificationResponse ÔÇ║ should navigate to deep 
link when provided

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 108 |[39m [36mfunction[39m 
testHandleNotificationResponse() {
     [90m 109 |[39m   it([32m'should navigate to 
deep link when provided'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 110 |[39m     
[36mconst[39m { [33mDeepLinkService[39m } 
[33m=[39m [36mawait[39m [36mimport[39m(
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 111 |[39m       
[32m'@/lib/notifications/deep-link-service'[39m
     [90m 112 |[39m     )[33m;[39m
     [90m 113 |[39m     [36mconst[39m mockHandle 
[33m=[39m jest[0m

      at Object.<anonymous> (src/lib/notifications/push-
receiver-service.test.ts:110:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/assessment/__tests__/playbook-integration.t
est.ts
  ÔùÅ PlaybookIntegrationService ÔÇ║ suggestAdjustments 
ÔÇ║ stage-specific adjustments ÔÇ║ should include 
stage-specific adjustments when stage metadata is 
available

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 268 |[39m         
expect(result[33m.[39madjustments[33m.[39msome(adj 
[33m=>[39m
     [90m 269 |[39m           adj[33m.[39mdescriptio
n[33m.[39mincludes([32m'reduced strength'[39m)
    [31m[1m>[22m[39m[90m 270 |[39m         
))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m            [31m[1m^[22m[39m
     [90m 271 |[39m       })[33m;[39m
     [90m 272 |[39m
     [90m 273 |[39m       it([32m'should not include 
stage-specific adjustments when stage metadata is 
missing'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/assessment/__tests__/playb
ook-integration.test.ts:270:12)

  ÔùÅ suggestPlaybookAdjustments (convenience function) 
ÔÇ║ should work with assessmentId provided

    ReferenceError: mockAssessment is not defined

    [0m [90m 338 |[39m   it([32m'should work with 
assessmentId provided'[39m[33m,[39m () [33m=>[39m {
     [90m 339 |[39m     [36mconst[39m result 
[33m=[39m suggestPlaybookAdjustments({
    [31m[1m>[22m[39m[90m 340 |[39m       
assessment[33m:[39m mockAssessment[33m,[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 341 |[39m       plan[33m:[39m 
mockPlan[33m,[39m
     [90m 342 |[39m       context[33m:[39m 
mockContext[33m,[39m
     [90m 343 |[39m       assessmentId[33m:[39m 
[32m'convenience-test-123'[39m[33m,[39m[0m

      at Object.mockAssessment (src/lib/assessment/__tes
ts__/playbook-integration.test.ts:340:19)

  ÔùÅ suggestPlaybookAdjustments (convenience function) 
ÔÇ║ should work without assessmentId provided

    ReferenceError: mockAssessment is not defined

    [0m [90m 350 |[39m   it([32m'should work 
without assessmentId provided'[39m[33m,[39m () 
[33m=>[39m {
     [90m 351 |[39m     [36mconst[39m result 
[33m=[39m suggestPlaybookAdjustments({
    [31m[1m>[22m[39m[90m 352 |[39m       
assessment[33m:[39m mockAssessment[33m,[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 353 |[39m       plan[33m:[39m 
mockPlan[33m,[39m
     [90m 354 |[39m       context[33m:[39m 
mockContext[33m,[39m
     [90m 355 |[39m       [90m// assessmentId not 
provided[39m[0m

      at Object.mockAssessment (src/lib/assessment/__tes
ts__/playbook-integration.test.ts:352:19)

  ÔùÅ suggestPlaybookAdjustments (convenience function) 
ÔÇ║ should return same result as service method

    ReferenceError: mockAssessment is not defined

    [0m [90m 362 |[39m   it([32m'should return same 
result as service method'[39m[33m,[39m () 
[33m=>[39m {
     [90m 363 |[39m     [36mconst[39m options 
[33m=[39m {
    [31m[1m>[22m[39m[90m 364 |[39m       
assessment[33m:[39m mockAssessment[33m,[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 365 |[39m       plan[33m:[39m 
mockPlan[33m,[39m
     [90m 366 |[39m       context[33m:[39m 
mockContext[33m,[39m
     [90m 367 |[39m       assessmentId[33m:[39m 
[32m'comparison-test'[39m[33m,[39m[0m

      at Object.mockAssessment (src/lib/assessment/__tes
ts__/playbook-integration.test.ts:364:19)

FAIL src/lib/assessment/__tests__/assessment-feedback-se
rvice.test.ts
  ÔùÅ AssessmentFeedbackService ÔÇ║ submitFeedback ÔÇ║ 
should create feedback record with all fields

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "test-assessment-1"
    Received: undefined

    [0m [90m 31 |[39m
     [90m 32 |[39m       
expect(feedback)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 33 |[39m       expect(fee
dback[33m.[39massessmentId)[33m.[39mtoBe(options[33
m.[39massessmentId)[33m;[39m
     [90m    |[39m                                    
 [31m[1m^[22m[39m
     [90m 34 |[39m       expect(feedback[33m.[39mhel
pful)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 35 |[39m       expect(feedback[33m.[39miss
ueResolved)[33m.[39mtoBe([32m'yes'[39m)[33m;[39m
     [90m 36 |[39m       expect(feedback[33m.[39mnot
es)[33m.[39mtoBe(options[33m.[39mnotes)[33m;[39m[
0m

      at Object.toBe (src/lib/assessment/__tests__/asses
sment-feedback-service.test.ts:33:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AssessmentFeedbackService ÔÇ║ submitFeedback ÔÇ║ 
should create feedback without optional fields

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "test-assessment-2"
    Received: undefined

    [0m [90m 61 |[39m
     [90m 62 |[39m       
expect(feedback)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 63 |[39m       expect(fee
dback[33m.[39massessmentId)[33m.[39mtoBe(options[33
m.[39massessmentId)[33m;[39m
     [90m    |[39m                                    
 [31m[1m^[22m[39m
     [90m 64 |[39m       expect(feedback[33m.[39mhel
pful)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 65 |[39m       expect(feedback[33m.[39miss
ueResolved)[33m.[39mtoBeNull()[33m;[39m
     [90m 66 |[39m       expect(feedback[33m.[39mnot
es)[33m.[39mtoBeNull()[33m;[39m[0m

      at Object.toBe (src/lib/assessment/__tests__/asses
sment-feedback-service.test.ts:63:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AssessmentFeedbackService ÔÇ║ submitFeedback ÔÇ║ 
should truncate notes to 500 characters

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 500
    Received: undefined

    [0m [90m 78 |[39m       [33mCREATED_ASSESSMENT_I
DS[39m[33m.[39madd(options[33m.[39massessmentId)[3
3m;[39m
     [90m 79 |[39m
    [31m[1m>[22m[39m[90m 80 |[39m       expect(fee
dback[33m.[39mnotes[33m?[39m[33m.[39mlength)[33m.
[39mtoBe([35m500[39m)[33m;[39m
     [90m    |[39m                                    
  [31m[1m^[22m[39m
     [90m 81 |[39m     })[33m;[39m
     [90m 82 |[39m
     [90m 83 |[39m     it([32m'should trim 
whitespace from notes'[39m[33m,[39m [36masync[39m 
() [33m=>[39m {[0m

      at Object.toBe (src/lib/assessment/__tests__/asses
sment-feedback-service.test.ts:80:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AssessmentFeedbackService ÔÇ║ submitFeedback ÔÇ║ 
should trim whitespace from notes

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Test notes with spaces"
    Received: undefined

    [0m [90m 91 |[39m       [33mCREATED_ASSESSMENT_I
DS[39m[33m.[39madd(options[33m.[39massessmentId)[3
3m;[39m
     [90m 92 |[39m
    [31m[1m>[22m[39m[90m 93 |[39m       expect(fee
dback[33m.[39mnotes)[33m.[39mtoBe([32m'Test notes 
with spaces'[39m)[33m;[39m
     [90m    |[39m                              
[31m[1m^[22m[39m
     [90m 94 |[39m     })[33m;[39m
     [90m 95 |[39m   })[33m;[39m
     [90m 96 |[39m[0m

      at Object.toBe (src/lib/assessment/__tests__/asses
sment-feedback-service.test.ts:93:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AssessmentFeedbackService ÔÇ║ 
getAssessmentFeedback ÔÇ║ should return feedback for 
existing assessment

    expect(received).not.toBeNull()

    Received: null

    [0m [90m 108 |[39m         [36mawait[39m feedba
ckService[33m.[39mgetAssessmentFeedback([32m'test-ass
essment-5'[39m)[33m;[39m
     [90m 109 |[39m
    [31m[1m>[22m[39m[90m 110 |[39m       expect(fe
edback)[33m.[39mnot[33m.[39mtoBeNull()[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 111 |[39m       expect(feedback[33m?[39m[
33m.[39massessmentId)[33m.[39mtoBe([32m'test-assessm
ent-5'[39m)[33m;[39m
     [90m 112 |[39m     })[33m;[39m
     [90m 113 |[39m[0m

      at Object.toBeNull (src/lib/assessment/__tests__/a
ssessment-feedback-service.test.ts:110:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AssessmentFeedbackService ÔÇ║ 
hasAssessmentFeedback ÔÇ║ should return true when 
feedback exists

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 131 |[39m         [36mawait[39m feedba
ckService[33m.[39mhasAssessmentFeedback([32m'test-ass
essment-6'[39m)[33m;[39m
     [90m 132 |[39m
    [31m[1m>[22m[39m[90m 133 |[39m       expect(ha
sFeedback)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 134 |[39m     })[33m;[39m
     [90m 135 |[39m
     [90m 136 |[39m     it([32m'should return false 
when feedback does not exist'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/assessment/__tests__/asses
sment-feedback-service.test.ts:133:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AssessmentFeedbackService ÔÇ║ getFeedbackStats 
ÔÇ║ should calculate correct feedback statistics

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 4
    Received:    0

    [0m [90m 173 |[39m       [36mconst[39m stats 
[33m=[39m [36mawait[39m 
feedbackService[33m.[39mgetFeedbackStats()[33m;[39m
     [90m 174 |[39m
    [31m[1m>[22m[39m[90m 175 |[39m       expect(st
ats[33m.[39mtotal)[33m.[39mtoBeGreaterThanOrEqual([
35m4[39m)[33m;[39m
     [90m     |[39m                           
[31m[1m^[22m[39m
     [90m 176 |[39m       expect(stats[33m.[39mhelpf
ul)[33m.[39mtoBeGreaterThanOrEqual([35m3[39m)[33m;
[39m
     [90m 177 |[39m       expect(stats[33m.[39mnotHe
lpful)[33m.[39mtoBeGreaterThanOrEqual([35m1[39m)[33
m;[39m
     [90m 178 |[39m       expect(stats[33m.[39mresol
ved)[33m.[39mtoBeGreaterThanOrEqual([35m1[39m)[33m;
[39m[0m

      at Object.toBeGreaterThanOrEqual (src/lib/assessme
nt/__tests__/assessment-feedback-service.test.ts:175:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)


  ÔùÅ Test suite failed to run

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 183 |[39m
     [90m 184 |[39m   afterAll([36masync[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 185 |[39m     
[36mconst[39m { [33mQ[39m } [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@nozbe/watermelon
db'[39m)[33m;[39m
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 186 |[39m     [36mawait[39m 
database[33m.[39mwrite([36masync[39m () 
[33m=>[39m {
     [90m 187 |[39m       [36mconst[39m toDelete 
[33m=[39m [36mawait[39m database
     [90m 188 |[39m         [33m.[39m[36mget[39m[
33m<[39m[33mAssessmentFeedbackModel[39m[33m>[39m([
32m'assessment_feedback'[39m)[0m

      at Object.<anonymous> (src/lib/assessment/__tests_
_/assessment-feedback-service.test.ts:185:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/nutrient-engine/services/template-service.t
est.ts
  ÔùÅ Template Service ÔÇ║ validateTemplate ÔÇ║ 
propagates phase validation errors with context

    expect(received).toThrow(expected)

    Expected pattern: /Phase 1.*vegetative/
    Received message: "Phase 1 (veg): Duration must be 
between 1 and 365 days, got -1"

        [0m [90m 237 |[39m     } [36mcatch[39m 
(error) {
         [90m 238 |[39m       [36mif[39m (error 
[36minstanceof[39m [33mTemplateValidationError[39m) 
{
        [31m[1m>[22m[39m[90m 239 |[39m         
[36mthrow[39m [36mnew[39m 
[33mTemplateValidationError[39m(
         [90m     |[39m               
[31m[1m^[22m[39m
         [90m 240 |[39m           [32m`Phase ${index 
+ 1} (${phase.phase}): ${error.message}`[39m[33m,[39m
         [90m 241 |[39m           
[32m`phases[${index}].${error.field}`[39m
         [90m 242 |[39m         )[33m;[39m[0m

      at src/lib/nutrient-engine/services/template-servi
ce.ts:239:15
                at Array.forEach (<anonymous>)
      at forEach (src/lib/nutrient-engine/services/templ
ate-service.ts:234:18)
      at src/lib/nutrient-engine/services/template-servi
ce.test.ts:356:36
      at Object.<anonymous> 
(node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] 
(node_modules/expect/build/index.js:320:21)
      at Object.toThrow (src/lib/nutrient-engine/service
s/template-service.test.ts:356:48)
      at Object.toThrow (src/lib/nutrient-engine/service
s/template-service.test.ts:356:48)

FAIL src/lib/task-notifications.test.ts
  ÔùÅ TaskNotificationService scheduleTaskReminder 
success ÔÇ║ uses reminderAtUtc when provided

    expect(received).resolves.toBe()

    Received promise rejected instead of resolved
    Rejected to value: [TypeError: Cannot read 
properties of undefined (reading 'DATE')]

    [0m [90m 62 |[39m     })[33m;[39m
     [90m 63 |[39m
    [31m[1m>[22m[39m[90m 64 |[39m     
[36mawait[39m 
expect(service[33m.[39mscheduleTaskReminder(task 
[36mas[39m any))[33m.[39mresolves[33m.[39mtoBe(
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 65 |[39m       
[32m'mock-notification-id'[39m
     [90m 66 |[39m     )[33m;[39m
     [90m 67 |[39m   })[33m;[39m[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect 
(src/lib/task-notifications.test.ts:64:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ TaskNotificationService scheduleTaskReminder 
success ÔÇ║ falls back to dueAtUtc when reminderAtUtc 
is missing

    expect(received).resolves.toBe()

    Received promise rejected instead of resolved
    Rejected to value: [TypeError: Cannot read 
properties of undefined (reading 'DATE')]

    [0m [90m 75 |[39m     })[33m;[39m
     [90m 76 |[39m
    [31m[1m>[22m[39m[90m 77 |[39m     
[36mawait[39m 
expect(service[33m.[39mscheduleTaskReminder(task 
[36mas[39m any))[33m.[39mresolves[33m.[39mtoBe(
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 78 |[39m       
[32m'mock-notification-id'[39m
     [90m 79 |[39m     )[33m;[39m
     [90m 80 |[39m   })[33m;[39m[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect 
(src/lib/task-notifications.test.ts:77:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ TaskNotificationService scheduleTaskReminder 
success ÔÇ║ handles string timestamps

    expect(received).resolves.toBe()

    Received promise rejected instead of resolved
    Rejected to value: [TypeError: Cannot read 
properties of undefined (reading 'DATE')]

    [0m [90m 86 |[39m     })[33m;[39m
     [90m 87 |[39m
    [31m[1m>[22m[39m[90m 88 |[39m     
[36mawait[39m 
expect(service[33m.[39mscheduleTaskReminder(task 
[36mas[39m any))[33m.[39mresolves[33m.[39mtoBe(
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 89 |[39m       
[32m'mock-notification-id'[39m
     [90m 90 |[39m     )[33m;[39m
     [90m 91 |[39m   })[33m;[39m[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect 
(src/lib/task-notifications.test.ts:88:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/inventory/__tests__/movement-service.test.ts
  ÔùÅ Movement Service ÔÇ║ createMovement ÔÇ║ should 
create a valid receipt movement

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "mock-id"
    Received: undefined

    [0m [90m 217 |[39m       expect(result[33m.[39m
success)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 218 |[39m       expect(result[33m.[39mmove
ment)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 219 |[39m       expect(re
sult[33m.[39mmovement[33m?[39m[33m.[39mitemId)[33
m.[39mtoBe(testItem[33m.[39mid)[33m;[39m
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 220 |[39m       expect(result[33m.[39mmove
ment[33m?[39m[33m.[39mtype)[33m.[39mtoBe([32m'rec
eipt'[39m)[33m;[39m
     [90m 221 |[39m       expect(result[33m.[39mmove
ment[33m?[39m[33m.[39mquantityDelta)[33m.[39mtoBe(
[35m500[39m)[33m;[39m
     [90m 222 |[39m       expect(result[33m.[39mmove
ment[33m?[39m[33m.[39mcostPerUnitMinor)[33m.[39mto
Be([35m45[39m)[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:219:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ createMovement ÔÇ║ should 
create a valid consumption movement

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "consumption"
    Received: undefined

    [0m [90m 239 |[39m       expect(result[33m.[39m
success)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 240 |[39m       expect(result[33m.[39mmove
ment)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 241 |[39m       expect(re
sult[33m.[39mmovement[33m?[39m[33m.[39mtype)[33m.
[39mtoBe([32m'consumption'[39m)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 242 |[39m       expect(result[33m.[39mmove
ment[33m?[39m[33m.[39mquantityDelta)[33m.[39mtoBe(
[33m-[39m[35m100[39m)[33m;[39m
     [90m 243 |[39m       expect(result[33m.[39mmove
ment[33m?[39m[33m.[39mtaskId)[33m.[39mtoBe([32m't
ask-123'[39m)[33m;[39m
     [90m 244 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:241:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ createMovement ÔÇ║ should 
return existing movement on duplicate external_key

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 264 |[39m       [36mconst[39m result2 
[33m=[39m [36mawait[39m 
createMovement(request)[33m;[39m
     [90m 265 |[39m       expect(result2[33m.[39msuc
cess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 266 |[39m       expect(re
sult2[33m.[39misIdempotentDuplicate)[33m.[39mtoBe([
36mtrue[39m)[33m;[39m
     [90m     |[39m                                   
          [31m[1m^[22m[39m
     [90m 267 |[39m       expect(result2[33m.[39mmov
ement[33m?[39m[33m.[39mid)[33m.[39mtoBe(result1[3
3m.[39mmovement[33m?[39m[33m.[39mid)[33m;[39m
     [90m 268 |[39m     })[33m;[39m
     [90m 269 |[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:266:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ 
createMovementWithBatchUpdate ÔÇ║ should atomically 
create movement and update batch quantity

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 301 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
createMovementWithBatchUpdate(request)[33m;[39m
     [90m 302 |[39m
    [31m[1m>[22m[39m[90m 303 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 304 |[39m       expect(result[33m.[39mmove
ment)[33m.[39mtoBeDefined()[33m;[39m
     [90m 305 |[39m
     [90m 306 |[39m       [90m// Verify batch 
quantity was updated[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:303:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ 
createMovementWithBatchUpdate ÔÇ║ should fail if batch 
quantity would go negative

    expect(received).toContain(expected) // indexOf

    Expected substring: "Insufficient batch quantity"
    Received string:    "batch.update is not a function"

    [0m [90m 324 |[39m
     [90m 325 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 326 |[39m       expect(re
sult[33m.[39merror)[33m.[39mtoContain([32m'Insuffic
ient batch quantity'[39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 327 |[39m
     [90m 328 |[39m       [90m// Verify batch 
quantity was not changed[39m
     [90m 329 |[39m       [36mconst[39m 
unchangedBatch [33m=[39m [36mawait[39m database[0m

      at Object.toContain (src/lib/inventory/__tests__/m
ovement-service.test.ts:326:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ 
createMovementWithBatchUpdate ÔÇ║ should handle 
idempotency with batch updates

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 349 |[39m       [90m// First call[39m
     [90m 350 |[39m       [36mconst[39m result1 
[33m=[39m [36mawait[39m 
createMovementWithBatchUpdate(request)[33m;[39m
    [31m[1m>[22m[39m[90m 351 |[39m       expect(re
sult1[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 352 |[39m       expect(result1[33m.[39misI
dempotentDuplicate)[33m.[39mtoBe([36mfalse[39m)[33m
;[39m
     [90m 353 |[39m
     [90m 354 |[39m       [36mconst[39m 
batchAfterFirst [33m=[39m [36mawait[39m database[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:351:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ 
createMovementWithBatchUpdate ÔÇ║ should handle UNIQUE 
constraint violation gracefully

    TypeError: batch.update is not a function

    [0m [90m 394 |[39m           [33m.[39m[36mget
[39m[33m<[39m[33mInventoryBatchModel[39m[33m>[39m(
[32m'inventory_batches'[39m)
     [90m 395 |[39m           
[33m.[39mfind(testBatch[33m.[39mid)[33m;[39m
    [31m[1m>[22m[39m[90m 396 |[39m         
[36mawait[39m batch[33m.[39mupdate((record) 
[33m=>[39m {
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 397 |[39m           
record[33m.[39mquantity [33m=[39m 
record[33m.[39mquantity [33m+[39m 
request[33m.[39mquantityDelta[33m;[39m
     [90m 398 |[39m         })[33m;[39m
     [90m 399 |[39m[0m

      at update (src/lib/inventory/__tests__/movement-se
rvice.test.ts:396:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ getMovementsForItem ÔÇ║ 
should retrieve all movements for an item

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 0
    Received array:  []

    [0m [90m 492 |[39m       [36mconst[39m 
movements [33m=[39m [36mawait[39m 
getMovementsForItem(testItem[33m.[39mid)[33m;[39m
     [90m 493 |[39m
    [31m[1m>[22m[39m[90m 494 |[39m       expect(mo
vements)[33m.[39mtoHaveLength([35m3[39m)[33m;[39m
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 495 |[39m       [90m// Should be sorted by 
created_at desc[39m
     [90m 496 |[39m       [90m// Debug: log the 
actual order[39m
     [90m 497 |[39m       console[33m.[39mlog([0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/movement-service.test.ts:494:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ getMovementsForItem ÔÇ║ 
should filter movements by type

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

    [0m [90m 509 |[39m       })[33m;[39m
     [90m 510 |[39m
    [31m[1m>[22m[39m[90m 511 |[39m       expect(mo
vements)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 512 |[39m       expect(movements[[35m0[39m
][33m.[39mtype)[33m.[39mtoBe([32m'consumption'[39m
)[33m;[39m
     [90m 513 |[39m     })[33m;[39m
     [90m 514 |[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/movement-service.test.ts:511:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ getMovementsForTask ÔÇ║ 
should retrieve movements linked to a task

    expect(received).toHaveLength(expected)

    Expected length: 2
    Received length: 0
    Received array:  []

    [0m [90m 547 |[39m       [36mconst[39m 
movements [33m=[39m [36mawait[39m 
getMovementsForTask(taskId)[33m;[39m
     [90m 548 |[39m
    [31m[1m>[22m[39m[90m 549 |[39m       expect(mo
vements)[33m.[39mtoHaveLength([35m2[39m)[33m;[39m
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 550 |[39m       
expect(movements[33m.[39mevery((m) [33m=>[39m 
m[33m.[39mtaskId [33m===[39m 
taskId))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 551 |[39m     })[33m;[39m
     [90m 552 |[39m   })[33m;[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/movement-service.test.ts:549:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ getMovementByExternalKey ÔÇ║ 
should retrieve movement by external key

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "test-ext-key-001"
    Received: undefined

    [0m [90m 568 |[39m
     [90m 569 |[39m       
expect(movement)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 570 |[39m       expect(mo
vement[33m?[39m[33m.[39mexternalKey)[33m.[39mtoBe(
externalKey)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 571 |[39m     })[33m;[39m
     [90m 572 |[39m
     [90m 573 |[39m     it([32m'should return null 
if external key not found'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:570:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ calculateStockFromMovements 
ÔÇ║ should calculate current stock from movements

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 450
    Received: 0

    [0m [90m 605 |[39m       [36mconst[39m stock 
[33m=[39m [36mawait[39m calculateStockFromMovements(
testItem[33m.[39mid)[33m;[39m
     [90m 606 |[39m
    [31m[1m>[22m[39m[90m 607 |[39m       
expect(stock)[33m.[39mtoBe([35m450[39m)[33m;[39m 
[90m// 500 - 100 + 50[39m
     [90m     |[39m                     
[31m[1m^[22m[39m
     [90m 608 |[39m     })[33m;[39m
     [90m 609 |[39m   })[33m;[39m
     [90m 610 |[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:607:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service ÔÇ║ 
calculateTotalCostFromMovements ÔÇ║ should calculate 
total cost from movements

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 7500
    Received: 0

    [0m [90m 630 |[39m       [36mconst[39m 
totalCost [33m=[39m 
calculateTotalCostFromMovements(movements)[33m;[39m
     [90m 631 |[39m
    [31m[1m>[22m[39m[90m 632 |[39m       expect(to
talCost)[33m.[39mtoBe([35m7500[39m)[33m;[39m 
[90m// (100 * 50) + (50 * 50)[39m
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 633 |[39m     })[33m;[39m
     [90m 634 |[39m
     [90m 635 |[39m     it([32m'should ignore 
movements without cost'[39m[33m,[39m [36masync[39m 
() [33m=>[39m {[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-service.test.ts:632:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/assessment/__tests__/image-storage.test.ts
  ÔùÅ Image Storage ÔÇ║ storeImage ÔÇ║ should store 
image with content-addressable filename

    Failed to store image

    [0m [90m 156 |[39m   } [36mcatch[39m (error) {
     [90m 157 |[39m     
console[33m.[39merror([32m'Failed to store 
image:'[39m[33m,[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 158 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
image'[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 159 |[39m   }
     [90m 160 |[39m }
     [90m 161 |[39m[0m

      at src/lib/assessment/image-storage.ts:158:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:160:2)
      at apply 
(src/lib/assessment/image-storage.ts:117:33)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:215:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ storeImage ÔÇ║ should sanitize 
assessmentId to prevent path traversal

    Failed to store image

    [0m [90m 156 |[39m   } [36mcatch[39m (error) {
     [90m 157 |[39m     
console[33m.[39merror([32m'Failed to store 
image:'[39m[33m,[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 158 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
image'[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 159 |[39m   }
     [90m 160 |[39m }
     [90m 161 |[39m[0m

      at src/lib/assessment/image-storage.ts:158:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:117:33)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:236:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ storeImage ÔÇ║ should add image 
to cache manager

    Failed to store image

    [0m [90m 156 |[39m   } [36mcatch[39m (error) {
     [90m 157 |[39m     
console[33m.[39merror([32m'Failed to store 
image:'[39m[33m,[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 158 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
image'[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 159 |[39m   }
     [90m 160 |[39m }
     [90m 161 |[39m[0m

      at src/lib/assessment/image-storage.ts:158:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:117:33)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:246:23)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ storeThumbnail ÔÇ║ should store 
thumbnail with filename key suffix

    Failed to store thumbnail

    [0m [90m 199 |[39m   } [36mcatch[39m (error) {
     [90m 200 |[39m     
console[33m.[39merror([32m'Failed to store 
thumbnail:'[39m[33m,[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
thumbnail'[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 202 |[39m   }
     [90m 203 |[39m }
     [90m 204 |[39m[0m

      at src/lib/assessment/image-storage.ts:201:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:203:2)
      at apply 
(src/lib/assessment/image-storage.ts:165:37)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:272:42)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ storeThumbnail ÔÇ║ should 
sanitize assessmentId to prevent path traversal

    Failed to store thumbnail

    [0m [90m 199 |[39m   } [36mcatch[39m (error) {
     [90m 200 |[39m     
console[33m.[39merror([32m'Failed to store 
thumbnail:'[39m[33m,[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
thumbnail'[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 202 |[39m   }
     [90m 203 |[39m }
     [90m 204 |[39m[0m

      at src/lib/assessment/image-storage.ts:201:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:165:37)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:292:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ storeThumbnail ÔÇ║ should add 
thumbnail to cache manager

    Failed to store thumbnail

    [0m [90m 199 |[39m   } [36mcatch[39m (error) {
     [90m 200 |[39m     
console[33m.[39merror([32m'Failed to store 
thumbnail:'[39m[33m,[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 201 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m'Failed to store 
thumbnail'[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 202 |[39m   }
     [90m 203 |[39m }
     [90m 204 |[39m[0m

      at src/lib/assessment/image-storage.ts:201:11
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/assessment/image-storage.ts:165:37)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/image-storage.test.ts:306:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ Image Storage ÔÇ║ deleteAssessmentImages ÔÇ║ 
should remove from cache and delete directory

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: StringContaining "assessment-123", 
{"idempotent": true}

    Number of calls: 0

    [0m [90m 349 |[39m         mockAssessmentId
     [90m 350 |[39m       )[33m;[39m
    [31m[1m>[22m[39m[90m 351 |[39m       expect([
33mFileSystem[39m[33m.[39mdeleteAsync)[33m.[39mtoHa
veBeenCalledWith(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 352 |[39m         expect[33m.[39mstringCon
taining(mockAssessmentId)[33m,[39m
     [90m 353 |[39m         { idempotent[33m:[39m 
[36mtrue[39m }
     [90m 354 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/assessment
/__tests__/image-storage.test.ts:351:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Image Storage ÔÇ║ deleteAssessmentImages ÔÇ║ 
should sanitize assessmentId to prevent path traversal

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 
"file:///documents/assessments/______root/"

    Number of calls: 0

    [0m [90m 364 |[39m       [36mawait[39m 
deleteAssessmentImages(maliciousId)[33m;[39m
     [90m 365 |[39m
    [31m[1m>[22m[39m[90m 366 |[39m       expect([
33mFileSystem[39m[33m.[39mgetInfoAsync)[33m.[39mtoH
aveBeenCalledWith(
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 367 |[39m         [32m`file:///documents/as
sessments/${sanitizedId}/`[39m
     [90m 368 |[39m       )[33m;[39m
     [90m 369 |[39m     })[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/assessment
/__tests__/image-storage.test.ts:366:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Image Storage ÔÇ║ cleanupOldAssessments ÔÇ║ 
should delete assessments older than retention period

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: StringContaining "old_assessment", 
{"idempotent": true}

    Number of calls: 0

    [0m [90m 407 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
cleanupOldAssessments([35m90[39m)[33m;[39m
     [90m 408 |[39m
    [31m[1m>[22m[39m[90m 409 |[39m       expect([
33mFileSystem[39m[33m.[39mdeleteAsync)[33m.[39mtoHa
veBeenCalledWith(
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 410 |[39m         expect[33m.[39mstringCon
taining([32m'old_assessment'[39m)[33m,[39m
     [90m 411 |[39m         { idempotent[33m:[39m 
[36mtrue[39m }
     [90m 412 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/assessment
/__tests__/image-storage.test.ts:409:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Image Storage ÔÇ║ cleanupOldAssessments ÔÇ║ 
should sanitize assessmentId to prevent path traversal

    expect(jest.fn()).toHaveBeenNthCalledWith(n, 
...expected)

    n: 2
    Expected: "file:///documents/assessments/___escape/"

    Number of calls: 0

    [0m [90m 432 |[39m       [36mawait[39m 
cleanupOldAssessments([35m90[39m)[33m;[39m
     [90m 433 |[39m
    [31m[1m>[22m[39m[90m 434 |[39m       expect([
33mFileSystem[39m[33m.[39mgetInfoAsync)[33m.[39mtoH
aveBeenNthCalledWith(
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 435 |[39m         [35m2[39m[33m,[39m
     [90m 436 |[39m         [32m`file:///documents/as
sessments/${sanitizedId}/`[39m
     [90m 437 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenNthCalledWith (src/lib/assessm
ent/__tests__/image-storage.test.ts:434:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Image Storage ÔÇ║ getAssessmentStorageSize ÔÇ║ 
should recursively calculate total size of all files in 
subdirectories

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 4500
    Received: 0

    [0m [90m 497 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
getAssessmentStorageSize()[33m;[39m
     [90m 498 |[39m
    [31m[1m>[22m[39m[90m 499 |[39m       expect(re
sult)[33m.[39mtoBe([35m4500[39m)[33m;[39m [90m// 
1000 + 2000 + 1500[39m
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 500 |[39m     })[33m;[39m
     [90m 501 |[39m   })[33m;[39m
     [90m 502 |[39m })[33m;[39m[0m

      at Object.toBe (src/lib/assessment/__tests__/image
-storage.test.ts:499:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/notifications/notification-manager.test.ts
  ÔùÅ NotificationManager Initialization ÔÇ║ 
initializes when permissions already granted

    TypeError: (0 , 
_iosCategories.registerNotificationCategories) is not a 
function

    [0m [90m 76 |[39m
     [90m 77 |[39m       [36mif[39m 
([33mPlatform[39m[33m.[39m[33mOS[39m 
[33m===[39m [32m'ios'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mawait[39m 
registerNotificationCategories()[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 79 |[39m       }
     [90m 80 |[39m
     [90m 81 |[39m       [36mconst[39m 
permissionGranted [33m=[39m[0m

      at 
src/lib/notifications/notification-manager.ts:78:45
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation 
(src/lib/notifications/notification-manager.ts:351:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at NotificationManager.operation 
(src/lib/notifications/notification-manager.ts:372:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as processQueue] 
(src/lib/notifications/notification-manager.ts:361:29)
      at processQueue 
(src/lib/notifications/notification-manager.ts:357:12)
      at NotificationManager.<anonymous> 
(src/lib/notifications/notification-manager.ts:348:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
enqueueOperation] 
(src/lib/notifications/notification-manager.ts:347:33)
      at NotificationManager.enqueueOperation 
(src/lib/notifications/notification-manager.ts:71:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as initialize] 
(src/lib/notifications/notification-manager.ts:70:19)
      at Object.initialize (src/lib/notifications/notifi
cation-manager.test.ts:199:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Initialization ÔÇ║ 
initializes without user information

    TypeError: (0 , 
_iosCategories.registerNotificationCategories) is not a 
function

    [0m [90m 76 |[39m
     [90m 77 |[39m       [36mif[39m 
([33mPlatform[39m[33m.[39m[33mOS[39m 
[33m===[39m [32m'ios'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mawait[39m 
registerNotificationCategories()[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 79 |[39m       }
     [90m 80 |[39m
     [90m 81 |[39m       [36mconst[39m 
permissionGranted [33m=[39m[0m

      at 
src/lib/notifications/notification-manager.ts:78:45
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation 
(src/lib/notifications/notification-manager.ts:351:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at NotificationManager.operation 
(src/lib/notifications/notification-manager.ts:372:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as processQueue] 
(src/lib/notifications/notification-manager.ts:361:29)
      at processQueue 
(src/lib/notifications/notification-manager.ts:357:12)
      at NotificationManager.<anonymous> 
(src/lib/notifications/notification-manager.ts:348:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
enqueueOperation] 
(src/lib/notifications/notification-manager.ts:347:33)
      at NotificationManager.enqueueOperation 
(src/lib/notifications/notification-manager.ts:71:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as initialize] 
(src/lib/notifications/notification-manager.ts:70:19)
      at Object.initialize (src/lib/notifications/notifi
cation-manager.test.ts:216:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Initialization ÔÇ║ skips 
registration when permission denied

    TypeError: (0 , 
_iosCategories.registerNotificationCategories) is not a 
function

    [0m [90m 76 |[39m
     [90m 77 |[39m       [36mif[39m 
([33mPlatform[39m[33m.[39m[33mOS[39m 
[33m===[39m [32m'ios'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mawait[39m 
registerNotificationCategories()[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 79 |[39m       }
     [90m 80 |[39m
     [90m 81 |[39m       [36mconst[39m 
permissionGranted [33m=[39m[0m

      at 
src/lib/notifications/notification-manager.ts:78:45
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation 
(src/lib/notifications/notification-manager.ts:351:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at NotificationManager.operation 
(src/lib/notifications/notification-manager.ts:372:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as processQueue] 
(src/lib/notifications/notification-manager.ts:361:29)
      at processQueue 
(src/lib/notifications/notification-manager.ts:357:12)
      at NotificationManager.<anonymous> 
(src/lib/notifications/notification-manager.ts:348:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
enqueueOperation] 
(src/lib/notifications/notification-manager.ts:347:33)
      at NotificationManager.enqueueOperation 
(src/lib/notifications/notification-manager.ts:71:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as initialize] 
(src/lib/notifications/notification-manager.ts:70:19)
      at Object.initialize (src/lib/notifications/notifi
cation-manager.test.ts:230:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Permissions ÔÇ║ requests 
permissions successfully

    TypeError: (0 , 
_iosCategories.registerNotificationCategories) is not a 
function

    [0m [90m 76 |[39m
     [90m 77 |[39m       [36mif[39m 
([33mPlatform[39m[33m.[39m[33mOS[39m 
[33m===[39m [32m'ios'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mawait[39m 
registerNotificationCategories()[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 79 |[39m       }
     [90m 80 |[39m
     [90m 81 |[39m       [36mconst[39m 
permissionGranted [33m=[39m[0m

      at 
src/lib/notifications/notification-manager.ts:78:45
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation 
(src/lib/notifications/notification-manager.ts:351:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at NotificationManager.operation 
(src/lib/notifications/notification-manager.ts:372:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as processQueue] 
(src/lib/notifications/notification-manager.ts:361:29)
      at processQueue 
(src/lib/notifications/notification-manager.ts:357:12)
      at NotificationManager.<anonymous> 
(src/lib/notifications/notification-manager.ts:348:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
enqueueOperation] 
(src/lib/notifications/notification-manager.ts:347:33)
      at NotificationManager.enqueueOperation 
(src/lib/notifications/notification-manager.ts:71:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as initialize] 
(src/lib/notifications/notification-manager.ts:70:19)
      at Object.initialize (src/lib/notifications/notifi
cation-manager.test.ts:246:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Permissions ÔÇ║ returns 
denial when permission request fails

    TypeError: Cannot read properties of undefined 
(reading 'requestNotificationPermission')

    [0m [90m 123 |[39m         }[33m;[39m
     [90m 124 |[39m
    [31m[1m>[22m[39m[90m 125 |[39m       
[36mconst[39m result [33m=[39m [36mawait[39m [33m
PermissionManager[39m[33m.[39mrequestNotificationPerm
ission()[33m;[39m
     [90m     |[39m                                   
           [31m[1m^[22m[39m
     [90m 126 |[39m       [36mif[39m (result 
[33m===[39m [32m'granted'[39m) {
     [90m 127 |[39m         [36mawait[39m 
registerAndroidChannels()[33m;[39m
     [90m 128 |[39m         [36mif[39m 
([36mthis[39m[33m.[39mcurrentUserId) {[0m

      at requestNotificationPermission 
(src/lib/notifications/notification-manager.ts:125:46)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation 
(src/lib/notifications/notification-manager.ts:351:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at NotificationManager.operation 
(src/lib/notifications/notification-manager.ts:372:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as processQueue] 
(src/lib/notifications/notification-manager.ts:361:29)
      at processQueue 
(src/lib/notifications/notification-manager.ts:357:12)
      at NotificationManager.<anonymous> 
(src/lib/notifications/notification-manager.ts:348:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
enqueueOperation] 
(src/lib/notifications/notification-manager.ts:347:33)
      at NotificationManager.enqueueOperation 
(src/lib/notifications/notification-manager.ts:118:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
requestPermissions] 
(src/lib/notifications/notification-manager.ts:117:27)
      at Object.requestPermissions (src/lib/notification
s/notification-manager.test.ts:266:34)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Local Notifications ÔÇ║ 
schedules local reminder through service

    TypeError: Cannot read properties of undefined 
(reading 'scheduleExactNotification')

    [0m [90m 215 |[39m     
threadId[33m?[39m[33m:[39m string[33m;[39m
     [90m 216 |[39m   })[33m:[39m 
[33mPromise[39m[33m<[39m[33mstring[39m[33m>[39m 
{
    [31m[1m>[22m[39m[90m 217 |[39m     
[36mreturn[39m [33mLocalNotificationService[39m[33m
.[39mscheduleExactNotification({
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 218 |[39m       title[33m:[39m 
request[33m.[39mtitle[33m,[39m
     [90m 219 |[39m       body[33m:[39m 
request[33m.[39mbody[33m,[39m
     [90m 220 |[39m       data[33m:[39m 
request[33m.[39mdata[33m,[39m[0m

      at NotificationManager.scheduleExactNotification 
(src/lib/notifications/notification-manager.ts:217:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
scheduleLocalReminder] 
(src/lib/notifications/notification-manager.ts:209:30)
      at Object.scheduleLocalReminder (src/lib/notificat
ions/notification-manager.test.ts:277:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Mutex Handling ÔÇ║ serializes 
concurrent initialize calls

    TypeError: (0 , 
_iosCategories.registerNotificationCategories) is not a 
function

    [0m [90m 76 |[39m
     [90m 77 |[39m       [36mif[39m 
([33mPlatform[39m[33m.[39m[33mOS[39m 
[33m===[39m [32m'ios'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mawait[39m 
registerNotificationCategories()[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 79 |[39m       }
     [90m 80 |[39m
     [90m 81 |[39m       [36mconst[39m 
permissionGranted [33m=[39m[0m

      at 
src/lib/notifications/notification-manager.ts:78:45
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at operation 
(src/lib/notifications/notification-manager.ts:351:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at NotificationManager.operation 
(src/lib/notifications/notification-manager.ts:372:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as processQueue] 
(src/lib/notifications/notification-manager.ts:361:29)
      at processQueue 
(src/lib/notifications/notification-manager.ts:357:12)
      at NotificationManager.<anonymous> 
(src/lib/notifications/notification-manager.ts:348:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as 
enqueueOperation] 
(src/lib/notifications/notification-manager.ts:347:33)
      at NotificationManager.enqueueOperation 
(src/lib/notifications/notification-manager.ts:71:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at NotificationManager.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at NotificationManager.apply [as initialize] 
(src/lib/notifications/notification-manager.ts:70:19)
      at Object.initialize (src/lib/notifications/notifi
cation-manager.test.ts:307:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Mutex Handling ÔÇ║ prevents 
operations once disposed

    TypeError: Cannot read properties of undefined 
(reading 'stopTokenListener')

    [0m [90m 232 |[39m     }
     [90m 233 |[39m     [33mPushReceiverService[39m
[33m.[39mremoveNotificationHandlers()[33m;[39m
    [31m[1m>[22m[39m[90m 234 |[39m     [33mPushNo
tificationService[39m[33m.[39mstopTokenListener()[33
m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 235 |[39m     
[36mthis[39m[33m.[39mlistenerUserId [33m=[39m 
[36mnull[39m[33m;[39m
     [90m 236 |[39m   }
     [90m 237 |[39m[0m

      at NotificationManager.stopTokenListener [as 
dispose] 
(src/lib/notifications/notification-manager.ts:234:29)
      at Object.dispose (src/lib/notifications/notificat
ion-manager.test.ts:325:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationManager Dispose ÔÇ║ cleans up token 
listener and subscriptions

    TypeError: Cannot read properties of undefined 
(reading 'stopTokenListener')

    [0m [90m 232 |[39m     }
     [90m 233 |[39m     [33mPushReceiverService[39m
[33m.[39mremoveNotificationHandlers()[33m;[39m
    [31m[1m>[22m[39m[90m 234 |[39m     [33mPushNo
tificationService[39m[33m.[39mstopTokenListener()[33
m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 235 |[39m     
[36mthis[39m[33m.[39mlistenerUserId [33m=[39m 
[36mnull[39m[33m;[39m
     [90m 236 |[39m   }
     [90m 237 |[39m[0m

      at NotificationManager.stopTokenListener [as 
dispose] 
(src/lib/notifications/notification-manager.ts:234:29)
      at Object.dispose (src/lib/notifications/notificat
ion-manager.test.ts:341:13)

FAIL 
src/lib/utils/__tests__/flashlist-performance.test.tsx
  ÔùÅ FlashList Performance Tests ÔÇ║ Rendering 
Performance ÔÇ║ should render 100 items efficiently

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 40 |[39m
     [90m 41 |[39m       render(
    [31m[1m>[22m[39m[90m 42 |[39m         
[33m<[39m[33mFlashList[39m
     [90m    |[39m         [31m[1m^[22m[39m
     [90m 43 |[39m           data[33m=[39m{tasks}
     [90m 44 |[39m           renderItem[33m=[39m{({ 
item }) [33m=>[39m [33m<[39m[33mTaskItem[39m 
item[33m=[39m{item} [33m/[39m[33m>[39m}
     [90m 45 |[39m           
testID[33m=[39m[32m"task-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:42:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Rendering 
Performance ÔÇ║ should render 1000 items efficiently

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 59 |[39m
     [90m 60 |[39m       render(
    [31m[1m>[22m[39m[90m 61 |[39m         
[33m<[39m[33mFlashList[39m
     [90m    |[39m         [31m[1m^[22m[39m
     [90m 62 |[39m           data[33m=[39m{tasks}
     [90m 63 |[39m           renderItem[33m=[39m{({ 
item }) [33m=>[39m [33m<[39m[33mTaskItem[39m 
item[33m=[39m{item} [33m/[39m[33m>[39m}
     [90m 64 |[39m           
testID[33m=[39m[32m"task-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:61:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Rendering 
Performance ÔÇ║ should render 5000 items efficiently

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 78 |[39m
     [90m 79 |[39m       render(
    [31m[1m>[22m[39m[90m 80 |[39m         
[33m<[39m[33mFlashList[39m
     [90m    |[39m         [31m[1m^[22m[39m
     [90m 81 |[39m           data[33m=[39m{tasks}
     [90m 82 |[39m           renderItem[33m=[39m{({ 
item }) [33m=>[39m [33m<[39m[33mTaskItem[39m 
item[33m=[39m{item} [33m/[39m[33m>[39m}
     [90m 83 |[39m           
testID[33m=[39m[32m"task-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:80:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Memory Usage ÔÇ║ 
should not leak memory with large datasets

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m  98 |[39m
     [90m  99 |[39m       [36mconst[39m { unmount } 
[33m=[39m render(
    [31m[1m>[22m[39m[90m 100 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 101 |[39m           data[33m=[39m{tasks}
     [90m 102 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 103 |[39m           
testID[33m=[39m[32m"task-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:100:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Scroll 
Performance ÔÇ║ should handle rapid data updates

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 131 |[39m       [36mconst[39m 
initialTasks [33m=[39m 
generateTasks([35m100[39m)[33m;[39m
     [90m 132 |[39m       [36mconst[39m { rerender 
} [33m=[39m render(
    [31m[1m>[22m[39m[90m 133 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 134 |[39m           
data[33m=[39m{initialTasks}
     [90m 135 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 136 |[39m           
testID[33m=[39m[32m"task-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:133:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Item Size 
Estimation ÔÇ║ should work without estimatedItemSize 
(FlashList v2 auto-sizing)

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 165 |[39m
     [90m 166 |[39m       render(
    [31m[1m>[22m[39m[90m 167 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 168 |[39m           data[33m=[39m{tasks}
     [90m 169 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 170 |[39m           [90m// No 
estimatedItemSize - FlashList v2 should handle 
this[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:167:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Item Size 
Estimation ÔÇ║ should handle variable item heights

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 195 |[39m
     [90m 196 |[39m       render(
    [31m[1m>[22m[39m[90m 197 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 198 |[39m           data[33m=[39m{tasks}
     [90m 199 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mVariableHeightItem[39m 
item[33m=[39m{item} [33m/[39m[33m>[39m}
     [90m 200 |[39m           
testID[33m=[39m[32m"task-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:197:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Playbook-specific 
scenarios ÔÇ║ should handle task timeline with 1000+ 
tasks

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 214 |[39m
     [90m 215 |[39m       render(
    [31m[1m>[22m[39m[90m 216 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 217 |[39m           data[33m=[39m{tasks}
     [90m 218 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 219 |[39m           
testID[33m=[39m[32m"playbook-timeline"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:216:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Playbook-specific 
scenarios ÔÇ║ should handle phase-grouped tasks 
efficiently

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 245 |[39m
     [90m 246 |[39m       render(
    [31m[1m>[22m[39m[90m 247 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 248 |[39m           data[33m=[39m{tasks}
     [90m 249 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 250 |[39m           
testID[33m=[39m[32m"phase-grouped-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:247:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Playbook-specific 
scenarios ÔÇ║ should handle filtered task views

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 268 |[39m
     [90m 269 |[39m       render(
    [31m[1m>[22m[39m[90m 270 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 271 |[39m           
data[33m=[39m{completedTasks}
     [90m 272 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 273 |[39m           
testID[33m=[39m[32m"filtered-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:270:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Performance 
Metrics ÔÇ║ should track render count for performance 
monitoring

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 294 |[39m
     [90m 295 |[39m       render(
    [31m[1m>[22m[39m[90m 296 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 297 |[39m           data[33m=[39m{tasks}
     [90m 298 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTrackedTaskItem[39m 
item[33m=[39m{item} [33m/[39m[33m>[39m}
     [90m 299 |[39m           
testID[33m=[39m[32m"tracked-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:296:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Performance 
Metrics ÔÇ║ should measure frame drops during updates

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 311 |[39m       [36mconst[39m tasks 
[33m=[39m generateTasks([35m500[39m)[33m;[39m
     [90m 312 |[39m       [36mconst[39m { rerender 
} [33m=[39m render(
    [31m[1m>[22m[39m[90m 313 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 314 |[39m           data[33m=[39m{tasks}
     [90m 315 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 316 |[39m           
testID[33m=[39m[32m"frame-test-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:313:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Edge Cases ÔÇ║ 
should handle empty list

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 354 |[39m     it([32m'should handle 
empty list'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m 355 |[39m       render(
    [31m[1m>[22m[39m[90m 356 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 357 |[39m           data[33m=[39m{[]}
     [90m 358 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 359 |[39m           
testID[33m=[39m[32m"empty-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:356:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Edge Cases ÔÇ║ 
should handle single item

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 370 |[39m
     [90m 371 |[39m       render(
    [31m[1m>[22m[39m[90m 372 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 373 |[39m           data[33m=[39m{tasks}
     [90m 374 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mTaskItem[39m item[33m=[39m{item} 
[33m/[39m[33m>[39m}
     [90m 375 |[39m           
testID[33m=[39m[32m"single-item-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:372:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ FlashList Performance Tests ÔÇ║ Edge Cases ÔÇ║ 
should handle very large items

    TypeError: Cannot read properties of undefined 
(reading 'displayName')

    [0m [90m 394 |[39m
     [90m 395 |[39m       render(
    [31m[1m>[22m[39m[90m 396 |[39m         
[33m<[39m[33mFlashList[39m
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 397 |[39m           data[33m=[39m{tasks}
     [90m 398 |[39m           
renderItem[33m=[39m{({ item }) [33m=>[39m 
[33m<[39m[33mLargeTaskItem[39m 
item[33m=[39m{item} [33m/[39m[33m>[39m}
     [90m 399 |[39m           
testID[33m=[39m[32m"large-item-list"[39m[0m

      at displayName (node_modules/react-native-css-inte
rop/src/runtime/third-party-libs/react-native-safe-area-
context.native.tsx:22:21)
      at node_modules/react-native-css-interop/src/runti
me/wrap-jsx.ts:21:39
      at Object.<anonymous> (src/lib/utils/__tests__/fla
shlist-performance.test.tsx:396:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/__tests__/sync-engine.test.ts
  ÔùÅ Sync Engine ÔÇ║ Offline-First Behavior ÔÇ║ should 
queue changes when offline

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

    [0m [90m 285 |[39m
     [90m 286 |[39m       [36mconst[39m 
pendingCount [33m=[39m [36mawait[39m 
getPendingChangesCount()[33m;[39m
    [31m[1m>[22m[39m[90m 287 |[39m       expect(pe
ndingCount)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;
[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 288 |[39m     })[33m;[39m
     [90m 289 |[39m
     [90m 290 |[39m     it([32m'should handle 
Last-Write-Wins conflict resolution'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toBeGreaterThan 
(src/lib/__tests__/sync-engine.test.ts:287:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/settings/__tests__/form-preservation.test.ts
  ÔùÅ Form Preservation Service ÔÇ║ preserveFormState 
ÔÇ║ saves form state to storage

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ preserveFormState 
ÔÇ║ includes validation state and dirty fields

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ restoreFormState 
ÔÇ║ returns null if no preserved state exists

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ restoreFormState 
ÔÇ║ returns preserved state if exists and not expired

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ restoreFormState 
ÔÇ║ returns null and clears if TTL expired

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ restoreFormState 
ÔÇ║ returns null and clears if parse error

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ clearPreservedState 
ÔÇ║ deletes preserved state from storage

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ 
clearAllPreservedStates ÔÇ║ deletes all preserved 
states from storage

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ hasPreservedState 
ÔÇ║ returns true if preserved state exists

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

  ÔùÅ Form Preservation Service ÔÇ║ hasPreservedState 
ÔÇ║ returns false if preserved state does not exist

    TypeError: Cannot read properties of undefined 
(reading 'mockReturnValue')

    [0m [90m 22 |[39m     mockStorage[33m.[39m[36m
set[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
     [90m 23 |[39m     mockStorage[33m.[39m[36mdele
te[39m[33m.[39mmockImplementation(() [33m=>[39m 
{})[33m;[39m
    [31m[1m>[22m[39m[90m 24 |[39m     mockStorage
[33m.[39mcontains[33m.[39mmockReturnValue([36mfalse
[39m)[33m;[39m
     [90m    |[39m                          
[31m[1m^[22m[39m
     [90m 25 |[39m     mockStorage[33m.[39mgetAllKey
s[33m.[39mmockReturnValue([])[33m;[39m
     [90m 26 |[39m   })[33m;[39m
     [90m 27 |[39m[0m

      at Object.mockReturnValue (src/lib/settings/__test
s__/form-preservation.test.ts:24:26)

FAIL src/lib/__tests__/sentry-pii-leak-sentinel.test.ts
  ÔùÅ Sentry PII Leak Sentinel ÔÇ║ beforeSend Hook - 
PII Detection ÔÇ║ redacts Cookie and Set-Cookie headers

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "[REDACTED]"
    Received: undefined

    [0m [90m 194 |[39m
     [90m 195 |[39m       expect(scrubbed)[33m.[39mn
ot[33m.[39mtoBeNull()[33m;[39m
    [31m[1m>[22m[39m[90m 196 |[39m       expect(sc
rubbed[33m?[39m[33m.[39mrequest[33m?[39m[33m.[39
mheaders[33m?[39m[33m.[39m[33mCookie[39m)[33m.[3
9mtoBe([32m'[REDACTED]'[39m)[33m;[39m
     [90m     |[39m                                   
               [31m[1m^[22m[39m
     [90m 197 |[39m       expect(scrubbed[33m?[39m[
33m.[39mrequest[33m?[39m[33m.[39mheaders[33m?[39m
[33m.[39m[[32m'Set-Cookie'[39m])[33m.[39mtoBe([32
m'[REDACTED]'[39m)[33m;[39m
     [90m 198 |[39m     })[33m;[39m
     [90m 199 |[39m[0m

      at Object.toBe (src/lib/__tests__/sentry-pii-leak-
sentinel.test.ts:196:50)

  ÔùÅ Sentry PII Leak Sentinel ÔÇ║ beforeSend Hook - 
PII Detection ÔÇ║ removes email from user context

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "[EMAIL_REDACTED]"
    Received: undefined

    [0m [90m 239 |[39m
     [90m 240 |[39m       expect(scrubbed)[33m.[39mn
ot[33m.[39mtoBeNull()[33m;[39m
    [31m[1m>[22m[39m[90m 241 |[39m       expect(sc
rubbed[33m?[39m[33m.[39muser[33m?[39m[33m.[39mem
ail)[33m.[39mtoBe([32m'[EMAIL_REDACTED]'[39m)[33m;
[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 242 |[39m     })[33m;[39m
     [90m 243 |[39m
     [90m 244 |[39m     test([32m'returns null if 
crashReporting consent is not given'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/__tests__/sentry-pii-leak-
sentinel.test.ts:241:37)

  ÔùÅ Sentry PII Leak Sentinel ÔÇ║ beforeBreadcrumb 
Hook - PII Detection ÔÇ║ scrubs HTTP request data in 
HTTP-type breadcrumbs

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "[REDACTED]"
    Received: undefined

    [0m [90m 300 |[39m
     [90m 301 |[39m       expect(scrubbed)[33m.[39mn
ot[33m.[39mtoBeNull()[33m;[39m
    [31m[1m>[22m[39m[90m 302 |[39m       expect(sc
rubbed[33m?[39m[33m.[39mdata[33m?[39m[33m.[39mhe
aders[33m?[39m[33m.[39m[33mAuthorization[39m)[33m
.[39mtoBe([32m'[REDACTED]'[39m)[33m;[39m
     [90m     |[39m                                   
                   [31m[1m^[22m[39m
     [90m 303 |[39m       expect(scrubbed[33m?[39m[
33m.[39mdata[33m?[39m[33m.[39mheaders[33m?[39m[3
3m.[39m[33mCookie[39m)[33m.[39mtoBe([32m'[REDACTED
]'[39m)[33m;[39m
     [90m 304 |[39m       expect(scrubbed[33m?[39m[
33m.[39mdata[33m?[39m[33m.[39mbody)[33m.[39mtoBe(
[32m'[REDACTED_AUTH_ENDPOINT]'[39m)[33m;[39m
     [90m 305 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/__tests__/sentry-pii-leak-
sentinel.test.ts:302:54)

FAIL src/lib/inventory/__tests__/deduction-integration.t
est.ts
  ÔùÅ Inventory Deduction Integration ÔÇ║ Basic 
Deduction ÔÇ║ should deduce inventory successfully with 
task completion

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 104 |[39m       })[33m;[39m
     [90m 105 |[39m
    [31m[1m>[22m[39m[90m 106 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 107 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 108 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mquantityDelta)[33m.[39mto
Be([33m-[39m[35m100[39m)[33m;[39m
     [90m 109 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mcostPerUnitMinor)[33m.[39
mtoBe([35m50[39m)[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/deduct
ion-integration.test.ts:106:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Basic 
Deduction ÔÇ║ should prevent duplicate deductions with 
idempotency key

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 149 |[39m       [90m// First 
deduction[39m
     [90m 150 |[39m       [36mconst[39m result1 
[33m=[39m [36mawait[39m 
deduceInventory(database[33m,[39m 
deductionRequest)[33m;[39m
    [31m[1m>[22m[39m[90m 151 |[39m       expect(re
sult1[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 152 |[39m       expect(result1[33m.[39mmov
ements)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 153 |[39m
     [90m 154 |[39m       [90m// Second deduction 
with same key[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/deduct
ion-integration.test.ts:151:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Basic 
Deduction ÔÇ║ should return resolved deduction map with 
actual deducted quantities in idempotency retries

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 198 |[39m       [90m// First deduction 
- should deduct 25 units[39m
     [90m 199 |[39m       [36mconst[39m result1 
[33m=[39m [36mawait[39m 
deduceInventory(database[33m,[39m 
deductionRequest)[33m;[39m
    [31m[1m>[22m[39m[90m 200 |[39m       expect(re
sult1[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 201 |[39m       expect(result1[33m.[39mmov
ements)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 202 |[39m       expect(result1[33m.[39mmov
ements[[35m0[39m][33m.[39mquantityDelta)[33m.[39mt
oBe([33m-[39m[35m25[39m)[33m;[39m
     [90m 203 |[39m       expect(result1[33m.[39mded
uctionMap)[33m.[39mtoHaveLength([35m1[39m)[33m;[39
m[0m

      at Object.toBe (src/lib/inventory/__tests__/deduct
ion-integration.test.ts:200:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ FEFO Picking 
ÔÇ║ should consume from batch expiring soonest (FEFO)

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 269 |[39m       })[33m;[39m
     [90m 270 |[39m
    [31m[1m>[22m[39m[90m 271 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 272 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 273 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mbatchId)[33m.[39mtoBe(bat
ch2[33m.[39mid)[33m;[39m
     [90m 274 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mcostPerUnitMinor)[33m.[39
mtoBe([35m60[39m)[33m;[39m [90m// FIFO cost from 
batch2[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/deduct
ion-integration.test.ts:271:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ FEFO Picking 
ÔÇ║ should exclude expired batches by default

    expect(received).toHaveLength(expected)

    Matcher error: received value must have a length 
property whose value must be a number

    Received has value: undefined

    [0m [90m 322 |[39m
     [90m 323 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 324 |[39m       expect(re
sult[33m.[39minsufficientItems)[33m.[39mtoHaveLength
([35m1[39m)[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 325 |[39m       expect(result[33m.[39minsu
fficientItems[33m![39m[[35m0[39m][33m.[39mavailabl
e)[33m.[39mtoBe([35m0[39m)[33m;[39m
     [90m 326 |[39m     })[33m;[39m
     [90m 327 |[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/deduction-integration.test.ts:324:40)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ FEFO Picking 
ÔÇ║ should allow expired batch consumption with override

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 360 |[39m       })[33m;[39m
     [90m 361 |[39m
    [31m[1m>[22m[39m[90m 362 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 363 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 364 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mbatchId)[33m.[39mtoBe(exp
iredBatch[33m.[39mid)[33m;[39m
     [90m 365 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/deduct
ion-integration.test.ts:362:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Insufficient 
Stock Handling ÔÇ║ should return insufficient stock 
error with recovery options

    expect(received).toHaveLength(expected)

    Matcher error: received value must have a length 
property whose value must be a number

    Received has value: undefined

    [0m [90m 401 |[39m
     [90m 402 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 403 |[39m       expect(re
sult[33m.[39minsufficientItems)[33m.[39mtoHaveLength
([35m1[39m)[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 404 |[39m
     [90m 405 |[39m       [36mconst[39m error 
[33m=[39m result[33m.[39minsufficientItems[33m![39
m[[35m0[39m][33m;[39m
     [90m 406 |[39m       expect(error[33m.[39mrequi
red)[33m.[39mtoBe([35m50[39m)[33m;[39m[0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/deduction-integration.test.ts:403:40)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Insufficient 
Stock Handling ÔÇ║ should handle partial completion 
consuming available stock

    TypeError: Cannot read properties of undefined 
(reading '0')

    [0m [90m 446 |[39m
     [90m 447 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 448 |[39m       
[36mconst[39m error [33m=[39m result[33m.[39minsuf
ficientItems[33m![39m[[35m0[39m][33m;[39m
     [90m     |[39m                                   
          [31m[1m^[22m[39m
     [90m 449 |[39m
     [90m 450 |[39m       [90m// Handle partial 
completion[39m
     [90m 451 |[39m       [36mconst[39m movements 
[33m=[39m [36mawait[39m handlePartialComplete({[0m

      at Object.<anonymous> (src/lib/inventory/__tests__
/deduction-integration.test.ts:448:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Insufficient 
Stock Handling ÔÇ║ should handle skip deduction with 
marker movement

    TypeError: Cannot read properties of undefined 
(reading '0')

    [0m [90m 490 |[39m
     [90m 491 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 492 |[39m       
[36mconst[39m error [33m=[39m result[33m.[39minsuf
ficientItems[33m![39m[[35m0[39m][33m;[39m
     [90m     |[39m                                   
          [31m[1m^[22m[39m
     [90m 493 |[39m
     [90m 494 |[39m       [90m// Handle skip[39m
     [90m 495 |[39m       [36mconst[39m movements 
[33m=[39m [36mawait[39m handleSkipDeduction({[0m

      at Object.<anonymous> (src/lib/inventory/__tests__
/deduction-integration.test.ts:492:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Deduction Integration ÔÇ║ Multi-Batch 
Consumption ÔÇ║ should split consumption across 
multiple batches with FIFO costing

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 554 |[39m       })[33m;[39m
     [90m 555 |[39m
    [31m[1m>[22m[39m[90m 556 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 557 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m2[39m)[33m;[39m
     [90m 558 |[39m
     [90m 559 |[39m       [90m// First movement from 
batch1 (50ml @ $0.50)[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/deduct
ion-integration.test.ts:556:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/media/__tests__/photo-storage-service.test.ts
  ÔùÅ photo-storage-service ÔÇ║ downloadRemoteImage ÔÇ║ 
should download and store remote image successfully

    Remote image host "example.com" is not allowlisted

    [0m [90m 241 |[39m
     [90m 242 |[39m   [36mif[39m ([33m![39mallowed
RemoteImageHosts[33m.[39mhas(host)) {
    [31m[1m>[22m[39m[90m 243 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Remote image host "${host}" is 
not allowlisted`[39m)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 244 |[39m   }
     [90m 245 |[39m
     [90m 246 |[39m   [36mif[39m ([0m

      at assertAllowedRemoteUri 
(src/lib/media/photo-storage-service.ts:243:11)
      at assertAllowedRemoteUri 
(src/lib/media/photo-storage-service.ts:59:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/media/photo-storage-service.ts:133:2)
      at apply 
(src/lib/media/photo-storage-service.ts:55:42)
      at Object.<anonymous> (src/lib/media/__tests__/pho
to-storage-service.test.ts:489:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ photo-storage-service ÔÇ║ downloadRemoteImage ÔÇ║ 
should throw error when FileSystem is unavailable

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 510 |[39m         [90m// Re-import a 
fresh instance of the module under test so it reads 
the[39m
     [90m 511 |[39m         [90m// mocked Paths 
during module initialization.[39m
    [31m[1m>[22m[39m[90m 512 |[39m         
[36mconst[39m { downloadRemoteImage[33m:[39m 
downloadRemoteImageFresh } [33m=[39m [36mawait[39m 
[36mimport[39m(
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 513 |[39m           
[32m'../photo-storage-service'[39m
     [90m 514 |[39m         )[33m;[39m
     [90m 515 |[39m[0m

      at Object.<anonymous> (src/lib/media/__tests__/pho
to-storage-service.test.ts:512:9)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ photo-storage-service ÔÇ║ downloadRemoteImage ÔÇ║ 
should handle fetch errors

    expect(received).rejects.toThrow(expected)

    Expected substring: "Failed to fetch remote image: 
Network error"
    Received message:   "Remote image host 
\"example.com\" is not allowlisted"

        [0m [90m 241 |[39m
         [90m 242 |[39m   [36mif[39m ([33m![39mall
owedRemoteImageHosts[33m.[39mhas(host)) {
        [31m[1m>[22m[39m[90m 243 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Remote image host "${host}" is 
not allowlisted`[39m)[33m;[39m
         [90m     |[39m           [31m[1m^[22m[39m
         [90m 244 |[39m   }
         [90m 245 |[39m
         [90m 246 |[39m   [36mif[39m ([0m

      at assertAllowedRemoteUri 
(src/lib/media/photo-storage-service.ts:243:11)
      at assertAllowedRemoteUri 
(src/lib/media/photo-storage-service.ts:59:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/media/photo-storage-service.ts:55:42)
      at Object.<anonymous> (src/lib/media/__tests__/pho
to-storage-service.test.ts:540:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/media/__tests__/photo-s
torage-service.test.ts:541:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ photo-storage-service ÔÇ║ downloadRemoteImage ÔÇ║ 
should reject non-image content types

    expect(received).rejects.toThrow(expected)

    Expected substring: "Remote file is not an image"
    Received message:   "Remote image host 
\"example.com\" is not allowlisted"

        [0m [90m 241 |[39m
         [90m 242 |[39m   [36mif[39m ([33m![39mall
owedRemoteImageHosts[33m.[39mhas(host)) {
        [31m[1m>[22m[39m[90m 243 |[39m     
[36mthrow[39m [36mnew[39m 
[33mError[39m([32m`Remote image host "${host}" is 
not allowlisted`[39m)[33m;[39m
         [90m     |[39m           [31m[1m^[22m[39m
         [90m 244 |[39m   }
         [90m 245 |[39m
         [90m 246 |[39m   [36mif[39m ([0m

      at assertAllowedRemoteUri 
(src/lib/media/photo-storage-service.ts:243:11)
      at assertAllowedRemoteUri 
(src/lib/media/photo-storage-service.ts:59:21)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/media/photo-storage-service.ts:55:42)
      at Object.<anonymous> (src/lib/media/__tests__/pho
to-storage-service.test.ts:562:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow (src/lib/media/__tests__/photo-s
torage-service.test.ts:563:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/harvest/harvest-notification-service.test.ts
  ÔùÅ Harvest Notification Service ÔÇ║ 
scheduleStageReminder ÔÇ║ should schedule target 
duration notification successfully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 106 |[39m       )[33m;[39m
     [90m 107 |[39m
    [31m[1m>[22m[39m[90m 108 |[39m       expect(re
sult[33m.[39mscheduled)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 109 |[39m       expect(result[33m.[39mnoti
ficationId)[33m.[39mtoBe([32m'notification-id-123'[3
9m)[33m;[39m
     [90m 110 |[39m       expect([33mNotifications[3
9m[33m.[39mscheduleNotificationAsync)[33m.[39mtoHave
BeenCalledWith(
     [90m 111 |[39m         
expect[33m.[39mobjectContaining({[0m

      at Object.toBe (src/lib/harvest/harvest-notificati
on-service.test.ts:108:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Harvest Notification Service ÔÇ║ 
scheduleStageReminder ÔÇ║ should request permissions if 
not granted

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 175 |[39m         [33mNotificationHandl
er[39m[33m.[39mrequestPermissionWithPrimer
     [90m 176 |[39m       
)[33m.[39mtoHaveBeenCalled()[33m;[39m
    [31m[1m>[22m[39m[90m 177 |[39m       expect(re
sult[33m.[39mscheduled)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 178 |[39m     })[33m;[39m
     [90m 179 |[39m
     [90m 180 |[39m     it([32m'should handle 
permission denial gracefully'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/harvest/harvest-notificati
on-service.test.ts:177:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Harvest Notification Service ÔÇ║ 
scheduleOverdueReminder ÔÇ║ should schedule overdue 
notification successfully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 210 |[39m       )[33m;[39m
     [90m 211 |[39m
    [31m[1m>[22m[39m[90m 212 |[39m       expect(re
sult[33m.[39mscheduled)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 213 |[39m       expect(result[33m.[39mnoti
ficationId)[33m.[39mtoBe([32m'notification-id-123'[3
9m)[33m;[39m
     [90m 214 |[39m       expect([33mNotifications[3
9m[33m.[39mscheduleNotificationAsync)[33m.[39mtoHave
BeenCalledWith(
     [90m 215 |[39m         
expect[33m.[39mobjectContaining({[0m

      at Object.toBe (src/lib/harvest/harvest-notificati
on-service.test.ts:212:32)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/auth/connectivity-handler.test.ts
  ÔùÅ connectivity-handler ÔÇ║ useConnectivityHandler 
ÔÇ║ should subscribe to connectivity changes

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: Any<Function>

    Number of calls: 0

    [0m [90m 86 |[39m       [36mconst[39m { 
unmount } [33m=[39m renderHook(() [33m=>[39m 
useConnectivityHandler())[33m;[39m
     [90m 87 |[39m
    [31m[1m>[22m[39m[90m 88 |[39m       expect(moc
kOnConnectivityChange)[33m.[39mtoHaveBeenCalledWith(
     [90m    |[39m                                    
    [31m[1m^[22m[39m
     [90m 89 |[39m         
expect[33m.[39many([33mFunction[39m)
     [90m 90 |[39m       )[33m;[39m
     [90m 91 |[39m[0m

      at Object.toHaveBeenCalledWith 
(src/lib/auth/connectivity-handler.test.ts:88:40)

  ÔùÅ connectivity-handler ÔÇ║ useConnectivityHandler 
ÔÇ║ should validate session when connectivity is 
restored

    TypeError: connectivityCallback is not a function

    [0m [90m 109 |[39m
     [90m 110 |[39m       [90m// Simulate going 
offline[39m
    [31m[1m>[22m[39m[90m 111 |[39m       
connectivityCallback[33m![39m({
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 112 |[39m         type[33m:[39m 
[32m'wifi'[39m[33m,[39m
     [90m 113 |[39m         isConnected[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 114 |[39m         
isInternetReachable[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.connectivityCallback 
(src/lib/auth/connectivity-handler.test.ts:111:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ connectivity-handler ÔÇ║ useConnectivityHandler 
ÔÇ║ should not validate if already online

    TypeError: connectivityCallback is not a function

    [0m [90m 146 |[39m
     [90m 147 |[39m       [90m// Simulate staying 
online[39m
    [31m[1m>[22m[39m[90m 148 |[39m       
connectivityCallback[33m![39m({
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 149 |[39m         type[33m:[39m 
[32m'wifi'[39m[33m,[39m
     [90m 150 |[39m         isConnected[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 151 |[39m         
isInternetReachable[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.connectivityCallback 
(src/lib/auth/connectivity-handler.test.ts:148:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ connectivity-handler ÔÇ║ useConnectivityHandler 
ÔÇ║ should handle failed session validation

    TypeError: connectivityCallback is not a function

    [0m [90m 179 |[39m
     [90m 180 |[39m       [90m// Simulate offline 
then online[39m
    [31m[1m>[22m[39m[90m 181 |[39m       
connectivityCallback[33m![39m({
     [90m     |[39m       [31m[1m^[22m[39m
     [90m 182 |[39m         type[33m:[39m 
[32m'wifi'[39m[33m,[39m
     [90m 183 |[39m         isConnected[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 184 |[39m         
isInternetReachable[33m:[39m 
[36mfalse[39m[33m,[39m[0m

      at Object.connectivityCallback 
(src/lib/auth/connectivity-handler.test.ts:181:7)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/moderation/moderation-notification-service.
test.ts
  ÔùÅ ModerationNotificationService ÔÇ║ 
sendSLABreachAlert ÔÇ║ should log moderator alert

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "moderator_alert_log"

    Number of calls: 0

    [0m [90m 328 |[39m       [36mawait[39m service
[33m.[39msendSLABreachAlert(alertData)[33m;[39m
     [90m 329 |[39m
    [31m[1m>[22m[39m[90m 330 |[39m       expect(su
pabase[33m.[39m[36mfrom[39m)[33m.[39mtoHaveBeenCal
ledWith([32m'moderator_alert_log'[39m)[33m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 331 |[39m     })[33m;[39m
     [90m 332 |[39m   })[33m;[39m
     [90m 333 |[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/moderation-notification-service.test.ts:330:29)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModerationNotificationService ÔÇ║ Email 
notification requirements ÔÇ║ should send email for 
content removal

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "send-moderation-email", Any<Object>

    Number of calls: 0

    [0m [90m 429 |[39m       [36mawait[39m service
[33m.[39msendStatementOfReasons(userId[33m,[39m 
decision[33m,[39m mockStatement)[33m;[39m
     [90m 430 |[39m
    [31m[1m>[22m[39m[90m 431 |[39m       expect(su
pabase[33m.[39mfunctions[33m.[39minvoke)[33m.[39mt
oHaveBeenCalledWith(
     [90m     |[39m                                   
      [31m[1m^[22m[39m
     [90m 432 |[39m         
[32m'send-moderation-email'[39m[33m,[39m
     [90m 433 |[39m         
expect[33m.[39many([33mObject[39m)
     [90m 434 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/moderation-notification-service.test.ts:431:41)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModerationNotificationService ÔÇ║ Email 
notification requirements ÔÇ║ should send email for 
account suspension

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "send-moderation-email", Any<Object>

    Number of calls: 0

    [0m [90m 444 |[39m       [36mawait[39m service
[33m.[39msendStatementOfReasons(userId[33m,[39m 
decision[33m,[39m mockStatement)[33m;[39m
     [90m 445 |[39m
    [31m[1m>[22m[39m[90m 446 |[39m       expect(su
pabase[33m.[39mfunctions[33m.[39minvoke)[33m.[39mt
oHaveBeenCalledWith(
     [90m     |[39m                                   
      [31m[1m^[22m[39m
     [90m 447 |[39m         
[32m'send-moderation-email'[39m[33m,[39m
     [90m 448 |[39m         
expect[33m.[39many([33mObject[39m)
     [90m 449 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/moderation-notification-service.test.ts:446:41)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModerationNotificationService ÔÇ║ Appeal deadline 
calculation ÔÇ║ should calculate 14-day deadline for 
content removal

    TypeError: Cannot read properties of undefined 
(reading '1')

    [0m [90m 474 |[39m
     [90m 475 |[39m       [36mconst[39m emailCall 
[33m=[39m 
(supabase[33m.[39mfunctions[33m.[39minvoke 
[36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmo
ck[33m.[39mcalls[[35m0[39m][33m;[39m
    [31m[1m>[22m[39m[90m 476 |[39m       
[36mconst[39m appealDeadline [33m=[39m 
[36mnew[39m [33mDate[39m(emailCall[[35m1[39m][33m
.[39mbody[33m.[39mappealDeadline)[33m;[39m
     [90m     |[39m                                   
             [31m[1m^[22m[39m
     [90m 477 |[39m       [36mconst[39m daysDiff 
[33m=[39m [33mMath[39m[33m.[39mceil(
     [90m 478 |[39m         
(appealDeadline[33m.[39mgetTime() [33m-[39m 
[33mDate[39m[33m.[39mnow()) [33m/[39m 
([35m1000[39m [33m*[39m [35m60[39m [33m*[39m 
[35m60[39m [33m*[39m [35m24[39m)
     [90m 479 |[39m       )[33m;[39m[0m

      at Object.<anonymous> (src/lib/moderation/moderati
on-notification-service.test.ts:476:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModerationNotificationService ÔÇ║ Appeal deadline 
calculation ÔÇ║ should calculate 30-day deadline for 
account suspension

    TypeError: Cannot read properties of undefined 
(reading '1')

    [0m [90m 492 |[39m
     [90m 493 |[39m       [36mconst[39m emailCall 
[33m=[39m 
(supabase[33m.[39mfunctions[33m.[39minvoke 
[36mas[39m jest[33m.[39m[33mMock[39m)[33m.[39mmo
ck[33m.[39mcalls[[35m0[39m][33m;[39m
    [31m[1m>[22m[39m[90m 494 |[39m       
[36mconst[39m appealDeadline [33m=[39m 
[36mnew[39m [33mDate[39m(emailCall[[35m1[39m][33m
.[39mbody[33m.[39mappealDeadline)[33m;[39m
     [90m     |[39m                                   
             [31m[1m^[22m[39m
     [90m 495 |[39m       [36mconst[39m daysDiff 
[33m=[39m [33mMath[39m[33m.[39mceil(
     [90m 496 |[39m         
(appealDeadline[33m.[39mgetTime() [33m-[39m 
[33mDate[39m[33m.[39mnow()) [33m/[39m 
([35m1000[39m [33m*[39m [35m60[39m [33m*[39m 
[35m60[39m [33m*[39m [35m24[39m)
     [90m 497 |[39m       )[33m;[39m[0m

      at Object.<anonymous> (src/lib/moderation/moderati
on-notification-service.test.ts:494:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/assessment/__tests__/model-manager.test.ts
  ÔùÅ ModelManager ÔÇ║ initialize ÔÇ║ should initialize 
successfully and load metadata

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "file:///models/", {"intermediates": true}

    Number of calls: 0

    [0m [90m 83 |[39m
     [90m 84 |[39m       expect(mockGetModelPaths)[33
m.[39mtoHaveBeenCalled()[33m;[39m
    [31m[1m>[22m[39m[90m 85 |[39m       expect(moc
kFileSystem[33m.[39mmakeDirectoryAsync)[33m.[39mtoHa
veBeenCalledWith(
     [90m    |[39m                                    
             [31m[1m^[22m[39m
     [90m 86 |[39m         
mockModelPaths[33m.[39mbaseDir[33m,[39m
     [90m 87 |[39m         { intermediates[33m:[39m 
[36mtrue[39m }
     [90m 88 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/assessment
/__tests__/model-manager.test.ts:85:49)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModelManager ÔÇ║ initialize ÔÇ║ should throw 
error on initialization failure

    expect(received).rejects.toThrow()

    Received promise resolved instead of rejected
    Resolved to value: undefined

    [0m [90m 105 |[39m       )[33m;[39m
     [90m 106 |[39m
    [31m[1m>[22m[39m[90m 107 |[39m       
[36mawait[39m expect(modelManager[33m.[39minitialize
())[33m.[39mrejects[33m.[39mtoThrow(
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 108 |[39m         [32m'Failed to 
initialize model manager'[39m
     [90m 109 |[39m       )[33m;[39m
     [90m 110 |[39m     })[33m;[39m[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect (src/lib/assessment/__tests__/mod
el-manager.test.ts:107:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/inventory/__tests__/inventory-sync-integrat
ion.test.ts
  ÔùÅ Inventory Sync Integration ÔÇ║ Offline CRUD 
Operations (Requirement 7.4) ÔÇ║ should create 
inventory item offline and queue for sync

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Test Nutrient"
    Received: undefined

    [0m [90m 50 |[39m
     [90m 51 |[39m       
expect(item)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 52 |[39m       
expect(item[33m.[39mname)[33m.[39mtoBe([32m'Test 
Nutrient'[39m)[33m;[39m
     [90m    |[39m                         
[31m[1m^[22m[39m
     [90m 53 |[39m       expect(item[33m.[39mtrackin
gMode)[33m.[39mtoBe([32m'batched'[39m)[33m;[39m
     [90m 54 |[39m
     [90m 55 |[39m       [90m// Verify item is in 
local database[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:52:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Offline CRUD 
Operations (Requirement 7.4) ÔÇ║ should create batch 
offline with proper relations

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "mock-id"
    Received: undefined

    [0m [90m 83 |[39m
     [90m 84 |[39m       
expect(batch)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 85 |[39m       expect(bat
ch[33m.[39mitemId)[33m.[39mtoBe(item[33m.[39mid)[
33m;[39m
     [90m    |[39m                            
[31m[1m^[22m[39m
     [90m 86 |[39m       expect(batch[33m.[39mlotNum
ber)[33m.[39mtoBe([32m'LOT-2025-001'[39m)[33m;[39m
     [90m 87 |[39m       expect(batch[33m.[39mquanti
ty)[33m.[39mtoBe([35m100[39m)[33m;[39m
     [90m 88 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:85:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Offline CRUD 
Operations (Requirement 7.4) ÔÇ║ should create movement 
offline (create-only)

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "receipt"
    Received: undefined

    [0m [90m 117 |[39m
     [90m 118 |[39m       
expect(movement)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 119 |[39m       expect(mo
vement[33m.[39mtype)[33m.[39mtoBe([32m'receipt'[39
m)[33m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 120 |[39m       expect(movement[33m.[39mqu
antityDelta)[33m.[39mtoBe([35m500[39m)[33m;[39m
     [90m 121 |[39m       expect(movement[33m.[39mex
ternalKey)[33m.[39mtoBe([32m'test-receipt-001'[39m)
[33m;[39m
     [90m 122 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:119:29)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Movement 
Immutability (Requirements 1.4, 10.6) ÔÇ║ should not 
allow updating movements

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 100
    Received: undefined

    [0m [90m 156 |[39m
     [90m 157 |[39m       
expect(movement)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 158 |[39m       expect(mo
vement[33m.[39mquantityDelta)[33m.[39mtoBe([35m100
[39m)[33m;[39m
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 159 |[39m
     [90m 160 |[39m       [90m// Note: Client-side 
update is technically possible in WatermelonDB,[39m
     [90m 161 |[39m       [90m// but sync-engine.ts 
filters out updated/deleted movements before 
push[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:158:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Movement 
Immutability (Requirements 1.4, 10.6) ÔÇ║ should 
support idempotency via external_key

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "idempotent-receipt-123"
    Received: undefined

    [0m [90m 195 |[39m
     [90m 196 |[39m       
expect(movement1)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 197 |[39m       expect(mo
vement1[33m.[39mexternalKey)[33m.[39mtoBe(externalKe
y)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 198 |[39m
     [90m 199 |[39m       [90m// Check for existing 
movement with same external_key before creating 
duplicate[39m
     [90m 200 |[39m       [36mconst[39m 
existingMovement [33m=[39m [36mawait[39m 
movementsCollection[0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:197:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Offline Workflow 
(Requirement 7.4) ÔÇ║ should support flight-mode 
workflow: create item ÔåÆ add batch ÔåÆ consume

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 1000
    Received: undefined

    [0m [90m 239 |[39m       })[33m;[39m
     [90m 240 |[39m
    [31m[1m>[22m[39m[90m 241 |[39m       expect(ba
tch[33m.[39mquantity)[33m.[39mtoBe([35m1000[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 242 |[39m
     [90m 243 |[39m       [90m// Step 3: Consume via 
task offline[39m
     [90m 244 |[39m       [36mconst[39m 
consumptionMovement[33m:[39m 
[33mInventoryMovementModel[39m [33m=[39m 
[36mawait[39m database[33m.[39mwrite([0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:241:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Sync Field 
Integrity ÔÇ║ should store server sync fields correctly

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 1
    Received: undefined

    [0m [90m 293 |[39m       })[33m;[39m
     [90m 294 |[39m
    [31m[1m>[22m[39m[90m 295 |[39m       expect(it
em[33m.[39mserverRevision)[33m.[39mtoBe([35m1[39m)
[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 296 |[39m       expect(item[33m.[39mserver
UpdatedAtMs)[33m.[39mtoBeDefined()[33m;[39m
     [90m 297 |[39m     })[33m;[39m
     [90m 298 |[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/invent
ory-sync-integration.test.ts:295:35)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Inventory Sync Integration ÔÇ║ Sync Field 
Integrity ÔÇ║ should support soft delete via deleted_at 
tombstones

    TypeError: item.markAsDeleted is not a function

    [0m [90m 312 |[39m       [90m// Mark as 
deleted[39m
     [90m 313 |[39m       [36mawait[39m 
database[33m.[39mwrite([36masync[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 314 |[39m         
[36mawait[39m 
item[33m.[39mmarkAsDeleted()[33m;[39m
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 315 |[39m       })[33m;[39m
     [90m 316 |[39m
     [90m 317 |[39m       [90m// Verify deletedAt 
timestamp is set (WatermelonDB field name)[39m[0m

      at markAsDeleted (src/lib/inventory/__tests__/inve
ntory-sync-integration.test.ts:314:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at Object.fn (jest-setup.ts:513:16)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.apply (jest-setup.ts:514:8)
      at Object.write (src/lib/inventory/__tests__/inven
tory-sync-integration.test.ts:313:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/moderation/config/moderation-config.test.ts
  ÔùÅ ModerationConfig ÔÇ║ Feature Flags ÔÇ║ all 
features disabled in production by default

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 153 |[39m
     [90m 154 |[39m       expect(config[33m.[39menvi
ronment)[33m.[39mtoBe([32m'production'[39m)[33m;[3
9m
    [31m[1m>[22m[39m[90m 155 |[39m       expect(co
nfig[33m.[39mfeatures[33m.[39mcontentReporting)[33m
.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                                   
             [31m[1m^[22m[39m
     [90m 156 |[39m       expect(config[33m.[39mfeat
ures[33m.[39mmoderationQueue)[33m.[39mtoBe([36mfals
e[39m)[33m;[39m
     [90m 157 |[39m       expect(config[33m.[39mfeat
ures[33m.[39mappeals)[33m.[39mtoBe([36mfalse[39m)
[33m;[39m
     [90m 158 |[39m       expect(config[33m.[39mfeat
ures[33m.[39modsIntegration)[33m.[39mtoBe([36mfalse
[39m)[33m;[39m[0m

      at Object.toBe (src/lib/moderation/config/moderati
on-config.test.ts:155:48)

  ÔùÅ ModerationConfig ÔÇ║ Feature Flags ÔÇ║ features 
enabled in development by default

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 176 |[39m       expect(config[33m.[39m
environment)[33m.[39mtoBe([32m'development'[39m)[33
m;[39m
     [90m 177 |[39m       expect(config[33m.[39mfeat
ures[33m.[39mcontentReporting)[33m.[39mtoBe([36mtru
e[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m       expect(co
nfig[33m.[39mfeatures[33m.[39mmoderationQueue)[33m.
[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                                   
            [31m[1m^[22m[39m
     [90m 179 |[39m       expect(config[33m.[39mfeat
ures[33m.[39mappeals)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m 180 |[39m
     [90m 181 |[39m       
process[33m.[39menv[33m.[39m[33mAPP_ENV[39m 
[33m=[39m originalEnv[33m;[39m[0m

      at Object.toBe (src/lib/moderation/config/moderati
on-config.test.ts:178:47)

FAIL src/lib/community/__tests__/offline-workflow-integr
ation.test.ts
  ÔùÅ Offline Workflow Integration Tests ÔÇ║ Complete 
offline workflow ÔÇ║ should queue comment while offline 
and sync on reconnect

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"body": "Offline comment", "post_id": 
"post-1"}, "idem-key-1", "client-tx-1"

    Number of calls: 0

    [0m [90m 121 |[39m       [36mawait[39m 
processor[33m.[39mprocessQueue()[33m;[39m
     [90m 122 |[39m
    [31m[1m>[22m[39m[90m 123 |[39m       expect(mo
ckApiClient[33m.[39mcreateComment)[33m.[39mtoHaveBee
nCalledWith(
     [90m     |[39m                                   
        [31m[1m^[22m[39m
     [90m 124 |[39m         { post_id[33m:[39m 
[32m'post-1'[39m[33m,[39m body[33m:[39m 
[32m'Offline comment'[39m }[33m,[39m
     [90m 125 |[39m         
mockEntry[33m.[39midempotencyKey[33m,[39m
     [90m 126 |[39m         
mockEntry[33m.[39mclientTxId[0m

      at Object.toHaveBeenCalledWith (src/lib/community/
__tests__/offline-workflow-integration.test.ts:123:43)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Offline Workflow Integration Tests ÔÇ║ Complete 
offline workflow ÔÇ║ should process multiple queued 
actions in FIFO order

    expect(jest.fn()).toHaveBeenCalledTimes(expected)

    Expected number of calls: 1
    Received number of calls: 0

    [0m [90m 153 |[39m       [90m// Verify FIFO 
order (check that all operations completed)[39m
     [90m 154 |[39m       expect(mockApiClient[33m.[
39mlikePost)[33m.[39mtoHaveBeenCalledTimes([35m1[39m
)[33m;[39m
    [31m[1m>[22m[39m[90m 155 |[39m       expect(mo
ckApiClient[33m.[39mcreateComment)[33m.[39mtoHaveBee
nCalledTimes([35m1[39m)[33m;[39m
     [90m     |[39m                                   
        [31m[1m^[22m[39m
     [90m 156 |[39m       expect(mockApiClient[33m.[
39munlikePost)[33m.[39mtoHaveBeenCalledTimes([35m1[3
9m)[33m;[39m
     [90m 157 |[39m     })[33m;[39m
     [90m 158 |[39m   })[33m;[39m[0m

      at Object.toHaveBeenCalledTimes (src/lib/community
/__tests__/offline-workflow-integration.test.ts:155:43)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Offline Workflow Integration Tests ÔÇ║ Target 
deleted scenarios ÔÇ║ should drop comment action when 
post is deleted

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

    [0m [90m 438 |[39m       [36mawait[39m 
processor[33m.[39mprocessQueue()[33m;[39m
     [90m 439 |[39m
    [31m[1m>[22m[39m[90m 440 |[39m       expect(mo
ckEntry[33m.[39mdestroyPermanently)[33m.[39mtoHaveBe
enCalled()[33m;[39m
     [90m     |[39m                                   
         [31m[1m^[22m[39m
     [90m 441 |[39m     })[33m;[39m
     [90m 442 |[39m   })[33m;[39m
     [90m 443 |[39m[0m

      at Object.toHaveBeenCalled (src/lib/community/__te
sts__/offline-workflow-integration.test.ts:440:44)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/assessment/__tests__/cloud-inference-client
.test.ts
  ÔùÅ CloudInferenceClient ÔÇ║ uploads images and 
returns inference result

    TypeError: Crypto.randomUUID is not a function

    [0m [90m 40 |[39m     [36mtry[39m {
     [90m 41 |[39m       [90m// Use provided 
idempotency key or generate new one[39m
    [31m[1m>[22m[39m[90m 42 |[39m       
[36mconst[39m requestIdempotencyKey [33m=[39m 
idempotencyKey [33m||[39m 
[33mCrypto[39m[33m.[39mrandomUUID()[33m;[39m
     [90m    |[39m                                    
                          [31m[1m^[22m[39m
     [90m 43 |[39m
     [90m 44 |[39m       [90m// Upload images to 
storage and get signed URLs[39m
     [90m 45 |[39m       [36mconst[39m 
uploadedImages [33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39muploadImages(photos[33m,[39m 
assessmentId)[33m;[39m[0m

      at CloudInferenceClient.randomUUID 
(src/lib/assessment/cloud-inference-client.ts:42:62)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CloudInferenceClient.<anonymous> (node_modules/
@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at CloudInferenceClient.apply [as predict] 
(src/lib/assessment/cloud-inference-client.ts:33:16)
      at Object.predict (src/lib/assessment/__tests__/cl
oud-inference-client.test.ts:165:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ CloudInferenceClient ÔÇ║ throws when edge 
function responds with error payload

    expect(received).rejects.toMatchObject(expected)

    - Expected  - 5
    + Received  + 1

    - Object {
    -   "code": "MODEL_FAILURE",
    -   "message": "Model execution failed",
    -   "retryable": true,
    - }
    + [TypeError: Crypto.randomUUID is not a function]

    [0m [90m 207 |[39m         
assessmentId[33m:[39m 
[32m'assessment-1'[39m[33m,[39m
     [90m 208 |[39m       })
    [31m[1m>[22m[39m[90m 209 |[39m     
)[33m.[39mrejects[33m.[39mtoMatchObject({
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 210 |[39m       code[33m:[39m 
[32m'MODEL_FAILURE'[39m[33m,[39m
     [90m 211 |[39m       message[33m:[39m 
[32m'Model execution failed'[39m[33m,[39m
     [90m 212 |[39m       retryable[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.toMatchObject 
(node_modules/expect/build/index.js:218:22)
      at Object.toMatchObject (src/lib/assessment/__test
s__/cloud-inference-client.test.ts:209:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ CloudInferenceClient ÔÇ║ uses provided 
idempotency key instead of generating new one

    Model execution failed



  ÔùÅ CloudInferenceClient ÔÇ║ handles 409 conflict by 
treating as successful upload

    TypeError: Crypto.randomUUID is not a function

    [0m [90m 40 |[39m     [36mtry[39m {
     [90m 41 |[39m       [90m// Use provided 
idempotency key or generate new one[39m
    [31m[1m>[22m[39m[90m 42 |[39m       
[36mconst[39m requestIdempotencyKey [33m=[39m 
idempotencyKey [33m||[39m 
[33mCrypto[39m[33m.[39mrandomUUID()[33m;[39m
     [90m    |[39m                                    
                          [31m[1m^[22m[39m
     [90m 43 |[39m
     [90m 44 |[39m       [90m// Upload images to 
storage and get signed URLs[39m
     [90m 45 |[39m       [36mconst[39m 
uploadedImages [33m=[39m [36mawait[39m 
[36mthis[39m[33m.[39muploadImages(photos[33m,[39m 
assessmentId)[33m;[39m[0m

      at CloudInferenceClient.randomUUID 
(src/lib/assessment/cloud-inference-client.ts:42:62)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at CloudInferenceClient.<anonymous> (node_modules/
@babel/runtime/helpers/asyncToGenerator.js:14:12)
      at CloudInferenceClient.apply [as predict] 
(src/lib/assessment/cloud-inference-client.ts:33:16)
      at Object.predict (src/lib/assessment/__tests__/cl
oud-inference-client.test.ts:245:33)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/moderation/sor-submission-orchestrator.test.ts
  ÔùÅ SoRSubmissionOrchestrator ÔÇ║ submit - happy path 
ÔÇ║ handles queue enqueue failure

    expect(received).toContain(expected) // indexOf

    Expected substring: "Failed to enqueue SoR"
    Received string:    "Database connection failed"

    [0m [90m 243 |[39m
     [90m 244 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 245 |[39m       expect(re
sult[33m.[39merror)[33m.[39mtoContain([32m'Failed 
to enqueue SoR'[39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 246 |[39m       expect(result[33m.[39mwasQ
ueued)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 247 |[39m     })[33m;[39m
     [90m 248 |[39m[0m

      at Object.toContain (src/lib/moderation/sor-submis
sion-orchestrator.test.ts:245:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ SoRSubmissionOrchestrator ÔÇ║ submit - happy path 
ÔÇ║ handles API submission failure within circuit 
breaker

    expect(received).toContain(expected) // indexOf

    Expected substring: "Submission failed"
    Received string:    "API timeout"

    [0m [90m 328 |[39m       expect(result[33m.[39m
wasQueued)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 329 |[39m       expect(result[33m.[39mgrac
efullyDegraded)[33m.[39mtoBe([36mtrue[39m)[33m;[39
m
    [31m[1m>[22m[39m[90m 330 |[39m       expect(re
sult[33m.[39merror)[33m.[39mtoContain([32m'Submissi
on failed'[39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 331 |[39m
     [90m 332 |[39m       [90m// Verify status 
update was called with failure[39m
     [90m 333 |[39m       expect(sorExportQueueManager
[33m.[39mupdateStatus)[33m.[39mtoHaveBeenCalledWith(
{[0m

      at Object.toContain (src/lib/moderation/sor-submis
sion-orchestrator.test.ts:330:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ SoRSubmissionOrchestrator ÔÇ║ processPendingQueue 
ÔÇ║ handles empty queue gracefully

    expect(received).not.toHaveBeenCalled()

    Matcher error: received value must be a mock or spy 
function

    Received has type:  function
    Received has value: [Function fetchStatement]

    [0m [90m 411 |[39m       [36mawait[39m 
orchestrator[33m.[39mprocessPendingQueue()[33m;[39m
     [90m 412 |[39m
    [31m[1m>[22m[39m[90m 413 |[39m       expect(or
chestrator[[32m'fetchStatement'[39m])[33m.[39mnot[3
3m.[39mtoHaveBeenCalled()[33m;[39m
     [90m     |[39m                                   
               [31m[1m^[22m[39m
     [90m 414 |[39m       expect(orchestrator[33m.[3
9msubmit)[33m.[39mnot[33m.[39mtoHaveBeenCalled()[33
m;[39m
     [90m 415 |[39m     })[33m;[39m
     [90m 416 |[39m[0m

      at Object.toHaveBeenCalled (src/lib/moderation/sor
-submission-orchestrator.test.ts:413:50)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ SoRSubmissionOrchestrator ÔÇ║ processPendingQueue 
ÔÇ║ handles individual item processing errors gracefully

    expect(received).not.toHaveBeenCalled()

    Matcher error: received value must be a mock or spy 
function

    Received has type:  function
    Received has value: [Function submit]

    [0m [90m 447 |[39m       [90m// Should not 
throw, should log error[39m
     [90m 448 |[39m       [36mawait[39m expect(orche
strator[33m.[39mprocessPendingQueue())[33m.[39mresol
ves[33m.[39mnot[33m.[39mtoThrow()[33m;[39m
    [31m[1m>[22m[39m[90m 449 |[39m       expect(or
chestrator[33m.[39msubmit)[33m.[39mnot[33m.[39mtoH
aveBeenCalled()[33m;[39m
     [90m     |[39m                                   
    [31m[1m^[22m[39m
     [90m 450 |[39m     })[33m;[39m
     [90m 451 |[39m   })[33m;[39m
     [90m 452 |[39m[0m

      at Object.toHaveBeenCalled (src/lib/moderation/sor
-submission-orchestrator.test.ts:449:39)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ SoRSubmissionOrchestrator ÔÇ║ health checks ÔÇ║ 
reports unhealthy system when latency SLA breached

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 518 |[39m       [36mconst[39m health 
[33m=[39m [36mawait[39m 
orchestrator[33m.[39mcheckHealth()[33m;[39m
     [90m 519 |[39m
    [31m[1m>[22m[39m[90m 520 |[39m       expect(he
alth[33m.[39mhealthy)[33m.[39mtoBe([36mfalse[39m)
[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 521 |[39m       expect(health[33m.[39mlate
ncySLABreached)[33m.[39mtoBe([36mtrue[39m)[33m;[39
m
     [90m 522 |[39m     })[33m;[39m
     [90m 523 |[39m   })[33m;[39m[0m

      at Object.toBe (src/lib/moderation/sor-submission-
orchestrator.test.ts:520:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/community/idempotency-service.test.ts
  ÔùÅ IdempotencyService ÔÇ║ processWithIdempotency ÔÇ║ 
processes new request successfully

    TypeError: _supabase.supabase.from(...).update is 
not a function

    [0m [90m 182 |[39m     [36mawait[39m supabase
     [90m 183 |[39m       
[33m.[39m[36mfrom[39m([32m'idempotency_keys'[39m)
    [31m[1m>[22m[39m[90m 184 |[39m       
[33m.[39mupdate({
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 185 |[39m         status[33m:[39m 
[32m'failed'[39m[33m,[39m
     [90m 186 |[39m         error_details[33m:[39m 
errorDetails[33m,[39m
     [90m 187 |[39m         expires_at[33m:[39m 
[36mnew[39m [33mDate[39m([0m

      at IdempotencyService.update 
(src/lib/community/idempotency-service.ts:184:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at IdempotencyService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at IdempotencyService.apply [as markAsFailed] 
(src/lib/community/idempotency-service.ts:166:29)
      at IdempotencyService.markAsFailed 
(src/lib/community/idempotency-service.ts:69:18)
          at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)

  ÔùÅ IdempotencyService ÔÇ║ processWithIdempotency ÔÇ║ 
returns cached result for completed request

    TypeError: _supabase.supabase.from(...).update is 
not a function

    [0m [90m 182 |[39m     [36mawait[39m supabase
     [90m 183 |[39m       
[33m.[39m[36mfrom[39m([32m'idempotency_keys'[39m)
    [31m[1m>[22m[39m[90m 184 |[39m       
[33m.[39mupdate({
     [90m     |[39m        [31m[1m^[22m[39m
     [90m 185 |[39m         status[33m:[39m 
[32m'failed'[39m[33m,[39m
     [90m 186 |[39m         error_details[33m:[39m 
errorDetails[33m,[39m
     [90m 187 |[39m         expires_at[33m:[39m 
[36mnew[39m [33mDate[39m([0m

      at IdempotencyService.update 
(src/lib/community/idempotency-service.ts:184:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at IdempotencyService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at IdempotencyService.apply [as markAsFailed] 
(src/lib/community/idempotency-service.ts:166:29)
      at IdempotencyService.markAsFailed 
(src/lib/community/idempotency-service.ts:69:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ IdempotencyService ÔÇ║ processWithIdempotency ÔÇ║ 
throws error for processing request

    expect(received).rejects.toThrow(expected)

    Expected substring: "Request already being 
processed"
    Received message:   
"_supabase.supabase.from(...).update is not a function"

        [0m [90m 182 |[39m     [36mawait[39m 
supabase
         [90m 183 |[39m       
[33m.[39m[36mfrom[39m([32m'idempotency_keys'[39m)
        [31m[1m>[22m[39m[90m 184 |[39m       
[33m.[39mupdate({
         [90m     |[39m        [31m[1m^[22m[39m
         [90m 185 |[39m         status[33m:[39m 
[32m'failed'[39m[33m,[39m
         [90m 186 |[39m         
error_details[33m:[39m errorDetails[33m,[39m
         [90m 187 |[39m         expires_at[33m:[39m 
[36mnew[39m [33mDate[39m([0m

      at IdempotencyService.update 
(src/lib/community/idempotency-service.ts:184:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at IdempotencyService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at IdempotencyService.apply [as markAsFailed] 
(src/lib/community/idempotency-service.ts:166:29)
      at IdempotencyService.markAsFailed 
(src/lib/community/idempotency-service.ts:69:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow 
(src/lib/community/idempotency-service.test.ts:138:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ IdempotencyService ÔÇ║ processWithIdempotency ÔÇ║ 
handles operation failure and marks as failed

    expect(received).rejects.toThrow(expected)

    Expected substring: "Operation failed"
    Received message:   
"_supabase.supabase.from(...).update is not a function"

        [0m [90m 182 |[39m     [36mawait[39m 
supabase
         [90m 183 |[39m       
[33m.[39m[36mfrom[39m([32m'idempotency_keys'[39m)
        [31m[1m>[22m[39m[90m 184 |[39m       
[33m.[39mupdate({
         [90m     |[39m        [31m[1m^[22m[39m
         [90m 185 |[39m         status[33m:[39m 
[32m'failed'[39m[33m,[39m
         [90m 186 |[39m         
error_details[33m:[39m errorDetails[33m,[39m
         [90m 187 |[39m         expires_at[33m:[39m 
[36mnew[39m [33mDate[39m([0m

      at IdempotencyService.update 
(src/lib/community/idempotency-service.ts:184:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at IdempotencyService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at IdempotencyService.apply [as markAsFailed] 
(src/lib/community/idempotency-service.ts:166:29)
      at IdempotencyService.markAsFailed 
(src/lib/community/idempotency-service.ts:69:18)
                at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow 
(src/lib/community/idempotency-service.test.ts:179:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ IdempotencyService ÔÇ║ processWithIdempotency ÔÇ║ 
throws error when key claim fails due to existing key

    expect(received).rejects.toThrow(expected)

    Expected substring: "Request already being 
processed"
    Received message:   
"_supabase.supabase.from(...).update is not a function"

        [0m [90m 182 |[39m     [36mawait[39m 
supabase
         [90m 183 |[39m       
[33m.[39m[36mfrom[39m([32m'idempotency_keys'[39m)
        [31m[1m>[22m[39m[90m 184 |[39m       
[33m.[39mupdate({
         [90m     |[39m        [31m[1m^[22m[39m
         [90m 185 |[39m         status[33m:[39m 
[32m'failed'[39m[33m,[39m
         [90m 186 |[39m         
error_details[33m:[39m errorDetails[33m,[39m
         [90m 187 |[39m         expires_at[33m:[39m 
[36mnew[39m [33mDate[39m([0m

      at IdempotencyService.update 
(src/lib/community/idempotency-service.ts:184:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at IdempotencyService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at IdempotencyService.apply [as markAsFailed] 
(src/lib/community/idempotency-service.ts:166:29)
      at IdempotencyService.markAsFailed 
(src/lib/community/idempotency-service.ts:69:18)
                at Generator.throw (<anonymous>)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _throw (node_modules/@babel/runtime/helpers/asy
ncToGenerator.js:20:9)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow 
(src/lib/community/idempotency-service.test.ts:213:17)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ IdempotencyService ÔÇ║ cleanupExpiredKeys ÔÇ║ 
cleans up expired keys successfully

    expect(received).resolves.toBeUndefined()

    Received promise rejected instead of resolved
    Rejected to value: [TypeError: 
_supabase.supabase.from(...).delete(...).lt is not a 
function]

    [0m [90m 226 |[39m       })[33m;[39m
     [90m 227 |[39m
    [31m[1m>[22m[39m[90m 228 |[39m       
[36mawait[39m expect(service[33m.[39mcleanupExpiredK
eys())[33m.[39mresolves[33m.[39mtoBeUndefined()[33m
;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 229 |[39m       expect(mockDelete)[33m.[39
mtoHaveBeenCalled()[33m;[39m
     [90m 230 |[39m     })[33m;[39m
     [90m 231 |[39m[0m

      at expect 
(node_modules/expect/build/index.js:113:15)
      at Object.expect 
(src/lib/community/idempotency-service.test.ts:228:13)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ IdempotencyService ÔÇ║ cleanupExpiredKeys ÔÇ║ 
throws error on cleanup failure

    expect(received).rejects.toThrow(expected)

    Expected substring: "Failed to cleanup expired 
keys: Cleanup failed"
    Received message:   
"_supabase.supabase.from(...).delete(...).lt is not a 
function"

        [0m [90m 277 |[39m       
[33m.[39m[36mfrom[39m([32m'idempotency_keys'[39m)
         [90m 278 |[39m       
[33m.[39m[36mdelete[39m()
        [31m[1m>[22m[39m[90m 279 |[39m       
[33m.[39mlt([32m'expires_at'[39m[33m,[39m 
[36mnew[39m [33mDate[39m()[33m.[39mtoISOString())
         [90m     |[39m        [31m[1m^[22m[39m
         [90m 280 |[39m       
[33m.[39m[36min[39m([32m'status'[39m[33m,[39m 
[[32m'completed'[39m[33m,[39m 
[32m'failed'[39m])[33m;[39m
         [90m 281 |[39m
         [90m 282 |[39m     [36mif[39m (error) {[0m

      at IdempotencyService.lt 
(src/lib/community/idempotency-service.ts:279:8)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at IdempotencyService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at IdempotencyService.apply [as 
cleanupExpiredKeys] 
(src/lib/community/idempotency-service.ts:275:27)
      at Object.cleanupExpiredKeys 
(src/lib/community/idempotency-service.test.ts:242:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)
      at Object.toThrow 
(node_modules/expect/build/index.js:218:22)
      at Object.toThrow 
(src/lib/community/idempotency-service.test.ts:242:58)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/media/photo-access.test.ts
  ÔùÅ photo-access (PHPicker path) ÔÇ║ returns 
granted=false on cancel

    expect(received).toEqual(expected) // deep equality

    Expected: []
    Received: undefined

    [0m [90m 18 |[39m     [36mconst[39m res 
[33m=[39m [36mawait[39m 
requestSelectedPhotos()[33m;[39m
     [90m 19 |[39m     expect(res[33m.[39mgranted)[
33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 20 |[39m     expect(res[
33m.[39mselection)[33m.[39mtoEqual([])[33m;[39m
     [90m    |[39m                           
[31m[1m^[22m[39m
     [90m 21 |[39m     expect(res[33m.[39mreselectio
nSupported)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 22 |[39m     expect([33mImagePicker[39m[3
3m.[39mlaunchImageLibraryAsync)[33m.[39mtoHaveBeenCal
ledTimes([35m1[39m)[33m;[39m
     [90m 23 |[39m   })[33m;[39m[0m

      at Object.toEqual 
(src/lib/media/photo-access.test.ts:20:27)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/inventory/__tests__/movement-integration.test.ts
  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Idempotency with external_key ÔÇ║ should 
return same movement on retry with same external_key

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 75 |[39m       [36mconst[39m result2 
[33m=[39m [36mawait[39m 
createMovement(request)[33m;[39m
     [90m 76 |[39m       expect(result2[33m.[39msucc
ess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 77 |[39m       expect(res
ult2[33m.[39misIdempotentDuplicate)[33m.[39mtoBe([3
6mtrue[39m)[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 78 |[39m       expect(result2[33m.[39mmove
ment[33m?[39m[33m.[39mid)[33m.[39mtoBe(movementId1
)[33m;[39m
     [90m 79 |[39m
     [90m 80 |[39m       [90m// Third retry[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-integration.test.ts:77:45)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Idempotency with external_key ÔÇ║ should 
handle batch updates idempotently

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 106 |[39m       [90m// First attempt - 
should update batch[39m
     [90m 107 |[39m       [36mconst[39m result1 
[33m=[39m [36mawait[39m 
createMovementWithBatchUpdate(request)[33m;[39m
    [31m[1m>[22m[39m[90m 108 |[39m       expect(re
sult1[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 109 |[39m       expect(result1[33m.[39misI
dempotentDuplicate)[33m.[39mtoBe([36mfalse[39m)[33m
;[39m
     [90m 110 |[39m
     [90m 111 |[39m       [36mconst[39m 
batchAfterFirst [33m=[39m [36mawait[39m database[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-integration.test.ts:108:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Idempotency with external_key ÔÇ║ should 
handle different requests with unique external_keys

    expect(received).not.toBe(expected) // Object.is 
equality

    Expected: not "mock-id"

    [0m [90m 164 |[39m       expect(result1[33m.[39
msuccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 165 |[39m       expect(result2[33m.[39msuc
cess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 166 |[39m       expect(re
sult1[33m.[39mmovement[33m?[39m[33m.[39mid)[33m.
[39mnot[33m.[39mtoBe(result2[33m.[39mmovement[33m?
[39m[33m.[39mid)[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 167 |[39m
     [90m 168 |[39m       [36mconst[39m movements 
[33m=[39m [36mawait[39m 
getMovementsForItem(testItem[33m.[39mid)[33m;[39m
     [90m 169 |[39m       expect(movements)[33m.[39m
toHaveLength([35m2[39m)[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-integration.test.ts:166:40)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Concurrent operations with same 
external_key ÔÇ║ should handle concurrent creation 
attempts

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

    [0m [90m 201 |[39m         (r) [33m=>[39m 
r[33m.[39misIdempotentDuplicate
     [90m 202 |[39m       
)[33m.[39mlength[33m;[39m
    [31m[1m>[22m[39m[90m 203 |[39m       expect(du
plicateCount)[33m.[39mtoBeGreaterThan([35m0[39m)[33
m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 204 |[39m
     [90m 205 |[39m       [90m// All should return 
same movement ID[39m
     [90m 206 |[39m       [36mconst[39m movementIds 
[33m=[39m results[33m.[39mmap((r) [33m=>[39m r[33
m.[39mmovement[33m?[39m[33m.[39mid)[33m;[39m[0m

      at Object.toBeGreaterThan (src/lib/inventory/__tes
ts__/movement-integration.test.ts:203:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Concurrent operations with same 
external_key ÔÇ║ should handle concurrent batch updates

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 238 |[39m       [90m// All should 
succeed[39m
     [90m 239 |[39m       
results[33m.[39mforEach((result) [33m=>[39m {
    [31m[1m>[22m[39m[90m 240 |[39m         expect(
result[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                                
[31m[1m^[22m[39m
     [90m 241 |[39m       })[33m;[39m
     [90m 242 |[39m
     [90m 243 |[39m       [90m// Verify batch was 
only updated once[39m[0m

      at toBe (src/lib/inventory/__tests__/movement-inte
gration.test.ts:240:32)
          at Array.forEach (<anonymous>)
      at Object.forEach (src/lib/inventory/__tests__/mov
ement-integration.test.ts:239:15)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Transaction rollback scenarios ÔÇ║ should 
rollback movement if batch update fails

    expect(received).toContain(expected) // indexOf

    Expected substring: "Insufficient batch quantity"
    Received string:    "batch.update is not a function"

    [0m [90m 263 |[39m
     [90m 264 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 265 |[39m       expect(re
sult[33m.[39merror)[33m.[39mtoContain([32m'Insuffic
ient batch quantity'[39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 266 |[39m
     [90m 267 |[39m       [90m// Verify no movement 
was created[39m
     [90m 268 |[39m       [36mconst[39m movements 
[33m=[39m [36mawait[39m getMovementsForItem(testItem
[33m.[39mid)[33m;[39m[0m

      at Object.toContain (src/lib/inventory/__tests__/m
ovement-integration.test.ts:265:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Transaction rollback scenarios ÔÇ║ should 
maintain atomicity across multiple movements

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 291 |[39m       })[33m;[39m
     [90m 292 |[39m
    [31m[1m>[22m[39m[90m 293 |[39m       expect(re
sult1[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 294 |[39m
     [90m 295 |[39m       [36mconst[39m 
batchAfterFirst [33m=[39m [36mawait[39m database
     [90m 296 |[39m         [33m.[39m[36mget[39m[
33m<[39m[33mInventoryBatchModel[39m[33m>[39m([32m'
inventory_batches'[39m)[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-integration.test.ts:293:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ External key lookup and retrieval ÔÇ║ 
should retrieve movement by external_key

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "lookup-1768559097312"
    Received: undefined

    [0m [90m 340 |[39m
     [90m 341 |[39m       
expect(retrieved)[33m.[39mtoBeDefined()[33m;[39m
    [31m[1m>[22m[39m[90m 342 |[39m       expect(re
trieved[33m?[39m[33m.[39mexternalKey)[33m.[39mtoBe
(externalKey)[33m;[39m
     [90m     |[39m                                   
   [31m[1m^[22m[39m
     [90m 343 |[39m       expect(retrieved[33m?[39m
[33m.[39mitemId)[33m.[39mtoBe(testItem[33m.[39mid)
[33m;[39m
     [90m 344 |[39m       expect(retrieved[33m?[39m
[33m.[39mquantityDelta)[33m.[39mtoBe([33m-[39m[35m
50[39m)[33m;[39m
     [90m 345 |[39m     })[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-integration.test.ts:342:38)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Movement immutability verification ÔÇ║ 
should enforce append-only behavior for movements

    expect(received).toBe(expected) // Object.is 
equality

    Expected: -100
    Received: undefined

    [0m [90m 366 |[39m
     [90m 367 |[39m       [90m// Verify original 
movement values[39m
    [31m[1m>[22m[39m[90m 368 |[39m       expect(or
iginalMovement[33m.[39mquantityDelta)[33m.[39mtoBe(
[33m-[39m[35m100[39m)[33m;[39m
     [90m     |[39m                                   
           [31m[1m^[22m[39m
     [90m 369 |[39m       expect(originalMovement[33m
.[39mreason)[33m.[39mtoBe([32m'Original'[39m)[33m;
[39m
     [90m 370 |[39m
     [90m 371 |[39m       [90m// Create corrective 
movement instead of updating[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/moveme
nt-integration.test.ts:368:46)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Movement Service Integration - Exactly-Once 
Behavior ÔÇ║ Movement immutability verification ÔÇ║ 
should require new movement for corrections

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 0
    Received array:  []

    [0m [90m 430 |[39m
     [90m 431 |[39m       [36mconst[39m movements 
[33m=[39m [36mawait[39m 
getMovementsForItem(testItem[33m.[39mid)[33m;[39m
    [31m[1m>[22m[39m[90m 432 |[39m       expect(mo
vements)[33m.[39mtoHaveLength([35m3[39m)[33m;[39m
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 433 |[39m
     [90m 434 |[39m       [90m// Net effect: -100 + 
100 - 75 = -75[39m
     [90m 435 |[39m       [36mconst[39m netQuantity 
[33m=[39m movements[33m.[39mreduce([0m

      at Object.toHaveLength (src/lib/inventory/__tests_
_/movement-integration.test.ts:432:25)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/harvest/harvest-error-handler.test.ts
  ÔùÅ handleBusinessLogicError ÔÇ║ should include 
update weight action for dry weight errors

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 280 |[39m     [36mconst[39m result 
[33m=[39m handleBusinessLogicError(error[33m,[39m 
mockT)[33m;[39m
     [90m 281 |[39m
    [31m[1m>[22m[39m[90m 282 |[39m     expect(resu
lt[33m.[39mactions[33m?[39m[33m.[39msome((a) 
[33m=>[39m a[33m.[39maction [33m===[39m 
[32m'update_weight'[39m))[33m.[39mtoBe(
     [90m     |[39m                                   
                                    [31m[1m^[22m[39m
     [90m 283 |[39m       [36mtrue[39m
     [90m 284 |[39m     )[33m;[39m
     [90m 285 |[39m   })[33m;[39m[0m

      at Object.toBe 
(src/lib/harvest/harvest-error-handler.test.ts:282:71)

  ÔùÅ handleHarvestError ÔÇ║ should route business 
logic errors correctly

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 355 |[39m     [36mconst[39m result 
[33m=[39m handleHarvestError(error[33m,[39m 
mockT)[33m;[39m
     [90m 356 |[39m
    [31m[1m>[22m[39m[90m 357 |[39m     expect(resu
lt[33m.[39mshouldShowBanner)[33m.[39mtoBe([36mtrue
[39m)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 358 |[39m   })[33m;[39m
     [90m 359 |[39m
     [90m 360 |[39m   it([32m'should route 
consistency errors correctly'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe 
(src/lib/harvest/harvest-error-handler.test.ts:357:37)

FAIL src/lib/sentry-utils.test.ts
  ÔùÅ sentry-utils ÔÇ║ sanitizeTextPII ÔÇ║ redacts 
phone numbers

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Call [PHONE_REDACTED] or 
[PHONE_REDACTED]"
    Received: "Call ([PHONE_REDACTED] or 
[PHONE_REDACTED]"

    [0m [90m 19 |[39m       [36mconst[39m input 
[33m=[39m [32m'Call (555) 123-4567 or 
555-123-4567'[39m[33m;[39m
     [90m 20 |[39m       [36mconst[39m result 
[33m=[39m sanitizeTextPII(input)[33m;[39m
    [31m[1m>[22m[39m[90m 21 |[39m       
expect(result)[33m.[39mtoBe([32m'Call 
[PHONE_REDACTED] or [PHONE_REDACTED]'[39m)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 22 |[39m     })[33m;[39m
     [90m 23 |[39m
     [90m 24 |[39m     test([32m'redacts API 
keys'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBe 
(src/lib/sentry-utils.test.ts:21:22)

  ÔùÅ sentry-utils ÔÇ║ sanitizeTextPII ÔÇ║ handles 
multiple sensitive patterns

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Email: [EMAIL_REDACTED], Phone: 
[PHONE_REDACTED], API: [API_KEY_REDACTED]"
    Received: "Email: [EMAIL_REDACTED], Phone: 
[PHONE_REDACTED], API: sk_test_abcdef123456"

    [0m [90m 31 |[39m       [36mconst[39m input 
[33m=[39m [32m'Email: test@example.com, Phone: 
555-123-4567, API: sk_test_abcdef123456'[39m[33m;[39m
     [90m 32 |[39m       [36mconst[39m result 
[33m=[39m sanitizeTextPII(input)[33m;[39m
    [31m[1m>[22m[39m[90m 33 |[39m       
expect(result)[33m.[39mtoBe([32m'Email: 
[EMAIL_REDACTED], Phone: [PHONE_REDACTED], API: 
[API_KEY_REDACTED]'[39m)[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 34 |[39m     })[33m;[39m
     [90m 35 |[39m   })[33m;[39m
     [90m 36 |[39m[0m

      at Object.toBe 
(src/lib/sentry-utils.test.ts:33:22)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ handles 
mixed-type arrays

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 1

      Array [
        "[EMAIL_REDACTED]",
        42,
        Object {
    -     "apiKey": "[API_KEY_REDACTED]",
    +     "apiKey": "sk_live_arrayitem",
        },
        null,
        undefined,
        true,
      ]

    [0m [90m 91 |[39m       ][33m;[39m
     [90m 92 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII(input)[33m;[39m
    [31m[1m>[22m[39m[90m 93 |[39m       
expect(result)[33m.[39mtoEqual([
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 94 |[39m         
[32m'[EMAIL_REDACTED]'[39m[33m,[39m
     [90m 95 |[39m         [35m42[39m[33m,[39m
     [90m 96 |[39m         { apiKey[33m:[39m 
[32m'[API_KEY_REDACTED]'[39m }[33m,[39m[0m

      at Object.toEqual 
(src/lib/sentry-utils.test.ts:93:22)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ handles 
Maps

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 1

      Object {
        "42": "number key",
    -   "apiKey": "[API_KEY_REDACTED]",
    +   "apiKey": "sk_live_mapvalue",
        "email": "[EMAIL_REDACTED]",
      }

    [0m [90m 107 |[39m       
map[33m.[39m[36mset[39m([35m42[39m[33m,[39m 
[32m'number key'[39m)[33m;[39m
     [90m 108 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII(map)[33m;[39m
    [31m[1m>[22m[39m[90m 109 |[39m       
expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 110 |[39m         email[33m:[39m 
[32m'[EMAIL_REDACTED]'[39m[33m,[39m
     [90m 111 |[39m         apiKey[33m:[39m 
[32m'[API_KEY_REDACTED]'[39m[33m,[39m
     [90m 112 |[39m         [32m'42'[39m[33m:[39m 
[32m'number key'[39m[33m,[39m[0m

      at Object.toEqual 
(src/lib/sentry-utils.test.ts:109:22)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ handles 
Sets

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 1

      Array [
        "[EMAIL_REDACTED]",
    -   "[API_KEY_REDACTED]",
    +   "sk_live_setvalue",
        42,
      ]

    [0m [90m 121 |[39m       ])[33m;[39m
     [90m 122 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII([36mset[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 123 |[39m       
expect(result)[33m.[39mtoEqual([
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 124 |[39m         
[32m'[EMAIL_REDACTED]'[39m[33m,[39m
     [90m 125 |[39m         
[32m'[API_KEY_REDACTED]'[39m[33m,[39m
     [90m 126 |[39m         
[35m42[39m[33m,[39m[0m

      at Object.toEqual 
(src/lib/sentry-utils.test.ts:123:22)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ handles 
Axios-like objects

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "[AUTH_HEADER_REDACTED]"
    Received: "Bearer sk_live_configheader"

    [0m [90m 149 |[39m       }[33m;[39m
     [90m 150 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII(axiosError)[33m;[39m
    [31m[1m>[22m[39m[90m 151 |[39m       expect(re
sult[33m.[39mconfig[33m.[39mheaders[33m.[39mauthor
ization)[33m.[39mtoBe([32m'[AUTH_HEADER_REDACTED]'[3
9m)[33m;[39m
     [90m     |[39m                                   
                [31m[1m^[22m[39m
     [90m 152 |[39m       expect(result[33m.[39mrequ
est[33m.[39m_header)[33m.[39mtoBe([32m'[AUTH_HEADER
_REDACTED]'[39m)[33m;[39m
     [90m 153 |[39m       expect(result[33m.[39mresp
onse[33m.[39mdata[33m.[39muser[33m.[39memail)[33m
.[39mtoBe([32m'[EMAIL_REDACTED]'[39m)[33m;[39m
     [90m 154 |[39m       expect(result[33m.[39mmess
age)[33m.[39mtoBe([32m'Request 
failed'[39m)[33m;[39m[0m

      at Object.toBe 
(src/lib/sentry-utils.test.ts:151:51)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ preserves 
Date objects

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Date

    Received value has no prototype
    Received value: "2020-01-01T00:00:00.000Z"

    [0m [90m 159 |[39m       [36mconst[39m input 
[33m=[39m { created[33m:[39m date }[33m;[39m
     [90m 160 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII(input)[33m;[39m
    [31m[1m>[22m[39m[90m 161 |[39m       expect(re
sult[33m.[39mcreated)[33m.[39mtoBeInstanceOf([33mDa
te[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 162 |[39m       expect(result[33m.[39mcrea
ted[33m.[39mtoISOString())[33m.[39mtoBe(date[33m.[
39mtoISOString())[33m;[39m
     [90m 163 |[39m     })[33m;[39m
     [90m 164 |[39m[0m

      at Object.toBeInstanceOf 
(src/lib/sentry-utils.test.ts:161:30)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ preserves 
RegExp objects

    expect(received).toBeInstanceOf(expected)

    Expected constructor: RegExp

    Received value has no prototype
    Received value: "/test/gi"

    [0m [90m 167 |[39m       [36mconst[39m input 
[33m=[39m { pattern[33m:[39m regex }[33m;[39m
     [90m 168 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII(input)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       expect(re
sult[33m.[39mpattern)[33m.[39mtoBeInstanceOf([33mRe
gExp[39m)[33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 170 |[39m       expect(result[33m.[39mpatt
ern[33m.[39mtoString())[33m.[39mtoBe(regex[33m.[39
mtoString())[33m;[39m
     [90m 171 |[39m     })[33m;[39m
     [90m 172 |[39m[0m

      at Object.toBeInstanceOf 
(src/lib/sentry-utils.test.ts:169:30)

  ÔùÅ sentry-utils ÔÇ║ sanitizeObjectPII ÔÇ║ handles 
complex nested structures

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "[EMAIL_REDACTED]"
    Received: "user1@example.com"

    [0m [90m 218 |[39m       }[33m;[39m
     [90m 219 |[39m       [36mconst[39m result 
[33m=[39m sanitizeObjectPII(input)[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m       expect(re
sult[33m.[39musers[[35m0[39m][33m.[39memail)[33m.
[39mtoBe([32m'[EMAIL_REDACTED]'[39m)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 221 |[39m       expect(result[33m.[39muser
s[[35m0[39m][33m.[39mprofile[33m?[39m[33m.[39mph
one)[33m.[39mtoBe([32m'[PHONE_REDACTED]'[39m)[33m;
[39m
     [90m 222 |[39m       expect(result[33m.[39muser
s[[35m0[39m][33m.[39mprofile[33m?[39m[33m.[39mad
dress)[33m.[39mtoBe([32m'[ADDRESS_REDACTED]'[39m)[3
3m;[39m
     [90m 223 |[39m       expect(result[33m.[39muser
s[[35m1[39m][33m.[39memail)[33m.[39mtoBe([32m'[EM
AIL_REDACTED]'[39m)[33m;[39m[0m

      at Object.toBe 
(src/lib/sentry-utils.test.ts:220:37)

FAIL src/lib/inventory/notifications/__tests__/exact-ala
rm-coordinator.test.ts
  ÔùÅ ExactAlarmCoordinator ÔÇ║ requestPermission ÔÇ║ 
should launch settings when user enables

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

    [0m [90m 215 |[39m       [36mawait[39m [33mExa
ctAlarmCoordinator[39m[33m.[39mrequestPermission()[3
3m;[39m
     [90m 216 |[39m
    [31m[1m>[22m[39m[90m 217 |[39m       expect([
33mLinking[39m[33m.[39mopenSettings)[33m.[39mtoHave
BeenCalled()[33m;[39m
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 218 |[39m     })[33m;[39m
     [90m 219 |[39m   })[33m;[39m
     [90m 220 |[39m[0m

      at Object.toHaveBeenCalled (src/lib/inventory/noti
fications/__tests__/exact-alarm-coordinator.test.ts:217:
36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/__tests__/analytics.test.ts
  ÔùÅ ConsentGatedAnalytics ÔÇ║ PII Sanitization ÔÇ║ 
removes nutrient_feature_usage context field when it 
contains only PII

    expect(received).toBeUndefined()

    Received: "[redacted_email] [redacted_phone]"

    [0m [90m 349 |[39m       [36mconst[39m 
sanitizedPayload [33m=[39m 
events[[35m0[39m][33m.[39mpayload [36mas[39m 
any[33m;[39m
     [90m 350 |[39m       expect(sanitizedPayload[33m
.[39mfeature)[33m.[39mtoBe([32m'acknowledge_alert'[
39m)[33m;[39m
    [31m[1m>[22m[39m[90m 351 |[39m       expect(sa
nitizedPayload[33m.[39mcontext)[33m.[39mtoBeUndefine
d()[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 352 |[39m     })[33m;[39m
     [90m 353 |[39m
     [90m 354 |[39m     it([32m'truncates 
nutrient_feature_usage context field to 200 
characters'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBeUndefined 
(src/lib/__tests__/analytics.test.ts:351:40)

  ÔùÅ ConsentGatedAnalytics ÔÇ║ PII Sanitization ÔÇ║ 
truncates nutrient_feature_usage context field to 200 
characters

    expect(received).toContain(expected) // indexOf

    Expected substring: "[redacted_email]"
    Received string:    "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
A"

    [0m [90m 366 |[39m       [36mconst[39m 
sanitizedPayload [33m=[39m 
events[[35m0[39m][33m.[39mpayload [36mas[39m 
any[33m;[39m
     [90m 367 |[39m       expect(sanitizedPayload[33m
.[39mcontext[33m?[39m[33m.[39mlength)[33m.[39mtoB
eLessThanOrEqual([35m200[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 368 |[39m       expect(sa
nitizedPayload[33m.[39mcontext)[33m.[39mtoContain([
32m'[redacted_email]'[39m)[33m;[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 369 |[39m     })[33m;[39m
     [90m 370 |[39m
     [90m 371 |[39m     it([32m'sanitizes various 
PII patterns in nutrient_feature_usage 
context'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toContain 
(src/lib/__tests__/analytics.test.ts:368:40)

  ÔùÅ ConsentGatedAnalytics ÔÇ║ PII Sanitization ÔÇ║ 
sanitizes various PII patterns in 
nutrient_feature_usage context

    expect(received).toContain(expected) // indexOf

    Expected substring: "[redacted_token]"
    Received string:    "User action: [redacted_url] 
Contact: [redacted_email] or call 
[redacted_phone]Payment: card[redacted_phone]Extra 
spaces and tabs here"

    [0m [90m 386 |[39m       [36mconst[39m context 
[33m=[39m 
sanitizedPayload[33m.[39mcontext[33m;[39m
     [90m 387 |[39m       expect(context)[33m.[39mto
Contain([32m'[redacted_url]'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 388 |[39m       expect(co
ntext)[33m.[39mtoContain([32m'[redacted_token]'[39m)
[33m;[39m
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 389 |[39m       expect(context)[33m.[39mto
Contain([32m'[redacted_email]'[39m)[33m;[39m
     [90m 390 |[39m       expect(context)[33m.[39mto
Contain([32m'[redacted_phone]'[39m)[33m;[39m
     [90m 391 |[39m       expect(context)[33m.[39mto
Contain([32m'[redacted_card]'[39m)[33m;[39m[0m

      at Object.toContain 
(src/lib/__tests__/analytics.test.ts:388:23)

FAIL src/lib/playbooks/analytics/__tests__/metrics-aggre
gator.test.ts
  ÔùÅ MetricsAggregator ÔÇ║ Health Status ÔÇ║ should 
report degraded status with low delivery rate

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "degraded"
    Received: "healthy"

    [0m [90m 104 |[39m
     [90m 105 |[39m       [36mconst[39m health 
[33m=[39m 
metricsAggregator[33m.[39mgetHealthStatus()[33m;[39m
    [31m[1m>[22m[39m[90m 106 |[39m       expect(he
alth[33m.[39mnotifications)[33m.[39mtoBe([32m'degra
ded'[39m)[33m;[39m
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 107 |[39m       expect(health[33m.[39missu
es[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[3
9m)[33m;[39m
     [90m 108 |[39m     })[33m;[39m
     [90m 109 |[39m[0m

      at Object.toBe (src/lib/playbooks/analytics/__test
s__/metrics-aggregator.test.ts:106:36)

  ÔùÅ MetricsAggregator ÔÇ║ Health Status ÔÇ║ should 
report unhealthy status with very low delivery rate

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "unhealthy"
    Received: "healthy"

    [0m [90m 128 |[39m
     [90m 129 |[39m       [36mconst[39m health 
[33m=[39m 
metricsAggregator[33m.[39mgetHealthStatus()[33m;[39m
    [31m[1m>[22m[39m[90m 130 |[39m       expect(he
alth[33m.[39mnotifications)[33m.[39mtoBe([32m'unhea
lthy'[39m)[33m;[39m
     [90m     |[39m                                   
 [31m[1m^[22m[39m
     [90m 131 |[39m     })[33m;[39m
     [90m 132 |[39m
     [90m 133 |[39m     it([32m'should report 
degraded status with high sync failure 
rate'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/playbooks/analytics/__test
s__/metrics-aggregator.test.ts:130:36)

  ÔùÅ MetricsAggregator ÔÇ║ Metrics Report ÔÇ║ should 
include health issues in report

    expect(received).toContain(expected) // indexOf

    Expected substring: "Issues"
    Received string:    "=== Playbook Metrics Report 
===┬À
    Overall Health: HEALTHY┬À
    --- Notifications ---
    Delivery Rate: 80.0%
    Average Delay: 1.0s
    Total Scheduled: 0
    Total Delivered: 16
    Total Missed: 4┬À
    --- Sync ---
    Success Rate: 100.0%
    Average Latency: 0.0s
    Total Syncs: 0
    Successful: 0
    Failed: 0┬À
    --- Conflicts ---
    Total Conflicts: 0
    Resolved by Server: 0
    Resolved by Client: 0
    Manual Resolutions: 0
    Restored: 0"

    [0m [90m 194 |[39m
     [90m 195 |[39m       [36mconst[39m report 
[33m=[39m metricsAggregator[33m.[39mgetMetricsReport
()[33m;[39m
    [31m[1m>[22m[39m[90m 196 |[39m       expect(re
port)[33m.[39mtoContain([32m'Issues'[39m)[33m;[39m
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 197 |[39m     })[33m;[39m
     [90m 198 |[39m   })[33m;[39m
     [90m 199 |[39m[0m

      at Object.toContain (src/lib/playbooks/analytics/_
_tests__/metrics-aggregator.test.ts:196:22)

FAIL src/lib/watermelon-models/__tests__/cached-strain.t
est.ts
  ÔùÅ CachedStrainModel - parsedStrains ÔÇ║ parses 
valid JSON strains data correctly

    expect(received).toHaveLength(expected)

    Expected length: 2
    Received length: 0
    Received array:  []

    [0m [90m 48 |[39m     [36mconst[39m parsed 
[33m=[39m model[33m.[39mparsedStrains[33m;[39m
     [90m 49 |[39m
    [31m[1m>[22m[39m[90m 50 |[39m     expect(parse
d)[33m.[39mtoHaveLength([35m2[39m)[33m;[39m
     [90m    |[39m                    
[31m[1m^[22m[39m
     [90m 51 |[39m     expect(parsed[[35m0[39m][33m
.[39mname)[33m.[39mtoBe([32m'OG 
Kush'[39m)[33m;[39m
     [90m 52 |[39m     expect(parsed[[35m1[39m][33m
.[39mname)[33m.[39mtoBe([32m'Blue 
Dream'[39m)[33m;[39m
     [90m 53 |[39m   })[33m;[39m[0m

      at Object.toHaveLength (src/lib/watermelon-models/
__tests__/cached-strain.test.ts:50:20)

  ÔùÅ CachedStrainModel - isExpired ÔÇ║ returns true 
when current time is after expiresAt

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 94 |[39m     })[33m;[39m
     [90m 95 |[39m
    [31m[1m>[22m[39m[90m 96 |[39m     expect(model
[33m.[39misExpired)[33m.[39mtoBe([36mtrue[39m)[33
m;[39m
     [90m    |[39m                             
[31m[1m^[22m[39m
     [90m 97 |[39m   })[33m;[39m
     [90m 98 |[39m
     [90m 99 |[39m   test([32m'returns false when 
current time is before expiresAt'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/watermelon-models/__tests_
_/cached-strain.test.ts:96:29)

  ÔùÅ CachedStrainModel - ageInSeconds ÔÇ║ calculates 
age correctly

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 119
    Received:    NaN

    [0m [90m 131 |[39m
     [90m 132 |[39m     [90m// Allow 1 second 
tolerance for test execution time[39m
    [31m[1m>[22m[39m[90m 133 |[39m     expect(age)
[33m.[39mtoBeGreaterThanOrEqual([35m119[39m)[33m;[
39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 134 |[39m     expect(age)[33m.[39mtoBeLess
ThanOrEqual([35m121[39m)[33m;[39m
     [90m 135 |[39m   })[33m;[39m
     [90m 136 |[39m })[33m;[39m[0m

      at Object.toBeGreaterThanOrEqual (src/lib/watermel
on-models/__tests__/cached-strain.test.ts:133:17)

FAIL src/lib/notifications/background-handler.test.ts
  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
handleBackgroundMessage ÔÇ║ should handle iOS 
background messages

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 25 |[39m
     [90m 26 |[39m [36masync[39m [36mfunction[39m 
setupMockStorage() {
    [31m[1m>[22m[39m[90m 27 |[39m   
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 28 |[39m     
[32m'@/lib/notifications/notification-storage'[39m
     [90m 29 |[39m   )[33m;[39m
     [90m 30 |[39m   [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at 
src/lib/notifications/background-handler.test.ts:27:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/background-handler.test.ts:33:2)
      at apply 
(src/lib/notifications/background-handler.test.ts:26:32)
      at Object.setupMockStorage 
(src/lib/notifications/background-handler.test.ts:45:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
handleBackgroundMessage ÔÇ║ should handle Android 
messages when not in Doze mode

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 25 |[39m
     [90m 26 |[39m [36masync[39m [36mfunction[39m 
setupMockStorage() {
    [31m[1m>[22m[39m[90m 27 |[39m   
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 28 |[39m     
[32m'@/lib/notifications/notification-storage'[39m
     [90m 29 |[39m   )[33m;[39m
     [90m 30 |[39m   [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at 
src/lib/notifications/background-handler.test.ts:27:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/background-handler.test.ts:26:32)
      at Object.setupMockStorage 
(src/lib/notifications/background-handler.test.ts:61:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
handleBackgroundMessage ÔÇ║ should queue messages when 
in Doze mode on Android

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 75 |[39m     
[33mPlatform[39m[33m.[39m[33mOS[39m [33m=[39m 
[32m'android'[39m[33m;[39m
     [90m 76 |[39m     [33mBackgroundNotificationHand
ler[39m[33m.[39msetDozeMode([36mtrue[39m)[33m;[39
m
    [31m[1m>[22m[39m[90m 77 |[39m     
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 78 |[39m       
[32m'@/lib/notifications/notification-storage'[39m
     [90m 79 |[39m     )[33m;[39m
     [90m 80 |[39m     [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/notifications/background-handler.test.ts:77:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
handleBackgroundMessage ÔÇ║ should handle errors 
gracefully

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 88 |[39m   it([32m'should handle 
errors gracefully'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m 89 |[39m     
[33mPlatform[39m[33m.[39m[33mOS[39m [33m=[39m 
[32m'android'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 90 |[39m     
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 91 |[39m       
[32m'@/lib/notifications/notification-storage'[39m
     [90m 92 |[39m     )[33m;[39m
     [90m 93 |[39m     [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/notifications/background-handler.test.ts:90:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
processPendingTasks ÔÇ║ success scenarios ÔÇ║ should 
process all queued tasks

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 25 |[39m
     [90m 26 |[39m [36masync[39m [36mfunction[39m 
setupMockStorage() {
    [31m[1m>[22m[39m[90m 27 |[39m   
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 28 |[39m     
[32m'@/lib/notifications/notification-storage'[39m
     [90m 29 |[39m   )[33m;[39m
     [90m 30 |[39m   [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at 
src/lib/notifications/background-handler.test.ts:27:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/background-handler.test.ts:26:32)
      at Object.setupMockStorage (src/lib/notifications/
background-handler.test.ts:122:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
processPendingTasks ÔÇ║ success scenarios ÔÇ║ should 
clear queue after processing

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 25 |[39m
     [90m 26 |[39m [36masync[39m [36mfunction[39m 
setupMockStorage() {
    [31m[1m>[22m[39m[90m 27 |[39m   
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 28 |[39m     
[32m'@/lib/notifications/notification-storage'[39m
     [90m 29 |[39m   )[33m;[39m
     [90m 30 |[39m   [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at 
src/lib/notifications/background-handler.test.ts:27:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/background-handler.test.ts:26:32)
      at Object.setupMockStorage (src/lib/notifications/
background-handler.test.ts:144:11)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
processPendingTasks ÔÇ║ error handling ÔÇ║ should 
handle errors in pending tasks and re-queue failed tasks

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 160 |[39m     [33mBackgroundNotificatio
nHandler[39m[33m.[39msetDozeMode([36mfalse[39m)[33
m;[39m
     [90m 161 |[39m
    [31m[1m>[22m[39m[90m 162 |[39m     
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 163 |[39m       
[32m'@/lib/notifications/notification-storage'[39m
     [90m 164 |[39m     )[33m;[39m
     [90m 165 |[39m     [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/notifications/background-handler.test.ts:162:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ 
processPendingTasks ÔÇ║ error handling ÔÇ║ should throw 
aggregated error when all tasks fail

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 188 |[39m     [33mBackgroundNotificatio
nHandler[39m[33m.[39msetDozeMode([36mfalse[39m)[33
m;[39m
     [90m 189 |[39m
    [31m[1m>[22m[39m[90m 190 |[39m     
[36mconst[39m { saveNotifications } [33m=[39m 
[36mawait[39m [36mimport[39m(
     [90m     |[39m     [31m[1m^[22m[39m
     [90m 191 |[39m       
[32m'@/lib/notifications/notification-storage'[39m
     [90m 192 |[39m     )[33m;[39m
     [90m 193 |[39m     [36mconst[39m mockSave 
[33m=[39m saveNotifications [36mas[39m 
jest[33m.[39m[33mMock[39m[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/notifications/background-handler.test.ts:190:5)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ BackgroundNotificationHandler ÔÇ║ state 
management ÔÇ║ should return correct pending task count

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 0
    Received: 3

    [0m [90m 214 |[39m     [33mBackgroundNotificatio
nHandler[39m[33m.[39msetDozeMode([36mtrue[39m)[33m
;[39m
     [90m 215 |[39m
    [31m[1m>[22m[39m[90m 216 |[39m     expect([33
mBackgroundNotificationHandler[39m[33m.[39mgetPending
TaskCount())[33m.[39mtoBe([35m0[39m)[33m;[39m
     [90m     |[39m                                   
                              [31m[1m^[22m[39m
     [90m 217 |[39m
     [90m 218 |[39m     [36mawait[39m [33mBackgroun
dNotificationHandler[39m[33m.[39mhandleBackgroundMess
age(mockMessage)[33m;[39m
     [90m 219 |[39m     expect([33mBackgroundNotifica
tionHandler[39m[33m.[39mgetPendingTaskCount())[33m.
[39mtoBe([35m1[39m)[33m;[39m[0m

      at Object.toBe (src/lib/notifications/background-h
andler.test.ts:216:65)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/moderation/moderation-metrics-queries.test.tsx
  ÔùÅ ModerationMetricsQueries ÔÇ║ 
calculateAppealReversalRate ÔÇ║ filters appeals by date 
range

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "submitted_at", "2024-01-01T00:00:00.000Z"

    Number of calls: 0

    [0m [90m 147 |[39m       expect(mockSupabase[33m
.[39m[36mfrom[39m)[33m.[39mtoHaveBeenCalledWith([3
2m'appeals'[39m)[33m;[39m
     [90m 148 |[39m       expect(mockFrom[33m.[39mse
lect)[33m.[39mtoHaveBeenCalledWith([32m'decision'[39
m)[33m;[39m
    [31m[1m>[22m[39m[90m 149 |[39m       expect(mo
ckFrom[33m.[39mselect()[33m.[39mgte)[33m.[39mtoHav
eBeenCalledWith(
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 150 |[39m         
[32m'submitted_at'[39m[33m,[39m
     [90m 151 |[39m         
period[33m.[39mstartDate[33m.[39mtoISOString()
     [90m 152 |[39m       )[33m;[39m[0m

      at Object.toHaveBeenCalledWith (src/lib/moderation
/moderation-metrics-queries.test.tsx:149:37)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ModerationMetricsQueries ÔÇ║ getAppealMetrics ÔÇ║ 
returns hardcoded metrics (placeholder - needs real 
implementation)

    expect(received).toEqual(expected) // deep equality

    - Expected  - 4
    + Received  + 4

      Object {
    -   "rejectedAppeals": 85,
    -   "reversalRate": 15,
    -   "totalAppeals": 100,
    -   "upheldAppeals": 15,
    +   "rejectedAppeals": 0,
    +   "reversalRate": 0,
    +   "totalAppeals": 0,
    +   "upheldAppeals": 0,
      }

    [0m [90m 167 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
getAppealMetrics(period)[33m;[39m
     [90m 168 |[39m
    [31m[1m>[22m[39m[90m 169 |[39m       
expect(result)[33m.[39mtoEqual({
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 170 |[39m         totalAppeals[33m:[39m 
[35m100[39m[33m,[39m
     [90m 171 |[39m         upheldAppeals[33m:[39m 
[35m15[39m[33m,[39m
     [90m 172 |[39m         
rejectedAppeals[33m:[39m [35m85[39m[33m,[39m[0m

      at Object.toEqual (src/lib/moderation/moderation-m
etrics-queries.test.tsx:169:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/harvest/__tests__/harvest-redaction.test.ts
  ÔùÅ Harvest Redaction ÔÇ║ createHarvestSharingSummary 
ÔÇ║ should calculate average duration

    expect(received).toBeCloseTo(expected, precision)

    Expected: 7.33
    Received: 9.333333333333334

    Expected precision:    2
    Expected difference: < 0.005
    Received difference:   2.003333333333334

    [0m [90m 206 |[39m
     [90m 207 |[39m       [90m// (6 days + 7 days + 
9 days) / 3 = 7.33 days (floored durations)[39m
    [31m[1m>[22m[39m[90m 208 |[39m       expect(su
mmary[33m.[39mavg_duration_days)[33m.[39mtoBeCloseTo
([35m7.33[39m[33m,[39m [35m2[39m)[33m;[39m
     [90m     |[39m                                   
      [31m[1m^[22m[39m
     [90m 209 |[39m     })[33m;[39m
     [90m 210 |[39m
     [90m 211 |[39m     it([32m'should count 
stages'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBeCloseTo (src/lib/harvest/__tests__/h
arvest-redaction.test.ts:208:41)

FAIL src/lib/watermelon-models/__tests__/assessment-requ
est.test.ts
  ÔùÅ sanitizePhotos ÔÇ║ returns empty array for 
non-array input

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 108 |[39m
     [90m 109 |[39m   test([32m'returns empty array 
for non-array input'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 110 |[39m     expect(sani
tizePhotos(undefined))[33m.[39mtoEqual([])[33m;[39m
     [90m     |[39m                          
[31m[1m^[22m[39m
     [90m 111 |[39m     
expect(sanitizePhotos([36mnull[39m [36mas[39m 
any))[33m.[39mtoEqual([])[33m;[39m
     [90m 112 |[39m     
expect(sanitizePhotos([32m'not an array'[39m 
[36mas[39m any))[33m.[39mtoEqual([])[33m;[39m
     [90m 113 |[39m     expect(sanitizePhotos({} 
[36mas[39m any))[33m.[39mtoEqual([])[33m;[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:110:26)

  ÔùÅ sanitizePhotos ÔÇ║ filters out photos with 
missing or empty id

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 116 |[39m   test([32m'filters out 
photos with missing or empty id'[39m[33m,[39m () 
[33m=>[39m {
     [90m 117 |[39m     [36mconst[39m photos 
[33m=[39m [mockValidPhoto[33m,[39m 
mockPhotoWithInvalidId][33m;[39m
    [31m[1m>[22m[39m[90m 118 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos(photos)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 119 |[39m
     [90m 120 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 121 |[39m     expect(result[[35m0[39m][33
m.[39mid)[33m.[39mtoBe([32m'photo-1'[39m)[33m;[39
m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:118:34)

  ÔùÅ sanitizePhotos ÔÇ║ filters out photos with 
missing or empty uri

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 124 |[39m   test([32m'filters out 
photos with missing or empty uri'[39m[33m,[39m () 
[33m=>[39m {
     [90m 125 |[39m     [36mconst[39m photos 
[33m=[39m [mockValidPhoto[33m,[39m 
mockPhotoWithInvalidUri][33m;[39m
    [31m[1m>[22m[39m[90m 126 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos(photos)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 127 |[39m
     [90m 128 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 129 |[39m     expect(result[[35m0[39m][33
m.[39mid)[33m.[39mtoBe([32m'photo-1'[39m)[33m;[39
m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:126:34)

  ÔùÅ sanitizePhotos ÔÇ║ filters out photos with 
whitespace-only id or uri

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 136 |[39m       { 
[33m...[39mmockValidPhoto[33m,[39m uri[33m:[39m 
[32m'\t\n  '[39m }[33m,[39m
     [90m 137 |[39m     ][33m;[39m
    [31m[1m>[22m[39m[90m 138 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos(photosWithWhitespace)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 139 |[39m
     [90m 140 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 141 |[39m     expect(result[[35m0[39m][33
m.[39mid)[33m.[39mtoBe([32m'photo-1'[39m)[33m;[39
m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:138:34)

  ÔùÅ sanitizePhotos ÔÇ║ limits results to MAX_PHOTOS 
after filtering

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 150 |[39m     }))[33m;[39m
     [90m 151 |[39m
    [31m[1m>[22m[39m[90m 152 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos(manyPhotos)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 153 |[39m     expect(result)[33m.[39mtoHav
eLength([35m10[39m)[33m;[39m
     [90m 154 |[39m   })[33m;[39m
     [90m 155 |[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:152:34)

  ÔùÅ sanitizePhotos ÔÇ║ coerces timestamp to number 
with fallback to Date.now()

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 155 |[39m
     [90m 156 |[39m   test([32m'coerces timestamp to 
number with fallback to Date.now()'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 157 |[39m     
[36mconst[39m result [33m=[39m sanitizePhotos([mockP
hotoWithInvalidTimestamp])[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 158 |[39m
     [90m 159 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 160 |[39m     expect([36mtypeof[39m result
[[35m0[39m][33m.[39mtimestamp)[33m.[39mtoBe([32m'
number'[39m)[33m;[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:157:34)

  ÔùÅ sanitizePhotos ÔÇ║ preserves valid timestamp as 
number

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 163 |[39m
     [90m 164 |[39m   test([32m'preserves valid 
timestamp as number'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 165 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos([mockValidPhoto])[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 166 |[39m
     [90m 167 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 168 |[39m     expect(result[[35m0[39m][33
m.[39mtimestamp)[33m.[39mtoBe([35m1234567890[39m)[
33m;[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:165:34)

  ÔùÅ sanitizePhotos ÔÇ║ sets default qualityScore when 
missing

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 170 |[39m
     [90m 171 |[39m   test([32m'sets default 
qualityScore when missing'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 172 |[39m     
[36mconst[39m result [33m=[39m sanitizePhotos([mockP
hotoWithMissingQualityScore])[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 173 |[39m
     [90m 174 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 175 |[39m     expect(result[[35m0[39m][33
m.[39mqualityScore)[33m.[39mtoEqual({[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:172:34)

  ÔùÅ sanitizePhotos ÔÇ║ preserves existing 
qualityScore when present

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 181 |[39m
     [90m 182 |[39m   test([32m'preserves existing 
qualityScore when present'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 183 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos([mockValidPhoto])[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 184 |[39m
     [90m 185 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 186 |[39m     expect(result[[35m0[39m][33
m.[39mqualityScore)[33m.[39mtoEqual({[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:183:34)

  ÔùÅ sanitizePhotos ÔÇ║ restricts metadata to only 
width and height

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 192 |[39m
     [90m 193 |[39m   test([32m'restricts metadata 
to only width and height'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 194 |[39m     
[36mconst[39m result [33m=[39m sanitizePhotos([mockP
hotoWithComplexMetadata])[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 195 |[39m
     [90m 196 |[39m     expect(result)[33m.[39mtoHav
eLength([35m1[39m)[33m;[39m
     [90m 197 |[39m     expect(result[[35m0[39m][33
m.[39mmetadata)[33m.[39mtoEqual({[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:194:34)

  ÔùÅ sanitizePhotos ÔÇ║ defaults metadata width and 
height to 0 when missing or invalid

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 219 |[39m     }[33m;[39m
     [90m 220 |[39m
    [31m[1m>[22m[39m[90m 221 |[39m     
[36mconst[39m result1 [33m=[39m 
sanitizePhotos([photoWithMissingMetadata])[33m;[39m
     [90m     |[39m                                   
[31m[1m^[22m[39m
     [90m 222 |[39m     [36mconst[39m result2 
[33m=[39m 
sanitizePhotos([photoWithInvalidMetadata])[33m;[39m
     [90m 223 |[39m
     [90m 224 |[39m     expect(result1[[35m0[39m][3
3m.[39mmetadata)[33m.[39mtoEqual({ width[33m:[39m 
[35m0[39m[33m,[39m height[33m:[39m [35m0[39m 
})[33m;[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:221:35)

  ÔùÅ sanitizePhotos ÔÇ║ handles complex filtering and 
transformation in one pass

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 236 |[39m     ][33m;[39m
     [90m 237 |[39m
    [31m[1m>[22m[39m[90m 238 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos(mixedPhotos)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 239 |[39m
     [90m 240 |[39m     expect(result)[33m.[39mtoHav
eLength([35m3[39m)[33m;[39m [90m// Only valid 
photos should remain[39m
     [90m 241 |[39m     
expect(result[33m.[39mmap((p) [33m=>[39m p[33m.[39
mid))[33m.[39mtoEqual([[32m'photo-1'[39m[33m,[39m 
[32m'photo-4'[39m[33m,[39m 
[32m'photo-5'[39m])[33m;[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:238:34)

  ÔùÅ sanitizePhotos ÔÇ║ returns empty array when all 
photos are filtered out

    TypeError: (0 , _assessmentRequest.sanitizePhotos) 
is not a function

    [0m [90m 262 |[39m     ][33m;[39m
     [90m 263 |[39m
    [31m[1m>[22m[39m[90m 264 |[39m     
[36mconst[39m result [33m=[39m 
sanitizePhotos(invalidPhotos)[33m;[39m
     [90m     |[39m                                  
[31m[1m^[22m[39m
     [90m 265 |[39m     
expect(result)[33m.[39mtoEqual([])[33m;[39m
     [90m 266 |[39m   })[33m;[39m
     [90m 267 |[39m })[33m;[39m[0m

      at Object.<anonymous> (src/lib/watermelon-models/_
_tests__/assessment-request.test.ts:264:34)

FAIL 
src/lib/inventory/__tests__/task-integration.test.ts
  ÔùÅ Task Workflow Integration ÔÇ║ Feeding Task 
Deduction (Requirement 3.1) ÔÇ║ should deduct nutrients 
with fixed quantity

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 139 |[39m
     [90m 140 |[39m       [90m// Assert: Verify 
successful deduction[39m
    [31m[1m>[22m[39m[90m 141 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 142 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 143 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mitemId)[33m.[39mtoBe(nutr
ientItem[33m.[39mid)[33m;[39m
     [90m 144 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mquantityDelta)[33m.[39mto
Be([33m-[39m[35m100[39m)[33m;[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:141:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Task Workflow Integration ÔÇ║ Feeding Task 
Deduction (Requirement 3.1) ÔÇ║ should scale nutrients 
per plant count

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 189 |[39m
     [90m 190 |[39m       [90m// Assert: Verify 
scaled deduction (50ml ├ù 5 plants = 250ml)[39m
    [31m[1m>[22m[39m[90m 191 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 192 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mquantityDelta)[33m.[39mto
Be([33m-[39m[35m250[39m)[33m;[39m
     [90m 193 |[39m
     [90m 194 |[39m       [36mconst[39m batches 
[33m=[39m [36mawait[39m db[0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:191:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Task Workflow Integration ÔÇ║ Feeding Task 
Deduction (Requirement 3.1) ÔÇ║ should handle 
insufficient stock gracefully

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "INSUFFICIENT_STOCK"
    Received: "Validation failed: Unit mismatch: entry 
uses 'ml' but item requires 'undefined'"

    [0m [90m 235 |[39m       [90m// Assert: Verify 
insufficient stock error[39m
     [90m 236 |[39m       expect(result[33m.[39msucc
ess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 237 |[39m       expect(re
sult[33m.[39merror)[33m.[39mtoBe([32m'INSUFFICIENT_
STOCK'[39m)[33m;[39m
     [90m     |[39m                            
[31m[1m^[22m[39m
     [90m 238 |[39m       expect(result[33m.[39minsu
fficientItems)[33m.[39mtoHaveLength([35m1[39m)[33m;
[39m
     [90m 239 |[39m       expect(result[33m.[39minsu
fficientItems[33m![39m[[35m0[39m])[33m.[39mtoEqual
({
     [90m 240 |[39m         itemId[33m:[39m 
nutrientItem[33m.[39mid[33m,[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:237:28)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Task Workflow Integration ÔÇ║ Harvest Task 
Deduction (Requirement 3.2) ÔÇ║ should deduct 
containers on harvest completion

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 287 |[39m
     [90m 288 |[39m       [90m// Assert: Verify 
container deduction[39m
    [31m[1m>[22m[39m[90m 289 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 290 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 291 |[39m       expect(result[33m.[39mmove
ments[[35m0[39m][33m.[39mquantityDelta)[33m.[39mto
Be([33m-[39m[35m3[39m)[33m;[39m
     [90m 292 |[39m       [90m// Movements are 
created with consumption type (verified by 
quantityDelta being negative)[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:289:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Task Workflow Integration ÔÇ║ Harvest Task 
Deduction (Requirement 3.2) ÔÇ║ should deduct multiple 
items in harvest workflow

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 353 |[39m
     [90m 354 |[39m       [90m// Assert: Verify both 
items deducted[39m
    [31m[1m>[22m[39m[90m 355 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 356 |[39m       expect(result[33m.[39mmove
ments)[33m.[39mtoHaveLength([35m2[39m)[33m;[39m
     [90m 357 |[39m
     [90m 358 |[39m       [36mconst[39m 
containerMovement [33m=[39m 
result[33m.[39mmovements[33m.[39mfind([0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:355:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Task Workflow Integration ÔÇ║ Idempotency 
(Requirement 3.3) ÔÇ║ should prevent double-deduction 
on retry

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 418 |[39m
     [90m 419 |[39m       [90m// Assert: Second 
request should be idempotent[39m
    [31m[1m>[22m[39m[90m 420 |[39m       expect(re
sult1[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)
[33m;[39m
     [90m     |[39m                               
[31m[1m^[22m[39m
     [90m 421 |[39m       expect(result2[33m.[39msuc
cess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 422 |[39m
     [90m 423 |[39m       [90m// Verify only one 
movement created[39m[0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:420:31)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ Task Workflow Integration ÔÇ║ FIFO Cost Tracking 
(Requirement 9.3) ÔÇ║ should preserve batch cost in 
movements

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 479 |[39m
     [90m 480 |[39m       [90m// Assert: Verify 
movement preserves batch cost[39m
    [31m[1m>[22m[39m[90m 481 |[39m       expect(re
sult[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 482 |[39m
     [90m 483 |[39m       [36mconst[39m movements 
[33m=[39m [36mawait[39m db
     [90m 484 |[39m         [33m.[39m[36mget[39m[
33m<[39m[33mInventoryMovementModel[39m[33m>[39m([3
2m'inventory_movements'[39m)[0m

      at Object.toBe (src/lib/inventory/__tests__/task-i
ntegration.test.ts:481:30)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/assessment/__tests__/assessment-analytics-f
eedback.test.ts
  ÔùÅ getFeedbackStats ÔÇ║ should return limited stats 
for all historical data when days=0

    TypeError: query.extend is not a function

    [0m [90m 34 |[39m   [36mif[39m (days 
[33m===[39m [35m0[39m) {
     [90m 35 |[39m     [90m// WatermelonDB Query 
doesn't have `.limit` ÔÇö use `Q.take` via `extend`[39m
    [31m[1m>[22m[39m[90m 36 |[39m     query 
[33m=[39m query[33m.[39mextend([33mQ[39m[33m.[39
mtake([35m50000[39m))[33m;[39m
     [90m    |[39m                   
[31m[1m^[22m[39m
     [90m 37 |[39m   }
     [90m 38 |[39m
     [90m 39 |[39m   [36mconst[39m allFeedback 
[33m=[39m [36mawait[39m 
query[33m.[39mfetch()[33m;[39m[0m

      at extend (src/lib/assessment/assessment-analytics
-feedback.ts:36:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply (src/lib/assessment/assessment-analytics-
feedback.ts:11:39)
      at Object.<anonymous> (src/lib/assessment/__tests_
_/assessment-analytics-feedback.test.ts:88:41)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/assessment/__tests__/conflict-resolver.test.ts
  ÔùÅ mergePartialUpdate ÔÇ║ adds new fields from server

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 0

      Object {
        "id": "1",
        "name": "Test",
    -   "newField": "new value",
      }

    [0m [90m 174 |[39m     [36mconst[39m merged 
[33m=[39m mergePartialUpdate(localData[33m,[39m 
serverUpdate)[33m;[39m
     [90m 175 |[39m
    [31m[1m>[22m[39m[90m 176 |[39m     
expect(merged)[33m.[39mtoEqual({
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 177 |[39m       id[33m:[39m 
[32m'1'[39m[33m,[39m
     [90m 178 |[39m       name[33m:[39m 
[32m'Test'[39m[33m,[39m
     [90m 179 |[39m       newField[33m:[39m 
[32m'new value'[39m[33m,[39m[0m

      at Object.toEqual (src/lib/assessment/__tests__/co
nflict-resolver.test.ts:176:20)

FAIL src/lib/moderation/__tests__/error-classification.t
est.ts
  ÔùÅ ErrorClassifier ÔÇ║ error message pattern 
classification ÔÇ║ classifies network errors as 
transient

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "network"
    Received: "unknown"

    [0m [90m 76 |[39m       [36mconst[39m 
classified [33m=[39m 
classifier[33m.[39mclassify(error)[33m;[39m
     [90m 77 |[39m
    [31m[1m>[22m[39m[90m 78 |[39m       expect(cla
ssified[33m.[39mcategory)[33m.[39mtoBe([32m'network
'[39m)[33m;[39m
     [90m    |[39m                                   
[31m[1m^[22m[39m
     [90m 79 |[39m       expect(classified[33m.[39mi
sRetryable)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 80 |[39m     })[33m;[39m
     [90m 81 |[39m[0m

      at Object.toBe (src/lib/moderation/__tests__/error
-classification.test.ts:78:35)

  ÔùÅ ErrorClassifier ÔÇ║ suggested actions ÔÇ║ 
suggests escalation for SLA-critical operations

    expect(received).toContain(expected) // indexOf

    Expected substring: "manual fallback"
    Received string:    "Retry operation with 
exponential backoff"

    [0m [90m 193 |[39m       })[33m;[39m
     [90m 194 |[39m
    [31m[1m>[22m[39m[90m 195 |[39m       expect(cl
assified[33m.[39msuggestedAction)[33m.[39mtoContain(
[32m'manual fallback'[39m)[33m;[39m
     [90m     |[39m                                   
       [31m[1m^[22m[39m
     [90m 196 |[39m     })[33m;[39m
     [90m 197 |[39m   })[33m;[39m
     [90m 198 |[39m[0m

      at Object.toContain (src/lib/moderation/__tests__/
error-classification.test.ts:195:42)

  ÔùÅ ErrorClassifier ÔÇ║ singleton instance ÔÇ║ 
isPermanent method works correctly

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 222 |[39m       })[33m;[39m
     [90m 223 |[39m
    [31m[1m>[22m[39m[90m 224 |[39m       expect(er
rorClassifier[33m.[39misPermanent(permanentError))[33
m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                                   
                        [31m[1m^[22m[39m
     [90m 225 |[39m       expect(errorClassifier[33m.
[39misPermanent(transientError))[33m.[39mtoBe([36mfa
lse[39m)[33m;[39m
     [90m 226 |[39m     })[33m;[39m
     [90m 227 |[39m   })[33m;[39m[0m

      at Object.toBe (src/lib/moderation/__tests__/error
-classification.test.ts:224:59)

FAIL 
src/lib/accessibility/__tests__/harvest-labels.test.ts
  ÔùÅ Harvest Accessibility Labels ÔÇ║ 
createStageActionA11yLabel ÔÇ║ should create label for 
advance action

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Advance to Curing stage"
    Received: "Advance to Curing"

    [0m [90m 78 |[39m         targetStage[33m:[39m 
[32m'Curing'[39m[33m,[39m
     [90m 79 |[39m       })[33m;[39m
    [31m[1m>[22m[39m[90m 80 |[39m       
expect(label)[33m.[39mtoBe([32m'Advance to Curing 
stage'[39m)[33m;[39m
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 81 |[39m     })[33m;[39m
     [90m 82 |[39m
     [90m 83 |[39m     it([32m'should create label 
for undo action without seconds'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe (src/lib/accessibility/__tests__/ha
rvest-labels.test.ts:80:21)

  ÔùÅ Harvest Accessibility Labels ÔÇ║ 
createStageActionA11yHint ÔÇ║ should create hint for 
advance action

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "Double-tap to advance to Drying stage"
    Received: "Double-tap to advance to Drying"

    [0m [90m 117 |[39m         
targetStage[33m:[39m [32m'Drying'[39m[33m,[39m
     [90m 118 |[39m       })[33m;[39m
    [31m[1m>[22m[39m[90m 119 |[39m       
expect(hint)[33m.[39mtoBe([32m'Double-tap to advance 
to Drying stage'[39m)[33m;[39m
     [90m     |[39m                    
[31m[1m^[22m[39m
     [90m 120 |[39m     })[33m;[39m
     [90m 121 |[39m
     [90m 122 |[39m     it([32m'should create hint 
for undo action'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.toBe (src/lib/accessibility/__tests__/ha
rvest-labels.test.ts:119:20)

FAIL src/lib/community/__tests__/health-monitor.test.ts
  ÔùÅ CommunityHealthMonitor ÔÇ║ Sentry integration ÔÇ║ 
should not report to Sentry when healthy

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 229 |[39m       [36mawait[39m 
monitor[33m.[39mreportToSentry(result)[33m;[39m
     [90m 230 |[39m
    [31m[1m>[22m[39m[90m 231 |[39m       
[36mconst[39m [33mSentry[39m [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@sentry/react-nat
ive'[39m)[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 232 |[39m       expect([33mSentry[39m[33m
.[39maddBreadcrumb)[33m.[39mnot[33m.[39mtoHaveBeenC
alled()[33m;[39m
     [90m 233 |[39m       expect([33mSentry[39m[33m
.[39mcaptureMessage)[33m.[39mnot[33m.[39mtoHaveBeen
Called()[33m;[39m
     [90m 234 |[39m     })[33m;[39m[0m

      at Object.<anonymous> (src/lib/community/__tests__
/health-monitor.test.ts:231:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CommunityHealthMonitor ÔÇ║ Sentry integration ÔÇ║ 
should report degraded status to Sentry

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 253 |[39m       [36mawait[39m 
monitor[33m.[39mreportToSentry(result)[33m;[39m
     [90m 254 |[39m
    [31m[1m>[22m[39m[90m 255 |[39m       
[36mconst[39m [33mSentry[39m [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@sentry/react-nat
ive'[39m)[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 256 |[39m       expect([33mSentry[39m[33m
.[39maddBreadcrumb)[33m.[39mtoHaveBeenCalledWith(
     [90m 257 |[39m         
expect[33m.[39mobjectContaining({
     [90m 258 |[39m           category[33m:[39m 
[32m'community.health'[39m[33m,[39m[0m

      at Object.<anonymous> (src/lib/community/__tests__
/health-monitor.test.ts:255:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CommunityHealthMonitor ÔÇ║ Sentry integration ÔÇ║ 
should capture critical alerts as Sentry messages

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 282 |[39m       [36mawait[39m 
monitor[33m.[39mreportToSentry(result)[33m;[39m
     [90m 283 |[39m
    [31m[1m>[22m[39m[90m 284 |[39m       
[36mconst[39m [33mSentry[39m [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@sentry/react-nat
ive'[39m)[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 285 |[39m       expect([33mSentry[39m[33m
.[39mcaptureMessage)[33m.[39mtoHaveBeenCalledWith(
     [90m 286 |[39m         
expect[33m.[39mstringContaining([32m'Real-time 
latency P95 exceeds 3s threshold'[39m)[33m,[39m
     [90m 287 |[39m         
expect[33m.[39mobjectContaining({[0m

      at Object.<anonymous> (src/lib/community/__tests__
/health-monitor.test.ts:284:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ CommunityHealthMonitor ÔÇ║ Sentry integration ÔÇ║ 
should sanitize metrics for privacy

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m 314 |[39m       [36mawait[39m 
monitor[33m.[39mreportToSentry(result)[33m;[39m
     [90m 315 |[39m
    [31m[1m>[22m[39m[90m 316 |[39m       
[36mconst[39m [33mSentry[39m [33m=[39m 
[36mawait[39m [36mimport[39m([32m'@sentry/react-nat
ive'[39m)[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 317 |[39m       [36mconst[39m 
breadcrumbCall [33m=[39m 
([33mSentry[39m[33m.[39maddBreadcrumb [36mas[39m 
jest[33m.[39m[33mMock[39m)[33m.[39mmock
     [90m 318 |[39m         
[33m.[39mcalls[[35m0[39m][[35m0[39m][33m;[39m
     [90m 319 |[39m[0m

      at Object.<anonymous> (src/lib/community/__tests__
/health-monitor.test.ts:316:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/__tests__/watermelon-migrations.test.ts
  ÔùÅ WatermelonDB migrations ÔÇ║ has schema version 35

    expect(received).toBe(expected) // Object.is 
equality

    Expected: 35
    Received: 38

    [0m [90m 40 |[39m [36mconst[39m 
testSchemaVersion [33m=[39m () [33m=>[39m {
     [90m 41 |[39m   it([32m'has schema version 
35'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 42 |[39m     
expect((schema [36mas[39m any)[33m.[39mversion)[33m
.[39mtoBe([35m35[39m)[33m;[39m
     [90m    |[39m                                    
 [31m[1m^[22m[39m
     [90m 43 |[39m   })[33m;[39m
     [90m 44 |[39m }[33m;[39m
     [90m 45 |[39m[0m

      at Object.toBe 
(src/lib/__tests__/watermelon-migrations.test.ts:42:37)

FAIL src/lib/notifications/deep-link-service.test.ts
  ÔùÅ DeepLinkService.handle ÔÇ║ defers protected 
navigation when authentication fails

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     router[33m:[39m { 
push[33m:[39m jest[33m.[39mfn() }[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mconst[39m module [33m=[39m [36mawait[39m [36m
import[39m([32m'./deep-link-service'[39m)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m  8 |[39m   [36mconst[39m { router } 
[33m=[39m [36mawait[39m 
[36mimport[39m([32m'expo-router'[39m)[33m;[39m
     [90m  9 |[39m   [36mreturn[39m {
     [90m 10 |[39m     
[33mDeepLinkService[39m[33m:[39m module[33m.[39m[
33mDeepLinkService[39m[33m,[39m[0m

      at 
src/lib/notifications/deep-link-service.test.ts:7:15
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/deep-link-service.test.ts:13:2)
      at apply 
(src/lib/notifications/deep-link-service.test.ts:3:27)
      at Object.loadService 
(src/lib/notifications/deep-link-service.test.ts:31:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DeepLinkService.handle ÔÇ║ navigates to protected 
path when authenticated

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     router[33m:[39m { 
push[33m:[39m jest[33m.[39mfn() }[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mconst[39m module [33m=[39m [36mawait[39m [36m
import[39m([32m'./deep-link-service'[39m)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m  8 |[39m   [36mconst[39m { router } 
[33m=[39m [36mawait[39m 
[36mimport[39m([32m'expo-router'[39m)[33m;[39m
     [90m  9 |[39m   [36mreturn[39m {
     [90m 10 |[39m     
[33mDeepLinkService[39m[33m:[39m module[33m.[39m[
33mDeepLinkService[39m[33m,[39m[0m

      at 
src/lib/notifications/deep-link-service.test.ts:7:15
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/deep-link-service.test.ts:3:27)
      at Object.loadService 
(src/lib/notifications/deep-link-service.test.ts:47:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DeepLinkService.handle ÔÇ║ allows public paths 
without authentication

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     router[33m:[39m { 
push[33m:[39m jest[33m.[39mfn() }[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mconst[39m module [33m=[39m [36mawait[39m [36m
import[39m([32m'./deep-link-service'[39m)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m  8 |[39m   [36mconst[39m { router } 
[33m=[39m [36mawait[39m 
[36mimport[39m([32m'expo-router'[39m)[33m;[39m
     [90m  9 |[39m   [36mreturn[39m {
     [90m 10 |[39m     
[33mDeepLinkService[39m[33m:[39m module[33m.[39m[
33mDeepLinkService[39m[33m,[39m[0m

      at 
src/lib/notifications/deep-link-service.test.ts:7:15
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/deep-link-service.test.ts:3:27)
      at Object.loadService 
(src/lib/notifications/deep-link-service.test.ts:62:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DeepLinkService.handle ÔÇ║ handles post deep link 
without comment

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     router[33m:[39m { 
push[33m:[39m jest[33m.[39mfn() }[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mconst[39m module [33m=[39m [36mawait[39m [36m
import[39m([32m'./deep-link-service'[39m)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m  8 |[39m   [36mconst[39m { router } 
[33m=[39m [36mawait[39m 
[36mimport[39m([32m'expo-router'[39m)[33m;[39m
     [90m  9 |[39m   [36mreturn[39m {
     [90m 10 |[39m     
[33mDeepLinkService[39m[33m:[39m module[33m.[39m[
33mDeepLinkService[39m[33m,[39m[0m

      at 
src/lib/notifications/deep-link-service.test.ts:7:15
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/deep-link-service.test.ts:3:27)
      at Object.loadService 
(src/lib/notifications/deep-link-service.test.ts:77:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ DeepLinkService.handle ÔÇ║ handles post deep link 
with comment scrolling

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     router[33m:[39m { 
push[33m:[39m jest[33m.[39mfn() }[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mconst[39m module [33m=[39m [36mawait[39m [36m
import[39m([32m'./deep-link-service'[39m)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m  8 |[39m   [36mconst[39m { router } 
[33m=[39m [36mawait[39m 
[36mimport[39m([32m'expo-router'[39m)[33m;[39m
     [90m  9 |[39m   [36mreturn[39m {
     [90m 10 |[39m     
[33mDeepLinkService[39m[33m:[39m module[33m.[39m[
33mDeepLinkService[39m[33m,[39m[0m

      at 
src/lib/notifications/deep-link-service.test.ts:7:15
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/deep-link-service.test.ts:3:27)
      at Object.loadService 
(src/lib/notifications/deep-link-service.test.ts:87:47)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/playbooks/__tests__/ai-adjustments-integrat
ion.test.ts
  ÔùÅ AI Adjustments Integration ÔÇ║ complete flow: 
generate ÔåÆ accept ÔåÆ vote

    RangeError: Invalid time value
        at Date.toISOString (<anonymous>)

    [0m [90m 444 |[39m     [36mconst[39m daysToAdd 
[33m=[39m rootCause [33m===[39m 
[32m'skipped_tasks'[39m [33m?[39m [35m2[39m 
[33m:[39m [35m1[39m[33m;[39m
     [90m 445 |[39m     
date[33m.[39msetDate(date[33m.[39mgetDate() 
[33m+[39m daysToAdd)[33m;[39m
    [31m[1m>[22m[39m[90m 446 |[39m     
[36mreturn[39m date[33m.[39mtoISOString()[33m.[39m
split([32m'T'[39m)[[35m0[39m][33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 447 |[39m   }
     [90m 448 |[39m
     [90m 449 |[39m   [36mprivate[39m 
getAdjustmentReason(rootCause[33m:[39m 
[33mAdjustmentRootCause[39m)[33m:[39m string {[0m

      at AIAdjustmentService.toISOString [as 
calculateProposedDate] 
(src/lib/playbooks/ai-adjustment-service.ts:446:17)
      at AIAdjustmentService.calculateProposedDate 
(src/lib/playbooks/ai-adjustment-service.ts:421:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ AI Adjustments Integration ÔÇ║ complete flow: 
generate ÔåÆ decline ÔåÆ cooldown

    RangeError: Invalid time value
        at Date.toISOString (<anonymous>)

    [0m [90m 444 |[39m     [36mconst[39m daysToAdd 
[33m=[39m rootCause [33m===[39m 
[32m'skipped_tasks'[39m [33m?[39m [35m2[39m 
[33m:[39m [35m1[39m[33m;[39m
     [90m 445 |[39m     
date[33m.[39msetDate(date[33m.[39mgetDate() 
[33m+[39m daysToAdd)[33m;[39m
    [31m[1m>[22m[39m[90m 446 |[39m     
[36mreturn[39m date[33m.[39mtoISOString()[33m.[39m
split([32m'T'[39m)[[35m0[39m][33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 447 |[39m   }
     [90m 448 |[39m
     [90m 449 |[39m   [36mprivate[39m 
getAdjustmentReason(rootCause[33m:[39m 
[33mAdjustmentRootCause[39m)[33m:[39m string {[0m

      at AIAdjustmentService.toISOString [as 
calculateProposedDate] 
(src/lib/playbooks/ai-adjustment-service.ts:446:17)
      at AIAdjustmentService.calculateProposedDate 
(src/lib/playbooks/ai-adjustment-service.ts:421:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/playbooks/__tests__/ai-adjustment-service.t
est.ts
  ÔùÅ AIAdjustmentService ÔÇ║ generateSuggestions ÔÇ║ 
generates suggestion with affected tasks

    RangeError: Invalid time value
        at Date.toISOString (<anonymous>)

    [0m [90m 444 |[39m     [36mconst[39m daysToAdd 
[33m=[39m rootCause [33m===[39m 
[32m'skipped_tasks'[39m [33m?[39m [35m2[39m 
[33m:[39m [35m1[39m[33m;[39m
     [90m 445 |[39m     
date[33m.[39msetDate(date[33m.[39mgetDate() 
[33m+[39m daysToAdd)[33m;[39m
    [31m[1m>[22m[39m[90m 446 |[39m     
[36mreturn[39m date[33m.[39mtoISOString()[33m.[39m
split([32m'T'[39m)[[35m0[39m][33m;[39m
     [90m     |[39m                 
[31m[1m^[22m[39m
     [90m 447 |[39m   }
     [90m 448 |[39m
     [90m 449 |[39m   [36mprivate[39m 
getAdjustmentReason(rootCause[33m:[39m 
[33mAdjustmentRootCause[39m)[33m:[39m string {[0m

      at AIAdjustmentService.toISOString [as 
calculateProposedDate] 
(src/lib/playbooks/ai-adjustment-service.ts:446:17)
      at AIAdjustmentService.calculateProposedDate 
(src/lib/playbooks/ai-adjustment-service.ts:421:36)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/nutrient-engine/services/performance-analys
is-service.test.ts
  ÔùÅ performance-analysis-service ÔÇ║ 
analyzePerformanceAndGenerateLearnings ÔÇ║ should 
handle unstable fluctuations by widening both range ends

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "stable"
    Received: "rising"

    [0m [90m 277 |[39m       )[33m;[39m
     [90m 278 |[39m
    [31m[1m>[22m[39m[90m 279 |[39m       expect(re
sult[33m.[39mmetrics[33m.[39mphTrendDirection)[33m.
[39mtoBe([32m'stable'[39m)[33m;[39m
     [90m     |[39m                                   
            [31m[1m^[22m[39m
     [90m 280 |[39m
     [90m 281 |[39m       [36mconst[39m 
phSuggestion [33m=[39m 
result[33m.[39msuggestions[33m.[39mfind(
     [90m 282 |[39m         (s) [33m=>[39m 
s[33m.[39madjustmentType [33m===[39m 
[32m'ph_range'[39m[0m

      at Object.toBe (src/lib/nutrient-engine/services/p
erformance-analysis-service.test.ts:279:47)

  ÔùÅ performance-analysis-service ÔÇ║ 
analyzePerformanceAndGenerateLearnings ÔÇ║ should 
respect phase boundaries when suggesting adjustments

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 6.2
    Received:    6.4

    [0m [90m 315 |[39m
     [90m 316 |[39m       [90m// Should not exceed 
phase max boundary[39m
    [31m[1m>[22m[39m[90m 317 |[39m       expect(ph
Suggestion[33m?[39m[33m.[39msuggestedPhMax)[33m.[3
9mtoBeLessThanOrEqual(
     [90m     |[39m                                   
         [31m[1m^[22m[39m
     [90m 318 |[39m         
mockPhase[33m.[39mphRange[[35m1[39m]
     [90m 319 |[39m       )[33m;[39m
     [90m 320 |[39m     })[33m;[39m[0m

      at Object.toBeLessThanOrEqual (src/lib/nutrient-en
gine/services/performance-analysis-service.test.ts:317:4
4)

FAIL 
src/lib/nutrient-engine/utils/annual-reminder.test.ts
  ÔùÅ annual-reminder ÔÇ║ 
getAnnualTestingEducationalContent ÔÇ║ should return 
educational tips about annual testing

    expect(received).toContain(expected) // indexOf

    Expected value: StringContaining "water quality can 
change"
    Received array: ["Source water quality can change 
seasonally or when utilities adjust treatment", "Annual 
retesting ensures your pH and EC guidance remains 
accurate", "Key parameters to test: pH, EC, alkalinity 
(as CaCOÔéâ), and hardness", "Professional lab testing 
provides most accurate results", "Home testing kits are 
acceptable for tracking trends over time", "Update your 
profile in GrowBro immediately after retesting"]

    Looks like you wanted to test for object/array 
equality with the stricter `toContain` matcher. You 
probably need to use `toContainEqual` instead.

    [0m [90m 300 |[39m
     [90m 301 |[39m       expect(content[33m.[39mlen
gth)[33m.[39mtoBeGreaterThan([35m4[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 302 |[39m       
expect(content)[33m.[39mtoContain(
     [90m     |[39m                       
[31m[1m^[22m[39m
     [90m 303 |[39m         
expect[33m.[39mstringContaining([32m'water quality 
can change'[39m)
     [90m 304 |[39m       )[33m;[39m
     [90m 305 |[39m       expect(content)[33m.[39mto
Contain(expect[33m.[39mstringContaining([32m'Annual 
retesting'[39m))[33m;[39m[0m

      at Object.toContain (src/lib/nutrient-engine/utils
/annual-reminder.test.ts:302:23)

  ÔùÅ annual-reminder ÔÇ║ getWaterTestingChecklist ÔÇ║ 
should include sample collection step

    expect(received).toContain(expected) // indexOf

    Expected value: StringContaining "Collect fresh 
sample"
    Received array: ["Collect fresh sample from your 
grow water source (tap, well, RO system)", "Let tap 
water sit 24 hours if chlorinated (or use 
dechlorinator)", "Test or request lab analysis for: pH, 
EC/TDS, alkalinity, hardness", "Optional: Test for 
calcium, magnesium, iron if using well water", "Record 
all measurements with date in GrowBro", "Compare to 
previous test results to identify trends", "Adjust 
reservoir target ranges if water chemistry changed 
significantly"]

    Looks like you wanted to test for object/array 
equality with the stricter `toContain` matcher. You 
probably need to use `toContainEqual` instead.

    [0m [90m 327 |[39m       [36mconst[39m 
checklist [33m=[39m 
getWaterTestingChecklist()[33m;[39m
     [90m 328 |[39m
    [31m[1m>[22m[39m[90m 329 |[39m       
expect(checklist)[33m.[39mtoContain(
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 330 |[39m         
expect[33m.[39mstringContaining([32m'Collect fresh 
sample'[39m)
     [90m 331 |[39m       )[33m;[39m
     [90m 332 |[39m     })[33m;[39m[0m

      at Object.toContain (src/lib/nutrient-engine/utils
/annual-reminder.test.ts:329:25)

  ÔùÅ annual-reminder ÔÇ║ getWaterTestingChecklist ÔÇ║ 
should include recording results step

    expect(received).toContain(expected) // indexOf

    Expected value: StringContaining "Record"
    Received array: ["Collect fresh sample from your 
grow water source (tap, well, RO system)", "Let tap 
water sit 24 hours if chlorinated (or use 
dechlorinator)", "Test or request lab analysis for: pH, 
EC/TDS, alkalinity, hardness", "Optional: Test for 
calcium, magnesium, iron if using well water", "Record 
all measurements with date in GrowBro", "Compare to 
previous test results to identify trends", "Adjust 
reservoir target ranges if water chemistry changed 
significantly"]

    Looks like you wanted to test for object/array 
equality with the stricter `toContain` matcher. You 
probably need to use `toContainEqual` instead.

    [0m [90m 345 |[39m       [36mconst[39m 
checklist [33m=[39m 
getWaterTestingChecklist()[33m;[39m
     [90m 346 |[39m
    [31m[1m>[22m[39m[90m 347 |[39m       expect(ch
ecklist)[33m.[39mtoContain(expect[33m.[39mstringCont
aining([32m'Record'[39m))[33m;[39m
     [90m     |[39m                         
[31m[1m^[22m[39m
     [90m 348 |[39m       expect(checklist)[33m.[39m
toContain(expect[33m.[39mstringContaining([32m'GrowBr
o'[39m))[33m;[39m
     [90m 349 |[39m     })[33m;[39m
     [90m 350 |[39m   })[33m;[39m[0m

      at Object.toContain (src/lib/nutrient-engine/utils
/annual-reminder.test.ts:347:25)

FAIL src/lib/moderation/transparency-service.test.ts
  ÔùÅ TransparencyService ÔÇ║ Authority Export ÔÇ║ 
should generate export with PII redaction

    TypeError: this.supabase.from(...).select(...).gte(.
..).lte(...).in is not a function

    [0m [90m 707 |[39m       
[33m.[39mgte([32m'timestamp'[39m[33m,[39m 
period[33m.[39mstartDate[33m.[39mtoISOString())
     [90m 708 |[39m       
[33m.[39mlte([32m'timestamp'[39m[33m,[39m 
period[33m.[39mendDate[33m.[39mtoISOString())
    [31m[1m>[22m[39m[90m 709 |[39m       [33m.[3
9m[36min[39m([32m'event_type'[39m[33m,[39m [
     [90m     |[39m          [31m[1m^[22m[39m
     [90m 710 |[39m         
[32m'report_submitted'[39m[33m,[39m
     [90m 711 |[39m         
[32m'decision_made'[39m[33m,[39m
     [90m 712 |[39m         
[32m'appeal_submitted'[39m[33m,[39m[0m

      at TransparencyService.<anonymous> 
(src/lib/moderation/transparency-service.ts:709:10)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at TransparencyService.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at TransparencyService.apply [as 
getAuditTrailForExport] 
(src/lib/moderation/transparency-service.ts:701:39)
      at TransparencyService.getAuditTrailForExport 
(src/lib/moderation/transparency-service.ts:243:12)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at TransparencyService.<anonymous> (node_modules/@
babel/runtime/helpers/asyncToGenerator.js:14:12)
      at TransparencyService.apply [as 
exportForAuthority] 
(src/lib/moderation/transparency-service.ts:234:27)
      at Object.exportForAuthority 
(src/lib/moderation/transparency-service.test.ts:146:40)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/device-id.test.ts
  ÔùÅ device-id ÔÇ║ getDeviceId ÔÇ║ re-checks storage 
before creating promise to handle external writes

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "externally-set-id"
    Received: "retry-id"

    [0m [90m  99 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m getDeviceId()[33m;[39m
     [90m 100 |[39m
    [31m[1m>[22m[39m[90m 101 |[39m       expect(re
sult)[33m.[39mtoBe([32m'externally-set-id'[39m)[33m
;[39m
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 102 |[39m       expect(mockStorage[33m.[39
mgetString)[33m.[39mtoHaveBeenCalledTimes([35m3[39m)
[33m;[39m
     [90m 103 |[39m       expect(mockCrypto[33m.[39m
randomUUID)[33m.[39mnot[33m.[39mtoHaveBeenCalled()[
33m;[39m
     [90m 104 |[39m       expect(mockStorage[33m.[39
m[36mset[39m)[33m.[39mnot[33m.[39mtoHaveBeenCalled
()[33m;[39m[0m

      at Object.toBe (src/lib/device-id.test.ts:101:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ device-id ÔÇ║ getDeviceIdSync ÔÇ║ returns 
temporary ID when no device ID exists

    expect(jest.fn()).toHaveBeenCalledTimes(expected)

    Expected number of calls: 1
    Received number of calls: 2

    [0m [90m 126 |[39m       
expect(result)[33m.[39mtoBe(tempId)[33m;[39m
     [90m 127 |[39m       expect(mockStorage[33m.[39
mgetString)[33m.[39mtoHaveBeenCalledWith([32m'device_
id'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 128 |[39m       expect(mo
ckCrypto[33m.[39mrandomUUID)[33m.[39mtoHaveBeenCalle
dTimes([35m1[39m)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 129 |[39m     })[33m;[39m
     [90m 130 |[39m
     [90m 131 |[39m     test([32m'triggers async 
generation when no device ID exists'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {[0m

      at Object.toHaveBeenCalledTimes 
(src/lib/device-id.test.ts:128:37)

  ÔùÅ device-id ÔÇ║ getDeviceIdSync ÔÇ║ triggers async 
generation when no device ID exists

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "temp-uuid-123"
    Received: "temp-final-uuid"

    [0m [90m 139 |[39m       [36mconst[39m result 
[33m=[39m getDeviceIdSync()[33m;[39m
     [90m 140 |[39m
    [31m[1m>[22m[39m[90m 141 |[39m       
expect(result)[33m.[39mtoBe(tempId)[33m;[39m
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 142 |[39m       expect(mockCrypto[33m.[39m
randomUUID)[33m.[39mtoHaveBeenCalledTimes([35m1[39m)
[33m;[39m
     [90m 143 |[39m
     [90m 144 |[39m       [90m// Flush microtasks to 
allow the background promise to resolve[39m[0m

      at Object.toBe (src/lib/device-id.test.ts:141:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/__tests__/feature-flags.test.ts
  ÔùÅ feature-flags ÔÇ║ getFeatureFlags ÔÇ║ returns 
feature flags from environment

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 3

      Object {
    +   "aiAdjustmentsEnabled": false,
    +   "aiAdjustmentsMinConfidence": 0.7,
    +   "aiAdjustmentsMinSkippedTasks": 2,
        "strainsEnabled": true,
        "strainsFavoritesSync": false,
        "strainsOfflineCache": true,
      }

    [0m [90m 28 |[39m     test([32m'returns feature 
flags from environment'[39m[33m,[39m () [33m=>[39m 
{
     [90m 29 |[39m       [36mconst[39m flags 
[33m=[39m getFeatureFlags()[33m;[39m
    [31m[1m>[22m[39m[90m 30 |[39m       
expect(flags)[33m.[39mtoEqual({
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 31 |[39m         strainsEnabled[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 32 |[39m         
strainsFavoritesSync[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 33 |[39m         
strainsOfflineCache[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.toEqual 
(src/lib/__tests__/feature-flags.test.ts:30:21)

  ÔùÅ feature-flags ÔÇ║ getFeatureFlags ÔÇ║ uses 
default values when env vars undefined

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 3

      Object {
    +   "aiAdjustmentsEnabled": false,
    +   "aiAdjustmentsMinConfidence": 0.7,
    +   "aiAdjustmentsMinSkippedTasks": 2,
        "strainsEnabled": true,
        "strainsFavoritesSync": true,
        "strainsOfflineCache": true,
      }

    [0m [90m 44 |[39m
     [90m 45 |[39m       [36mconst[39m flags 
[33m=[39m getFeatureFlags()[33m;[39m
    [31m[1m>[22m[39m[90m 46 |[39m       
expect(flags)[33m.[39mtoEqual({
     [90m    |[39m                     
[31m[1m^[22m[39m
     [90m 47 |[39m         strainsEnabled[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 48 |[39m         
strainsFavoritesSync[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 49 |[39m         
strainsOfflineCache[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.toEqual 
(src/lib/__tests__/feature-flags.test.ts:46:21)

  ÔùÅ feature-flags ÔÇ║ useFeatureFlags ÔÇ║ returns 
feature flags from store

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 4

      Object {
    +   "aiAdjustmentsEnabled": false,
    +   "aiAdjustmentsMinConfidence": 0.7,
    +   "aiAdjustmentsMinSkippedTasks": 2,
        "strainsEnabled": true,
    -   "strainsFavoritesSync": false,
    +   "strainsFavoritesSync": true,
        "strainsOfflineCache": true,
      }

    [0m [90m 57 |[39m     test([32m'returns feature 
flags from store'[39m[33m,[39m () [33m=>[39m {
     [90m 58 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m 
useFeatureFlags())[33m;[39m
    [31m[1m>[22m[39m[90m 59 |[39m       
expect(result[33m.[39mcurrent)[33m.[39mtoEqual({
     [90m    |[39m                              
[31m[1m^[22m[39m
     [90m 60 |[39m         strainsEnabled[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 61 |[39m         
strainsFavoritesSync[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 62 |[39m         
strainsOfflineCache[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.toEqual 
(src/lib/__tests__/feature-flags.test.ts:59:30)

  ÔùÅ feature-flags ÔÇ║ useFeatureFlags ÔÇ║ re-renders 
when flags refreshed

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 3

      Object {
    +   "aiAdjustmentsEnabled": false,
    +   "aiAdjustmentsMinConfidence": 0.7,
    +   "aiAdjustmentsMinSkippedTasks": 2,
        "strainsEnabled": false,
        "strainsFavoritesSync": true,
        "strainsOfflineCache": true,
      }

    [0m [90m 76 |[39m       })[33m;[39m
     [90m 77 |[39m
    [31m[1m>[22m[39m[90m 78 |[39m       
expect(result[33m.[39mcurrent)[33m.[39mtoEqual({
     [90m    |[39m                              
[31m[1m^[22m[39m
     [90m 79 |[39m         strainsEnabled[33m:[39m 
[36mfalse[39m[33m,[39m
     [90m 80 |[39m         
strainsFavoritesSync[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 81 |[39m         
strainsOfflineCache[33m:[39m 
[36mtrue[39m[33m,[39m[0m

      at Object.toEqual 
(src/lib/__tests__/feature-flags.test.ts:78:30)

  ÔùÅ feature-flags ÔÇ║ refreshFeatureFlags ÔÇ║ updates 
store with current env values

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 89 |[39m     test([32m'updates store 
with current env values'[39m[33m,[39m () 
[33m=>[39m {
     [90m 90 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m 
useFeatureFlags())[33m;[39m
    [31m[1m>[22m[39m[90m 91 |[39m       expect(res
ult[33m.[39mcurrent[33m.[39mstrainsEnabled)[33m.[3
9mtoBe([36mtrue[39m)[33m;[39m
     [90m    |[39m                                    
         [31m[1m^[22m[39m
     [90m 92 |[39m
     [90m 93 |[39m       [36mconst[39m originalEnv 
[33m=[39m { [33m...[39m[33mEnv[39m }[33m;[39m
     [90m 94 |[39m       [33mObject[39m[33m.[39mas
sign([33mEnv[39m[33m,[39m { 
[33mFEATURE_STRAINS_ENABLED[39m[33m:[39m 
[36mfalse[39m })[33m;[39m[0m

      at Object.toBe 
(src/lib/__tests__/feature-flags.test.ts:91:45)

  ÔùÅ feature-flags ÔÇ║ isFeatureEnabled ÔÇ║ returns 
true for enabled features

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 105 |[39m   
describe([32m'isFeatureEnabled'[39m[33m,[39m () 
[33m=>[39m {
     [90m 106 |[39m     test([32m'returns true for 
enabled features'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 107 |[39m       expect(is
FeatureEnabled([32m'strainsEnabled'[39m))[33m.[39mto
Be([36mtrue[39m)[33m;[39m
     [90m     |[39m                                   
               [31m[1m^[22m[39m
     [90m 108 |[39m       expect(isFeatureEnabled([32
m'strainsOfflineCache'[39m))[33m.[39mtoBe([36mtrue[
39m)[33m;[39m
     [90m 109 |[39m     })[33m;[39m
     [90m 110 |[39m[0m

      at Object.toBe 
(src/lib/__tests__/feature-flags.test.ts:107:50)

  ÔùÅ feature-flags ÔÇ║ isFeatureEnabled ÔÇ║ returns 
false for disabled features

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 110 |[39m
     [90m 111 |[39m     test([32m'returns false for 
disabled features'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 112 |[39m       expect(is
FeatureEnabled([32m'strainsFavoritesSync'[39m))[33m.
[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                                   
                     [31m[1m^[22m[39m
     [90m 113 |[39m     })[33m;[39m
     [90m 114 |[39m
     [90m 115 |[39m     test([32m'returns undefined 
for invalid feature key'[39m[33m,[39m () 
[33m=>[39m {[0m

      at Object.toBe 
(src/lib/__tests__/feature-flags.test.ts:112:56)

  ÔùÅ feature-flags ÔÇ║ useFeatureFlag ÔÇ║ returns 
feature flag value for specific feature

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 129 |[39m       )[33m;[39m
     [90m 130 |[39m
    [31m[1m>[22m[39m[90m 131 |[39m       expect(en
abledResult[33m.[39mcurrent)[33m.[39mtoBe([36mtrue
[39m)[33m;[39m
     [90m     |[39m                                   
  [31m[1m^[22m[39m
     [90m 132 |[39m       expect(disabledResult[33m.
[39mcurrent)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 133 |[39m     })[33m;[39m
     [90m 134 |[39m[0m

      at Object.toBe 
(src/lib/__tests__/feature-flags.test.ts:131:37)

  ÔùÅ feature-flags ÔÇ║ useFeatureFlag ÔÇ║ re-renders 
when flags refreshed

    expect(received).toBe(expected) // Object.is 
equality

    Expected: true
    Received: false

    [0m [90m 135 |[39m     test([32m're-renders 
when flags refreshed'[39m[33m,[39m () [33m=>[39m {
     [90m 136 |[39m       [36mconst[39m { result } 
[33m=[39m renderHook(() [33m=>[39m 
useFeatureFlag([32m'strainsEnabled'[39m))[33m;[39m
    [31m[1m>[22m[39m[90m 137 |[39m       expect(re
sult[33m.[39mcurrent)[33m.[39mtoBe([36mtrue[39m)[
33m;[39m
     [90m     |[39m                              
[31m[1m^[22m[39m
     [90m 138 |[39m
     [90m 139 |[39m       [36mconst[39m originalEnv 
[33m=[39m { [33m...[39m[33mEnv[39m }[33m;[39m
     [90m 140 |[39m       [33mObject[39m[33m.[39ma
ssign([33mEnv[39m[33m,[39m { 
[33mFEATURE_STRAINS_ENABLED[39m[33m:[39m 
[36mfalse[39m })[33m;[39m[0m

      at Object.toBe 
(src/lib/__tests__/feature-flags.test.ts:137:30)

FAIL src/lib/moderation/geo-location-service.test.ts
  ÔùÅ GeoLocationService ÔÇ║ applyGeoRestriction ÔÇ║ 
should apply geo-restriction to content

    GeoLocationError: 
_supabase.supabase.from(...).select is not a function

    [0m [90m 526 |[39m
     [90m 527 |[39m     [36mconst[39m message 
[33m=[39m error [36minstanceof[39m [33mError[39m 
[33m?[39m error[33m.[39mmessage [33m:[39m 
[33mString[39m(error)[33m;[39m
    [31m[1m>[22m[39m[90m 528 |[39m     
[36mreturn[39m [36mnew[39m 
[33mGeoLocationError[39m(message[33m,[39m 
code[33m,[39m metadata)[33m;[39m
     [90m     |[39m            [31m[1m^[22m[39m
     [90m 529 |[39m   }
     [90m 530 |[39m }
     [90m 531 |[39m[0m

      at GeoLocationService.handleError 
(src/lib/moderation/geo-location-service.ts:528:12)
      at GeoLocationService.handleError 
(src/lib/moderation/geo-location-service.ts:312:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at GeoLocationService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at GeoLocationService.apply [as 
notifyGeoRestriction] 
(src/lib/moderation/geo-location-service.ts:265:29)
      at GeoLocationService.notifyGeoRestriction 
(src/lib/moderation/geo-location-service.ts:248:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ GeoLocationService ÔÇ║ applyGeoRestriction ÔÇ║ 
should expand EU region code to member states

    GeoLocationError: 
_supabase.supabase.from(...).select is not a function

    [0m [90m 526 |[39m
     [90m 527 |[39m     [36mconst[39m message 
[33m=[39m error [36minstanceof[39m [33mError[39m 
[33m?[39m error[33m.[39mmessage [33m:[39m 
[33mString[39m(error)[33m;[39m
    [31m[1m>[22m[39m[90m 528 |[39m     
[36mreturn[39m [36mnew[39m 
[33mGeoLocationError[39m(message[33m,[39m 
code[33m,[39m metadata)[33m;[39m
     [90m     |[39m            [31m[1m^[22m[39m
     [90m 529 |[39m   }
     [90m 530 |[39m }
     [90m 531 |[39m[0m

      at GeoLocationService.handleError 
(src/lib/moderation/geo-location-service.ts:528:12)
      at GeoLocationService.handleError 
(src/lib/moderation/geo-location-service.ts:312:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at GeoLocationService.<anonymous> (node_modules/@b
abel/runtime/helpers/asyncToGenerator.js:14:12)
      at GeoLocationService.apply [as 
notifyGeoRestriction] 
(src/lib/moderation/geo-location-service.ts:265:29)
      at GeoLocationService.notifyGeoRestriction 
(src/lib/moderation/geo-location-service.ts:248:18)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/privacy/deletion-manager.test.ts
  ÔùÅ deletion-manager - deleteAccountInApp ÔÇ║ 
surfaces Supabase errors

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 2
    Received array:  [{"action": 
"account-delete-request", "details": {"deletionUrl": 
"https://growbro.app/delete-account", 
"estimatedCompletion": "2025-09-01T00:00:00Z", "jobId": 
"job-123", "reason": "test_reason", "source": 
"in_app"}, "hash": "44997610", "id": "1", "prevHash": 
"0", "t": 1768559128986}, {"action": 
"account-delete-request", "details": {"deletionUrl": 
"https://growbro.app/delete-account", "reason": 
"user_initiated_in_app", "source": "in_app"}, "hash": 
"369d5b11", "id": "2", "prevHash": "44997610", "t": 
1768559129013}]

    [0m [90m 87 |[39m
     [90m 88 |[39m     [36mconst[39m audit 
[33m=[39m [36mawait[39m getAuditLog()[33m;[39m
    [31m[1m>[22m[39m[90m 89 |[39m     expect(audit
)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m    |[39m                   
[31m[1m^[22m[39m
     [90m 90 |[39m     expect(audit[[35m0[39m][33m?
[39m[33m.[39mdetails)[33m.[39mtoEqual(
     [90m 91 |[39m       
expect[33m.[39mobjectContaining({ source[33m:[39m 
[32m'in_app'[39m })
     [90m 92 |[39m     )[33m;[39m[0m

      at Object.toHaveLength 
(src/lib/privacy/deletion-manager.test.ts:89:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ deletion-manager - data export and web deletion 
ÔÇ║ requestDeletionViaWeb queues deletion and audits 
web source

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 4
    Received array:  [{"action": 
"account-delete-request", "details": {"deletionUrl": 
"https://growbro.app/delete-account", 
"estimatedCompletion": "2025-09-01T00:00:00Z", "jobId": 
"job-123", "reason": "test_reason", "source": 
"in_app"}, "hash": "44997610", "id": "1", "prevHash": 
"0", "t": 1768559128986}, {"action": 
"account-delete-request", "details": {"deletionUrl": 
"https://growbro.app/delete-account", "reason": 
"user_initiated_in_app", "source": "in_app"}, "hash": 
"369d5b11", "id": "2", "prevHash": "44997610", "t": 
1768559129013}, {"action": "account-delete-request", 
"details": {"deletionUrl": 
"https://growbro.app/delete-account", 
"estimatedCompletion": "2025-09-01T00:00:00Z", "jobId": 
"job-123", "reason": "data_export_before_delete", 
"source": "in_app"}, "hash": "932b3f68", "id": "3", 
"prevHash": "369d5b11", "t": 1768559129201}, {"action": 
"account-delete-request", "details": {"deletionUrl": 
"https://growbro.app/delete-account", 
"estimatedCompletion": "2025-09-01T00:00:00Z", "jobId": 
"job-123", "reason": "web_self_service", "source": 
"web", "userId": "user-1"}, "hash": "2b305828", "id": 
"4", "prevHash": "932b3f68", "t": 1768559129223}]

    [0m [90m 131 |[39m
     [90m 132 |[39m     [36mconst[39m audit 
[33m=[39m [36mawait[39m getAuditLog()[33m;[39m
    [31m[1m>[22m[39m[90m 133 |[39m     expect(audi
t)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m     |[39m                   
[31m[1m^[22m[39m
     [90m 134 |[39m     
expect(audit[[35m0[39m])[33m.[39mtoMatchObject({
     [90m 135 |[39m       details[33m:[39m 
expect[33m.[39mobjectContaining({
     [90m 136 |[39m         source[33m:[39m 
[32m'web'[39m[33m,[39m[0m

      at Object.toHaveLength 
(src/lib/privacy/deletion-manager.test.ts:133:19)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL 
src/lib/watermelon-models/__tests__/favorite.test.ts
  ÔùÅ FavoriteModel - parsedSnapshot ÔÇ║ parses valid 
JSON snapshot correctly

    expect(received).toEqual(expected) // deep equality

    - Expected  - 4
    + Received  + 5

      Object {
    -   "id": "strain-123",
    -   "imageUrl": "https://example.com/image.jpg",
    -   "name": "OG Kush",
    +   "id": undefined,
    +   "imageUrl": "",
    +   "name": "Unknown Strain",
        "race": "hybrid",
    -   "thc_display": "18-24%",
    +   "slug": "unknown",
    +   "thc_display": "Not reported",
      }

    [0m [90m 36 |[39m     [36mconst[39m snapshot 
[33m=[39m model[33m.[39mparsedSnapshot[33m;[39m
     [90m 37 |[39m
    [31m[1m>[22m[39m[90m 38 |[39m     
expect(snapshot)[33m.[39mtoEqual({
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 39 |[39m       id[33m:[39m 
[32m'strain-123'[39m[33m,[39m
     [90m 40 |[39m       name[33m:[39m [32m'OG 
Kush'[39m[33m,[39m
     [90m 41 |[39m       race[33m:[39m 
[32m'hybrid'[39m[33m,[39m[0m

      at Object.toEqual (src/lib/watermelon-models/__tes
ts__/favorite.test.ts:38:22)

  ÔùÅ FavoriteModel - parsedSnapshot ÔÇ║ returns safe 
default on invalid JSON

    expect(received).toEqual(expected) // deep equality

    - Expected  - 1
    + Received  + 2

      Object {
    -   "id": "strain-123",
    +   "id": undefined,
        "imageUrl": "",
        "name": "Unknown Strain",
        "race": "hybrid",
    +   "slug": "unknown",
        "thc_display": "Not reported",
      }

    [0m [90m 61 |[39m     [36mconst[39m snapshot 
[33m=[39m model[33m.[39mparsedSnapshot[33m;[39m
     [90m 62 |[39m
    [31m[1m>[22m[39m[90m 63 |[39m     
expect(snapshot)[33m.[39mtoEqual({
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 64 |[39m       id[33m:[39m 
[32m'strain-123'[39m[33m,[39m
     [90m 65 |[39m       name[33m:[39m 
[32m'Unknown Strain'[39m[33m,[39m
     [90m 66 |[39m       race[33m:[39m 
[32m'hybrid'[39m[33m,[39m[0m

      at Object.toEqual (src/lib/watermelon-models/__tes
ts__/favorite.test.ts:63:22)

  ÔùÅ FavoriteModel - needsSync ÔÇ║ returns false when 
syncedAt is after updatedAt

    expect(received).toBe(expected) // Object.is 
equality

    Expected: false
    Received: true

    [0m [90m 121 |[39m     })[33m;[39m
     [90m 122 |[39m
    [31m[1m>[22m[39m[90m 123 |[39m     expect(mode
l[33m.[39mneedsSync)[33m.[39mtoBe([36mfalse[39m)[
33m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m 124 |[39m   })[33m;[39m
     [90m 125 |[39m })[33m;[39m
     [90m 126 |[39m[0m

      at Object.toBe (src/lib/watermelon-models/__tests_
_/favorite.test.ts:123:29)

FAIL src/lib/watermelon-models/notification-preference.t
est.ts
  ÔùÅ NotificationPreferenceModel ÔÇ║ findOrCreate ÔÇ║ 
returns existing record

    TypeError: Cannot read properties of undefined 
(reading 'fetch')

    [0m [90m 48 |[39m     it([32m'returns existing 
record'[39m[33m,[39m [36masync[39m () [33m=>[39m 
{
     [90m 49 |[39m       [36mconst[39m existing 
[33m=[39m { id[33m:[39m [32m'1'[39m[33m,[39m 
userId[33m:[39m [32m'user-123'[39m }[33m;[39m
    [31m[1m>[22m[39m[90m 50 |[39m       mockCollec
tion[33m.[39mfetch[33m.[39mmockResolvedValue([existi
ng])[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 51 |[39m
     [90m 52 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m [33mNotificationPreferenceM
odel[39m[33m.[39mfindOrCreate(
     [90m 53 |[39m         mockDatabase [36mas[39m 
any[33m,[39m[0m

      at Object.fetch (src/lib/watermelon-models/notific
ation-preference.test.ts:50:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationPreferenceModel ÔÇ║ findOrCreate ÔÇ║ 
creates new record with defaults

    TypeError: Cannot read properties of undefined 
(reading 'fetch')

    [0m [90m 60 |[39m     it([32m'creates new 
record with defaults'[39m[33m,[39m [36masync[39m 
() [33m=>[39m {
     [90m 61 |[39m       [36mconst[39m created 
[33m=[39m { id[33m:[39m [32m'2'[39m[33m,[39m 
userId[33m:[39m [32m'user-123'[39m }[33m;[39m
    [31m[1m>[22m[39m[90m 62 |[39m       mockCollec
tion[33m.[39mfetch[33m.[39mmockResolvedValue([])[33
m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 63 |[39m       mockCollection[33m.[39mcrea
te[33m.[39mmockResolvedValue(created)[33m;[39m
     [90m 64 |[39m
     [90m 65 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m [33mNotificationPreferenceM
odel[39m[33m.[39mfindOrCreate([0m

      at Object.fetch (src/lib/watermelon-models/notific
ation-preference.test.ts:62:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationPreferenceModel ÔÇ║ findOrCreate ÔÇ║ 
creates new record with custom defaults

    TypeError: Cannot read properties of undefined 
(reading 'fetch')

    [0m [90m 74 |[39m     it([32m'creates new 
record with custom defaults'[39m[33m,[39m 
[36masync[39m () [33m=>[39m {
     [90m 75 |[39m       [36mconst[39m created 
[33m=[39m { id[33m:[39m [32m'3'[39m[33m,[39m 
userId[33m:[39m [32m'user-456'[39m }[33m;[39m
    [31m[1m>[22m[39m[90m 76 |[39m       mockCollec
tion[33m.[39mfetch[33m.[39mmockResolvedValue([])[33
m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 77 |[39m       mockCollection[33m.[39mcrea
te[33m.[39mmockResolvedValue(created)[33m;[39m
     [90m 78 |[39m
     [90m 79 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m [33mNotificationPreferenceM
odel[39m[33m.[39mfindOrCreate([0m

      at Object.fetch (src/lib/watermelon-models/notific
ation-preference.test.ts:76:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationPreferenceModel ÔÇ║ upsert ÔÇ║ is an 
alias for findOrCreate

    TypeError: Cannot read properties of undefined 
(reading 'fetch')

    [0m [90m 92 |[39m     it([32m'is an alias for 
findOrCreate'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m 93 |[39m       [36mconst[39m existing 
[33m=[39m { id[33m:[39m [32m'4'[39m[33m,[39m 
userId[33m:[39m [32m'user-789'[39m }[33m;[39m
    [31m[1m>[22m[39m[90m 94 |[39m       mockCollec
tion[33m.[39mfetch[33m.[39mmockResolvedValue([existi
ng])[33m;[39m
     [90m    |[39m                      
[31m[1m^[22m[39m
     [90m 95 |[39m
     [90m 96 |[39m       [36mconst[39m result 
[33m=[39m [36mawait[39m 
[33mNotificationPreferenceModel[39m[33m.[39mupsert(
     [90m 97 |[39m         mockDatabase [36mas[39m 
any[33m,[39m[0m

      at Object.fetch (src/lib/watermelon-models/notific
ation-preference.test.ts:94:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationPreferenceModel ÔÇ║ concurrent 
operations ÔÇ║ handles concurrent calls

    TypeError: Cannot read properties of undefined 
(reading 'fetch')

    [0m [90m 107 |[39m   describe([32m'concurrent 
operations'[39m[33m,[39m () [33m=>[39m {
     [90m 108 |[39m     it([32m'handles concurrent 
calls'[39m[33m,[39m [36masync[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 109 |[39m       mockColle
ction[33m.[39mfetch[33m.[39mmockResolvedValueOnce([]
)[33m;[39m
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 110 |[39m       mockCollection[33m.[39mcre
ate[33m.[39mmockResolvedValue({
     [90m 111 |[39m         id[33m:[39m 
[32m'5'[39m[33m,[39m
     [90m 112 |[39m         userId[33m:[39m 
[32m'concurrent'[39m[33m,[39m[0m

      at Object.fetch (src/lib/watermelon-models/notific
ation-preference.test.ts:109:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ NotificationPreferenceModel ÔÇ║ concurrent 
operations ÔÇ║ uses write transaction

    TypeError: Cannot read properties of undefined 
(reading 'fetch')

    [0m [90m 135 |[39m     it([32m'uses write 
transaction'[39m[33m,[39m [36masync[39m () 
[33m=>[39m {
     [90m 136 |[39m       [36mconst[39m existing 
[33m=[39m { id[33m:[39m [32m'7'[39m[33m,[39m 
userId[33m:[39m [32m'transaction'[39m }[33m;[39m
    [31m[1m>[22m[39m[90m 137 |[39m       mockColle
ction[33m.[39mfetch[33m.[39mmockResolvedValue([exist
ing])[33m;[39m
     [90m     |[39m                      
[31m[1m^[22m[39m
     [90m 138 |[39m
     [90m 139 |[39m       [36mawait[39m [33mNotific
ationPreferenceModel[39m[33m.[39mfindOrCreate(
     [90m 140 |[39m         mockDatabase [36mas[39m 
any[33m,[39m[0m

      at Object.fetch (src/lib/watermelon-models/notific
ation-preference.test.ts:137:22)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/privacy/consent-service.getConsents.test.ts
  ÔùÅ ConsentService.getConsents ÔÇ║ returns stored 
consent when version matches

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 2

      Object {
    -   "aiTraining": true,
    +   "aiTraining": false,
        "cloudProcessing": false,
        "crashDiagnostics": false,
        "experiments": false,
        "locale": Any<String>,
    -   "telemetry": true,
    +   "telemetry": false,
        "timestamp": Any<String>,
        "version": "2025-09-01",
      }

    [0m [90m 52 |[39m
     [90m 53 |[39m     [90m// Should return the 
stored consent values, but with updated locale and 
timestamp[39m
    [31m[1m>[22m[39m[90m 54 |[39m     
expect(result)[33m.[39mtoEqual({
     [90m    |[39m                    
[31m[1m^[22m[39m
     [90m 55 |[39m       
[33m...[39mstoredConsent[33m,[39m
     [90m 56 |[39m       timestamp[33m:[39m 
expect[33m.[39many([33mString[39m)[33m,[39m 
[90m// timestamp gets updated to current time[39m
     [90m 57 |[39m       locale[33m:[39m 
expect[33m.[39many([33mString[39m)[33m,[39m 
[90m// locale gets updated to current locale[39m[0m

      at Object.toEqual (src/lib/privacy/consent-service
.getConsents.test.ts:54:20)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

  ÔùÅ ConsentService.getConsents - versioning ÔÇ║ 
clears and returns fresh defaults when stored version 
is outdated

    expect(received).toBe(expected) // Object.is 
equality

    Expected: "2025-09-01"
    Received: "2024-01-01"

    [0m [90m  95 |[39m     [90m// Should have 
cleared the old data from storage[39m
     [90m  96 |[39m     [36mconst[39m stored 
[33m=[39m [36mawait[39m getSecureConfig[33m<[39m[
33mConsentState[39m[33m>[39m([33mCONSENT_KEY[39m)[
33m;[39m
    [31m[1m>[22m[39m[90m  97 |[39m     expect(stor
ed[33m?[39m[33m.[39mversion)[33m.[39mtoBe([33mCUR
RENT_CONSENT_VERSION[39m)[33m;[39m
     [90m     |[39m                             
[31m[1m^[22m[39m
     [90m  98 |[39m     expect(stored[33m?[39m[33m.
[39mtelemetry)[33m.[39mtoBe([36mfalse[39m)[33m;[3
9m
     [90m  99 |[39m   })[33m;[39m
     [90m 100 |[39m })[33m;[39m[0m

      at Object.toBe (src/lib/privacy/consent-service.ge
tConsents.test.ts:97:29)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)

FAIL src/lib/notifications/notification-badge.test.ts
  ÔùÅ notification-badge ÔÇ║ sanitizes badge counts

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     
setBadgeCountAsync[33m:[39m 
setBadgeCountMock[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mreturn[39m [36mimport[39m([32m'@/lib/notificati
ons/notification-badge'[39m)[33m;[39m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m  8 |[39m }
     [90m  9 |[39m
     [90m 10 |[39m 
describe([32m'notification-badge'[39m[33m,[39m () 
[33m=>[39m {[0m

      at 
src/lib/notifications/notification-badge.test.ts:7:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/notification-badge.test.ts:8:2)
      at apply 
(src/lib/notifications/notification-badge.test.ts:3:28)
      at Object.importModule 
(src/lib/notifications/notification-badge.test.ts:17:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ notification-badge ÔÇ║ updates badge count with 
sanitized value

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     
setBadgeCountAsync[33m:[39m 
setBadgeCountMock[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mreturn[39m [36mimport[39m([32m'@/lib/notificati
ons/notification-badge'[39m)[33m;[39m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m  8 |[39m }
     [90m  9 |[39m
     [90m 10 |[39m 
describe([32m'notification-badge'[39m[33m,[39m () 
[33m=>[39m {[0m

      at 
src/lib/notifications/notification-badge.test.ts:7:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/notification-badge.test.ts:3:28)
      at Object.importModule 
(src/lib/notifications/notification-badge.test.ts:26:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

  ÔùÅ notification-badge ÔÇ║ logs warning when update 
fails

    TypeError: A dynamic import callback was invoked 
without --experimental-vm-modules

    [0m [90m  5 |[39m     
setBadgeCountAsync[33m:[39m 
setBadgeCountMock[33m,[39m
     [90m  6 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m  7 |[39m   
[36mreturn[39m [36mimport[39m([32m'@/lib/notificati
ons/notification-badge'[39m)[33m;[39m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m  8 |[39m }
     [90m  9 |[39m
     [90m 10 |[39m 
describe([32m'notification-badge'[39m[33m,[39m () 
[33m=>[39m {[0m

      at 
src/lib/notifications/notification-badge.test.ts:7:3
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/lib/notifications/notification-badge.test.ts:3:28)
      at Object.importModule 
(src/lib/notifications/notification-badge.test.ts:36:26)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL src/lib/strains/parse-percentage.test.ts
  ÔùÅ parsePercentageRange ÔÇ║ edge cases ÔÇ║ handles 
empty string

    expect(received).toEqual(expected) // deep equality

    - Expected  - 3
    + Received  + 1

    - Object {
    -   "label": "",
    - }
    + Object {}

    [0m[0m

      at Object.<anonymous> 
(src/lib/strains/parse-percentage.test.ts:87:60)

FAIL src/lib/strains/generate-id.test.ts
  ÔùÅ generateId ÔÇ║ generates unique IDs

    expect(received).toMatch(expected)

    Expected pattern: /^strain:[0-9a-f]{8}-[0-9a-f]{4}-[
0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/
    Received string:  "strain_1768559137408_jx42u3"

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mimport[39m { generateId } 
[36mfrom[39m [32m'./normalization'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 6 |[39m
     [90m   |[39m [31m[1m^[22m[39m
     [90m 7 |[39m 
describe([32m'generateId'[39m[33m,[39m () 
[33m=>[39m {
     [90m 8 |[39m   test([32m'generates unique 
IDs'[39m[33m,[39m () [33m=>[39m {
     [90m 9 |[39m     [36mconst[39m id1 [33m=[39m 
generateId()[33m;[39m[0m

      at Object.<anonymous> 
(src/lib/strains/generate-id.test.ts:6:17)

FAIL src/api/auth/use-request-account-deletion.test.tsx
  ÔùÅ useRequestAccountDeletion ÔÇ║ 
checkPendingDeletion ÔÇ║ uses snake_case column names 
in queries

    TypeError: _supabase.supabase.from(...).select(...).
eq(...).eq(...).limit is not a function

    [0m [90m 236 |[39m     
[33m.[39meq([32m'user_id'[39m[33m,[39m userId)
     [90m 237 |[39m     
[33m.[39meq([32m'status'[39m[33m,[39m 
[32m'pending'[39m)
    [31m[1m>[22m[39m[90m 238 |[39m     
[33m.[39mlimit([35m1[39m)[33m;[39m
     [90m     |[39m      [31m[1m^[22m[39m
     [90m 239 |[39m
     [90m 240 |[39m   [36mconst[39m row [33m=[39m 
data[33m?[39m[33m.[39m[[35m0[39m][33m;[39m
     [90m 241 |[39m   [36mif[39m (error 
[33m||[39m [33m![39mrow) {[0m

      at limit 
(src/api/auth/use-request-account-deletion.ts:238:6)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:14:12
      at apply 
(src/api/auth/use-request-account-deletion.ts:254:2)
      at apply 
(src/api/auth/use-request-account-deletion.ts:230:43)
      at Object.<anonymous> (src/api/auth/use-request-ac
count-deletion.test.tsx:237:48)
      at asyncGeneratorStep (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyn
cToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGene
rator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime
/helpers/asyncToGenerator.js:14:12)

FAIL 
src/lib/__tests__/watermelondb-plugin-config.test.ts
  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Package 
Dependencies ÔÇ║ WatermelonDB core dependencies are 
installed

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Package 
Dependencies ÔÇ║ Legacy WatermelonDB Expo plugin is not 
required

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Expo Config 
Plugin Setup ÔÇ║ expo-build-properties config declares 
simdjson pod

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Expo Config 
Plugin Setup ÔÇ║ expo-build-properties config declares 
libc++ pickFirst

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Development 
Build Requirements ÔÇ║ EAS build configuration exists

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Development 
Build Requirements ÔÇ║ development build profile is 
configured

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Development 
Build Requirements ÔÇ║ README documents development 
build requirement

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Database 
Schema Configuration ÔÇ║ WatermelonDB schema includes 
inventory tables

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Database 
Schema Configuration ÔÇ║ inventory_items table has 
required columns

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Database 
Schema Configuration ÔÇ║ inventory_batches table has 
required columns

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Database 
Schema Configuration ÔÇ║ inventory_movements table has 
required columns

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Database 
Adapter Configuration ÔÇ║ database adapter is 
configured for SQLite

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Database 
Adapter Configuration ÔÇ║ synchronize() includes 
inventory tables

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ CI/CD 
Guards ÔÇ║ CI should fail if build properties are 
missing

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ CI/CD 
Guards ÔÇ║ inventory schema version is up to date

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Migration 
Configuration ÔÇ║ migrations directory exists

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

  ÔùÅ WatermelonDB Plugin Configuration ÔÇ║ Migration 
Configuration ÔÇ║ schema includes migration support

    Cannot find module 
'C:\Users\Peter\GrowBro\app.config.cjs' from 
'src/lib/__tests__/watermelondb-plugin-config.test.ts'

    [0m [90m  7 |[39m [90m * Requirements:[39m
     [90m  8 |[39m [90m * - 10.1: WatermelonDB 
offline-first local storage[39m
    [31m[1m>[22m[39m[90m  9 |[39m [90m * - 10.2: 
Expo config plugin setup with development build 
requirements[39m
     [90m    |[39m                                  
[31m[1m^[22m[39m
     [90m 10 |[39m [90m */[39m
     [90m 11 |[39m
     [90m 12 |[39m [36mimport[39m fs [36mfrom[39m 
[32m'fs'[39m[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/lib/__tests__/watermelo
ndb-plugin-config.test.ts:9:34)

FAIL src/lib/assessment/assessment-analytics.test.ts
  ÔùÅ Test suite failed to run

    TypeError: (0 , _watermelondb.tableSchema) is not a 
function

    [0m [90m  6 |[39m     tableSchema({
     [90m  7 |[39m       name[33m:[39m 
[32m'series'[39m[33m,[39m
    [31m[1m>[22m[39m[90m  8 |[39m       
columns[33m:[39m [
     [90m    |[39m                           
[31m[1m^[22m[39m
     [90m  9 |[39m         { name[33m:[39m 
[32m'title'[39m[33m,[39m type[33m:[39m 
[32m'string'[39m }[33m,[39m
     [90m 10 |[39m         { name[33m:[39m 
[32m'description'[39m[33m,[39m type[33m:[39m 
[32m'string'[39m[33m,[39m isOptional[33m:[39m 
[36mtrue[39m }[33m,[39m
     [90m 11 |[39m         { name[33m:[39m 
[32m'dtstart_local'[39m[33m,[39m type[33m:[39m 
[32m'string'[39m }[33m,[39m[0m

      at Object.<anonymous> 
(src/lib/watermelon-schema.ts:8:42)
      at Object.require 
(src/lib/database/unsafe-sql-utils.ts:4:1)
      at Object.require 
(src/lib/assessment/assessment-analytics-summary.ts:1:1)
      at Object.<anonymous> 
(src/lib/assessment/assessment-analytics.ts:50:35)
      at Object.<anonymous> 
(src/lib/assessment/assessment-analytics.test.ts:74:28)

FAIL src/lib/assessment/__tests__/integration/task-creat
ion-flow.test.ts
  ÔùÅ Test suite failed to run

    Cannot find module '../../../action-tracking' from '
src/lib/assessment/__tests__/integration/task-creation-f
low.test.ts'

    [0m [90m 20 |[39m }))[33m;[39m
     [90m 21 |[39m
    [31m[1m>[22m[39m[90m 22 |[39m jest[33m.[39mm
ock([32m'@/lib/action-tracking'[39m[33m,[39m () 
[33m=>[39m ({
     [90m    |[39m      [31m[1m^[22m[39m
     [90m 23 |[39m   trackTaskCreation[33m:[39m 
jest[33m.[39mfn()[33m,[39m
     [90m 24 |[39m }))[33m;[39m
     [90m 25 |[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.mock (src/lib/assessment/__tests__/integ
ration/task-creation-flow.test.ts:22:6)

FAIL src/app/post/[id]/comment/[comment-id].test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\app\post\
[id]\comment\[comment-id].test.tsx: The module factory 
of `jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: redirectSpy
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 10 |[39m 
jest[33m.[39mmock([32m'expo-router'[39m[33m,[39m 
() [33m=>[39m ({
     [90m 11 |[39m   [33mRedirect[39m[33m:[39m 
(props[33m:[39m { href[33m:[39m string }) 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 12 |[39m     
redirectSpy(props)[33m;[39m
     [90m    |[39m     [31m[1m^[22m[39m[31m[1m^
[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[
1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[3
1m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39
m[31m[1m^[22m[39m
     [90m 13 |[39m     [36mreturn[39m 
[36mnull[39m[33m;[39m
     [90m 14 |[39m   }[33m,[39m
     [90m 15 |[39m   useLocalSearchParams[33m:[39m 
() [33m=>[39m 
useLocalSearchParamsMock()[33m,[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/app/(app)/playbooks/__tests__/[id].test.tsx
  ÔùÅ Test suite failed to run

    Your test suite must contain at least one test.

      at onResult 
(node_modules/@jest/core/build/TestScheduler.js:133:18)
      at 
node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit 
(node_modules/emittery/index.js:361:23)

FAIL 
src/app/(app)/inventory/__tests__/navigation.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/inventory/offline-banner.tsx:13:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../inventory/__tests__/navigation.test.tsx:12
:1)

FAIL src/lib/strains/__tests__/performance.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/difficulty-badge.tsx:3:1)
      at Object.require 
(src/components/strains/strain-card.tsx:16:1)
      at Object.require (src/components/strains/strains-
list-with-cache.tsx:17:1)
      at Object.require 
(src/lib/strains/__tests__/performance.test.tsx:10:1)

FAIL src/lib/strains/__tests__/navigation.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/lib/strains/__tests__/navigation.test.tsx:9:1)

FAIL src/lib/nutrient-engine/services/diagnostic-service
.test.ts
  ÔùÅ Test suite failed to run

    TypeError: Super expression must either be null or 
a function

    [0m [90m 56 |[39m
     [90m 57 |[39m   [90m// Relations[39m
    [31m[1m>[22m[39m[90m 58 |[39m   [33m@[39mrel
ation([32m'source_water_profiles_v2'[39m[33m,[39m 
[32m'source_water_profile_id'[39m)
     [90m    |[39m                                    
                               [31m[1m^[22m[39m
     [90m 59 |[39m   
sourceWaterProfile[33m?[39m[33m:[39m [33mRelation[
39m[33m<[39m[33mSourceWaterProfileModel[39m[33m>[3
9m[33m;[39m
     [90m 60 |[39m }
     [90m 61 |[39m[0m

      at _inherits 
(node_modules/@babel/runtime/helpers/inherits.js:3:51)
      at src/lib/watermelon-models/reservoir.ts:58:67
      at Object.<anonymous> 
(src/lib/watermelon-models/reservoir.ts:58:67)
      at Object.require (src/lib/nutrient-engine/service
s/diagnostic-service.ts:6:1)
      at Object.require (src/lib/nutrient-engine/service
s/diagnostic-service.test.ts:9:1)

FAIL src/lib/inventory/__tests__/batch-picking-service.t
est.ts
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\lib\inven
tory\__tests__\batch-picking-service.test.ts: The 
module factory of `jest.mock()` is not allowed to 
reference any out-of-scope variables.
    Invalid variable access: LokiJSAdapter
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 26 |[39m
     [90m 27 |[39m jest[33m.[39mmock([32m'@nozbe/wa
termelondb/adapters/sqlite'[39m[33m,[39m () 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 28 |[39m   
[36mconst[39m [33mLokiJSAdapterMock[39m [33m=[39m 
[33mLokiJSAdapter[39m[33m;[39m
     [90m    |[39m                             [31m[
1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[3
1m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39
m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m
[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^
[22m[39m[31m[1m^[22m[39m
     [90m 29 |[39m
     [90m 30 |[39m   [90m// Return a class that 
wraps LokiJSAdapter[39m
     [90m 31 |[39m   [36mreturn[39m [36mclass[39m 
[33mMockSQLiteAdapter[39m [36mextends[39m 
[33mLokiJSAdapterMock[39m {[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/lib/assessment/__tests__/cloud-inference-flow.t
est.ts
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\lib\asses
sment\__tests__\cloud-inference-flow.test.ts: The 
module factory of `jest.mock()` is not allowed to 
reference any out-of-scope variables.
    Invalid variable access: storageFromMock
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 14 |[39m   supabase[33m:[39m {
     [90m 15 |[39m     storage[33m:[39m {
    [31m[1m>[22m[39m[90m 16 |[39m       
[36mfrom[39m[33m:[39m storageFromMock[33m,[39m
     [90m    |[39m             [31m[1m^[22m[39m[3
1m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39
m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m
[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^
[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[
1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
     [90m 17 |[39m     }[33m,[39m
     [90m 18 |[39m     functions[33m:[39m {
     [90m 19 |[39m       invoke[33m:[39m 
functionsInvokeMock[33m,[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/lib/auth/__tests__/performance.test.ts
  ÔùÅ Test suite failed to run

    Your test suite must contain at least one test.

      at onResult 
(node_modules/@jest/core/build/TestScheduler.js:133:18)
      at 
node_modules/@jest/core/build/TestScheduler.js:254:19
      at node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit 
(node_modules/emittery/index.js:361:23)

FAIL src/components/playbooks/__tests__/playbook-selecti
on-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/playbooks/playbo
ok-selection-card.tsx:15:1)
      at Object.require (src/components/playbooks/playbo
ok-selection-list.tsx:14:1)
      at Object.require (src/components/playbooks/__test
s__/playbook-selection-list.test.tsx:5:1)

FAIL src/components/playbooks/__tests__/playbook-selecti
on-card.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/playbooks/playbo
ok-selection-card.tsx:15:1)
      at Object.require (src/components/playbooks/__test
s__/playbook-selection-card.test.tsx:3:1)

FAIL src/components/playbooks/__tests__/adjustment-sugge
stion-card.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/playbooks/adjust
ment-suggestion-card.tsx:6:1)
      at Object.require (src/components/playbooks/__test
s__/adjustment-suggestion-card.test.tsx:6:1)

FAIL src/components/nutrient-engine/__tests__/diagnostic
-result-card.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/nutrient-engine/
diagnostic-result-card.tsx:4:1)
      at Object.require (src/components/nutrient-engine/
__tests__/diagnostic-result-card.test.tsx:3:1)

FAIL src/components/inventory/__tests__/inventory-valuat
ion-summary.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/inventory/invent
ory-valuation-summary.tsx:14:1)
      at Object.require (src/components/inventory/__test
s__/inventory-valuation-summary.test.tsx:10:1)

FAIL src/components/inventory/__tests__/cost-breakdown-c
ard.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/inventory/cost-breakdown-card.tsx:14:1)
      at Object.require (src/components/inventory/__test
s__/cost-breakdown-card.test.tsx:13:1)

FAIL src/components/inventory/__tests__/cost-trend-chart
.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/inventory/cost-trend-chart.tsx:18:1)
      at Object.require (src/components/inventory/__test
s__/cost-trend-chart.test.tsx:13:1)

FAIL src/components/inventory/__tests__/consumption-hist
ory-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/inventory/consum
ption-history-list.tsx:17:1)
      at Object.require (src/components/inventory/__test
s__/consumption-history-list.test.tsx:13:1)

FAIL src/components/assessment/__tests__/assessment-hist
ory-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/assessment/asses
sment-history-list.tsx:17:1)
      at Object.require (src/components/assessment/__tes
ts__/assessment-history-list.test.tsx:12:1)

FAIL src/app/settings/__tests__/profile.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/settings/validation-feedback.tsx:13:1)
      at Object.require 
(src/app/settings/profile.tsx:23:1)
      at Object.require 
(src/app/settings/__tests__/profile.test.tsx:14:1)

FAIL src/app/settings/__tests__/performance.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/cannabis-educational-banner.tsx:3:1)
      at Object.require (src/app/settings/index.tsx:6:1)
      at Object.require 
(src/app/settings/__tests__/performance.test.tsx:14:1)

FAIL 
src/app/settings/__tests__/privacy-and-data.test.tsx
  ÔùÅ Test suite failed to run

    TypeError: Cannot read properties of undefined 
(reading 'SCROLLVIEW')

    [0m [90m 39 |[39m   
[33mBottomSheetScrollViewMethods[39m[33m,[39m
     [90m 40 |[39m   
[33mBottomSheetKeyboardAwareProps[39m
    [31m[1m>[22m[39m[90m 41 |[39m [33m>[39m([33
mSCROLLABLE_TYPE[39m[33m.[39m[33mSCROLLVIEW[39m[33
m,[39m [33mAnimatedScrollView[39m)[33m;[39m
     [90m    |[39m                   
[31m[1m^[22m[39m
     [90m 42 |[39m [36mconst[39m 
[33mBottomSheetKeyboardAwareScrollView[39m 
[33m=[39m memo([33mBottomSheetScrollViewComponent[39
m)[33m;[39m
     [90m 43 |[39m
     [90m 44 |[39m [33mBottomSheetKeyboardAwareScroll
View[39m[33m.[39mdisplayName [33m=[39m[0m

      at Object.SCROLLVIEW (src/components/ui/modal-keyb
oard-aware-scroll-view.tsx:41:19)
      at Object.require 
(src/components/auth/re-auth-modal.tsx:20:1)
      at Object.require 
(src/app/settings/privacy-and-data.tsx:4:1)
      at Object.require (src/app/settings/__tests__/priv
acy-and-data.test.tsx:7:1)

FAIL 
src/app/settings/__tests__/accessibility-audit.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/settings/item.tsx:3:1)
      at Object.require (src/app/settings/about.tsx:8:1)
      at Object.require (src/app/settings/__tests__/acce
ssibility-audit.test.tsx:7:1)

FAIL src/app/settings/support/feedback.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/app/settings/support/feedback.tsx:14:1)
      at Object.require 
(src/app/settings/support/feedback.test.tsx:13:1)

FAIL src/app/notifications/__tests__/index.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/notifications/notification-row.tsx:3:1)
      at Object.require 
(src/app/notifications/index.tsx:6:1)
      at Object.require 
(src/app/notifications/__tests__/index.test.tsx:3:1)

FAIL src/app/(app)/__tests__/_layout.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\app\(app)
\__tests__\_layout.test.tsx: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: statusSelector
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 40 |[39m     
[33m...[39mactual[33m,[39m
     [90m 41 |[39m     translate[33m:[39m 
jest[33m.[39mfn((key[33m:[39m string) [33m=>[39m 
key)[33m,[39m
    [31m[1m>[22m[39m[90m 42 |[39m     
useAuth[33m:[39m { use[33m:[39m { status[33m:[39m 
statusSelector } }[33m,[39m
     [90m    |[39m                               [31m
[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[
39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[2
2m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m
^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
     [90m 43 |[39m     useIsFirstTime[33m:[39m () 
[33m=>[39m [[36mfalse[39m][33m,[39m
     [90m 44 |[39m     useAgeGate[33m:[39m { 
status[33m:[39m ageGateStatusMock }[33m,[39m
     [90m 45 |[39m   }[33m;[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/app/(app)/__tests__/strains.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/active-filters-row.tsx:5:1)
      at Object.require 
(src/components/strains/index.ts:1:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../strains/index.tsx:7:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../__tests__/strains.test.tsx:7:1)

FAIL src/app/(app)/__tests__/community.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\app\(app)
\__tests__\community.test.tsx: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: analyticsTrackMock
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 19 |[39m     
[33m...[39mactual[33m,[39m
     [90m 20 |[39m     translate[33m:[39m 
jest[33m.[39mfn((key[33m:[39m string) [33m=>[39m 
key)[33m,[39m
    [31m[1m>[22m[39m[90m 21 |[39m     
useAnalytics[33m:[39m () [33m=>[39m ({ 
track[33m:[39m analyticsTrackMock })[33m,[39m
     [90m    |[39m                                   
[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[
39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[2
2m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m
^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m
[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[
39m[31m[1m^[22m[39m
     [90m 22 |[39m   }[33m;[39m
     [90m 23 |[39m })[33m;[39m
     [90m 24 |[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/app/(app)/inventory/add.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../inventory/add.tsx:23:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../inventory/add.test.tsx:6:1)

FAIL 
supabase/functions/__tests__/auth-edge-functions.test.ts
  ÔùÅ Test suite failed to run

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when 
your code or its dependencies use non-standard 
JavaScript syntax, or when Jest is not configured to 
support such syntax.

    Out of the box Jest supports Babel, which will be 
used to transform your files into valid JS based on 
your Babel configuration.

    By default "node_modules" folder is ignored by 
transformers.

    Here's what you can do:
     ÔÇó If you are trying to use ECMAScript Modules, 
see https://jestjs.io/docs/ecmascript-modules for how 
to enable it.
     ÔÇó If you are trying to use TypeScript, see 
https://jestjs.io/docs/getting-started#using-typescript
     ÔÇó To have some of your "node_modules" files 
transformed, you can specify a custom 
"transformIgnorePatterns" in your config.
     ÔÇó If you need a custom transformation specify a 
"transform" option in your config.
     ÔÇó If you simply want to mock your non-JS modules 
(e.g. binary assets) you can stub them out with the 
"moduleNameMapper" config option.

    You'll find more details and examples of these 
config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    SyntaxError: C:\Users\Peter\GrowBro\supabase\functio
ns\__tests__\auth-edge-functions.test.ts: Identifier 
'supabase' has already been declared. (71:6)

    [0m [90m 69 |[39m }
     [90m 70 |[39m
    [31m[1m>[22m[39m[90m 71 |[39m [36mconst[39m 
supabase[33m:[39m [33mSupabaseClient[39m 
[33m=[39m createClient(
     [90m    |[39m       [31m[1m^[22m[39m
     [90m 72 |[39m   [33mSUPABASE_URL[39m[33m,[39m
     [90m 73 |[39m   
[33mSUPABASE_SERVICE_ROLE_KEY[39m
     [90m 74 |[39m )[33m;[39m[0m

      at constructor (node_modules/@babel/core/node_modu
les/@babel/parser/src/parse-error.ts:95:45)
      at TypeScriptParserMixin.toParseError [as raise] (
node_modules/@babel/core/node_modules/@babel/parser/src/
tokenizer/index.ts:1503:19)
      at TypeScriptScopeHandler.raise [as 
checkRedeclarationInScope] (node_modules/@babel/core/nod
e_modules/@babel/parser/src/util/scope.ts:164:19)
      at 
TypeScriptScopeHandler.checkRedeclarationInScope (node_m
odules/@babel/core/node_modules/@babel/parser/src/util/s
cope.ts:118:12)
      at TypeScriptScopeHandler.declareName (node_module
s/@babel/core/node_modules/@babel/parser/src/plugins/typ
escript/scope.ts:89:11)
      at TypeScriptParserMixin.declareName [as 
declareNameFromIdentifier] (node_modules/@babel/core/nod
e_modules/@babel/parser/src/parser/lval.ts:818:16)
      at 
TypeScriptParserMixin.declareNameFromIdentifier [as 
checkIdentifier] (node_modules/@babel/core/node_modules/
@babel/parser/src/parser/lval.ts:813:12)
      at TypeScriptParserMixin.checkIdentifier [as 
checkLVal] (node_modules/@babel/core/node_modules/@babel
/parser/src/parser/lval.ts:713:12)
      at TypeScriptParserMixin.checkLVal (node_modules/@
babel/core/node_modules/@babel/parser/src/parser/stateme
nt.ts:1628:10)
      at TypeScriptParserMixin.parseVarId (node_modules/
@babel/core/node_modules/@babel/parser/src/plugins/types
cript/index.ts:3663:13)
      at TypeScriptParserMixin.parseVarId [as parseVar] 
(node_modules/@babel/core/node_modules/@babel/parser/src
/parser/statement.ts:1577:12)
      at TypeScriptParserMixin.parseVar (node_modules/@b
abel/core/node_modules/@babel/parser/src/parser/statemen
t.ts:1246:10)
      at TypeScriptParserMixin.parseVarStatement (node_m
odules/@babel/core/node_modules/@babel/parser/src/plugin
s/typescript/index.ts:3126:33)
      at TypeScriptParserMixin.parseVarStatement (node_m
odules/@babel/core/node_modules/@babel/parser/src/parser
/statement.ts:607:21)
      at TypeScriptParserMixin.parseStatementContent (no
de_modules/@babel/core/node_modules/@babel/parser/src/pl
ugins/typescript/index.ts:3185:20)
      at TypeScriptParserMixin.parseStatementContent 
[as parseStatementLike] (node_modules/@babel/core/node_m
odules/@babel/parser/src/parser/statement.ts:477:17)
      at TypeScriptParserMixin.parseStatementLike [as 
parseModuleItem] (node_modules/@babel/core/node_modules/
@babel/parser/src/parser/statement.ts:414:17)
      at TypeScriptParserMixin.parseModuleItem [as 
parseBlockOrModuleBlockBody] (node_modules/@babel/core/n
ode_modules/@babel/parser/src/parser/statement.ts:1438:1
6)
      at 
TypeScriptParserMixin.parseBlockOrModuleBlockBody [as 
parseBlockBody] (node_modules/@babel/core/node_modules/@
babel/parser/src/parser/statement.ts:1412:10)
      at TypeScriptParserMixin.parseBlockBody [as 
parseProgram] (node_modules/@babel/core/node_modules/@ba
bel/parser/src/parser/statement.ts:229:10)
      at TypeScriptParserMixin.parseProgram [as 
parseTopLevel] (node_modules/@babel/core/node_modules/@b
abel/parser/src/parser/statement.ts:203:25)
      at TypeScriptParserMixin.parseTopLevel (node_modul
es/@babel/core/node_modules/@babel/parser/src/parser/ind
ex.ts:93:10)
      at TypeScriptParserMixin.parse (node_modules/@babe
l/core/node_modules/@babel/parser/src/plugins/typescript
/index.ts:4309:20)
      at parse (node_modules/@babel/core/node_modules/@b
abel/parser/src/index.ts:92:38)
      at parser 
(node_modules/@babel/core/src/parser/index.ts:28:19)
          at parser.next (<anonymous>)
      at normalizeFile (node_modules/@babel/core/src/tra
nsformation/normalize-file.ts:49:24)
          at normalizeFile.next (<anonymous>)
      at run (node_modules/@babel/core/src/transformatio
n/index.ts:40:36)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL supabase/functions/send-push-notification/payload-v
alidator.test.ts
  ÔùÅ Test suite failed to run

    ReferenceError: Deno is not defined

    [0m [90m  9 |[39m } [36mfrom[39m 
[32m'./payload-validator'[39m[33m;[39m
     [90m 10 |[39m
    [31m[1m>[22m[39m[90m 11 |[39m 
[33mDeno[39m[33m.[39mtest([32m'validatePayloadSize 
- accepts small payload'[39m[33m,[39m () 
[33m=>[39m {
     [90m    |[39m [31m[1m^[22m[39m
     [90m 12 |[39m   [36mconst[39m payload 
[33m=[39m {
     [90m 13 |[39m     to[33m:[39m [32m'ExponentPus
hToken[xxxxxxxxxxxxxxxxxxxxxx]'[39m[33m,[39m
     [90m 14 |[39m     title[33m:[39m 
[32m'Test'[39m[33m,[39m[0m

      at Object.Deno (supabase/functions/send-push-notif
ication/payload-validator.test.ts:11:1)

FAIL src/lib/__tests__/sync-status.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/sync/sync-status.tsx:5:1)
      at Object.require 
(src/lib/__tests__/sync-status.test.tsx:4:1)

FAIL src/lib/__tests__/sync-offline-e2e.test.ts
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\lib\__tes
ts__\sync-offline-e2e.test.ts: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: isOnline
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 22 |[39m     auth[33m:[39m {
     [90m 23 |[39m       getSession[33m:[39m 
jest[33m.[39mfn()[33m.[39mmockImplementation(() 
[33m=>[39m {
    [31m[1m>[22m[39m[90m 24 |[39m         
[36mif[39m ([33m![39misOnline) {
     [90m    |[39m              [31m[1m^[22m[39m[
31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[3
9m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22
m[39m[31m[1m^[22m[39m
     [90m 25 |[39m           [36mreturn[39m 
[33mPromise[39m[33m.[39mreject([36mnew[39m 
[33mError[39m([32m'Network 
unavailable'[39m))[33m;[39m
     [90m 26 |[39m         }
     [90m 27 |[39m         [36mreturn[39m 
[33mPromise[39m[33m.[39mresolve({[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/lib/moderation/use-geo-location.test.ts
  ÔùÅ Test suite failed to run

    Cannot find module '../geo-location-service' from 
'src/lib/moderation/use-geo-location.test.ts'

    [0m [90m 21 |[39m [90m// Mock dependencies[39m
     [90m 22 |[39m jest[33m.[39mmock([32m'expo-loca
tion'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 23 |[39m jest[33m.[39mm
ock([32m'../geo-location-service'[39m)[33m;[39m
     [90m    |[39m      [31m[1m^[22m[39m
     [90m 24 |[39m jest[33m.[39mmock([32m'@/lib/sup
abase'[39m)[33m;[39m
     [90m 25 |[39m
     [90m 26 |[39m afterEach(cleanup)[33m;[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.mock 
(src/lib/moderation/use-geo-location.test.ts:23:6)

FAIL src/lib/moderation/sor-export-queue.test.ts
  ÔùÅ Test suite failed to run

    PII_SCRUBBING_SALT environment variable is required 
in production

    [0m [90m 76 |[39m     [36mif[39m 
([33m![39msalt) {
     [90m 77 |[39m       [36mif[39m (environment 
[33m===[39m [32m'production'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mthrow[39m [36mnew[39m [33mError[39m(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 79 |[39m           [32m'PII_SCRUBBING_SALT 
environment variable is required in production'[39m
     [90m 80 |[39m         )[33m;[39m
     [90m 81 |[39m       }[0m

      at new PIIScrubber 
(src/lib/moderation/pii-scrubber.ts:78:15)
      at Object.<anonymous> 
(src/lib/moderation/pii-scrubber.ts:332:28)
      at Object.require 
(src/lib/moderation/sor-export-queue.ts:20:1)
      at Object.require 
(src/lib/moderation/sor-export-queue.test.ts:3:1)

FAIL src/lib/moderation/sla-monitor-service.test.ts
  ÔùÅ Test suite failed to run

    Cannot find module '../audit-service' from 
'src/lib/moderation/sla-monitor-service.test.ts'

    [0m [90m 20 |[39m
     [90m 21 |[39m [90m// Mock audit service[39m
    [31m[1m>[22m[39m[90m 22 |[39m jest[33m.[39mm
ock([32m'../audit-service'[39m[33m,[39m () 
[33m=>[39m ({
     [90m    |[39m      [31m[1m^[22m[39m
     [90m 23 |[39m   
[33mAuditService[39m[33m:[39m 
jest[33m.[39mfn()[33m.[39mmockImplementation(() 
[33m=>[39m ({
     [90m 24 |[39m     logEvent[33m:[39m jest[33m.
[39mfn()[33m.[39mmockResolvedValue(undefined)[33m,[3
9m
     [90m 25 |[39m   }))[33m,[39m[0m

      at Resolver._throwModNotFoundError 
(node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.mock 
(src/lib/moderation/sla-monitor-service.test.ts:22:6)

FAIL src/lib/moderation/pii-scrubber.test.ts
  ÔùÅ Test suite failed to run

    PII_SCRUBBING_SALT environment variable is required 
in production

    [0m [90m 76 |[39m     [36mif[39m 
([33m![39msalt) {
     [90m 77 |[39m       [36mif[39m (environment 
[33m===[39m [32m'production'[39m) {
    [31m[1m>[22m[39m[90m 78 |[39m         
[36mthrow[39m [36mnew[39m [33mError[39m(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 79 |[39m           [32m'PII_SCRUBBING_SALT 
environment variable is required in production'[39m
     [90m 80 |[39m         )[33m;[39m
     [90m 81 |[39m       }[0m

      at new PIIScrubber 
(src/lib/moderation/pii-scrubber.ts:78:15)
      at Object.<anonymous> 
(src/lib/moderation/pii-scrubber.ts:332:28)
      at Object.require 
(src/lib/moderation/pii-scrubber.test.ts:3:1)

FAIL src/components/__tests__/cannabis-educational-banne
r.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/cannabis-educational-banner.tsx:3:1)
      at Object.require (src/components/__tests__/cannab
is-educational-banner.test.tsx:3:1)

FAIL 
src/components/strains/strains-list-with-cache.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\component
s\strains\strains-list-with-cache.test.tsx: The module 
factory of `jest.mock()` is not allowed to reference 
any out-of-scope variables.
    Invalid variable access: _ReactNativeCSSInterop
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.
     (This is an error on an internal node. Probably an 
internal error.)

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/components/strains/strains-empty-state.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/strains-empty-state.tsx:4:1)
      at Object.require (src/components/strains/strains-
empty-state.test.tsx:5:1)

FAIL src/components/strains/strain-card.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\component
s\strains\strain-card.test.tsx: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: React
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 13 |[39m 
jest[33m.[39mmock([32m'expo-router'[39m[33m,[39m 
() [33m=>[39m ({
     [90m 14 |[39m   [33mLink[39m[33m:[39m ({ 
children[33m,[39m href[33m,[39m [33m...[39mprops 
}[33m:[39m any) [33m=>[39m {
    [31m[1m>[22m[39m[90m 15 |[39m     
[36mconst[39m child [33m=[39m [33mReact[39m[33m.
[39m[33mChildren[39m[33m.[39monly(children)[33m;[3
9m
     [90m    |[39m                   [31m[1m^[22m[
39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[2
2m[39m[31m[1m^[22m[39m
     [90m 16 |[39m     [36mreturn[39m 
[33mReact[39m[33m.[39mcloneElement(child[33m,[39m 
{
     [90m 17 |[39m       [33m...[39mprops[33m,[39m
     [90m 18 |[39m       
[33m...[39mchild[33m.[39mprops[33m,[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/components/strains/race-badge.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/race-badge.tsx:3:1)
      at Object.require 
(src/components/strains/race-badge.test.tsx:3:1)

FAIL src/components/strains/filter-modal.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/filter-modal.tsx:5:1)
      at Object.require 
(src/components/strains/filter-modal.test.tsx:11:1)

FAIL src/components/strains/filter-chips.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/filter-chips.tsx:4:1)
      at Object.require 
(src/components/strains/filter-chips.test.tsx:6:1)

FAIL src/components/strains/favorite-button.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/strains/favorite-button.tsx:11:1)
      at Object.require 
(src/components/strains/favorite-button.test.tsx:3:1)

FAIL src/components/strains/did-you-mean.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/strains/did-you-mean.tsx:3:1)
      at Object.require 
(src/components/strains/did-you-mean.test.tsx:7:1)

FAIL src/components/sync/sync-status.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/sync/sync-status.tsx:5:1)
      at Object.require 
(src/components/sync/sync-status.test.tsx:4:1)

FAIL src/components/sync/enhanced-conflict-resolution-mo
dal.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/sync/enhanced-co
nflict-resolution-modal.tsx:14:1)
      at Object.require (src/components/sync/enhanced-co
nflict-resolution-modal.test.tsx:5:1)

FAIL src/components/sync/connectivity-banner.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/sync/connectivity-banner.tsx:3:1)
      at Object.require 
(src/components/sync/connectivity-banner.test.tsx:4:1)

FAIL 
src/components/settings/legal-document-viewer.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/settings/offline-badge.tsx:10:1)
      at Object.require 
(src/components/settings/legal-document-viewer.tsx:12:1)
      at Object.require (src/components/settings/legal-d
ocument-viewer.test.tsx:5:1)

FAIL 
src/components/playbooks/share-template-modal.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/playbooks/share-template-modal.tsx:19:1)
      at Object.require (src/components/playbooks/share-
template-modal.test.tsx:5:1)

FAIL src/components/playbooks/phase-timeline.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/playbooks/phase-timeline.tsx:16:1)
      at Object.require 
(src/components/playbooks/phase-timeline.test.tsx:7:1)

FAIL src/components/playbooks/assumptions-chip.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/playbooks/assumptions-chip.tsx:11:1)
      at Object.require 
(src/components/playbooks/assumptions-chip.test.tsx:5:1)

FAIL src/components/plants/plants-card.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/plants/completion-progress.tsx:10:1)
      at Object.require 
(src/components/plants/index.ts:1:1)
      at Object.require 
(src/components/plants/plants-card.test.tsx:4:1)

FAIL src/components/plants/plant-form.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/plants/completion-progress.tsx:10:1)
      at Object.require 
(src/components/plants/plant-form.tsx:28:1)
      at Object.require 
(src/components/plants/plant-form.test.tsx:6:1)

FAIL src/components/onboarding/permission-primer-screen.
test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/onboarding/permi
ssion-primer-screen.tsx:12:1)
      at Object.require (src/components/onboarding/permi
ssion-primer-screen.test.tsx:5:1)

FAIL src/components/onboarding/pagination-dots.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/onboarding/pagination-dots.tsx:19:1)
      at Object.require (src/components/onboarding/pagin
ation-dots.test.tsx:10:1)

FAIL src/components/onboarding/onboarding-pager.test.tsx
  ÔùÅ Test suite failed to run

    TypeError: Cannot read properties of undefined 
(reading '950')

    [0m [90m 231 |[39m   backdrop[33m:[39m {
     [90m 232 |[39m     [90m// Use centralized 
design token for charcoal 950 and append alpha '66' for 
backdrop[39m
    [31m[1m>[22m[39m[90m 233 |[39m     
backgroundColor[33m:[39m 
[32m`${colors.charcoal[950]}66`[39m[33m,[39m
     [90m     |[39m                                   
     [31m[1m^[22m[39m
     [90m 234 |[39m   }[33m,[39m
     [90m 235 |[39m   detached[33m:[39m {
     [90m 236 |[39m     marginHorizontal[33m:[39m 
[35m16[39m[33m,[39m[0m

      at Object.<anonymous> 
(src/components/ui/modal.tsx:233:40)
      at Object.require 
(src/components/ui/date-picker.tsx:21:1)
      at Object.require 
(src/components/ui/index.tsx:7:1)
      at Object.require 
(src/components/onboarding/onboarding-pager.tsx:27:1)
      at Object.require (src/components/onboarding/onboa
rding-pager.test.tsx:19:1)

FAIL src/components/onboarding/notification-permission-p
rimer.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/onboarding/anima
ted-primer-icon.tsx:26:1)
      at Object.require (src/components/onboarding/notif
ication-permission-primer.tsx:11:1)
      at Object.require (src/components/onboarding/notif
ication-permission-primer.test.tsx:6:1)

FAIL 
src/components/nutrient-engine/quality-section.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/nutrient-engine/quality-section.tsx:9:1)
      at Object.require (src/components/nutrient-engine/
quality-section.test.tsx:6:1)

FAIL src/components/nutrient-engine/phase-adjustment-row
.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/nutrient-engine/
phase-adjustment-row.tsx:10:1)
      at Object.require (src/components/nutrient-engine/
phase-adjustment-row.test.tsx:7:1)

FAIL 
src/components/nutrient-engine/ph-ec-input-form.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/nutrient-engine/
ph-ec-input-form.tsx:14:1)
      at Object.require (src/components/nutrient-engine/
ph-ec-input-form.test.tsx:12:1)

FAIL src/components/nutrient-engine/feeding-adjustment-m
odal.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/nutrient-engine/
feeding-adjustment-modal.tsx:15:1)
      at Object.require (src/components/nutrient-engine/
feeding-adjustment-modal.test.tsx:15:1)

FAIL src/components/nutrient/template-list-item.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/nutrient/template-list-item.tsx:14:1)
      at Object.require (src/components/nutrient/templat
e-list-item.test.tsx:12:1)

FAIL src/components/nutrient/strain-profile-save-dialog.
test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/nutrient/strain-
profile-save-dialog.tsx:17:1)
      at Object.require (src/components/nutrient/strain-
profile-save-dialog.test.tsx:5:1)

FAIL src/components/nutrient/reservoir-form.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/nutrient/reservoir-form.tsx:12:1)
      at Object.require 
(src/components/nutrient/reservoir-form.test.tsx:5:1)

FAIL src/components/nutrient/ph-ec-reading-form.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/nutrient/ph-ec-reading-form.tsx:7:1)
      at Object.require (src/components/nutrient/ph-ec-r
eading-form.test.tsx:5:1)

FAIL src/components/nutrient/ph-ec-line-chart.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/nutrient/ph-ec-line-chart.tsx:22:1)
      at Object.require 
(src/components/nutrient/ph-ec-line-chart.test.tsx:11:1)

FAIL src/components/navigation/shared-header.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at requireActual 
(src/components/navigation/shared-header.test.tsx:17:36)
      at Object.require 
(src/components/navigation/shared-header.tsx:14:1)
      at Object.require 
(src/components/navigation/shared-header.test.tsx:6:1)

FAIL 
src/components/moderation/sor-preview-panels.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/moderation/sor-preview-panels.tsx:11:1)
      at Object.require (src/components/moderation/sor-p
review-panels.test.tsx:5:1)

FAIL src/components/moderation/original-decision-context
.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/moderation/origi
nal-decision-context.tsx:4:1)
      at Object.require (src/components/moderation/origi
nal-decision-context.test.tsx:6:1)

FAIL src/components/moderation/flagger-analytics-dashboa
rd.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/moderation/flagg
er-analytics-dashboard.tsx:11:1)
      at Object.require (src/components/moderation/flagg
er-analytics-dashboard.test.tsx:5:1)

FAIL src/components/moderation/counter-arguments-input.t
est.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/moderation/count
er-arguments-input.tsx:4:1)
      at Object.require (src/components/moderation/count
er-arguments-input.test.tsx:5:1)

FAIL src/components/inventory/inventory-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/inventory/inventory-list-item.tsx:14:1)
      at Object.require 
(src/components/inventory/inventory-list.tsx:23:1)
      at Object.require 
(src/components/inventory/inventory-list.test.tsx:11:1)

FAIL src/components/inventory/consumption-trend-chart.te
st.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/inventory/consum
ption-trend-chart.tsx:9:1)
      at Object.require (src/components/inventory/consum
ption-trend-chart.test.tsx:6:1)

FAIL src/components/inventory/batch-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/inventory/batch-list-item.tsx:13:1)
      at Object.require 
(src/components/inventory/batch-list.tsx:12:1)
      at Object.require 
(src/components/inventory/batch-list.test.tsx:12:1)

FAIL src/components/home/activation-checklist.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/home/activation-checklist.tsx:9:1)
      at Object.require 
(src/components/home/activation-checklist.test.tsx:12:1)

FAIL src/components/harvest/weight-chart.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\component
s\harvest\weight-chart.test.tsx: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: View
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 17 |[39m   
[33mLineChart[39m[33m:[39m ({ data[33m,[39m 
testID }[33m:[39m any) [33m=>[39m {
     [90m 18 |[39m     [36mreturn[39m (
    [31m[1m>[22m[39m[90m 19 |[39m       
[33m<[39m[33mView[39m testID[33m=[39m{testID 
[33m||[39m [32m'line-chart'[39m}[33m>[39m
     [90m    |[39m        [31m[1m^[22m[39m[31m[1
m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
     [90m 20 |[39m         [33m<[39m[33mText[39m t
estID[33m=[39m[32m"chart-data-count"[39m[33m>[39m{
data[33m.[39mlength}[33m<[39m[33m/[39m[33mText[3
9m[33m>[39m
     [90m 21 |[39m         
{data[33m.[39mmap((point[33m:[39m any[33m,[39m 
index[33m:[39m number) [33m=>[39m (
     [90m 22 |[39m           
[33m<[39m[33mText[39m key[33m=[39m{index} testID[
33m=[39m{[32m`chart-point-${index}`[39m}[33m>[39m[
0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/components/harvest/weight-chart-table.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/harvest/weight-chart-table.tsx:14:1)
      at Object.require (src/components/harvest/weight-c
hart-table.test.tsx:12:1)

FAIL src/components/harvest/weight-chart-empty.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/harvest/weight-chart-empty.tsx:12:1)
      at Object.require (src/components/harvest/weight-c
hart-empty.test.tsx:11:1)

FAIL 
src/components/harvest/harvest-history-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/harvest/harvest-history-list.tsx:4:1)
      at Object.require (src/components/harvest/harvest-
history-list.test.tsx:8:1)

FAIL 
src/components/harvest/harvest-error-banner.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/harvest/harvest-error-banner.tsx:11:1)
      at Object.require (src/components/harvest/harvest-
error-banner.test.tsx:11:1)

FAIL 
src/components/harvest/harvest-chart-container.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\component
s\harvest\harvest-chart-container.test.tsx: The module 
factory of `jest.mock()` is not allowed to reference 
any out-of-scope variables.
    Invalid variable access: View
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 17 |[39m jest[33m.[39mmock([32m'./wei
ght-chart'[39m[33m,[39m () [33m=>[39m ({
     [90m 18 |[39m   [33mWeightChart[39m[33m:[39m 
jest[33m.[39mfn((props[33m:[39m any) [33m=>[39m (
    [31m[1m>[22m[39m[90m 19 |[39m     
[33m<[39m[33mView[39m 
testID[33m=[39m{props[33m.[39mtestID [33m||[39m 
[32m'weight-chart'[39m}[33m>[39m
     [90m    |[39m      [31m[1m^[22m[39m[31m[1m^
[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
     [90m 20 |[39m       [33m<[39m[33mText[39m tes
tID[33m=[39m{[32m`${props.testID}-data-count`[39m}[
33m>[39m{props[33m.[39mdata[33m.[39mlength}[33m<[
39m[33m/[39m[33mText[39m[33m>[39m
     [90m 21 |[39m     
[33m<[39m[33m/[39m[33mView[39m[33m>[39m
     [90m 22 |[39m   ))[33m,[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL 
src/components/community/user-profile-header.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/community/user-profile-header.tsx:10:1)
      at Object.require (src/components/community/user-p
rofile-header.test.tsx:12:1)

FAIL 
src/components/community/community-empty-state.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/community/community-empty-state.tsx:4:1)
      at Object.require (src/components/community/commun
ity-empty-state.test.tsx:5:1)

FAIL 
src/components/calendar/draggable-agenda-item.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/calendar/drag-handle.tsx:4:1)
      at Object.require 
(src/components/calendar/agenda-item.tsx:4:1)
      at Object.require 
(src/components/calendar/draggable-agenda-item.tsx:14:1)
      at Object.require (src/components/calendar/draggab
le-agenda-item.test.tsx:4:1)

FAIL 
src/components/calendar/calendar-empty-state.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/calendar/calendar-empty-state.tsx:4:1)
      at Object.require (src/components/calendar/calenda
r-empty-state.test.tsx:5:1)

FAIL src/components/calendar/agenda-list.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/calendar/agenda-list.test.tsx:5:1)

FAIL src/components/calendar/agenda-item.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/calendar/drag-handle.tsx:4:1)
      at Object.require 
(src/components/calendar/agenda-item.tsx:4:1)
      at Object.require 
(src/components/calendar/agenda-item.test.tsx:6:1)

FAIL src/components/auth/offline-mode-banner.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/auth/offline-mode-banner.tsx:4:1)
      at Object.require 
(src/components/auth/offline-mode-banner.test.tsx:3:1)

FAIL 
src/components/assessment/queue-status-sheet.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/assessment/queue-status-sheet.tsx:4:1)
      at Object.require (src/components/assessment/queue
-status-sheet.test.tsx:5:1)

FAIL 
src/components/assessment/diagnostic-checklist.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/assessment/diagnostic-checklist.tsx:5:1)
      at Object.require (src/components/assessment/diagn
ostic-checklist.test.tsx:6:1)

FAIL 
src/components/assessment/community-cta-button.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/assessment/commu
nity-cta-button.tsx:13:1)
      at Object.require (src/components/assessment/commu
nity-cta-button.test.tsx:15:1)

FAIL src/components/assessment/assessment-feedback-sheet
.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/assessment/asses
sment-feedback-sheet.tsx:5:1)
      at Object.require (src/components/assessment/asses
sment-feedback-sheet.test.tsx:5:1)

FAIL 
src/app/__tests__/post-moderation-visibility.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/community/comment-input-footer.tsx:7:1)
      at Object.require 
(src/components/community/post-detail-content.tsx:10:1)
      at Object.require (src/app/feed/[id].tsx:22:1)
      at Object.require (src/app/__tests__/post-moderati
on-visibility.test.tsx:3:1)

FAIL src/app/__tests__/onboarding-flow.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/legal-confirmation-modal.tsx:5:1)
      at Object.require (src/app/age-gate.tsx:6:1)
      at Object.require 
(src/app/__tests__/onboarding-flow.test.tsx:13:1)

FAIL src/app/__tests__/calendar-works-without-notificati
ons.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/calendar/month-picker-modal.tsx:7:1)
      at Object.require 
(src/components/calendar/calendar-header.tsx:7:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../calendar.tsx:12:1)
      at Object.require (src/app/__tests__/calendar-work
s-without-notifications.test.tsx:4:1)

FAIL src/app/__tests__/add-post.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\app\__tes
ts__\add-post.test.tsx: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: mutateMock
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 18 |[39m
     [90m 19 |[39m 
jest[33m.[39mmock([32m'@/api'[39m[33m,[39m () 
[33m=>[39m ({
    [31m[1m>[22m[39m[90m 20 |[39m   
useAddPost[33m:[39m () [33m=>[39m ({ 
mutate[33m:[39m mutateMock[33m,[39m 
isPending[33m:[39m [36mfalse[39m })[33m,[39m
     [90m    |[39m                                [31
m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m
[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m
[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[
22m[39m[31m[1m^[22m[39m
     [90m 21 |[39m }))[33m;[39m
     [90m 22 |[39m
     [90m 23 |[39m jest[33m.[39mmock([32m'@/lib/ass
essment/community-post-prefill'[39m[33m,[39m () 
[33m=>[39m ({[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/app/settings/storage.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/app/settings/storage.tsx:14:1)
      at Object.require 
(src/app/settings/storage.test.tsx:5:1)

FAIL src/app/settings/security.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/auth/change-password-modal.tsx:16:1)
      at Object.require 
(src/app/settings/security.tsx:12:1)
      at Object.require 
(src/app/settings/security.test.tsx:4:1)

FAIL src/app/settings/delete-account.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/app/settings/delete-account.tsx:23:1)
      at Object.require 
(src/app/settings/delete-account.test.tsx:12:1)

FAIL src/app/settings/delete-account-flow.test.tsx
  ÔùÅ Test suite failed to run

    TypeError: Cannot read properties of undefined 
(reading 'SCROLLVIEW')

    [0m [90m 39 |[39m   
[33mBottomSheetScrollViewMethods[39m[33m,[39m
     [90m 40 |[39m   
[33mBottomSheetKeyboardAwareProps[39m
    [31m[1m>[22m[39m[90m 41 |[39m [33m>[39m([33
mSCROLLABLE_TYPE[39m[33m.[39m[33mSCROLLVIEW[39m[33
m,[39m [33mAnimatedScrollView[39m)[33m;[39m
     [90m    |[39m                   
[31m[1m^[22m[39m
     [90m 42 |[39m [36mconst[39m 
[33mBottomSheetKeyboardAwareScrollView[39m 
[33m=[39m memo([33mBottomSheetScrollViewComponent[39
m)[33m;[39m
     [90m 43 |[39m
     [90m 44 |[39m [33mBottomSheetKeyboardAwareScroll
View[39m[33m.[39mdisplayName [33m=[39m[0m

      at Object.SCROLLVIEW (src/components/ui/modal-keyb
oard-aware-scroll-view.tsx:41:19)
      at Object.require 
(src/components/auth/re-auth-modal.tsx:20:1)
      at Object.require 
(src/app/settings/delete-account.tsx:22:1)
      at Object.require 
(src/app/settings/delete-account-flow.test.tsx:21:1)

FAIL src/app/settings/active-sessions.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/auth/session-list-item.tsx:6:1)
      at Object.require 
(src/app/settings/active-sessions.tsx:5:1)
      at Object.require 
(src/app/settings/active-sessions.test.tsx:6:1)

FAIL src/app/settings/about.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/settings/item.tsx:3:1)
      at Object.require (src/app/settings/about.tsx:8:1)
      at Object.require 
(src/app/settings/about.test.tsx:10:1)

FAIL src/app/(app)/index.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/home/activation-checklist.tsx:9:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../index.tsx:10:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(app)../../../index.test.tsx:7:1)

FAIL src/app/(modals)/trichome-helper.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/trichome/harvest
-suggestion-card.tsx:10:1)
      at Object.require 
(src/components/trichome/index.ts:7:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(modals)../../../trichome-helper.tsx:13:1)
      at Object.require (C:\Users\Peter\GrowBro\src\app\
(modals)../../../trichome-helper.test.tsx:6:1)

FAIL src/api/community/use-like-post.test.ts
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\api\commu
nity\use-like-post.test.ts: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: canonicalState
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 44 |[39m     constructor(
     [90m 45 |[39m       message[33m:[39m 
string[33m,[39m
    [31m[1m>[22m[39m[90m 46 |[39m       
[36mpublic[39m readonly canonicalState[33m:[39m {
     [90m    |[39m                       
[31m[1m^[22m[39m
     [90m 47 |[39m         
post_id[33m?[39m[33m:[39m string[33m;[39m
     [90m 48 |[39m         
user_id[33m?[39m[33m:[39m string[33m;[39m
     [90m 49 |[39m         
exists[33m?[39m[33m:[39m boolean[33m;[39m[0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/components/privacy-settings.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/privacy-settings.tsx:5:1)
      at Object.require 
(src/components/privacy-settings.test.tsx:9:1)

FAIL src/components/photo-capture.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/photo-capture.tsx:6:1)
      at Object.require 
(src/components/photo-capture.test.tsx:5:1)

FAIL src/components/moderation-actions.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/community/modera
tor-tools-modal.tsx:20:1)
      at Object.require 
(src/components/moderation-actions.tsx:3:1)
      at Object.require 
(src/components/moderation-actions.test.tsx:14:1)

FAIL src/components/login-form.test.tsx
  ÔùÅ Test suite failed to run

    ReferenceError: C:\Users\Peter\GrowBro\src\component
s\login-form.test.tsx: The module factory of 
`jest.mock()` is not allowed to reference any 
out-of-scope variables.
    Invalid variable access: hasPlayServicesMock
    Allowed objects: AbortController, AbortSignal, 
AggregateError, Array, ArrayBuffer, Atomics, BigInt, 
BigInt64Array, BigUint64Array, Blob, Boolean, 
BroadcastChannel, Buffer, ByteLengthQueuingStrategy, 
CompressionStream, CountQueuingStrategy, Crypto, 
CryptoKey, CustomEvent, DOMException, DataView, Date, 
DecompressionStream, Error, EvalError, Event, 
EventTarget, File, FinalizationRegistry, Float32Array, 
Float64Array, FormData, Function, Generator, 
GeneratorFunction, Headers, Infinity, Int16Array, 
Int32Array, Int8Array, InternalError, Intl, Iterator, 
JSON, Map, Math, MessageChannel, MessageEvent, 
MessagePort, NaN, Navigator, Number, Object, 
Performance, PerformanceEntry, PerformanceMark, 
PerformanceMeasure, PerformanceObserver, 
PerformanceObserverEntryList, 
PerformanceResourceTiming, Promise, Proxy, RangeError, 
ReadableByteStreamController, ReadableStream, 
ReadableStreamBYOBReader, ReadableStreamBYOBRequest, 
ReadableStreamDefaultController, 
ReadableStreamDefaultReader, ReferenceError, Reflect, 
RegExp, Request, Response, Set, SharedArrayBuffer, 
String, SubtleCrypto, Symbol, SyntaxError, TextDecoder, 
TextDecoderStream, TextEncoder, TextEncoderStream, 
TransformStream, TransformStreamDefaultController, 
TypeError, URIError, URL, URLSearchParams, Uint16Array, 
Uint32Array, Uint8Array, Uint8ClampedArray, WeakMap, 
WeakRef, WeakSet, WebAssembly, WebSocket, 
WritableStream, WritableStreamDefaultController, 
WritableStreamDefaultWriter, __dirname, __filename, 
arguments, atob, btoa, clearImmediate, clearInterval, 
clearTimeout, console, crypto, decodeURI, 
decodeURIComponent, encodeURI, encodeURIComponent, 
escape, eval, expect, exports, fetch, global, 
globalThis, isFinite, isNaN, jest, module, navigator, 
parseFloat, parseInt, performance, process, 
queueMicrotask, require, setImmediate, setInterval, 
setTimeout, structuredClone, undefined, unescape.
    Note: This is a precaution to guard against 
uninitialized mock variables. If it is ensured that the 
mock is required lazily, variable names prefixed with 
`mock` (case insensitive) are permitted.

    [0m [90m 13 |[39m   __esModule[33m:[39m 
[36mtrue[39m[33m,[39m
     [90m 14 |[39m   
[33mGoogleSignin[39m[33m:[39m {
    [31m[1m>[22m[39m[90m 15 |[39m     
hasPlayServices[33m:[39m 
hasPlayServicesMock[33m,[39m
     [90m    |[39m                      [31m[1m^[22
m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^
[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m
[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[
31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22m[3
9m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^[22
m[39m[31m[1m^[22m[39m[31m[1m^[22m[39m[31m[1m^
[22m[39m[31m[1m^[22m[39m
     [90m 16 |[39m     signIn[33m:[39m 
googleSignInMock[33m,[39m
     [90m 17 |[39m   }[33m,[39m
     [90m 18 |[39m   
[33mGoogleSigninButton[39m[33m:[39m ({ 
onPress[33m,[39m testID }[33m:[39m any) 
[33m=>[39m ([0m

      at File.buildCodeFrameError (node_modules/@babel/c
ore/src/transformation/file/file.ts:257:12)
      at NodePath.buildError [as buildCodeFrameError] 
(node_modules/@babel/traverse/src/path/index.ts:157:21)
      at call 
(node_modules/@babel/traverse/src/visitors.ts:303:14)
      at NodePath.call [as _call] 
(node_modules/@babel/traverse/src/path/context.ts:36:20)
      at NodePath.call 
(node_modules/@babel/traverse/src/path/context.ts:21:18)
      at NodePath.call [as visit] 
(node_modules/@babel/traverse/src/path/context.ts:97:31)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitMultiple] 
(node_modules/@babel/traverse/src/context.ts:99:17)
      at TraversalContext.visitMultiple [as visit] 
(node_modules/@babel/traverse/src/context.ts:178:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at NodePath.visit (node_modules/@babel/traverse/sr
c/path/context.ts:104:33)
      at TraversalContext.visit [as visitQueue] 
(node_modules/@babel/traverse/src/context.ts:148:16)
      at TraversalContext.visitQueue [as visitSingle] 
(node_modules/@babel/traverse/src/context.ts:109:19)
      at TraversalContext.visitSingle [as visit] 
(node_modules/@babel/traverse/src/context.ts:180:19)
      at visit (node_modules/@babel/traverse/src/travers
e-node.ts:208:17)
      at traverse 
(node_modules/@babel/traverse/src/index.ts:84:15)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:119:15)
          at transformFile.next (<anonymous>)
      at transformFile (node_modules/@babel/core/src/tra
nsformation/index.ts:49:12)
          at run.next (<anonymous>)
      at transform 
(node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync 
(node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite
-stack-trace.ts:99:14)
      at transformSync 
(node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules
/@jest/transform/build/ScriptTransformer.js:545:31)
      at ScriptTransformer._transformAndBuildScript (nod
e_modules/@jest/transform/build/ScriptTransformer.js:674
:40)
      at ScriptTransformer.transform (node_modules/@jest
/transform/build/ScriptTransformer.js:726:19)

FAIL src/components/legal-confirmation-modal.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/legal-confirmation-modal.tsx:5:1)
      at Object.require 
(src/components/legal-confirmation-modal.test.tsx:12:1)

FAIL src/components/inputs.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/inputs.tsx:4:1)
      at Object.require 
(src/components/inputs.test.tsx:5:1)

FAIL src/components/consent-modal.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require 
(src/components/consent-modal.tsx:5:1)
      at Object.require 
(src/components/consent-modal.test.tsx:5:1)

FAIL src/app/camera-primer.test.tsx
  ÔùÅ Test suite failed to run

    Cannot find native module 'ExpoGlassEffect'

    [0m [90m 54 |[39m }[33m;[39m
     [90m 55 |[39m
    [31m[1m>[22m[39m[90m 56 |[39m [36mconst[39m 
glassAvailable [33m=[39m 
isLiquidGlassAvailable()[33m;[39m
     [90m    |[39m                                    
          [31m[1m^[22m[39m
     [90m 57 |[39m
     [90m 58 |[39m [36mexport[39m 
[36mfunction[39m [33mGlassSurface[39m({
     [90m 59 |[39m   glassEffectStyle [33m=[39m 
[32m'regular'[39m[33m,[39m[0m

      at requireNativeModule 
(node_modules/jest-expo/src/preset/setup.js:282:15)
      at isLiquidGlassAvailable (node_modules/expo-glass
-effect/src/isLiquidGlassAvailable.ios.ts:18:52)
      at Object.<anonymous> 
(src/components/shared/glass-surface.tsx:56:46)
      at Object.require 
(src/components/ui/glass-button.tsx:12:1)
      at Object.require 
(src/components/ui/index.tsx:10:1)
      at Object.require (src/components/onboarding/anima
ted-primer-icon.tsx:26:1)
      at Object.require (src/components/onboarding/camer
a-permission-primer.tsx:11:1)
      at Object.require 
(src/components/onboarding/index.ts:1:1)
      at Object.require (src/app/camera-primer.tsx:4:1)
      at Object.require 
(src/app/camera-primer.test.tsx:6:1)


Test Suites: 228 failed, 2 skipped, 224 passed, 452 of 
454 total
Tests:       655 failed, 9 skipped, 3690 passed, 4354 
total
Snapshots:   0 total
Time:        857.075 s
Ran all test suites.
Force exiting Jest: Have you considered using 
`--detectOpenHandles` to detect async operations that 
kept running after all tests finished?
